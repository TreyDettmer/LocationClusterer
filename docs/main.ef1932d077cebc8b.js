var $3e=Object.defineProperty,Aie=Object.getOwnPropertySymbols,B3e=Object.prototype.hasOwnProperty,V3e=Object.prototype.propertyIsEnumerable,y8=(rt,Ae,z)=>Ae in rt?$3e(rt,Ae,{enumerable:!0,configurable:!0,writable:!0,value:z}):rt[Ae]=z,Lv=(rt,Ae)=>{for(var z in Ae||(Ae={}))B3e.call(Ae,z)&&y8(rt,z,Ae[z]);if(Aie)for(var z of Aie(Ae))V3e.call(Ae,z)&&y8(rt,z,Ae[z]);return rt},gt=(rt,Ae,z)=>(y8(rt,"symbol"!=typeof Ae?Ae+"":Ae,z),z);(self.webpackChunkgeo_cluster=self.webpackChunkgeo_cluster||[]).push([[179],{1063:(rt,Ae,z)=>{"use strict";var G={};z.r(G),z.d(G,{arraysEqual:()=>ri,assert:()=>De,assertNonNegativeIntegerDimensions:()=>Bu,assertNonNull:()=>Ug,assertShapesMatch:()=>sa,bytesFromStringArray:()=>w7,bytesPerElement:()=>wC,checkConversionForErrors:()=>_7,clamp:()=>Op,computeStrides:()=>ur,convertBackendValuesAndArrayBuffer:()=>S7,createScalarValue:()=>Yf,createShuffledIndices:()=>Hue,decodeString:()=>Qf,distSquared:()=>Vue,encodeString:()=>Ph,fetch:()=>L7,fingerPrint64:()=>P7,flatten:()=>Lh,getArrayFromDType:()=>Ws,getTypedArrayFromDType:()=>Wo,hasEncodingLoss:()=>J4,hexToLong:()=>AS,indexToLoc:()=>jg,inferDtype:()=>Gg,inferFromImplicitShape:()=>Q4,isBoolean:()=>x7,isFunction:()=>Fp,isInt:()=>Hg,isNumber:()=>Yk,isPromise:()=>Xf,isScalarShape:()=>zue,isString:()=>Fh,isTypedArray:()=>jo,isValidDtype:()=>b7,locToIndex:()=>Wc,makeOnesTypedArray:()=>Jk,makeZerosNestedTypedArray:()=>eU,makeZerosTypedArray:()=>oa,nearestDivisor:()=>Qk,nearestLargerEven:()=>Kk,now:()=>aa,parseAxisParam:()=>Yr,randUniform:()=>Bue,repeatedTry:()=>Y4,rightPad:()=>Wg,shuffle:()=>X4,shuffleCombo:()=>$ue,sizeFromShape:()=>Xt,sizeToSquarishShape:()=>Xk,squeezeShape:()=>Kf,sum:()=>y7,swap:()=>Zf,tanh:()=>Uue,toNestedArray:()=>yl,toTypedArray:()=>Lp});var K={};z.r(K),z.d(K,{assertTypesMatch:()=>H7,getTensorsInContainer:()=>Jf,isTensorInList:()=>_R,makeTypesMatch:()=>Ds});var ue={};z.r(ue),z.d(ue,{isBrowser:()=>hU,isMobile:()=>cU,mockIsMobile:()=>Nle});var re={};z.r(re),z.d(re,{Serializable:()=>Jg,SerializationMap:()=>bl,registerClass:()=>Nn});var X={};z.r(X),z.d(X,{assertAndGetBroadcastShape:()=>Fr,getBroadcastDims:()=>tv,getReductionAxes:()=>go});var se={};z.r(se),z.d(se,{browserFiles:()=>$ce,browserHTTPRequest:()=>vZ,concatenateArrayBuffers:()=>wR,copyModel:()=>Kle,decodeWeights:()=>gU,encodeWeights:()=>pU,fromMemory:()=>Hce,fromMemorySync:()=>AR,getLoadHandlers:()=>J7,getModelArtifactsForJSON:()=>_U,getModelArtifactsForJSONSync:()=>yU,getModelArtifactsInfoForJSON:()=>OS,getSaveHandlers:()=>Q7,getWeightSpecs:()=>wU,http:()=>HU,isHTTPScheme:()=>UU,listModels:()=>qle,loadWeights:()=>dZ,moveModel:()=>Xle,registerLoadRouter:()=>Ple,registerSaveRouter:()=>Fle,removeModel:()=>Zle,weightsLoaderFactory:()=>pZ,withSaveHandler:()=>Wce,withSaveHandlerSync:()=>Gce});var be={};z.r(be),z.d(be,{confusionMatrix:()=>Jce});var V={};z.r(V),z.d(V,{fromPixels:()=>bZ,fromPixelsAsync:()=>ihe,toPixels:()=>she});var ee={};z.r(ee),z.d(ee,{prepareAndValidate:()=>IR});var ge={};z.r(ge),z.d(ge,{calculateShapes:()=>Vp,validateInput:()=>DR,validateUpdateShape:()=>ZU});var W={};z.r(W),z.d(W,{assertParamsValid:()=>XU,computeFlatOffset:()=>JU,computeOutShape:()=>YU,getNormalizedAxes:()=>uhe,isSliceContinous:()=>QU,maskToAxes:()=>ahe,parseSliceParams:()=>MR,sliceInfo:()=>e5,startForAxis:()=>TZ,startIndicesWithElidedDims:()=>SZ,stopForAxis:()=>AZ,stopIndicesWithElidedDims:()=>EZ,stridesForAxis:()=>NZ,stridesWithElidedDims:()=>wZ});var J={};z.r(J),z.d(J,{TEST_EPSILON_FLOAT16:()=>DZ,createVideoElement:()=>vhe,encodeStrings:()=>MZ,expectArrayBuffersEqual:()=>ghe,expectArraysClose:()=>hhe,expectArraysEqual:()=>dhe,expectNumbersClose:()=>phe,expectPromiseToFail:()=>fhe,expectValuesInRange:()=>mhe,play:()=>yhe,testEpsilon:()=>t5});var H={};z.r(H),z.d(H,{conv2d:()=>wK,depthwiseConv2d:()=>zpe,matMul:()=>hH});var Y={};z.r(Y),z.d(Y,{collectGatherOpShapeInfo:()=>$H,computeOutShape:()=>sX,segOpComputeOptimalWindowSize:()=>iX});var me={};z.r(me),z.d(me,{ERF_A1:()=>SH,ERF_A2:()=>EH,ERF_A3:()=>NH,ERF_A4:()=>TH,ERF_A5:()=>AH,ERF_P:()=>CH,PARALLELIZE_THRESHOLD:()=>_H,RowPartitionType:()=>hc,SELU_SCALE:()=>pO,SELU_SCALEALPHA:()=>dO,applyActivation:()=>aO,assertAndGetBroadcastShape:()=>Fr,assertAxesAreInnerMostDims:()=>ca,assertParamsConsistent:()=>yH,assignToTypedArray:()=>UK,axesAreInnerMostDims:()=>O5,calculateShapes:()=>Vp,checkEinsumDimSizes:()=>RH,checkPadOnDimRoundingMode:()=>Za,combineLocations:()=>VZ,combineRaggedTensorToTensorShapes:()=>FK,complexWithEvenIndex:()=>VK,complexWithOddIndex:()=>zK,computeConv2DInfo:()=>qo,computeConv3DInfo:()=>zp,computeDefaultPad:()=>p5,computeDilation2DInfo:()=>LS,computeOptimalWindowSize:()=>fO,computeOutAndReduceShapes:()=>Ko,computeOutShape:()=>Hh,computePool2DInfo:()=>uc,computePool3DInfo:()=>rd,convertConv2DDataFormat:()=>id,decodeEinsumEquation:()=>MH,eitherStridesOrDilationsAreOne:()=>la,expandShapeToKeepDim:()=>eo,exponent:()=>WK,exponents:()=>HK,fromStringArrayToUint8:()=>oX,fromUint8ToStringArray:()=>cd,getAxesPermutation:()=>ks,getBroadcastDims:()=>tv,getComplexWithIndex:()=>IH,getEinsumComputePath:()=>OH,getEinsumPermutation:()=>kH,getFusedBiasGradient:()=>oO,getFusedDyActivation:()=>sO,getImageCenter:()=>bH,getInnerMostAxes:()=>to,getPermuted:()=>rE,getRaggedRank:()=>LK,getReductionAxes:()=>go,getReshaped:()=>nE,getReshapedPermuted:()=>iE,getRowPartitionTypesHelper:()=>PK,getSliceBeginCoords:()=>wH,getSliceSize:()=>xH,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>qK,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>ZK,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>KK,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>QK,getSparseReshapeInputOutputMismatchErrorMessage:()=>eX,getSparseReshapeInputOutputMultipleErrorMessage:()=>JK,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>XK,getSparseReshapeNegativeOutputDimErrorMessage:()=>YK,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>rX,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>LH,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>tX,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>nX,getUndoAxesPermutation:()=>Hp,isIdentityPermutation:()=>FH,log:()=>ele,mergeRealAndImagArrays:()=>ld,prepareAndValidate:()=>IR,prepareSplitSize:()=>PH,segment_util:()=>Y,shouldFuse:()=>uO,slice_util:()=>W,splitRealAndImagArrays:()=>BK,stridesOrDilationsArePositive:()=>iv,tupleValuesAreOne:()=>Up,upcastType:()=>pu,validateDefaultValueShape:()=>$K,validateInput:()=>DR,validateUpdateShape:()=>ZU,warn:()=>_l});var te={};z.r(te),z.d(te,{nonMaxSuppressionV3Impl:()=>lO,nonMaxSuppressionV4Impl:()=>cO,nonMaxSuppressionV5Impl:()=>hO,whereImpl:()=>rO});var ce={};z.r(ce),z.d(ce,{maxNorm:()=>i_e,minMaxNorm:()=>a_e,nonNeg:()=>o_e,unitNorm:()=>s_e});var xe={};z.r(xe),z.d(xe,{constant:()=>c_e,glorotNormal:()=>v_e,glorotUniform:()=>g_e,heNormal:()=>y_e,heUniform:()=>__e,identity:()=>p_e,leCunNormal:()=>b_e,leCunUniform:()=>w_e,ones:()=>l_e,orthogonal:()=>x_e,randomNormal:()=>f_e,randomUniform:()=>h_e,truncatedNormal:()=>d_e,varianceScaling:()=>m_e,zeros:()=>u_e});var Pe={};z.r(Pe),z.d(Pe,{Layer:()=>Jr,RNN:()=>nm,RNNCell:()=>gE,activation:()=>Y0e,add:()=>obe,alphaDropout:()=>Hbe,average:()=>abe,averagePooling1d:()=>O6,averagePooling2d:()=>F6,averagePooling3d:()=>P6,avgPool1d:()=>gbe,avgPool2d:()=>ybe,avgPool3d:()=>bbe,avgPooling1d:()=>vbe,avgPooling2d:()=>_be,avgPooling3d:()=>wbe,batchNormalization:()=>dbe,bidirectional:()=>Fbe,categoryEncoding:()=>Zbe,centerCrop:()=>jbe,concatenate:()=>ube,conv1d:()=>U0e,conv2d:()=>H0e,conv2dTranspose:()=>W0e,conv3d:()=>G0e,conv3dTranspose:()=>j0e,convLstm2d:()=>Mbe,convLstm2dCell:()=>kbe,cropping2D:()=>Z0e,dense:()=>Q0e,depthwiseConv2d:()=>X0e,dot:()=>fbe,dropout:()=>J0e,elu:()=>P0e,embedding:()=>sbe,flatten:()=>tbe,gaussianDropout:()=>Ube,gaussianNoise:()=>zbe,globalAveragePooling1d:()=>xbe,globalAveragePooling2d:()=>Cbe,globalMaxPool1d:()=>Lbe,globalMaxPool2d:()=>$be,globalMaxPooling1d:()=>FQ,globalMaxPooling2d:()=>PQ,gru:()=>Ebe,gruCell:()=>Nbe,input:()=>bY,inputLayer:()=>F0e,layerNormalization:()=>pbe,leakyReLU:()=>$0e,lstm:()=>Tbe,lstmCell:()=>Abe,masking:()=>Wbe,maxPool1d:()=>Bbe,maxPool2d:()=>Vbe,maxPooling1d:()=>LQ,maxPooling2d:()=>$Q,maxPooling3d:()=>Sbe,maximum:()=>lbe,minimum:()=>cbe,multiply:()=>hbe,permute:()=>ibe,prelu:()=>B0e,randomWidth:()=>Kbe,reLU:()=>L0e,repeatVector:()=>nbe,rescaling:()=>Gbe,reshape:()=>rbe,resizing:()=>qbe,rnn:()=>Rbe,separableConv2d:()=>q0e,simpleRNN:()=>Ibe,simpleRNNCell:()=>Dbe,softmax:()=>V0e,spatialDropout1d:()=>ebe,stackedRNNCells:()=>Obe,thresholdedReLU:()=>z0e,timeDistributed:()=>Pbe,upSampling2d:()=>K0e,zeroPadding2d:()=>mbe});var Ke={};z.r(Ke),z.d(Ke,{MAPE:()=>owe,MSE:()=>lwe,binaryAccuracy:()=>Xbe,binaryCrossentropy:()=>Ybe,categoricalAccuracy:()=>Jbe,categoricalCrossentropy:()=>ewe,cosineProximity:()=>rwe,mape:()=>awe,meanAbsoluteError:()=>iwe,meanAbsolutePercentageError:()=>swe,meanSquaredError:()=>uwe,mse:()=>cwe,precision:()=>twe,recall:()=>nwe,sparseCategoricalAccuracy:()=>Qbe});var Ve={};z.r(Ve),z.d(Ve,{modelFromJSON:()=>u0e});var it={};z.r(it),z.d(it,{l1:()=>fwe,l1l2:()=>hwe,l2:()=>dwe});var bt={};z.r(bt),z.d(bt,{json:()=>ywe});var $e={};z.r($e),z.d($e,{json:()=>_we});var Ne={};z.r(Ne),z.d(Ne,{json:()=>bwe});var we={};z.r(we),z.d(we,{json:()=>wwe});var qe={};z.r(qe),z.d(qe,{json:()=>xwe});var Ye={};z.r(Ye),z.d(Ye,{json:()=>Cwe});var at={};z.r(at),z.d(at,{json:()=>Swe});var At={};z.r(At),z.d(At,{json:()=>Ewe});var Ut={};z.r(Ut),z.d(Ut,{json:()=>Nwe});var Mt={};z.r(Mt),z.d(Mt,{json:()=>Twe});var sn={};z.r(sn),z.d(sn,{json:()=>Awe});var je={};z.r(je),z.d(je,{json:()=>Iwe});var We={};z.r(We),z.d(We,{json:()=>Dwe});var tt={};z.r(tt),z.d(tt,{json:()=>Mwe});var Pt={};z.r(Pt),z.d(Pt,{json:()=>kwe});var Ue={};z.r(Ue),z.d(Ue,{json:()=>Rwe});var xt={};z.r(xt),z.d(xt,{json:()=>Owe});var Vt={};z.r(Vt),z.d(Vt,{json:()=>Fwe});var Qt={};z.r(Qt),z.d(Qt,{json:()=>Pwe});var rn={};z.r(rn),z.d(rn,{OP_SCOPE_SUFFIX:()=>fU,abs:()=>mo,acos:()=>o5,acosh:()=>a5,add:()=>_n,addN:()=>OZ,all:()=>kR,any:()=>PS,argMax:()=>rv,argMin:()=>u5,asin:()=>l5,asinh:()=>c5,atan:()=>h5,atan2:()=>f5,atanh:()=>d5,avgPool:()=>VS,avgPool3d:()=>g5,basicLSTMCell:()=>FZ,batchNorm:()=>P0,batchNorm2d:()=>v5,batchNorm3d:()=>y5,batchNorm4d:()=>_5,batchToSpaceND:()=>zS,bincount:()=>b5,booleanMaskAsync:()=>mK,broadcastArgs:()=>PZ,broadcastTo:()=>ov,buffer:()=>Zr,cast:()=>Fn,ceil:()=>w5,clipByValue:()=>gu,clone:()=>Vh,complex:()=>ed,concat:()=>Js,concat1d:()=>x5,concat2d:()=>C5,concat3d:()=>S5,concat4d:()=>E5,conv1d:()=>RR,conv2d:()=>sd,conv2dTranspose:()=>OR,conv3d:()=>T5,conv3dTranspose:()=>A5,cos:()=>US,cosh:()=>FR,cosineWindow:()=>iO,cumprod:()=>HS,cumsum:()=>PR,denseBincount:()=>LR,depthToSpace:()=>I5,depthwiseConv2d:()=>L0,diag:()=>$Z,dilation2d:()=>D5,div:()=>nr,divNoNan:()=>M5,dot:()=>k5,dropout:()=>aH,einsum:()=>BZ,elu:()=>$0,enclosingPowerOfTwo:()=>uH,equal:()=>zu,erf:()=>R5,euclideanNorm:()=>F5,exp:()=>Uu,expandDims:()=>Ma,expm1:()=>P5,eye:()=>$R,fft:()=>eE,fill:()=>ev,floor:()=>z0,floorDiv:()=>ER,fused:()=>H,gather:()=>U0,gatherND:()=>_K,greater:()=>Ka,greaterEqual:()=>od,ifft:()=>j0,imag:()=>FS,image:()=>cc,inTopKAsync:()=>bK,irfft:()=>JR,isFinite:()=>L5,isInf:()=>$5,isNaN:()=>B5,leakyRelu:()=>WS,less:()=>H0,lessEqual:()=>Wp,linalg:()=>gH,linspace:()=>UZ,localResponseNormalization:()=>V5,log:()=>Hu,log1p:()=>GS,logSigmoid:()=>z5,logSoftmax:()=>BR,logSumExp:()=>VR,logicalAnd:()=>lc,logicalNot:()=>jS,logicalOr:()=>zR,logicalXor:()=>U5,losses:()=>kK,lowerBound:()=>HZ,matMul:()=>Qr,max:()=>wl,maxPool:()=>qS,maxPool3d:()=>H5,maxPoolWithArgmax:()=>WZ,maximum:()=>Uh,mean:()=>Rs,meshgrid:()=>GZ,min:()=>B0,minimum:()=>Gp,mirrorPad:()=>W5,mod:()=>G5,moments:()=>ZS,movingAverage:()=>gK,mul:()=>vt,multiRNNCell:()=>jZ,multinomial:()=>qZ,neg:()=>ss,norm:()=>V0,notEqual:()=>uv,oneHot:()=>R0,ones:()=>Wu,onesLike:()=>Gu,op:()=>ut,outerProduct:()=>ZZ,pad:()=>ad,pad1d:()=>KZ,pad2d:()=>XZ,pad3d:()=>YZ,pad4d:()=>QZ,pool:()=>j5,pow:()=>nd,prelu:()=>XS,print:()=>MU,prod:()=>q5,raggedGather:()=>JZ,raggedRange:()=>eK,raggedTensorToTensor:()=>tK,rand:()=>nK,randomGamma:()=>rK,randomNormal:()=>WR,randomStandardNormal:()=>iK,randomUniform:()=>lv,range:()=>cv,real:()=>O0,reciprocal:()=>X5,relu:()=>Zc,relu6:()=>GR,reshape:()=>wt,reverse:()=>Cl,reverse1d:()=>sK,reverse2d:()=>oK,reverse3d:()=>aK,reverse4d:()=>uK,rfft:()=>tE,round:()=>jR,rsqrt:()=>qR,scalar:()=>hr,scatterND:()=>vK,searchSorted:()=>HR,selu:()=>ZR,separableConv2d:()=>KR,setdiff1dAsync:()=>lK,sigmoid:()=>qc,sign:()=>Q5,signal:()=>MK,sin:()=>XR,sinh:()=>YR,slice:()=>ui,slice1d:()=>YS,slice2d:()=>QR,slice3d:()=>QS,slice4d:()=>G0,softmax:()=>JS,softplus:()=>av,spaceToBatchND:()=>KS,sparse:()=>RK,sparseToDense:()=>yK,spectral:()=>DK,split:()=>vu,sqrt:()=>ua,square:()=>Zi,squaredDifference:()=>eO,squeeze:()=>jp,stack:()=>yu,step:()=>hv,stridedSlice:()=>J5,string:()=>OK,sub:()=>qn,sum:()=>Yn,tan:()=>eH,tanh:()=>sv,tensor:()=>Vu,tensor1d:()=>ka,tensor2d:()=>qp,tensor3d:()=>GU,tensor4d:()=>cK,tensor5d:()=>hK,tensor6d:()=>fK,tensorScatterUpdate:()=>dK,tile:()=>xl,topk:()=>tH,transpose:()=>ii,truncatedNormal:()=>tO,unique:()=>nH,unsortedSegmentSum:()=>nO,unstack:()=>Sl,upperBound:()=>pK,variable:()=>rH,where:()=>Zo,whereAsync:()=>sH,zeros:()=>vo,zerosLike:()=>ai});var he={};z.r(he),z.d(he,{CSVDataset:()=>dJ,Dataset:()=>wE,FileDataSource:()=>yJ,TextLineDataset:()=>cJ,URLDataSource:()=>_J,array:()=>jxe,csv:()=>r1e,func:()=>i1e,generator:()=>s1e,microphone:()=>a1e,version_data:()=>bJ,webcam:()=>o1e,zip:()=>qxe});var _e={};z.r(_e),z.d(_e,{addImpl:()=>SJ,bincountImpl:()=>uW,bincountReduceImpl:()=>EJ,castImpl:()=>CJ,ceilImpl:()=>NJ,concatImpl:()=>TJ,equalImpl:()=>AJ,expImpl:()=>DJ,expm1Impl:()=>kJ,floorDivImpl:()=>OJ,floorImpl:()=>RJ,gatherNdImpl:()=>FJ,gatherV2Impl:()=>PJ,greaterEqualImpl:()=>$J,greaterImpl:()=>LJ,lessEqualImpl:()=>VJ,lessImpl:()=>BJ,linSpaceImpl:()=>zJ,logImpl:()=>UJ,maxImpl:()=>HJ,maximumImpl:()=>WJ,minimumImpl:()=>GJ,multiplyImpl:()=>lW,negImpl:()=>jJ,notEqualImpl:()=>qJ,prodImpl:()=>ZJ,raggedGatherImpl:()=>XJ,raggedRangeImpl:()=>QJ,raggedTensorToTensorImpl:()=>tee,rangeImpl:()=>nee,rsqrtImpl:()=>ree,scatterImpl:()=>Cv,sigmoidImpl:()=>rCe,simpleAbsImpl:()=>xJ,sliceImpl:()=>see,sparseFillEmptyRowsImpl:()=>oee,sparseReshapeImpl:()=>aee,sparseSegmentReductionImpl:()=>hW,sqrtImpl:()=>oCe,squaredDifferenceImpl:()=>uee,staticRegexReplaceImpl:()=>lee,stridedSliceImpl:()=>cee,stringNGramsImpl:()=>hee,stringSplitImpl:()=>fee,stringToHashBucketFastImpl:()=>dee,subImpl:()=>pee,tileImpl:()=>mee,topKImpl:()=>vee,transposeImpl:()=>cW,uniqueImpl:()=>yee});var Fe={};z.r(Fe),z.d(Fe,{assertNotComplex:()=>ob,bindCanvasToFramebuffer:()=>BAe,bindColorTextureToFramebuffer:()=>uF,bindTextureToProgramUniformSampler:()=>Jee,bindTextureUnit:()=>Xee,bindVertexBufferToProgramAttribute:()=>bW,callAndCheck:()=>Ln,canBeRepresented:()=>Bee,createFragmentShader:()=>Uee,createFramebuffer:()=>Kee,createProgram:()=>Hee,createStaticIndexBuffer:()=>jee,createStaticVertexBuffer:()=>Gee,createTexture:()=>qee,createVertexShader:()=>zee,getBatchDim:()=>Ev,getExtensionOrThrow:()=>TE,getFramebufferErrorMessage:()=>ete,getMaxTexturesInShader:()=>ite,getNumChannels:()=>LAe,getProgramUniformLocation:()=>Qee,getProgramUniformLocationOrThrow:()=>Yee,getRowsCols:()=>Nv,getShapeAs3D:()=>IE,getTextureShapeFromLogicalShape:()=>nte,getWebGLDisjointQueryTimerVersion:()=>ste,getWebGLErrorMessage:()=>Vee,getWebGLMaxTextureSize:()=>rte,hasExtension:()=>Al,isCapableOfRenderingToFloatTexture:()=>ote,isDownloadFloatTextureEnabled:()=>ate,isReshapeFree:()=>DE,isWebGLFenceEnabled:()=>ute,isWebGLVersionEnabled:()=>xW,linkProgram:()=>Wee,logShaderSourceAndInfoLog:()=>_W,resetMaxTextureSize:()=>VAe,resetMaxTexturesInShader:()=>zAe,unbindColorTextureFromFramebuffer:()=>wW,unbindTextureUnit:()=>$Ae,validateFramebuffer:()=>AE,validateProgram:()=>aF,validateTextureSize:()=>Zee});var yt={};z.r(yt),z.d(yt,{bindVertexProgramAttributeStreams:()=>Ste,createBufferFromOutputTexture:()=>Tte,createFloat16MatrixTexture:()=>bte,createFloat16PackedMatrixTexture:()=>Cte,createFloat32MatrixTexture:()=>_te,createIndexBuffer:()=>yte,createPackedMatrixTexture:()=>xte,createUnsignedBytesMatrixTexture:()=>wte,createVertexBuffer:()=>vte,createVertexShader:()=>gte,downloadByteEncodedFloatMatrixFromOutputTexture:()=>Ite,downloadFloat32MatrixFromBuffer:()=>Ate,downloadMatrixFromPackedOutputTexture:()=>Mte,downloadPackedMatrixFromBuffer:()=>Dte,getInternalFormatForFloat16MatrixTexture:()=>AW,getInternalFormatForFloat16PackedMatrixTexture:()=>MW,getInternalFormatForFloat32MatrixTexture:()=>TW,getInternalFormatForPackedMatrixTexture:()=>DW,getInternalFormatForUnsignedBytesMatrixTexture:()=>IW,uploadDenseMatrixToTexture:()=>Ete,uploadPixelDataToTexture:()=>Nte});var _t={};function pt(n){return"function"==typeof n}function Sn(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}z.r(_t),z.d(_t,{Abs:()=>xC,Acos:()=>M_,Acosh:()=>k_,AdadeltaOptimizer:()=>RU,AdagradOptimizer:()=>OU,AdamOptimizer:()=>FU,AdamaxOptimizer:()=>PU,Add:()=>qg,AddN:()=>CC,All:()=>e2,Any:()=>t2,ArgMax:()=>SC,ArgMin:()=>EC,Asin:()=>R_,Asinh:()=>O_,Atan:()=>F_,Atan2:()=>L_,Atanh:()=>P_,AvgPool:()=>NC,AvgPool3D:()=>TC,AvgPool3DGrad:()=>r2,AvgPoolGrad:()=>n2,BatchMatMul:()=>AC,BatchToSpaceND:()=>IC,Bincount:()=>s2,BroadcastArgs:()=>o2,BroadcastTo:()=>A7,Callback:()=>BQ,CallbackList:()=>XX,Cast:()=>$_,Ceil:()=>B_,ClipByValue:()=>V_,Complex:()=>a2,ComplexAbs:()=>DC,Concat:()=>MC,Conv2D:()=>kC,Conv2DBackpropFilter:()=>u2,Conv2DBackpropInput:()=>RC,Conv3D:()=>OC,Conv3DBackpropFilterV2:()=>l2,Conv3DBackpropInputV2:()=>c2,Cos:()=>z_,Cosh:()=>U_,CropAndResize:()=>f2,Cumprod:()=>h2,Cumsum:()=>FC,CustomCallback:()=>QX,DataStorage:()=>K4,DenseBincount:()=>d2,DepthToSpace:()=>p2,DepthwiseConv2dNative:()=>PC,DepthwiseConv2dNativeBackpropFilter:()=>m2,DepthwiseConv2dNativeBackpropInput:()=>g2,Diag:()=>v2,Dilation2D:()=>LC,Dilation2DBackpropFilter:()=>_2,Dilation2DBackpropInput:()=>y2,ENV:()=>tU,EarlyStopping:()=>zQ,Einsum:()=>b2,Elu:()=>W_,EluGrad:()=>w2,Environment:()=>N7,Equal:()=>$C,Erf:()=>G_,Exp:()=>j_,ExpandDims:()=>BC,Expm1:()=>q_,FFT:()=>x2,Fill:()=>C2,FlipLeftRight:()=>S2,Floor:()=>Z_,FloorDiv:()=>K_,FromPixels:()=>oR,FusedBatchNorm:()=>VC,FusedConv2D:()=>ES,FusedDepthwiseConv2D:()=>NS,GPGPUContext:()=>pF,GatherNd:()=>E2,GatherV2:()=>zC,GraphModel:()=>Y6,Greater:()=>UC,GreaterEqual:()=>X_,History:()=>YX,IFFT:()=>N2,Identity:()=>Y_,Imag:()=>T2,InputSpec:()=>yo,IsFinite:()=>Q_,IsInf:()=>J_,IsNan:()=>e0,KernelBackend:()=>Zk,LRN:()=>KC,LRNGrad:()=>I2,LayerVariable:()=>Qc,LayersModel:()=>Jp,LeakyRelu:()=>HC,Less:()=>WC,LessEqual:()=>GC,LinSpace:()=>A2,Log:()=>t0,Log1p:()=>n0,LogSoftmax:()=>I7,LogicalAnd:()=>jC,LogicalNot:()=>qC,LogicalOr:()=>ZC,LogicalXor:()=>Kue,LowerBound:()=>Xue,MathBackendCPU:()=>wJ,MathBackendWebGL:()=>zte,MatrixBandPart:()=>Yue,Max:()=>XC,MaxPool:()=>YC,MaxPool3D:()=>QC,MaxPool3DGrad:()=>M2,MaxPoolGrad:()=>D2,MaxPoolWithArgmax:()=>k2,Maximum:()=>r0,Mean:()=>JC,Min:()=>eS,Minimum:()=>s0,MirrorPad:()=>tS,Mod:()=>o0,MomentumOptimizer:()=>LU,Multinomial:()=>R2,Multiply:()=>a0,Neg:()=>nS,NonMaxSuppressionV3:()=>O2,NonMaxSuppressionV4:()=>F2,NonMaxSuppressionV5:()=>P2,NotEqual:()=>rS,OP_SCOPE_SUFFIX:()=>fU,OneHot:()=>sS,OnesLike:()=>iS,Optimizer:()=>td,OptimizerConstructors:()=>RZ,Pack:()=>oS,PadV2:()=>aS,Pool:()=>Que,Pow:()=>u0,Prelu:()=>uS,Prod:()=>lS,RMSPropOptimizer:()=>$U,RNN:()=>nm,RaggedGather:()=>L2,RaggedRange:()=>$2,RaggedTensorToTensor:()=>B2,Range:()=>V2,Rank:()=>dR,Real:()=>z2,RealDiv:()=>H_,Reciprocal:()=>l0,Reduction:()=>Ra,Relu:()=>c0,Relu6:()=>h0,Reshape:()=>cS,ResizeBilinear:()=>fS,ResizeBilinearGrad:()=>H2,ResizeNearestNeighbor:()=>hS,ResizeNearestNeighborGrad:()=>U2,Reverse:()=>dS,RotateWithOffset:()=>aR,Round:()=>f0,Rsqrt:()=>d0,SGDOptimizer:()=>TR,ScatterNd:()=>W2,SearchSorted:()=>j2,Select:()=>pS,Selu:()=>p0,Sequential:()=>x6,Sigmoid:()=>y0,Sign:()=>v0,Sin:()=>m0,Sinh:()=>g0,Slice:()=>mS,Softmax:()=>_S,Softplus:()=>_0,SpaceToBatchND:()=>vS,SparseFillEmptyRows:()=>q2,SparseReshape:()=>Z2,SparseSegmentMean:()=>K2,SparseSegmentSum:()=>X2,SparseToDense:()=>Y2,SplitV:()=>yS,Sqrt:()=>b0,Square:()=>Q2,SquaredDifference:()=>w0,StaticRegexReplace:()=>bS,Step:()=>N0,StridedSlice:()=>J2,StringNGrams:()=>eR,StringSplit:()=>tR,StringToHashBucketFast:()=>nR,Sub:()=>x0,Sum:()=>gS,SymbolicTensor:()=>Jc,Tan:()=>C0,Tanh:()=>S0,Tensor:()=>yi,TensorBuffer:()=>po,TensorScatterUpdate:()=>G2,Tile:()=>E0,TopK:()=>rR,Transform:()=>iR,Transpose:()=>Zg,Unique:()=>sR,Unpack:()=>wS,UnsortedSegmentSum:()=>xS,UpperBound:()=>Jue,Variable:()=>kS,ZerosLike:()=>CS,_FusedMatMul:()=>SS,abs:()=>mo,acos:()=>o5,acosh:()=>a5,add:()=>_n,addN:()=>OZ,all:()=>kR,any:()=>PS,argMax:()=>rv,argMin:()=>u5,asin:()=>l5,asinh:()=>c5,atan:()=>h5,atan2:()=>f5,atanh:()=>d5,avgPool:()=>VS,avgPool3d:()=>g5,backend:()=>uZ,backend_util:()=>me,basicLSTMCell:()=>FZ,batchNorm:()=>P0,batchNorm2d:()=>v5,batchNorm3d:()=>y5,batchNorm4d:()=>_5,batchToSpaceND:()=>zS,bincount:()=>b5,booleanMaskAsync:()=>mK,broadcastArgs:()=>PZ,broadcastTo:()=>ov,broadcast_util:()=>X,browser:()=>V,buffer:()=>Zr,callbacks:()=>mwe,cast:()=>Fn,ceil:()=>w5,clipByValue:()=>gu,clone:()=>Vh,complex:()=>ed,concat:()=>Js,concat1d:()=>x5,concat2d:()=>C5,concat3d:()=>S5,concat4d:()=>E5,constraints:()=>ce,conv1d:()=>RR,conv2d:()=>sd,conv2dTranspose:()=>OR,conv3d:()=>T5,conv3dTranspose:()=>A5,copyRegisteredKernels:()=>rle,cos:()=>US,cosh:()=>FR,cosineWindow:()=>iO,cumprod:()=>HS,cumsum:()=>PR,customGrad:()=>zh,data:()=>he,denseBincount:()=>LR,deprecationWarn:()=>aZ,depthToSpace:()=>I5,depthwiseConv2d:()=>L0,deregisterOp:()=>vwe,device_util:()=>ue,diag:()=>$Z,dilation2d:()=>D5,disableDeprecationWarnings:()=>ice,dispose:()=>Or,disposeVariables:()=>sce,div:()=>nr,divNoNan:()=>M5,dot:()=>k5,dropout:()=>aH,einsum:()=>BZ,elu:()=>$0,enableDebugMode:()=>rce,enableProdMode:()=>nce,enclosingPowerOfTwo:()=>uH,engine:()=>jc,env:()=>Ft,equal:()=>zu,erf:()=>R5,euclideanNorm:()=>F5,exp:()=>Uu,expandDims:()=>Ma,expm1:()=>P5,eye:()=>$R,fft:()=>eE,fill:()=>ev,findBackend:()=>fce,findBackendFactory:()=>dce,floor:()=>z0,floorDiv:()=>ER,forceHalfFloat:()=>Hte,fused:()=>H,gather:()=>U0,gatherND:()=>_K,gather_util:()=>ee,getBackend:()=>cce,getGradient:()=>iU,getKernel:()=>uR,getKernelsForBackend:()=>lR,gpgpu_util:()=>yt,grad:()=>xce,grads:()=>Cce,greater:()=>Ka,greaterEqual:()=>od,ifft:()=>j0,imag:()=>FS,image:()=>cc,inTopKAsync:()=>bK,initializers:()=>xe,input:()=>bY,io:()=>se,irfft:()=>JR,isFinite:()=>L5,isInf:()=>$5,isNaN:()=>B5,keep:()=>Ao,kernel_impls:()=>te,layers:()=>Pe,leakyRelu:()=>WS,less:()=>H0,lessEqual:()=>Wp,linalg:()=>gH,linspace:()=>UZ,loadGraphModel:()=>Cxe,loadGraphModelSync:()=>Sxe,loadLayersModel:()=>l0e,localResponseNormalization:()=>V5,log:()=>Hu,log1p:()=>GS,logSigmoid:()=>z5,logSoftmax:()=>BR,logSumExp:()=>VR,logicalAnd:()=>lc,logicalNot:()=>jS,logicalOr:()=>zR,logicalXor:()=>U5,losses:()=>kK,lowerBound:()=>HZ,matMul:()=>Qr,math:()=>be,max:()=>wl,maxPool:()=>qS,maxPool3d:()=>H5,maxPoolWithArgmax:()=>WZ,maximum:()=>Uh,mean:()=>Rs,memory:()=>SR,meshgrid:()=>GZ,metrics:()=>Ke,min:()=>B0,minimum:()=>Gp,mirrorPad:()=>W5,mod:()=>G5,model:()=>f0e,models:()=>Ve,moments:()=>ZS,movingAverage:()=>gK,mul:()=>vt,multiRNNCell:()=>jZ,multinomial:()=>qZ,neg:()=>ss,nextFrame:()=>vH,norm:()=>V0,notEqual:()=>uv,oneHot:()=>R0,ones:()=>Wu,onesLike:()=>Gu,op:()=>ut,outerProduct:()=>ZZ,pad:()=>ad,pad1d:()=>KZ,pad2d:()=>XZ,pad3d:()=>YZ,pad4d:()=>QZ,pool:()=>j5,pow:()=>nd,prelu:()=>XS,print:()=>MU,prod:()=>q5,profile:()=>oce,raggedGather:()=>JZ,raggedRange:()=>eK,raggedTensorToTensor:()=>tK,rand:()=>nK,randomGamma:()=>rK,randomNormal:()=>WR,randomStandardNormal:()=>iK,randomUniform:()=>lv,range:()=>cv,ready:()=>lce,real:()=>O0,reciprocal:()=>X5,registerBackend:()=>kU,registerCallbackConstructor:()=>p0e,registerGradient:()=>D7,registerKernel:()=>cR,registerOp:()=>gwe,regularizers:()=>it,relu:()=>Zc,relu6:()=>GR,removeBackend:()=>hce,reshape:()=>wt,reverse:()=>Cl,reverse1d:()=>sK,reverse2d:()=>oK,reverse3d:()=>aK,reverse4d:()=>uK,rfft:()=>tE,round:()=>jR,rsqrt:()=>qR,scalar:()=>hr,scatterND:()=>vK,scatter_util:()=>ge,searchSorted:()=>HR,selu:()=>ZR,separableConv2d:()=>KR,sequential:()=>d0e,serialization:()=>re,setBackend:()=>uce,setPlatform:()=>pce,setWebGLContext:()=>$ee,setdiff1dAsync:()=>lK,shared:()=>_e,sigmoid:()=>qc,sign:()=>Q5,signal:()=>MK,sin:()=>XR,sinh:()=>YR,slice:()=>ui,slice1d:()=>YS,slice2d:()=>QR,slice3d:()=>QS,slice4d:()=>G0,slice_util:()=>W,softmax:()=>JS,softplus:()=>av,spaceToBatchND:()=>KS,sparse:()=>RK,sparseToDense:()=>yK,spectral:()=>DK,split:()=>vu,sqrt:()=>ua,square:()=>Zi,squaredDifference:()=>eO,squeeze:()=>jp,stack:()=>yu,step:()=>hv,stridedSlice:()=>J5,string:()=>OK,sub:()=>qn,sum:()=>Yn,sumOutType:()=>yR,tan:()=>eH,tanh:()=>sv,tensor:()=>Vu,tensor1d:()=>ka,tensor2d:()=>qp,tensor3d:()=>GU,tensor4d:()=>cK,tensor5d:()=>hK,tensor6d:()=>fK,tensorScatterUpdate:()=>dK,tensor_util:()=>K,test_util:()=>J,tidy:()=>Ot,tile:()=>xl,time:()=>ace,topk:()=>tH,train:()=>fv,transpose:()=>ii,truncatedNormal:()=>tO,unique:()=>nH,unregisterGradient:()=>nle,unregisterKernel:()=>tle,unsortedSegmentSum:()=>nO,unstack:()=>Sl,upcastType:()=>pu,upperBound:()=>pK,util:()=>G,valueAndGrad:()=>Sce,valueAndGrads:()=>Ece,variable:()=>rH,variableGrads:()=>lZ,version:()=>$Le,version_converter:()=>eJ,version_core:()=>kZ,version_cpu:()=>_ee,version_layers:()=>OO,version_webgl:()=>Ute,webgl:()=>JDe,webgl_util:()=>Fe,where:()=>Zo,whereAsync:()=>sH,zeros:()=>vo,zerosLike:()=>ai});const Gn=Sn(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function _r(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class mr{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(pt(r))try{r()}catch(s){t=s instanceof Gn?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{Yi(s)}catch(o){t=null!=t?t:[],o instanceof Gn?t=[...t,...o.errors]:t.push(o)}}if(t)throw new Gn(t)}}add(t){var e;if(t&&t!==this)if(this.closed)Yi(t);else{if(t instanceof mr){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&_r(e,t)}remove(t){const{_finalizers:e}=this;e&&_r(e,t),t instanceof mr&&t._removeParent(this)}}mr.EMPTY=(()=>{const n=new mr;return n.closed=!0,n})();const Br=mr.EMPTY;function Ps(n){return n instanceof mr||n&&"closed"in n&&pt(n.remove)&&pt(n.add)&&pt(n.unsubscribe)}function Yi(n){pt(n)?n():n.unsubscribe()}const xs={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ct={setTimeout(n,t,...e){const{delegate:r}=ct;return(null==r?void 0:r.setTimeout)?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=ct;return((null==t?void 0:t.clearTimeout)||clearTimeout)(n)},delegate:void 0};function ze(n){ct.setTimeout(()=>{const{onUnhandledError:t}=xs;if(!t)throw n;t(n)})}function et(){}const ft=wn("C",void 0,void 0);function wn(n,t,e){return{kind:n,value:t,error:e}}let on=null;function En(n){if(xs.useDeprecatedSynchronousErrorHandling){const t=!on;if(t&&(on={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=on;if(on=null,e)throw r}}else n()}class Nr extends mr{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Ps(t)&&t.add(this)):this.destination=_d}static create(t,e,r){return new bo(t,e,r)}next(t){this.isStopped?kl(function bn(n){return wn("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?kl(function Gt(n){return wn("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?kl(ft,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ji=Function.prototype.bind;function bi(n,t){return ji.call(n,t)}class js{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){Ml(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){Ml(r)}else Ml(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Ml(e)}}}class bo extends Nr{constructor(t,e,r){let i;if(super(),pt(t)||!t)i={next:null!=t?t:void 0,error:null!=e?e:void 0,complete:null!=r?r:void 0};else{let s;this&&xs.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),i={next:t.next&&bi(t.next,s),error:t.error&&bi(t.error,s),complete:t.complete&&bi(t.complete,s)}):i=t}this.destination=new js(i)}}function Ml(n){xs.useDeprecatedSynchronousErrorHandling?function Zn(n){xs.useDeprecatedSynchronousErrorHandling&&on&&(on.errorThrown=!0,on.error=n)}(n):ze(n)}function kl(n,t){const{onStoppedNotification:e}=xs;e&&ct.setTimeout(()=>e(n,t))}const _d={closed:!0,next:et,error:function ym(n){throw n},complete:et},Ls="function"==typeof Symbol&&Symbol.observable||"@@observable";function ko(n){return n}let $i=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,i){const s=function Qh(n){return n&&n instanceof Nr||function yc(n){return n&&pt(n.next)&&pt(n.error)&&pt(n.complete)}(n)&&Ps(n)}(e)?e:new bo(e,r,i);return En(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=Qu(r))((i,s)=>{const o=new bo({next:a=>{try{e(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[Ls](){return this}pipe(...e){return function oh(n){return 0===n.length?ko:1===n.length?n[0]:function(e){return n.reduce((r,i)=>i(r),e)}}(e)(this)}toPromise(e){return new(e=Qu(e))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=t=>new n(t),n})();function Qu(n){var t;return null!==(t=null!=n?n:xs.Promise)&&void 0!==t?t:Promise}const _m=Sn(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Qi=(()=>{class n extends $i{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new bd(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new _m}next(e){En(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){En(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){En(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Br:(this.currentObservers=null,s.push(e),new mr(()=>{this.currentObservers=null,_r(s,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:i,isStopped:s}=this;r?e.error(i):s&&e.complete()}asObservable(){const e=new $i;return e.source=this,e}}return n.create=(t,e)=>new bd(t,e),n})();class bd extends Qi{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:Br}}function Pi(n){return t=>{if(function wd(n){return pt(null==n?void 0:n.lift)}(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Bn(n,t,e,r,i){return new Cu(n,t,e,r,i)}class Cu extends Nr{constructor(t,e,r,i,s,o){super(t),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=e?function(a){try{e(a)}catch(u){t.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function qs(n,t){return Pi((e,r)=>{let i=0;e.subscribe(Bn(r,s=>{r.next(n.call(t,s,i++))}))})}function ns(n){return this instanceof ns?(this.v=n,this):new ns(n)}function Cs(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=e.apply(n,t||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(_){r[_]&&(i[_]=function(E){return new Promise(function(D,O){s.push([_,E,D,O])>1||a(_,E)})})}function a(_,E){try{!function u(_){_.value instanceof ns?Promise.resolve(_.value.v).then(d,m):y(s[0][2],_)}(r[_](E))}catch(D){y(s[0][3],D)}}function d(_){a("next",_)}function m(_){a("throw",_)}function y(_,E){_(E),s.shift(),s.length&&a(s[0][0],s[0][1])}}function li(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function tf(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(s){e[s]=n[s]&&function(o){return new Promise(function(a,u){!function i(s,o,a,u){Promise.resolve(u).then(function(d){s({value:d,done:a})},o)}(a,u,(o=n[s](o)).done,o.value)})}}}const pn=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function ms(n){return pt(null==n?void 0:n.then)}function Bi(n){return pt(n[Ls])}function ah(n){return Symbol.asyncIterator&&pt(null==n?void 0:n[Symbol.asyncIterator])}function Pl(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const vr=function _c(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Xn(n){return pt(null==n?void 0:n[vr])}function Oo(n){return Cs(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:i}=yield ns(e.read());if(i)return yield ns(void 0);yield yield ns(r)}}finally{e.releaseLock()}})}function Ju(n){return pt(null==n?void 0:n.getReader)}function ro(n){if(n instanceof $i)return n;if(null!=n){if(Bi(n))return function Fo(n){return new $i(t=>{const e=n[Ls]();if(pt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(pn(n))return function Ed(n){return new $i(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(ms(n))return function Eu(n){return new $i(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,ze)})}(n);if(ah(n))return af(n);if(Xn(n))return function sf(n){return new $i(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(Ju(n))return function Nd(n){return af(Oo(n))}(n)}throw Pl(n)}function af(n){return new $i(t=>{(function uh(n,t){var e,r,i,s;return function xm(n,t,e,r){return new(e||(e=Promise))(function(s,o){function a(m){try{d(r.next(m))}catch(y){o(y)}}function u(m){try{d(r.throw(m))}catch(y){o(y)}}function d(m){m.done?s(m.value):function i(s){return s instanceof e?s:new e(function(o){o(s)})}(m.value).then(a,u)}d((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=li(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=e.return)&&(yield s.call(e))}finally{if(i)throw i.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function io(n,t,e,r=0,i=!1){const s=t.schedule(function(){e(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function bc(n,t,e=1/0){return pt(t)?bc((r,i)=>qs((s,o)=>t(r,s,i,o))(ro(n(r,i))),e):("number"==typeof t&&(e=t),Pi((r,i)=>function Td(n,t,e,r,i,s,o,a){const u=[];let d=0,m=0,y=!1;const _=()=>{y&&!u.length&&!d&&t.complete()},E=O=>d<r?D(O):u.push(O),D=O=>{s&&t.next(O),d++;let R=!1;ro(e(O,m++)).subscribe(Bn(t,$=>{null==i||i($),s?E($):t.next($)},()=>{R=!0},void 0,()=>{if(R)try{for(d--;u.length&&d<r;){const $=u.shift();o?io(t,o,()=>D($)):D($)}_()}catch($){t.error($)}}))};return n.subscribe(Bn(t,E,()=>{y=!0,_()})),()=>{null==a||a()}}(r,i,n,e)))}function Dr(n=1/0){return bc(ko,n)}const ma=new $i(n=>n.complete());function lf(n){return n&&pt(n.schedule)}function wc(n){return n[n.length-1]}function cf(n){return pt(wc(n))?n.pop():void 0}function eu(n){return lf(wc(n))?n.pop():void 0}function lh(n,t=0){return Pi((e,r)=>{e.subscribe(Bn(r,i=>io(r,n,()=>r.next(i),t),()=>io(r,n,()=>r.complete(),t),i=>io(r,n,()=>r.error(i),t)))})}function Zs(n,t=0){return Pi((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function Em(n,t){if(!n)throw new Error("Iterable cannot be null");return new $i(e=>{io(e,t,()=>{const r=n[Symbol.asyncIterator]();io(e,t,()=>{r.next().then(i=>{i.done?e.complete():e.next(i.value)})},0,!0)})})}function Cc(n,t){return t?function wb(n,t){if(null!=n){if(Bi(n))return function xc(n,t){return ro(n).pipe(Zs(t),lh(t))}(n,t);if(pn(n))return function Vv(n,t){return new $i(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(ms(n))return function Bv(n,t){return ro(n).pipe(Zs(t),lh(t))}(n,t);if(ah(n))return Em(n,t);if(Xn(n))return function bb(n,t){return new $i(e=>{let r;return io(e,t,()=>{r=n[vr](),io(e,t,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void e.error(o)}s?e.complete():e.next(i)},0,!0)}),()=>pt(null==r?void 0:r.return)&&r.return()})}(n,t);if(Ju(n))return function Nm(n,t){return Em(Oo(n),t)}(n,t)}throw Pl(n)}(n,t):ro(n)}function ei(...n){const t=eu(n),e=function Sm(n,t){return"number"==typeof wc(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?ro(r[0]):Dr(e)(Cc(r,t)):ma}function zv(n={}){const{connector:t=(()=>new Qi),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,u,d=0,m=!1,y=!1;const _=()=>{null==a||a.unsubscribe(),a=void 0},E=()=>{_(),o=u=void 0,m=y=!1},D=()=>{const O=o;E(),null==O||O.unsubscribe()};return Pi((O,R)=>{d++,!y&&!m&&_();const $=u=null!=u?u:t();R.add(()=>{d--,0===d&&!y&&!m&&(a=ga(D,i))}),$.subscribe(R),!o&&d>0&&(o=new bo({next:B=>$.next(B),error:B=>{y=!0,_(),a=ga(E,e,B),$.error(B)},complete:()=>{m=!0,_(),a=ga(E,r),$.complete()}}),ro(O).subscribe(o))})(s)}}function ga(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new bo({next:()=>{r.unsubscribe(),n()}});return t(...e).subscribe(r)}function ci(n){for(let t in n)if(n[t]===ci)return t;throw Error("Could not find renamed property on target object.")}function Ad(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Ni(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Ni).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function hf(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const xb=ci({__forward_ref__:ci});function Di(n){return n.__forward_ref__=Di,n.toString=function(){return Ni(this())},n}function Pr(n){return Uv(n)?n():n}function Uv(n){return"function"==typeof n&&n.hasOwnProperty(xb)&&n.__forward_ref__===Di}class jn extends Error{constructor(t,e){super(function Pa(n,t){return`NG0${Math.abs(n)}${t?": "+t:""}`}(t,e)),this.code=t}}function Tr(n){return"string"==typeof n?n:null==n?"":String(n)}function wo(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Tr(n)}function Id(n,t){const e=t?` in ${t}`:"";throw new jn(-201,`No provider for ${wo(n)} found${e}`)}function gs(n,t){null==n&&function xi(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}(t,n,null,"!=")}function yn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ci(n){return{providers:n.providers||[],imports:n.imports||[]}}function el(n){return ta(n,ff)||ta(n,Gv)}function ta(n,t){return n.hasOwnProperty(t)?n[t]:null}function tu(n){return n&&(n.hasOwnProperty($l)||n.hasOwnProperty(df))?n[$l]:null}const ff=ci({\u0275prov:ci}),$l=ci({\u0275inj:ci}),Gv=ci({ngInjectableDef:ci}),df=ci({ngInjectorDef:ci});var Ar=(()=>((Ar=Ar||{})[Ar.Default=0]="Default",Ar[Ar.Host=1]="Host",Ar[Ar.Self=2]="Self",Ar[Ar.SkipSelf=4]="SkipSelf",Ar[Ar.Optional=8]="Optional",Ar))();let hh;function Po(n){const t=hh;return hh=n,t}function pf(n,t,e){const r=el(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Ar.Optional?null:void 0!==t?t:void Id(Ni(n),"Injector")}function Au(n){return{toString:n}.toString()}var nu=(()=>((nu=nu||{})[nu.OnPush=0]="OnPush",nu[nu.Default=1]="Default",nu))(),Co=(()=>{return(n=Co||(Co={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Co;var n})();const Ib="undefined"!=typeof globalThis&&globalThis,Iu="undefined"!=typeof window&&window,kd="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Si=Ib||"undefined"!=typeof global&&global||Iu||kd,Du={},cr=[],tr=ci({\u0275cmp:ci}),mf=ci({\u0275dir:ci}),fh=ci({\u0275pipe:ci}),qv=ci({\u0275mod:ci}),Lo=ci({\u0275fac:ci}),Rd=ci({__NG_ELEMENT_ID__:ci});let Mm=0;function Vl(n){return Au(()=>{const e={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===nu.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||cr,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Co.Emulated,id:"c",styles:n.styles||cr,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.directives,s=n.features,o=n.pipes;return r.id+=Mm++,r.inputs=kb(n.inputs,e),r.outputs=kb(n.outputs),s&&s.forEach(a=>a(r)),r.directiveDefs=i?()=>("function"==typeof i?i():i).map(Zv):null,r.pipeDefs=o?()=>("function"==typeof o?o():o).map(Vr):null,r})}function Zv(n){return vs(n)||function Xe(n){return n[mf]||null}(n)}function Vr(n){return function La(n){return n[fh]||null}(n)}const Od={};function Vi(n){return Au(()=>{const t={type:n.type,bootstrap:n.bootstrap||cr,declarations:n.declarations||cr,imports:n.imports||cr,exports:n.exports||cr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(Od[n.id]=n.type),t})}function kb(n,t){if(null==n)return Du;const e={};for(const r in n)if(n.hasOwnProperty(r)){let i=n[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),e[i]=r,t&&(t[i]=s)}return e}const sr=Vl;function ya(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function vs(n){return n[tr]||null}function $a(n,t){const e=n[qv]||null;if(!e&&!0===t)throw new Error(`Type ${Ni(n)} does not have '\u0275mod' property.`);return e}const P=16;function hn(n){return Array.isArray(n)&&"object"==typeof n[1]}function Rn(n){return Array.isArray(n)&&!0===n[1]}function fr(n){return 0!=(8&n.flags)}function Wr(n){return 2==(2&n.flags)}function $o(n){return 1==(1&n.flags)}function so(n){return null!==n.template}function Fd(n){return 0!=(512&n[2])}function _f(n,t){return n.hasOwnProperty(Lo)?n[Lo]:null}class WF{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function Hl(){return sN}function sN(n){return n.type.prototype.ngOnChanges&&(n.setInput=jF),GF}function GF(){const n=aN(this),t=null==n?void 0:n.current;if(t){const e=n.previous;if(e===Du)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function jF(n,t,e,r){const i=aN(n)||function C8(n,t){return n[oN]=t}(n,{previous:Du,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[e],u=o[a];s[a]=new WF(u&&u.currentValue,t,o===Du),n[r]=t}Hl.ngInherit=!0;const oN="__ngSimpleChanges__";function aN(n){return n[oN]||null}let Bb;function Es(n){return!!n.listen}const lN={createRenderer:(n,t)=>function Vb(){return void 0!==Bb?Bb:"undefined"!=typeof document?document:void 0}()};function Ks(n){for(;Array.isArray(n);)n=n[0];return n}function zb(n,t){return Ks(t[n])}function Mu(n,t){return Ks(t[n.index])}function Ub(n,t){return n.data[t]}function Pd(n,t){return n[t]}function ru(n,t){const e=t[n];return hn(e)?e:e[0]}function cN(n){return 4==(4&n[2])}function Hb(n){return 128==(128&n[2])}function mh(n,t){return null==t?null:n[t]}function hN(n){n[18]=0}function Wb(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const Ir={lFrame:_N(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function fN(){return Ir.bindingsEnabled}function xn(){return Ir.lFrame.lView}function fi(){return Ir.lFrame.tView}function Fm(n){return Ir.lFrame.contextLView=n,n[8]}function oo(){let n=dN();for(;null!==n&&64===n.type;)n=n.parent;return n}function dN(){return Ir.lFrame.currentTNode}function Wl(n,t){const e=Ir.lFrame;e.currentTNode=n,e.isParent=t}function Gb(){return Ir.lFrame.isParent}function jb(){Ir.lFrame.isParent=!1}function Yv(){return Ir.isInCheckNoChangesMode}function Qv(n){Ir.isInCheckNoChangesMode=n}function dr(){return Ir.lFrame.bindingIndex++}function uP(n,t){const e=Ir.lFrame;e.bindingIndex=e.bindingRootIndex=n,qb(t)}function qb(n){Ir.lFrame.currentDirectiveIndex=n}function gN(){return Ir.lFrame.currentQueryIndex}function Kb(n){Ir.lFrame.currentQueryIndex=n}function cP(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function vN(n,t,e){if(e&Ar.SkipSelf){let i=t,s=n;for(;!(i=i.parent,null!==i||e&Ar.Host||(i=cP(s),null===i||(s=s[15],10&i.type))););if(null===i)return!1;t=i,n=s}const r=Ir.lFrame=yN();return r.currentTNode=t,r.lView=n,!0}function Jv(n){const t=yN(),e=n[1];Ir.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function yN(){const n=Ir.lFrame,t=null===n?null:n.child;return null===t?_N(n):t}function _N(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function ey(){const n=Ir.lFrame;return Ir.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const bN=ey;function ty(){const n=ey();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function xa(){return Ir.lFrame.selectedIndex}function Mr(n){Ir.lFrame.selectedIndex=n}function Ns(){const n=Ir.lFrame;return Ub(n.tView,n.selectedIndex)}function iu(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const s=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:d,ngOnDestroy:m}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),a&&((n.contentHooks||(n.contentHooks=[])).push(e,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,a)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),d&&((n.viewHooks||(n.viewHooks=[])).push(e,d),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,d)),null!=m&&(n.destroyHooks||(n.destroyHooks=[])).push(e,m)}}function Lr(n,t,e){ki(n,t,3,e)}function Lm(n,t,e,r){(3&n[2])===e&&ki(n,t,e,r)}function ny(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function ki(n,t,e,r){const s=null!=r?r:-1,o=t.length-1;let a=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(a=t[u],null!=r&&a>=r)break}else t[u]<0&&(n[18]+=65536),(a<s||-1==s)&&(Bd(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function Bd(n,t,e,r){const i=e[r]<0,s=e[r+1],a=n[i?-e[r]:e[r]];if(i){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Vd{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function Yb(n,t,e){const r=Es(n);let i=0;for(;i<e.length;){const s=e[i];if("number"==typeof s){if(0!==s)break;i++;const o=e[i++],a=e[i++],u=e[i++];r?n.setAttribute(t,a,u,o):t.setAttributeNS(o,a,u)}else{const o=s,a=e[++i];Qb(o)?r&&n.setProperty(t,o,a):r?n.setAttribute(t,o,a):t.setAttribute(o,a),i++}}return i}function NN(n){return 3===n||4===n||6===n}function Qb(n){return 64===n.charCodeAt(0)}function Bm(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const i=t[r];"number"==typeof i?e=i:0===e||pP(n,e,i,null,-1===e||2===e?t[++r]:null)}}return n}function pP(n,t,e,r,i){let s=0,o=n.length;if(-1===t)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===t){o=-1;break}if(a>t){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===e){if(null===r)return void(null!==i&&(n[s+1]=i));if(r===n[s+1])return void(n[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(n.splice(o,0,t),s=o+1),n.splice(s++,0,e),null!==r&&n.splice(s++,0,r),null!==i&&n.splice(s++,0,i)}function bf(n){return-1!==n}function Ac(n){return 32767&n}function zm(n,t){let e=function Vm(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let TN=!0;function Jb(n){const t=TN;return TN=n,t}let mP=0;function Um(n,t){const e=iy(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,ry(r.data,n),ry(t,null),ry(r.blueprint,null));const i=Hm(n,t),s=n.injectorIndex;if(bf(i)){const o=Ac(i),a=zm(i,t),u=a[1].data;for(let d=0;d<8;d++)t[s+d]=a[o+d]|u[o+d]}return t[s+8]=i,s}function ry(n,t){n.push(0,0,0,0,0,0,0,0,t)}function iy(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Hm(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,i=t;for(;null!==i;){const s=i[1],o=s.type;if(r=2===o?s.declTNode:1===o?i[6]:null,null===r)return-1;if(e++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function ew(n,t,e){!function gP(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(Rd)&&(r=e[Rd]),null==r&&(r=e[Rd]=mP++);const i=255&r;t.data[n+(i>>5)]|=1<<i}(n,t,e)}function tw(n,t,e){if(e&Ar.Optional)return n;Id(t,"NodeInjector")}function yP(n,t,e,r){if(e&Ar.Optional&&void 0===r&&(r=null),0==(e&(Ar.Self|Ar.Host))){const i=n[9],s=Po(void 0);try{return i?i.get(t,r,e&Ar.Optional):pf(t,r,e&Ar.Optional)}finally{Po(s)}}return tw(r,t,e)}function nw(n,t,e,r=Ar.Default,i){if(null!==n){const s=function M8(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Rd)?n[Rd]:void 0;return"number"==typeof t?t>=0?255&t:_P:t}(e);if("function"==typeof s){if(!vN(t,n,r))return r&Ar.Host?tw(i,e,r):yP(t,e,r,i);try{const o=s(r);if(null!=o||r&Ar.Optional)return o;Id(e)}finally{bN()}}else if("number"==typeof s){let o=null,a=iy(n,t),u=-1,d=r&Ar.Host?t[P][6]:null;for((-1===a||r&Ar.SkipSelf)&&(u=-1===a?Hm(n,t):t[a+8],-1!==u&&sy(r,!1)?(o=t[1],a=Ac(u),t=zm(u,t)):a=-1);-1!==a;){const m=t[1];if(wP(s,a,m.data)){const y=bP(a,t,e,o,r,d);if(y!==rw)return y}u=t[a+8],-1!==u&&sy(r,t[1].data[a+8]===d)&&wP(s,a,t)?(o=m,a=Ac(u),t=zm(u,t)):a=-1}}}return yP(t,e,r,i)}const rw={};function _P(){return new Gm(oo(),xn())}function bP(n,t,e,r,i,s){const o=t[1],a=o.data[n+8],m=Ud(a,o,e,null==r?Wr(a)&&TN:r!=o&&0!=(3&a.type),i&Ar.Host&&s===a);return null!==m?Wm(t,o,m,a):rw}function Ud(n,t,e,r,i){const s=n.providerIndexes,o=t.data,a=1048575&s,u=n.directiveStart,m=s>>20,_=i?a+m:n.directiveEnd;for(let E=r?a:a+m;E<_;E++){const D=o[E];if(E<u&&e===D||E>=u&&D.type===e)return E}if(i){const E=o[u];if(E&&so(E)&&E.type===e)return u}return null}function Wm(n,t,e,r){let i=n[e];const s=t.data;if(function Xb(n){return n instanceof Vd}(i)){const o=i;o.resolving&&function Ll(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new jn(-200,`Circular dependency in DI detected for ${n}${e}`)}(wo(s[e]));const a=Jb(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Po(o.injectImpl):null;vN(n,r,Ar.Default);try{i=n[e]=o.factory(void 0,s,n,r),t.firstCreatePass&&e>=r.directiveStart&&function zr(n,t,e){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=t.type.prototype;if(r){const o=sN(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}i&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,i),s&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,s))}(e,s[e],t)}finally{null!==u&&Po(u),Jb(a),o.resolving=!1,bN()}}return i}function wP(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function sy(n,t){return!(n&Ar.Self||n&Ar.Host&&t)}class Gm{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return nw(this._tNode,this._lView,t,r,e)}}function Bo(n){return Au(()=>{const t=n.prototype.constructor,e=t[Lo]||iw(t),r=Object.prototype;let i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){const s=i[Lo]||iw(i);if(s&&s!==e)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function iw(n){return Uv(n)?()=>{const t=iw(Pr(n));return t&&t()}:_f(n)}function jm(n){return function vP(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let i=0;for(;i<r;){const s=e[i];if(NN(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<r&&"string"==typeof e[i];)i++;else{if(s===t)return e[i+1];i+=2}}}return null}(oo(),n)}const Ic="__parameters__";function rl(n,t,e){return Au(()=>{const r=function ay(n){return function(...e){if(n){const r=n(...e);for(const i in r)this[i]=r[i]}}}(t);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,d,m){const y=u.hasOwnProperty(Ic)?u[Ic]:Object.defineProperty(u,Ic,{value:[]})[Ic];for(;y.length<=m;)y.push(null);return(y[m]=y[m]||[]).push(o),u}}return e&&(i.prototype=Object.create(e.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}class Qn{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=yn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function ou(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),ou(r,t)):t!==n&&t.push(r)}return t}function il(n,t){n.forEach(e=>Array.isArray(e)?il(e,t):t(e))}function ow(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function ly(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Gd(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function Va(n,t,e){let r=wf(n,t);return r>=0?n[1|r]=e:(r=~r,function MN(n,t,e,r){let i=n.length;if(i==t)n.push(e,r);else if(1===i)n.push(r,n[0]),n[0]=e;else{for(i--,n.push(n[i-1],n[i]);i>t;)n[i]=n[i-2],i--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function cy(n,t){const e=wf(n,t);if(e>=0)return n[1|e]}function wf(n,t){return function ON(n,t,e){let r=0,i=n.length>>e;for(;i!==r;){const s=r+(i-r>>1),o=n[s<<e];if(t===o)return s<<e;o>t?i=s:r=s+1}return~(i<<e)}(n,t,1)}const zi={},uw="__NG_DI_FLAG__",dy="ngTempTokenPath",BN=/\n/gm,lw="__source",zN=ci({provide:String,useValue:ci});let jd;function cw(n){const t=jd;return jd=n,t}function kP(n,t=Ar.Default){if(void 0===jd)throw new jn(203,"");return null===jd?pf(n,void 0,t):jd.get(n,t&Ar.Optional?null:void 0,t)}function dn(n,t=Ar.Default){return(function Ab(){return hh}()||kP)(Pr(n),t)}const py=dn;function my(n){const t=[];for(let e=0;e<n.length;e++){const r=Pr(n[e]);if(Array.isArray(r)){if(0===r.length)throw new jn(900,"");let i,s=Ar.Default;for(let o=0;o<r.length;o++){const a=r[o],u=RP(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}t.push(dn(i,s))}else t.push(dn(r))}return t}function qm(n,t){return n[uw]=t,n.prototype[uw]=t,n}function RP(n){return n[uw]}const _h=qm(rl("Optional"),8),qd=qm(rl("SkipSelf"),4);let yy;function Zd(n){var t;return(null===(t=function mw(){if(void 0===yy&&(yy=null,Si.trustedTypes))try{yy=Si.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return yy}())||void 0===t?void 0:t.createHTML(n))||n}class Cf{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class GP extends Cf{getTypeName(){return"HTML"}}class jP extends Cf{getTypeName(){return"Style"}}class qP extends Cf{getTypeName(){return"Script"}}class Km extends Cf{getTypeName(){return"URL"}}class ZP extends Cf{getTypeName(){return"ResourceURL"}}function Ca(n){return n instanceof Cf?n.changingThisBreaksApplicationSecurity:n}function au(n,t){const e=KN(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function KN(n){return n instanceof Cf&&n.getTypeName()||null}class YN{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Zd(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class QN{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Zd(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=Zd(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let i=e.length-1;0<i;i--){const o=e.item(i).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const eT=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,tT=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Xm(n){return(n=String(n)).match(eT)||n.match(tT)?n:"unsafe:"+n}function sl(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Ym(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const rT=sl("area,br,col,hr,img,wbr"),_w=sl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),iT=sl("rp,rt"),by=Ym(rT,Ym(_w,sl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Ym(iT,sl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Ym(iT,_w)),bw=sl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ww=sl("srcset"),sT=Ym(bw,ww,sl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),sl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),tL=sl("script,style,template");class oT{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let i=this.checkClobberedElement(e,e.nextSibling);if(i){e=i;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!by.hasOwnProperty(e))return this.sanitizedSomething=!0,!tL.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let i=0;i<r.length;i++){const s=r.item(i),o=s.name,a=o.toLowerCase();if(!sT.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let u=s.value;bw[a]&&(u=Xm(u)),ww[a]&&(n=u,u=(n=String(n)).split(",").map(t=>Xm(t.trim())).join(", ")),this.buf.push(" ",o,'="',xw(u),'"')}var n;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();by.hasOwnProperty(e)&&!rT.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(xw(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const nL=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rL=/([^\#-~ |!])/g;function xw(n){return n.replace(/&/g,"&amp;").replace(nL,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(rL,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let wy;function aT(n,t){let e=null;try{wy=wy||function yw(n){const t=new QN(n);return function JN(){try{return!!(new window.DOMParser).parseFromString(Zd(""),"text/html")}catch(n){return!1}}()?new YN(t):t}(n);let r=t?String(t):"";e=wy.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=e.innerHTML,e=wy.getInertBodyElement(r)}while(r!==s);return Zd((new oT).sanitizeChildren(xy(e)||e))}finally{if(e){const r=xy(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function xy(n){return"content"in n&&function iL(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Ai=(()=>((Ai=Ai||{})[Ai.NONE=0]="NONE",Ai[Ai.HTML=1]="HTML",Ai[Ai.STYLE=2]="STYLE",Ai[Ai.SCRIPT=3]="SCRIPT",Ai[Ai.URL=4]="URL",Ai[Ai.RESOURCE_URL=5]="RESOURCE_URL",Ai))();const hT="__ngContext__";function na(n,t){n[hT]=t}function wh(n){const t=function uu(n){return n[hT]||null}(n);return t?Array.isArray(t)?t:t.lView:null}function Tw(n){return n.ngOriginalError}function mL(n,...t){n.error(...t)}class Mc{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),r=function pL(n){return n&&n.ngErrorLogger||mL}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&Tw(t);for(;e&&Tw(e);)e=Tw(e);return e||null}}const CL=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Si))();function Zl(n){return n instanceof Function?n():n}var za=(()=>((za=za||{})[za.Important=1]="Important",za[za.DashCase=2]="DashCase",za))();function Mw(n,t){return undefined(n,t)}function Qm(n){const t=n[3];return Rn(t)?t[3]:t}function Rw(n){return Ow(n[13])}function Jm(n){return Ow(n[4])}function Ow(n){for(;null!==n&&!Rn(n);)n=n[4];return n}function Sf(n,t,e,r,i){if(null!=r){let s,o=!1;Rn(r)?s=r:hn(r)&&(o=!0,r=r[0]);const a=Ks(r);0===n&&null!==e?null==i?DT(t,e,a):Ef(t,e,a,i||null,!0):1===n&&null!==e?Ef(t,e,a,i||null,!0):2===n?function FT(n,t,e){const r=tg(n,t);r&&function $w(n,t,e,r){Es(n)?n.removeChild(t,e,r):t.removeChild(e)}(n,r,t,e)}(t,a,o):3===n&&t.destroyNode(a),null!=s&&function PL(n,t,e,r,i){const s=e[7];s!==Ks(e)&&Sf(t,n,r,s,i);for(let a=10;a<e.length;a++){const u=e[a];ng(u[1],u,n,t,r,s)}}(t,n,s,e,i)}}function Xd(n,t,e){if(Es(n))return n.createElement(t,e);{const r=null!==e?function XF(n){const t=n.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(e):null;return null===r?n.createElement(t):n.createElementNS(r,t)}}function Pw(n,t){const e=n[9],r=e.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Wb(i,-1)),e.splice(r,1)}function Lw(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const i=r[17];null!==i&&i!==n&&Pw(i,r),t>0&&(n[e-1][4]=r[4]);const s=ly(n,10+t);!function ET(n,t){ng(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=s[19];null!==o&&o.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function TT(n,t){if(!(256&t[2])){const e=t[11];Es(e)&&e.destroyNode&&ng(n,t,e,3,null,null),function NT(n){let t=n[13];if(!t)return Ey(n[1],n);for(;t;){let e=null;if(hn(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)hn(t)&&Ey(t[1],t),t=t[3];null===t&&(t=n),hn(t)&&Ey(t[1],t),e=t&&t[4]}t=e}}(t)}}function Ey(n,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function OL(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const i=t[e[r]];if(!(i instanceof Vd)){const s=e[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];try{u.call(a)}finally{}}else try{s.call(i)}finally{}}}}(n,t),function RL(n,t){const e=n.cleanup,r=t[7];let i=-1;if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const o=e[s+1],a="function"==typeof o?o(t):Ks(t[o]),u=r[i=e[s+2]],d=e[s+3];"boolean"==typeof d?a.removeEventListener(e[s],u,d):d>=0?r[i=d]():r[i=-d].unsubscribe(),s+=2}else{const o=r[i=e[s+1]];e[s].call(o)}if(null!==r){for(let s=i+1;s<r.length;s++)r[s]();t[7]=null}}(n,t),1===t[1].type&&Es(t[11])&&t[11].destroy();const e=t[17];if(null!==e&&Rn(t[3])){e!==t[3]&&Pw(e,t);const r=t[19];null!==r&&r.detachView(n)}}}function AT(n,t,e){return function IT(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const i=n.data[r.directiveStart].encapsulation;if(i===Co.None||i===Co.Emulated)return null}return Mu(r,e)}(n,t.parent,e)}function Ef(n,t,e,r,i){Es(n)?n.insertBefore(t,e,r,i):t.insertBefore(e,r,i)}function DT(n,t,e){Es(n)?n.appendChild(t,e):t.appendChild(e)}function MT(n,t,e,r,i){null!==r?Ef(n,t,e,r,i):DT(n,t,e)}function tg(n,t){return Es(n)?n.parentNode(t):t.parentNode}function Bw(n,t,e){return zw(n,t,e)}let zw=function Vw(n,t,e){return 40&n.type?Mu(n,e):null};function Ny(n,t,e,r){const i=AT(n,r,t),s=t[11],a=Bw(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(e))for(let u=0;u<e.length;u++)MT(s,i,e[u],a,!1);else MT(s,i,e,a,!1)}function Ty(n,t){if(null!==t){const e=t.type;if(3&e)return Mu(t,n);if(4&e)return Hw(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return Ty(n,r);{const i=n[t.index];return Rn(i)?Hw(-1,i):Ks(i)}}if(32&e)return Mw(t,n)()||Ks(n[t.index]);{const r=OT(n,t);return null!==r?Array.isArray(r)?r[0]:Ty(Qm(n[P]),r):Ty(n,t.next)}}return null}function OT(n,t){return null!==t?n[P][6].projection[t.projection]:null}function Hw(n,t){const e=10+n+1;if(e<t.length){const r=t[e],i=r[1].firstChild;if(null!==i)return Ty(r,i)}return t[7]}function Ay(n,t,e,r,i,s,o){for(;null!=e;){const a=r[e.index],u=e.type;if(o&&0===t&&(a&&na(Ks(a),r),e.flags|=4),64!=(64&e.flags))if(8&u)Ay(n,t,e.child,r,i,s,!1),Sf(t,n,i,a,s);else if(32&u){const d=Mw(e,r);let m;for(;m=d();)Sf(t,n,i,m,s);Sf(t,n,i,a,s)}else 16&u?Ww(n,t,r,e,i,s):Sf(t,n,i,a,s);e=o?e.projectionNext:e.next}}function ng(n,t,e,r,i,s){Ay(e,r,n.firstChild,t,i,s,!1)}function Ww(n,t,e,r,i,s){const o=e[P],u=o[6].projection[r.projection];if(Array.isArray(u))for(let d=0;d<u.length;d++)Sf(t,n,i,u[d],s);else Ay(n,t,u,o[3],i,s,!0)}function Gw(n,t,e){Es(n)?n.setAttribute(t,"style",e):t.style.cssText=e}function jw(n,t,e){Es(n)?""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e):t.className=e}function PT(n,t,e){let r=n.length;for(;;){const i=n.indexOf(t,e);if(-1===i)return i;if(0===i||n.charCodeAt(i-1)<=32){const s=t.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}e=i+1}}const LT="ng-template";function $L(n,t,e){let r=0;for(;r<n.length;){let i=n[r++];if(e&&"class"===i){if(i=n[r],-1!==PT(i.toLowerCase(),t,0))return!0}else if(1===i){for(;r<n.length&&"string"==typeof(i=n[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function qw(n){return 4===n.type&&n.value!==LT}function Zw(n,t,e){return t===(4!==n.type||e?n.value:LT)}function $T(n,t,e){let r=4;const i=n.attrs||[],s=function zL(n){for(let t=0;t<n.length;t++)if(NN(n[t]))return t;return n.length}(i);let o=!1;for(let a=0;a<t.length;a++){const u=t[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!Zw(n,u,e)||""===u&&1===t.length){if(ol(r))return!1;o=!0}}else{const d=8&r?u:t[++a];if(8&r&&null!==n.attrs){if(!$L(n.attrs,d,e)){if(ol(r))return!1;o=!0}continue}const y=BL(8&r?"class":u,i,qw(n),e);if(-1===y){if(ol(r))return!1;o=!0;continue}if(""!==d){let _;_=y>s?"":i[y+1].toLowerCase();const E=8&r?_:null;if(E&&-1!==PT(E,d,0)||2&r&&d!==_){if(ol(r))return!1;o=!0}}}}else{if(!o&&!ol(r)&&!ol(u))return!1;if(o&&ol(u))continue;o=!1,r=u|1&r}}return ol(r)||o}function ol(n){return 0==(1&n)}function BL(n,t,e,r){if(null===t)return-1;let i=0;if(r||!e){let s=!1;for(;i<t.length;){const o=t[i];if(o===n)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=t[++i];for(;"string"==typeof a;)a=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function UL(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function VL(n,t,e=!1){for(let r=0;r<t.length;r++)if($T(n,t[r],e))return!0;return!1}function VT(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let i=0;i<n.length;i++)if(n[i]!==r[i])continue e;return!0}}return!1}function zT(n,t){return n?":not("+t.trim()+")":t}function HL(n){let t=n[0],e=1,r=2,i="",s=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const a=n[++e];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!ol(o)&&(t+=zT(s,i),i=""),r=o,s=s||!ol(r);e++}return""!==i&&(t+=zT(s,i)),t}const Rr={};function Li(n){HT(fi(),xn(),xa()+n,Yv())}function HT(n,t,e,r){if(!r)if(3==(3&t[2])){const s=n.preOrderCheckHooks;null!==s&&Lr(t,s,e)}else{const s=n.preOrderHooks;null!==s&&Lm(t,s,0,e)}Mr(e)}function Iy(n,t){return n<<17|t<<2}function al(n){return n>>17&32767}function Kw(n){return 2|n}function kc(n){return(131068&n)>>2}function Dy(n,t){return-131069&n|t<<2}function Xw(n){return 1|n}function rA(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const i=e[r],s=e[r+1];if(-1!==s){const o=n.data[s];Kb(i),o.contentQueries(2,t[s],s)}}}function sg(n,t,e,r,i,s,o,a,u,d){const m=t.blueprint.slice();return m[0]=i,m[2]=140|r,hN(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=a||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=d||n&&n[9]||null,m[6]=s,m[P]=2==t.type?n[P]:m,m}function Nf(n,t,e,r,i){let s=n.data[t];if(null===s)s=function rx(n,t,e,r,i){const s=dN(),o=Gb(),u=n.data[t]=function i$(n,t,e,r,i,s){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,e,t,r,i);return null===n.firstChild&&(n.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u)),u}(n,t,e,r,i),function Ld(){return Ir.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=e,s.value=r,s.attrs=i;const o=function Pm(){const n=Ir.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Wl(s,!0),s}function Qd(n,t,e,r){if(0===e)return-1;const i=t.length;for(let s=0;s<e;s++)t.push(r),n.blueprint.push(r),n.data.push(null);return i}function Jd(n,t,e){Jv(t);try{const r=n.viewQuery;null!==r&&tp(1,r,e);const i=n.template;null!==i&&sA(n,t,i,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&rA(n,t),n.staticViewQueries&&tp(2,n.viewQuery,e);const s=n.components;null!==s&&function n$(n,t){for(let e=0;e<t.length;e++)_$(n,t[e])}(t,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,ty()}}function ep(n,t,e,r){const i=t[2];if(256==(256&i))return;Jv(t);const s=Yv();try{hN(t),function pN(n){return Ir.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&sA(n,t,e,2,r);const o=3==(3&i);if(!s)if(o){const d=n.preOrderCheckHooks;null!==d&&Lr(t,d,null)}else{const d=n.preOrderHooks;null!==d&&Lm(t,d,0,null),ny(t,0)}if(function y$(n){for(let t=Rw(n);null!==t;t=Jm(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const i=e[r],s=i[3];0==(1024&i[2])&&Wb(s,1),i[2]|=1024}}}(t),function v$(n){for(let t=Rw(n);null!==t;t=Jm(t))for(let e=10;e<t.length;e++){const r=t[e],i=r[1];Hb(r)&&ep(i,r,i.template,r[8])}}(t),null!==n.contentQueries&&rA(n,t),!s)if(o){const d=n.contentCheckHooks;null!==d&&Lr(t,d)}else{const d=n.contentHooks;null!==d&&Lm(t,d,1),ny(t,1)}!function t$(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const i=e[r];if(i<0)Mr(~i);else{const s=i,o=e[++r],a=e[++r];uP(o,s),a(2,t[s])}}}finally{Mr(-1)}}(n,t);const a=n.components;null!==a&&function iA(n,t){for(let e=0;e<t.length;e++)Ui(n,t[e])}(t,a);const u=n.viewQuery;if(null!==u&&tp(2,u,r),!s)if(o){const d=n.viewCheckHooks;null!==d&&Lr(t,d)}else{const d=n.viewHooks;null!==d&&Lm(t,d,2),ny(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Wb(t[3],-1))}finally{ty()}}function r$(n,t,e,r){const i=t[10],s=!Yv(),o=cN(t);try{s&&!o&&i.begin&&i.begin(),o&&Jd(n,t,r),ep(n,t,e,r)}finally{s&&!o&&i.end&&i.end()}}function sA(n,t,e,r,i){const s=xa(),o=2&r;try{Mr(-1),o&&t.length>20&&HT(n,t,20,Yv()),e(r,i)}finally{Mr(s)}}function oA(n,t,e){if(fr(t)){const i=t.directiveEnd;for(let s=t.directiveStart;s<i;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,e[s],s)}}}function ix(n,t,e){!fN()||(function d$(n,t,e,r){const i=e.directiveStart,s=e.directiveEnd;n.firstCreatePass||Um(e,t),na(r,t);const o=e.initialInputs;for(let a=i;a<s;a++){const u=n.data[a],d=so(u);d&&Py(t,e,u);const m=Wm(t,n,a,e);na(m,t),null!==o&&Vo(0,a-i,m,u,0,o),d&&(ru(e.index,t)[8]=m)}}(n,t,e,Mu(e,t)),128==(128&e.flags)&&function p$(n,t,e){const r=e.directiveStart,i=e.directiveEnd,o=e.index,a=function lP(){return Ir.lFrame.currentDirectiveIndex}();try{Mr(o);for(let u=r;u<i;u++){const d=n.data[u],m=t[u];qb(u),(null!==d.hostBindings||0!==d.hostVars||null!==d.hostAttrs)&&fA(d,m)}}finally{Mr(-1),qb(a)}}(n,t,e))}function sx(n,t,e=Mu){const r=t.localNames;if(null!==r){let i=t.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?e(t,n):n[o];n[i++]=a}}}function aA(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=Fy(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function Fy(n,t,e,r,i,s,o,a,u,d){const m=20+r,y=m+i,_=function uA(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:Rr);return e}(m,y),E="function"==typeof d?d():d;return _[1]={type:n,blueprint:_,template:e,queries:null,viewQuery:a,declTNode:t,data:_.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:E,incompleteFirstPass:!1}}function cA(n,t,e,r){const i=gA(t);null===e?i.push(r):(i.push(e),n.firstCreatePass&&E$(n).push(r,i.length-1))}function ax(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const i=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,i):e[r]=[t,i]}return e}function lu(n,t,e,r,i,s,o,a){const u=Mu(t,e);let m,d=t.inputs;!a&&null!=d&&(m=d[r])?(gx(n,e,m,r,i),Wr(t)&&function a$(n,t){const e=ru(t,n);16&e[2]||(e[2]|=64)}(e,t.index)):3&t.type&&(r=function o$(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),i=null!=o?o(i,t.value||"",r):i,Es(s)?s.setProperty(u,r,i):Qb(r)||(u.setProperty?u.setProperty(r,i):u[r]=i))}function ux(n,t,e,r){let i=!1;if(fN()){const s=function ul(n,t,e){const r=n.directiveRegistry;let i=null;if(r)for(let s=0;s<r.length;s++){const o=r[s];VL(e,o.selectors,!1)&&(i||(i=[]),ew(Um(e,t),n,o.type),so(o)?(dA(n,e),i.unshift(o)):i.push(o))}return i}(n,t,e),o=null===r?null:{"":-1};if(null!==s){i=!0,pA(e,n.data.length,s.length);for(let m=0;m<s.length;m++){const y=s[m];y.providersResolver&&y.providersResolver(y)}let a=!1,u=!1,d=Qd(n,t,s.length,null);for(let m=0;m<s.length;m++){const y=s[m];e.mergedAttrs=Bm(e.mergedAttrs,y.hostAttrs),mA(n,e,t,d,y),Ea(d,y,o),null!==y.contentQueries&&(e.flags|=8),(null!==y.hostBindings||null!==y.hostAttrs||0!==y.hostVars)&&(e.flags|=128);const _=y.type.prototype;!a&&(_.ngOnChanges||_.ngOnInit||_.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),a=!0),!u&&(_.ngOnChanges||_.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),d++}!function s$(n,t){const r=t.directiveEnd,i=n.data,s=t.attrs,o=[];let a=null,u=null;for(let d=t.directiveStart;d<r;d++){const m=i[d],y=m.inputs,_=null===s||qw(t)?null:g$(y,s);o.push(_),a=ax(y,d,a),u=ax(m.outputs,d,u)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=a,t.outputs=u}(n,e)}o&&function m$(n,t,e){if(t){const r=n.localNames=[];for(let i=0;i<t.length;i+=2){const s=e[t[i+1]];if(null==s)throw new jn(-301,!1);r.push(t[i],s)}}}(e,r,o)}return e.mergedAttrs=Bm(e.mergedAttrs,e.attrs),i}function lx(n,t,e,r,i,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const u=~t.index;(function f$(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(a)!=u&&a.push(u),a.push(r,i,o)}}function fA(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function dA(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function Ea(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;so(t)&&(e[""]=n)}}function pA(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function mA(n,t,e,r,i){n.data[r]=i;const s=i.factory||(i.factory=_f(i.type)),o=new Vd(s,so(i),null);n.blueprint[r]=o,e[r]=o,lx(n,t,0,r,Qd(n,e,i.hostVars,Rr),i)}function Py(n,t,e){const r=Mu(t,n),i=aA(e),s=n[10],o=og(n,sg(n,i,null,e.onPush?64:16,r,t,s,s.createRenderer(r,e),null,null));n[t.index]=o}function Kl(n,t,e,r,i,s){const o=Mu(n,t);!function cx(n,t,e,r,i,s,o){if(null==s)Es(n)?n.removeAttribute(t,i,e):t.removeAttribute(i);else{const a=null==o?Tr(s):o(s,r||"",i);Es(n)?n.setAttribute(t,i,a,e):e?t.setAttributeNS(e,i,a):t.setAttribute(i,a)}}(t[11],o,s,n.value,e,r,i)}function Vo(n,t,e,r,i,s){const o=s[t];if(null!==o){const a=r.setInput;for(let u=0;u<o.length;){const d=o[u++],m=o[u++],y=o[u++];null!==a?r.setInput(e,y,d,m):e[m]=y}}}function g$(n,t){let e=null,r=0;for(;r<t.length;){const i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;n.hasOwnProperty(i)&&(null===e&&(e=[]),e.push(i,n[i],t[r+1])),r+=2}else r+=2;else r+=4}return e}function ao(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function Ui(n,t){const e=ru(t,n);if(Hb(e)){const r=e[1];80&e[2]?ep(r,e,r.template,e[8]):e[5]>0&&hx(e)}}function hx(n){for(let r=Rw(n);null!==r;r=Jm(r))for(let i=10;i<r.length;i++){const s=r[i];if(1024&s[2]){const o=s[1];ep(o,s,o.template,s[8])}else s[5]>0&&hx(s)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const i=ru(e[r],n);Hb(i)&&i[5]>0&&hx(i)}}function _$(n,t){const e=ru(t,n),r=e[1];(function di(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),Jd(r,e,e[8])}function og(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function fx(n){for(;n;){n[2]|=64;const t=Qm(n);if(Fd(n)&&!t)return n;n=t}return null}function px(n,t,e){const r=t[10];r.begin&&r.begin();try{ep(n,t,n.template,e)}catch(i){throw vA(t,i),i}finally{r.end&&r.end()}}function Oc(n){!function dx(n){for(let t=0;t<n.components.length;t++){const e=n.components[t],r=wh(e),i=r[1];r$(i,r,i.template,e)}}(n[8])}function tp(n,t,e){Kb(0),t(n,e)}const S$=(()=>Promise.resolve(null))();function gA(n){return n[7]||(n[7]=[])}function E$(n){return n.cleanup||(n.cleanup=[])}function vA(n,t){const e=n[9],r=e?e.get(Mc,null):null;r&&r.handleError(t)}function gx(n,t,e,r,i){for(let s=0;s<e.length;){const o=e[s++],a=e[s++],u=t[o],d=n.data[o];null!==d.setInput?d.setInput(u,i,r,a):u[a]=i}}function Ch(n,t,e){const r=zb(t,n);!function CT(n,t,e){Es(n)?n.setValue(t,e):t.textContent=e}(n[11],r,e)}function vx(n,t,e){let r=e?n.styles:null,i=e?n.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?s=a:1==s?i=hf(i,a):2==s&&(r=hf(r,a+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=i:n.classesWithoutHost=i}const Ly=new Qn("INJECTOR",-1);class yA{get(t,e=zi){if(e===zi){const r=new Error(`NullInjectorError: No provider for ${Ni(t)}!`);throw r.name="NullInjectorError",r}return e}}const yx=new Qn("Set Injector scope."),uo={},_A={};let _x;function bA(){return void 0===_x&&(_x=new yA),_x}function bx(n,t=null,e=null,r){const i=wA(n,t,e,r);return i._resolveInjectorDefTypes(),i}function wA(n,t=null,e=null,r){return new A$(n,e,t||bA(),r)}class A${constructor(t,e,r,i=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&il(e,a=>this.processProvider(a,t,e)),il([t],a=>this.processInjectorType(a,[],s)),this.records.set(Ly,np(void 0,this));const o=this.records.get(yx);this.scope=null!=o?o.value:null,this.source=i||("object"==typeof t?null:Ni(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=zi,r=Ar.Default){this.assertNotDestroyed();const i=cw(this),s=Po(void 0);try{if(!(r&Ar.SkipSelf)){let a=this.records.get(t);if(void 0===a){const u=function R$(n){return"function"==typeof n||"object"==typeof n&&n instanceof Qn}(t)&&el(t);a=u&&this.injectableDefInScope(u)?np($y(t),uo):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(r&Ar.Self?bA():this.parent).get(t,e=r&Ar.Optional&&e===zi?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[dy]=o[dy]||[]).unshift(Ni(t)),i)throw o;return function HN(n,t,e,r){const i=n[dy];throw t[lw]&&i.unshift(t[lw]),n.message=function WN(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let i=Ni(t);if(Array.isArray(t))i=t.map(Ni).join(" -> ");else if("object"==typeof t){let s=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Ni(a)))}i=`{${s.join(", ")}}`}return`${e}${r?"("+r+")":""}[${i}]: ${n.replace(BN,"\n  ")}`}("\n"+n.message,i,e,r),n.ngTokenPath=i,n[dy]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{Po(s),cw(i)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((r,i)=>t.push(Ni(i))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new jn(205,!1)}processInjectorType(t,e,r){if(!(t=Pr(t)))return!1;let i=tu(t);const s=null==i&&t.ngModule||void 0,o=void 0===s?t:s,a=-1!==r.indexOf(o);if(void 0!==s&&(i=tu(s)),null==i)return!1;if(null!=i.imports&&!a){let m;r.push(o);try{il(i.imports,y=>{this.processInjectorType(y,e,r)&&(void 0===m&&(m=[]),m.push(y))})}finally{}if(void 0!==m)for(let y=0;y<m.length;y++){const{ngModule:_,providers:E}=m[y];il(E,D=>this.processProvider(D,_,E||cr))}}this.injectorDefTypes.add(o);const u=_f(o)||(()=>new o);this.records.set(o,np(u,uo));const d=i.providers;if(null!=d&&!a){const m=t;il(d,y=>this.processProvider(y,m,d))}return void 0!==s&&void 0!==t.providers}processProvider(t,e,r){let i=rp(t=Pr(t))?t:Pr(t&&t.provide);const s=function D$(n,t,e){return ll(n)?np(void 0,n.useValue):np(xA(n),uo)}(t);if(rp(t)||!0!==t.multi)this.records.get(i);else{let o=this.records.get(i);o||(o=np(void 0,uo,!0),o.factory=()=>my(o.multi),this.records.set(i,o)),i=t,o.multi.push(t)}this.records.set(i,s)}hydrate(t,e){return e.value===uo&&(e.value=_A,e.value=e.factory()),"object"==typeof e.value&&e.value&&function k$(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Pr(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function $y(n){const t=el(n),e=null!==t?t.factory:_f(n);if(null!==e)return e;if(n instanceof Qn)throw new jn(204,!1);if(n instanceof Function)return function I$(n){const t=n.length;if(t>0)throw Gd(t,"?"),new jn(204,!1);const e=function Tu(n){const t=n&&(n[ff]||n[Gv]);if(t){const e=function Tb(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new jn(204,!1)}function xA(n,t,e){let r;if(rp(n)){const i=Pr(n);return _f(i)||$y(i)}if(ll(n))r=()=>Pr(n.useValue);else if(function M$(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...my(n.deps||[]));else if(function CA(n){return!(!n||!n.useExisting)}(n))r=()=>dn(Pr(n.useExisting));else{const i=Pr(n&&(n.useClass||n.provide));if(!function SA(n){return!!n.deps}(n))return _f(i)||$y(i);r=()=>new i(...my(n.deps))}return r}function np(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function ll(n){return null!==n&&"object"==typeof n&&zN in n}function rp(n){return"function"==typeof n}let ra=(()=>{class n{static create(e,r){var i;if(Array.isArray(e))return bx({name:""},r,e,"");{const s=null!==(i=e.name)&&void 0!==i?i:"";return bx({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=zi,n.NULL=new yA,n.\u0275prov=yn({token:n,providedIn:"any",factory:()=>dn(Ly)}),n.__NG_ELEMENT_ID__=-1,n})();function B$(n,t){iu(wh(n)[1],oo())}function oi(n){let t=function RA(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let i;if(so(n))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new jn(903,"");i=t.\u0275dir}if(i){if(e){r.push(i);const o=n;o.inputs=Tx(n.inputs),o.declaredInputs=Tx(n.declaredInputs),o.outputs=Tx(n.outputs);const a=i.hostBindings;a&&U$(n,a);const u=i.viewQuery,d=i.contentQueries;if(u&&z$(n,u),d&&FA(n,d),Ad(n.inputs,i.inputs),Ad(n.declaredInputs,i.declaredInputs),Ad(n.outputs,i.outputs),so(i)&&i.data.animation){const m=n.data;m.animation=(m.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===oi&&(e=!1)}}t=Object.getPrototypeOf(t)}!function OA(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const i=n[r];i.hostVars=t+=i.hostVars,i.hostAttrs=Bm(i.hostAttrs,e=Bm(e,i.hostAttrs))}}(r)}function Tx(n){return n===Du?{}:n===cr?[]:n}function z$(n,t){const e=n.viewQuery;n.viewQuery=e?(r,i)=>{t(r,i),e(r,i)}:t}function FA(n,t){const e=n.contentQueries;n.contentQueries=e?(r,i,s)=>{t(r,i,s),e(r,i,s)}:t}function U$(n,t){const e=n.hostBindings;n.hostBindings=e?(r,i)=>{t(r,i),e(r,i)}:t}let Vy=null;function ag(){if(!Vy){const n=Si.Symbol;if(n&&n.iterator)Vy=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Vy=r)}}}return Vy}function ug(n){return!!zy(n)&&(Array.isArray(n)||!(n instanceof Map)&&ag()in n)}function zy(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function zo(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function Na(n,t,e,r){const i=xn();return zo(i,dr(),t)&&(fi(),Kl(Ns(),i,n,t,e,r)),Na}function So(n,t,e,r,i,s,o,a){const u=xn(),d=fi(),m=n+20,y=d.firstCreatePass?function WA(n,t,e,r,i,s,o,a,u){const d=t.consts,m=Nf(t,n,4,o||null,mh(d,a));ux(t,e,m,mh(d,u)),iu(t,m);const y=m.tViews=Fy(2,m,r,i,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,d);return null!==t.queries&&(t.queries.template(t,m),y.queries=t.queries.embeddedTView(m)),m}(m,d,u,t,e,r,i,s,o):d.data[m];Wl(y,!1);const _=u[11].createComment("");Ny(d,u,_,y),na(_,u),og(u,u[m]=ao(_,u,_,y)),$o(y)&&ix(d,u,y),null!=o&&sx(u,y,a)}function nn(n,t=Ar.Default){const e=xn();return null===e?dn(n,t):nw(oo(),e,Pr(n),t)}function Ri(n,t,e){const r=xn();return zo(r,dr(),t)&&lu(fi(),Ns(),r,n,t,r[11],e,!1),Ri}function Px(n,t,e,r,i){const o=i?"class":"style";gx(n,e,t.inputs[o],o,r)}function Kr(n,t,e,r){const i=xn(),s=fi(),o=20+n,a=i[11],u=i[o]=Xd(a,t,function $d(){return Ir.lFrame.currentNamespace}()),d=s.firstCreatePass?function iI(n,t,e,r,i,s,o){const a=t.consts,d=Nf(t,n,2,i,mh(a,s));return ux(t,e,d,mh(a,o)),null!==d.attrs&&vx(d,d.attrs,!1),null!==d.mergedAttrs&&vx(d,d.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,d),d}(o,s,i,0,t,e,r):s.data[o];Wl(d,!0);const m=d.mergedAttrs;null!==m&&Yb(a,u,m);const y=d.classes;null!==y&&jw(a,u,y);const _=d.styles;return null!==_&&Gw(a,u,_),64!=(64&d.flags)&&Ny(s,i,u,d),0===function nP(){return Ir.lFrame.elementDepthCount}()&&na(u,i),function rP(){Ir.lFrame.elementDepthCount++}(),$o(d)&&(ix(s,i,d),oA(s,d,i)),null!==r&&sx(i,d),Kr}function Gr(){let n=oo();Gb()?jb():(n=n.parent,Wl(n,!1));const t=n;!function iP(){Ir.lFrame.elementDepthCount--}();const e=fi();return e.firstCreatePass&&(iu(e,n),fr(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function SN(n){return 0!=(16&n.flags)}(t)&&Px(e,t,xn(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function EN(n){return 0!=(32&n.flags)}(t)&&Px(e,t,xn(),t.stylesWithoutHost,!1),Gr}function lo(n,t,e,r){return Kr(n,t,e,r),Gr(),lo}function fg(n,t,e){const r=xn(),i=fi(),s=n+20,o=i.firstCreatePass?function uB(n,t,e,r,i){const s=t.consts,o=mh(s,r),a=Nf(t,n,8,"ng-container",o);return null!==o&&vx(a,o,!0),ux(t,e,a,mh(s,i)),null!==t.queries&&t.queries.elementStart(t,a),a}(s,i,r,t,e):i.data[s];Wl(o,!0);const a=r[s]=r[11].createComment("");return Ny(i,r,a,o),na(a,r),$o(o)&&(ix(i,r,o),oA(i,o,r)),null!=e&&sx(r,o),fg}function hp(){let n=oo();const t=fi();return Gb()?jb():(n=n.parent,Wl(n,!1)),t.firstCreatePass&&(iu(t,n),fr(n)&&t.queries.elementEnd(n)),hp}function dg(){return xn()}function Fc(n){return!!n&&"function"==typeof n.then}function Lx(n){return!!n&&"function"==typeof n.subscribe}const oI=Lx;function Vs(n,t,e,r){const i=xn(),s=fi(),o=oo();return function aI(n,t,e,r,i,s,o,a){const u=$o(r),m=n.firstCreatePass&&E$(n),y=t[8],_=gA(t);let E=!0;if(3&r.type||a){const R=Mu(r,t),$=a?a(R):R,B=_.length,Q=a?ie=>a(Ks(ie[r.index])):r.index;if(Es(e)){let ie=null;if(!a&&u&&(ie=function lB(n,t,e,r){const i=n.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===e&&i[s+1]===r){const a=t[7],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(n,t,i,r.index)),null!==ie)(ie.__ngLastListenerFn__||ie).__ngNextListenerFn__=s,ie.__ngLastListenerFn__=s,E=!1;else{s=pg(r,t,y,s,!1);const ye=e.listen($,i,s);_.push(s,ye),m&&m.push(i,Q,B,B+1)}}else s=pg(r,t,y,s,!0),$.addEventListener(i,s,o),_.push(s),m&&m.push(i,Q,B,o)}else s=pg(r,t,y,s,!1);const D=r.outputs;let O;if(E&&null!==D&&(O=D[i])){const R=O.length;if(R)for(let $=0;$<R;$+=2){const Me=t[O[$]][O[$+1]].subscribe(s),Be=_.length;_.push(s,Me),m&&m.push(i,r.index,Be,-(Be+1))}}}(s,i,i[11],o,n,t,!!e,r),Vs}function cB(n,t,e,r){try{return!1!==e(r)}catch(i){return vA(n,i),!1}}function pg(n,t,e,r,i){return function s(o){if(o===Function)return r;const a=2&n.flags?ru(n.index,t):t;0==(32&t[2])&&fx(a);let u=cB(t,0,r,o),d=s.__ngNextListenerFn__;for(;d;)u=cB(t,0,d,o)&&u,d=d.__ngNextListenerFn__;return i&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function cu(n=1){return function wN(n){return(Ir.lFrame.contextLView=function hP(n,t){for(;n>0;)t=t[15],n--;return t}(n,Ir.lFrame.contextLView))[8]}(n)}function hB(n,t){let e=null;const r=function BT(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let i=0;i<t.length;i++){const s=t[i];if("*"!==s){if(null===r?VL(n,s,!0):VT(r,s))return i}else e=i}return e}function Bx(n){const t=xn()[P][6];if(!t.projection){const r=t.projection=Gd(n?n.length:1,null),i=r.slice();let s=t.child;for(;null!==s;){const o=n?hB(s,n):0;null!==o&&(i[o]?i[o].projectionNext=s:r[o]=s,i[o]=s),s=s.next}}}function Ou(n,t=0,e){const r=xn(),i=fi(),s=Nf(i,20+n,16,null,e||null);null===s.projection&&(s.projection=t),jb(),64!=(64&s.flags)&&function FL(n,t,e){Ww(t[11],0,t,e,AT(n,e,t),Bw(e.parent||t[6],e,t))}(i,r,s)}function gI(n,t,e,r,i){const s=n[e+1],o=null===t;let a=r?al(s):kc(s),u=!1;for(;0!==a&&(!1===u||o);){const m=n[a+1];vI(n[a],t)&&(u=!0,n[a+1]=r?Xw(m):Kw(m)),a=r?al(m):kc(m)}u&&(n[e+1]=r?Kw(s):Xw(s))}function vI(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&wf(n,t)>=0}function Gx(n,t,e){return hl(n,t,e,!1),Gx}function Ua(n,t){return hl(n,t,null,!0),Ua}function hl(n,t,e,r){const i=xn(),s=fi(),o=function ku(n){const t=Ir.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}(2);s.firstUpdatePass&&function EI(n,t,e,r){const i=n.data;if(null===i[e+1]){const s=i[xa()],o=function SI(n,t){return t>=n.expandoStartIndex}(n,e);(function SB(n,t){return 0!=(n.flags&(t?16:32))})(s,r)&&null===t&&!o&&(t=!1),t=function jx(n,t,e,r){const i=function Zb(n){const t=Ir.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let s=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(e=mg(e=qy(null,n,t,e,r),t.attrs,r),s=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==i)if(e=qy(i,n,t,e,r),null===s){let u=function yB(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==kc(r))return n[al(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=qy(null,n,t,u[1],r),u=mg(u,t.attrs,r),function _B(n,t,e,r){n[al(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else s=function bB(n,t,e){let r;const i=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<i;s++)r=mg(r,n[s].hostAttrs,e);return mg(r,t.attrs,e)}(n,t,r)}return void 0!==s&&(r?t.residualClasses=s:t.residualStyles=s),e}(i,s,t,r),function mI(n,t,e,r,i,s){let o=s?t.classBindings:t.styleBindings,a=al(o),u=kc(o);n[r]=e;let m,d=!1;if(Array.isArray(e)){const y=e;m=y[1],(null===m||wf(y,m)>0)&&(d=!0)}else m=e;if(i)if(0!==u){const _=al(n[a+1]);n[r+1]=Iy(_,a),0!==_&&(n[_+1]=Dy(n[_+1],r)),n[a+1]=function jT(n,t){return 131071&n|t<<17}(n[a+1],r)}else n[r+1]=Iy(a,0),0!==a&&(n[a+1]=Dy(n[a+1],r)),a=r;else n[r+1]=Iy(u,0),0===a?a=r:n[u+1]=Dy(n[u+1],r),u=r;d&&(n[r+1]=Kw(n[r+1])),gI(n,m,r,!0),gI(n,m,r,!1),function dB(n,t,e,r,i){const s=i?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof t&&wf(s,t)>=0&&(e[r+1]=Xw(e[r+1]))}(t,m,n,r,s),o=Iy(a,u),s?t.classBindings=o:t.styleBindings=o}(i,s,t,e,o,r)}}(s,n,o,r),t!==Rr&&zo(i,o,t)&&function NI(n,t,e,r,i,s,o,a){if(!(3&t.type))return;const u=n.data,d=u[a+1];Zy(function qT(n){return 1==(1&n)}(d)?Zx(u,t,e,i,kc(d),o):void 0)||(Zy(s)||function GT(n){return 2==(2&n)}(d)&&(s=Zx(u,null,e,i,a,o)),function Yd(n,t,e,r,i){const s=Es(n);if(t)i?s?n.addClass(e,r):e.classList.add(r):s?n.removeClass(e,r):e.classList.remove(r);else{let o=-1===r.indexOf("-")?void 0:za.DashCase;if(null==i)s?n.removeStyle(e,r,o):e.style.removeProperty(r);else{const a="string"==typeof i&&i.endsWith("!important");a&&(i=i.slice(0,-10),o|=za.Important),s?n.setStyle(e,r,i,o):e.style.setProperty(r,i,a?"important":"")}}}(r,o,zb(xa(),e),i,s))}(s,s.data[xa()],i,i[11],n,i[o+1]=function CB(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Ni(Ca(n)))),n}(t,e),r,o)}function qy(n,t,e,r,i){let s=null;const o=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<o&&(s=t[a],r=mg(r,s.hostAttrs,i),s!==n);)a++;return null!==n&&(e.directiveStylingLast=a),r}function mg(n,t,e){const r=e?1:2;let i=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?i=o:i===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Va(n,o,!!e||t[++s]))}return void 0===n?null:n}function Zx(n,t,e,r,i,s){const o=null===t;let a;for(;i>0;){const u=n[i],d=Array.isArray(u),m=d?u[1]:u,y=null===m;let _=e[i+1];_===Rr&&(_=y?cr:void 0);let E=y?cy(_,r):m===r?_:void 0;if(d&&!Zy(E)&&(E=cy(u,r)),Zy(E)&&(a=E,o))return a;const D=n[i+1];i=o?al(D):kc(D)}if(null!==t){let u=s?t.residualClasses:t.residualStyles;null!=u&&(a=cy(u,r))}return a}function Zy(n){return void 0!==n}function zs(n,t=""){const e=xn(),r=fi(),i=n+20,s=r.firstCreatePass?Nf(r,i,1,t,null):r.data[i],o=e[i]=function Fw(n,t){return Es(n)?n.createText(t):n.createTextNode(t)}(e[11],t);Ny(r,e,o,s),Wl(s,!1)}function pp(n){return Ky("",n,""),pp}function Ky(n,t,e){const r=xn(),i=function sp(n,t,e,r){return zo(n,dr(),e)?t+Tr(e)+r:Rr}(r,n,t,e);return i!==Rr&&Ch(r,xa(),i),Ky}function Qx(n,t,e){const r=xn();return zo(r,dr(),t)&&lu(fi(),Ns(),r,n,t,r[11],e,!0),Qx}const gg="en-US";let Jx=gg;function n_(n,t,e,r,i){if(n=Pr(n),Array.isArray(n))for(let s=0;s<n.length;s++)n_(n[s],t,e,r,i);else{const s=fi(),o=xn();let a=rp(n)?n:Pr(n.provide),u=xA(n);const d=oo(),m=1048575&d.providerIndexes,y=d.directiveStart,_=d.providerIndexes>>20;if(rp(n)||!n.multi){const E=new Vd(u,i,nn),D=r_(a,t,i?m:m+_,y);-1===D?(ew(Um(d,o),s,a),a1(s,n,t.length),t.push(a),d.directiveStart++,d.directiveEnd++,i&&(d.providerIndexes+=1048576),e.push(E),o.push(E)):(e[D]=E,o[D]=E)}else{const E=r_(a,t,m+_,y),D=r_(a,t,m,m+_),O=E>=0&&e[E],R=D>=0&&e[D];if(i&&!R||!i&&!O){ew(Um(d,o),s,a);const $=function C3(n,t,e,r,i){const s=new Vd(n,e,nn);return s.multi=[],s.index=t,s.componentProviders=0,TD(s,i,r&&!e),s}(i?x3:w3,e.length,i,r,u);!i&&R&&(e[D].providerFactory=$),a1(s,n,t.length,0),t.push(a),d.directiveStart++,d.directiveEnd++,i&&(d.providerIndexes+=1048576),e.push($),o.push($)}else a1(s,n,E>-1?E:D,TD(e[i?D:E],u,!i&&r));!i&&r&&R&&e[D].componentProviders++}}}function a1(n,t,e,r){const i=rp(t),s=function eG(n){return!!n.useClass}(t);if(i||s){const u=(s?Pr(t.useClass):t).prototype.ngOnDestroy;if(u){const d=n.destroyHooks||(n.destroyHooks=[]);if(!i&&t.multi){const m=d.indexOf(e);-1===m?d.push(e,[r,u]):d[m+1].push(r,u)}else d.push(e,u)}}}function TD(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function r_(n,t,e,r){for(let i=e;i<r;i++)if(t[i]===n)return i;return-1}function w3(n,t,e,r){return i_(this.multi,[])}function x3(n,t,e,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Wm(e,e[1],this.providerFactory.index,r);s=a.slice(0,o),i_(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],i_(i,s);return s}function i_(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Hi(n,t=[]){return e=>{e.providersResolver=(r,i)=>function b3(n,t,e){const r=fi();if(r.firstCreatePass){const i=so(n);n_(e,r.data,r.blueprint,i,!0),n_(t,r.data,r.blueprint,i,!1)}}(r,i?i(n):n,t)}}class AD{}class N3{resolveComponentFactory(t){throw function E3(n){const t=Error(`No component factory found for ${Ni(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let $c=(()=>{class n{}return n.NULL=new N3,n})();function T3(){return _p(oo(),xn())}function _p(n,t){return new As(Mu(n,t))}let As=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=T3,n})();function ID(n){return n instanceof As?n.nativeElement:n}class _g{}let Mf=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function MD(){const n=xn(),e=ru(oo().index,n);return function A3(n){return n[11]}(hn(e)?e:n)}(),n})(),I3=(()=>{class n{}return n.\u0275prov=yn({token:n,providedIn:"root",factory:()=>null}),n})();class bp{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const kD=new bp("13.2.7"),l1={};function s_(n,t,e,r,i=!1){for(;null!==e;){const s=t[e.index];if(null!==s&&r.push(Ks(s)),Rn(s))for(let a=10;a<s.length;a++){const u=s[a],d=u[1].firstChild;null!==d&&s_(u[1],u,d,r)}const o=e.type;if(8&o)s_(n,t,e.child,r);else if(32&o){const a=Mw(e,t);let u;for(;u=a();)r.push(u)}else if(16&o){const a=OT(t,e);if(Array.isArray(a))r.push(...a);else{const u=Qm(t[P]);s_(u[1],u,a,r,!0)}}e=i?e.projectionNext:e.next}return r}class wp{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return s_(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Rn(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(Lw(t,r),ly(e,r))}this._attachedToViewContainer=!1}TT(this._lView[1],this._lView)}onDestroy(t){cA(this._lView[1],this._lView,null,t)}markForCheck(){fx(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){px(this._lView[1],this._lView,this.context)}checkNoChanges(){!function w$(n,t,e){Qv(!0);try{px(n,t,e)}finally{Qv(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new jn(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function DL(n,t){ng(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new jn(902,"");this._appRef=t}}class D3 extends wp{constructor(t){super(t),this._view=t}detectChanges(){Oc(this._view)}checkNoChanges(){!function x$(n){Qv(!0);try{Oc(n)}finally{Qv(!1)}}(this._view)}get context(){return null}}class RD extends $c{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=vs(t);return new o_(e,this.ngModule)}}function c1(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class o_ extends AD{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function UT(n){return n.map(HL).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return c1(this.componentDef.inputs)}get outputs(){return c1(this.componentDef.outputs)}create(t,e,r,i){const s=(i=i||this.ngModule)?function k3(n,t){return{get:(e,r,i)=>{const s=n.get(e,l1,i);return s!==l1||r===l1?s:t.get(e,r,i)}}}(t,i.injector):t,o=s.get(_g,lN),a=s.get(I3,null),u=o.createRenderer(null,this.componentDef),d=this.componentDef.selectors[0][0]||"div",m=r?function ox(n,t,e){if(Es(n))return n.selectRootElement(t,e===Co.ShadowDom);let r="string"==typeof t?n.querySelector(t):t;return r.textContent="",r}(u,r,this.componentDef.encapsulation):Xd(o.createRenderer(null,this.componentDef),d,function M3(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(d)),y=this.componentDef.onPush?576:528,_=function kA(n,t){return{components:[],scheduler:n||CL,clean:S$,playerHandler:t||null,flags:0}}(),E=Fy(0,null,null,1,0,null,null,null,null,null),D=sg(null,E,_,y,null,null,o,u,a,s);let O,R;Jv(D);try{const $=function MA(n,t,e,r,i,s){const o=e[1];e[20]=n;const u=Nf(o,20,2,"#host",null),d=u.mergedAttrs=t.hostAttrs;null!==d&&(vx(u,d,!0),null!==n&&(Yb(i,n,d),null!==u.classes&&jw(i,n,u.classes),null!==u.styles&&Gw(i,n,u.styles)));const m=r.createRenderer(n,t),y=sg(e,aA(t),null,t.onPush?64:16,e[20],u,r,m,s||null,null);return o.firstCreatePass&&(ew(Um(u,e),o,t.type),dA(o,u),pA(u,e.length,1)),og(e,y),e[20]=y}(m,this.componentDef,D,o,u);if(m)if(r)Yb(u,m,["ng-version",kD.full]);else{const{attrs:B,classes:Q}=function WL(n){const t=[],e=[];let r=1,i=2;for(;r<n.length;){let s=n[r];if("string"==typeof s)2===i?""!==s&&t.push(s,n[++r]):8===i&&e.push(s);else{if(!ol(i))break;i=s}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);B&&Yb(u,m,B),Q&&Q.length>0&&jw(u,m,Q.join(" "))}if(R=Ub(E,20),void 0!==e){const B=R.projection=[];for(let Q=0;Q<this.ngContentSelectors.length;Q++){const ie=e[Q];B.push(null!=ie?Array.from(ie):null)}}O=function Nx(n,t,e,r,i){const s=e[1],o=function h$(n,t,e){const r=oo();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),mA(n,r,t,Qd(n,t,1,null),e));const i=Wm(t,n,r.directiveStart,r);na(i,t);const s=Mu(r,t);return s&&na(s,t),i}(s,e,t);if(r.components.push(o),n[8]=o,i&&i.forEach(u=>u(o,t)),t.contentQueries){const u=oo();t.contentQueries(1,o,u.directiveStart)}const a=oo();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Mr(a.index),lx(e[1],a,0,a.directiveStart,a.directiveEnd,t),fA(t,o)),o}($,this.componentDef,D,_,[B$]),Jd(E,D,null)}finally{ty()}return new O3(this.componentType,O,_p(R,D),D,R)}}class O3 extends class S3{}{constructor(t,e,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new D3(i),this.componentType=t}get injector(){return new Gm(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class xp{}const Cp=new Map;class FD extends xp{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new RD(this);const r=$a(t);this._bootstrapComponents=Zl(r.bootstrap),this._r3Injector=wA(t,e,[{provide:xp,useValue:this},{provide:$c,useValue:this.componentFactoryResolver}],Ni(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=ra.THROW_IF_NOT_FOUND,r=Ar.Default){return t===ra||t===xp||t===Ly?this:this._r3Injector.get(t,e,r)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class a_ extends class OD{}{constructor(t){super(),this.moduleType=t,null!==$a(t)&&function P3(n){const t=new Set;!function e(r){const i=$a(r,!0),s=i.id;null!==s&&(function h1(n,t,e){if(t&&t!==e)throw new Error(`Duplicate module registered for ${n} - ${Ni(t)} vs ${Ni(t.name)}`)}(s,Cp.get(s),r),Cp.set(s,r));const o=Zl(i.imports);for(const a of o)t.has(a)||(t.add(a),e(a))}(n)}(t)}create(t){return new FD(this.moduleType,t)}}function VD(n,t,e,r,i,s){const o=t+e;return zo(n,o,i)?function Xl(n,t,e){return n[t]=e}(n,o+1,s?r.call(s,i):r(i)):function bg(n,t){const e=n[t];return e===Rr?void 0:e}(n,o+1)}function qD(n,t,e){const r=n+20,i=xn(),s=Pd(i,r);return function Sp(n,t){return n[1].data[t].pure}(i,r)?VD(i,function wa(){const n=Ir.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}(),t,s.transform,e,s):s.transform(e)}function d1(n){return t=>{setTimeout(n,void 0,t)}}const ho=class KD extends Qi{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){var i,s,o;let a=t,u=e||(()=>null),d=r;if(t&&"object"==typeof t){const y=t;a=null===(i=y.next)||void 0===i?void 0:i.bind(y),u=null===(s=y.error)||void 0===s?void 0:s.bind(y),d=null===(o=y.complete)||void 0===o?void 0:o.bind(y)}this.__isAsync&&(u=d1(u),a&&(a=d1(a)),d&&(d=d1(d)));const m=super.subscribe({next:a,error:u,complete:d});return t instanceof mr&&t.add(m),m}};function XD(){return this._results[ag()]()}class p1{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=ag(),r=p1.prototype;r[e]||(r[e]=XD)}get changes(){return this._changes||(this._changes=new ho)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const i=ou(t);(this._changesDetected=!function DN(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],s=t[r];if(e&&(i=e(i),s=e(s)),s!==i)return!1}return!0}(r._results,i,e))&&(r._results=i,r.length=i.length,r.last=i[this.length-1],r.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Bc=(()=>{class n{}return n.__NG_ELEMENT_ID__=q3,n})();const YD=Bc,j3=class extends YD{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t){const e=this._declarationTContainer.tViews,r=sg(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(r[19]=s.createEmbeddedView(e)),Jd(e,r,t),new wp(r)}};function q3(){return Ep(oo(),xn())}function Ep(n,t){return 4&n.type?new j3(t,n,_p(n,t)):null}let Pu=(()=>{class n{}return n.__NG_ELEMENT_ID__=Z3,n})();function Z3(){return v1(oo(),xn())}const K3=Pu,m1=class extends K3{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return _p(this._hostTNode,this._hostLView)}get injector(){return new Gm(this._hostTNode,this._hostLView)}get parentInjector(){const t=Hm(this._hostTNode,this._hostLView);if(bf(t)){const e=zm(t,this._hostLView),r=Ac(t);return new Gm(e[1].data[r+8],e)}return new Gm(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=QD(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){const i=t.createEmbeddedView(e||{});return this.insert(i,r),i}createComponent(t,e,r,i,s){const o=t&&!function Dc(n){return"function"==typeof n}(t);let a;if(o)a=e;else{const y=e||{};a=y.index,r=y.injector,i=y.projectableNodes,s=y.ngModuleRef}const u=o?t:new o_(vs(t)),d=r||this.parentInjector;if(!s&&null==u.ngModule){const _=(o?d:this.parentInjector).get(xp,null);_&&(s=_)}const m=u.create(d,i,void 0,s);return this.insert(m.hostView,a),m}insert(t,e){const r=t._lView,i=r[1];if(function tP(n){return Rn(n[3])}(r)){const m=this.indexOf(t);if(-1!==m)this.detach(m);else{const y=r[3],_=new m1(y,y[6],y[3]);_.detach(_.indexOf(t))}}const s=this._adjustIndex(e),o=this._lContainer;!function ML(n,t,e,r){const i=10+r,s=e.length;r>0&&(e[i-1][4]=t),r<s-10?(t[4]=e[i],ow(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function kL(n,t){const e=n[9];t[P]!==t[3][3][P]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(n),t[2]|=128}(i,r,o,s);const a=Hw(s,o),u=r[11],d=tg(u,o[7]);return null!==d&&function IL(n,t,e,r,i,s){r[0]=i,r[6]=t,ng(n,r,e,1,i,s)}(i,o[6],u,r,d,a),t.attachToViewContainerRef(),ow(g1(o),s,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=QD(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=Lw(this._lContainer,e);r&&(ly(g1(this._lContainer),e),TT(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=Lw(this._lContainer,e);return r&&null!=ly(g1(this._lContainer),e)?new wp(r):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function QD(n){return n[8]}function g1(n){return n[8]||(n[8]=[])}function v1(n,t){let e;const r=t[n.index];if(Rn(r))e=r;else{let i;if(8&n.type)i=Ks(r);else{const s=t[11];i=s.createComment("");const o=Mu(n,t);Ef(s,tg(s,o),i,function kT(n,t){return Es(n)?n.nextSibling(t):t.nextSibling}(s,o),!1)}t[n.index]=e=ao(r,t,i,n),og(t,e)}return new m1(e,n,t)}class y1{constructor(t){this.queryList=t,this.matches=null}clone(){return new y1(this.queryList)}setDirty(){this.queryList.setDirty()}}class _1{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,i=[];for(let s=0;s<r;s++){const o=e.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new _1(i)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==tV(t,e).matches&&this.queries[e].setDirty()}}class b1{constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class w1{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const i=null!==e?e.length:0,s=this.getByIndex(r).embeddedTView(t,i);s&&(s.indexInDeclarationView=r,null!==e?e.push(s):e=[s])}return null!==e?new w1(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class x1{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new x1(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=r[i];this.matchTNodeWithReadOption(t,e,JD(e,s)),this.matchTNodeWithReadOption(t,e,Ud(e,t,s,!1,!1))}else r===Bc?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Ud(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===As||i===Pu||i===Bc&&4&e.type)this.addMatch(e.index,-2);else{const s=Ud(e,t,i,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function JD(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function eV(n,t,e,r){return-1===e?function J3(n,t){return 11&n.type?_p(n,t):4&n.type?Ep(n,t):null}(t,n):-2===e?function eM(n,t,e){return e===As?_p(t,n):e===Bc?Ep(t,n):e===Pu?v1(t,n):void 0}(n,t,r):Wm(n,n[1],e,t)}function tM(n,t,e,r){const i=t[19].queries[r];if(null===i.matches){const s=n.data,o=e.matches,a=[];for(let u=0;u<o.length;u+=2){const d=o[u];a.push(d<0?null:eV(t,s[d],o[u+1],e.metadata.read))}i.matches=a}return i.matches}function C1(n,t,e,r){const i=n.queries.getByIndex(e),s=i.matches;if(null!==s){const o=tM(n,t,i,e);for(let a=0;a<s.length;a+=2){const u=s[a];if(u>0)r.push(o[a/2]);else{const d=s[a+1],m=t[-u];for(let y=10;y<m.length;y++){const _=m[y];_[17]===_[3]&&C1(_[1],_,d,r)}if(null!==m[9]){const y=m[9];for(let _=0;_<y.length;_++){const E=y[_];C1(E[1],E,d,r)}}}}}return r}function mn(n){const t=xn(),e=fi(),r=gN();Kb(r+1);const i=tV(e,r);if(n.dirty&&cN(t)===(2==(2&i.metadata.flags))){if(null===i.matches)n.reset([]);else{const s=i.crossesNgTemplate?C1(e,t,r,[]):tM(e,t,i,r);n.reset(s,ID),n.notifyOnChanges()}return!0}return!1}function Ii(n,t,e){const r=fi();r.firstCreatePass&&(nM(r,new b1(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),kf(r,xn(),t)}function Vc(n,t,e,r){const i=fi();if(i.firstCreatePass){const s=oo();nM(i,new b1(t,e,r),s.index),function AG(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(i,n),2==(2&e)&&(i.staticContentQueries=!0)}kf(i,xn(),e)}function Aa(){return function TG(n,t){return n[19].queries[t].queryList}(xn(),gN())}function kf(n,t,e){const r=new p1(4==(4&e));cA(n,t,r,r.destroy),null===t[19]&&(t[19]=new _1),t[19].queries.push(new y1(r))}function nM(n,t,e){null===n.queries&&(n.queries=new w1),n.queries.track(new x1(t,e))}function tV(n,t){return n.queries.getByIndex(t)}function Nh(...n){}const gV=new Qn("Application Initializer");let lM=(()=>{class n{constructor(e){this.appInits=e,this.resolve=Nh,this.reject=Nh,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const s=this.appInits[i]();if(Fc(s))e.push(s);else if(oI(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(i=>{this.reject(i)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(dn(gV,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const c_=new Qn("AppId",{providedIn:"root",factory:function cM(){return`${I1()}${I1()}${I1()}`}});function I1(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Rf=new Qn("Platform Initializer"),D1=new Qn("Platform ID"),zG=new Qn("appBootstrapListener");let UG=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();const Th=new Qn("LocaleId",{providedIn:"root",factory:()=>py(Th,Ar.Optional|Ar.SkipSelf)||function vV(){return"undefined"!=typeof $localize&&$localize.locale||gg}()}),GG=(()=>Promise.resolve(0))();function hM(n){"undefined"==typeof Zone?GG.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Oi{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ho(!1),this.onMicrotaskEmpty=new ho(!1),this.onStable=new ho(!1),this.onError=new ho(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&e,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function bV(){let n=Si.requestAnimationFrame,t=Si.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function qG(n){const t=()=>{!function dM(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Si,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Cg(n),n.isCheckStableRunning=!0,fM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Cg(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,i,s,o,a)=>{try{return wV(n),e.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&t(),xV(n)}},onInvoke:(e,r,i,s,o,a,u)=>{try{return wV(n),e.invoke(i,s,o,a,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),xV(n)}},onHasTask:(e,r,i,s)=>{e.hasTask(i,s),r===i&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Cg(n),fM(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,r,i,s)=>(e.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Oi.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Oi.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,t,jG,Nh,Nh);try{return s.runTask(o,e,r)}finally{s.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const jG={};function fM(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Cg(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function wV(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function xV(n){n._nesting--,fM(n)}class ZG{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ho,this.onMicrotaskEmpty=new ho,this.onStable=new ho,this.onError=new ho}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,i){return t.apply(e,r)}}let pM=(()=>{class n{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Oi.assertNotInAngularZone(),hM(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())hM(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:i})}whenStable(e,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,r,i){return[]}}return n.\u0275fac=function(e){return new(e||n)(dn(Oi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})(),CV=(()=>{class n{constructor(){this._applications=new Map,Jl.addToWindow(this)}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return Jl.findTestabilityInTree(this,e,r)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();class Ff{addToWindow(t){}findTestabilityInTree(t,e,r){return null}}let ec,Jl=new Ff;const $n=new Qn("AllowMultipleToken");function NV(n,t,e=[]){const r=`Platform: ${t}`,i=new Qn(r);return(s=[])=>{let o=mM();if(!o||o.injector.get($n,!1))if(n)n(e.concat(s).concat({provide:i,useValue:!0}));else{const a=e.concat(s).concat({provide:i,useValue:!0},{provide:yx,useValue:"platform"});!function EV(n){if(ec&&!ec.destroyed&&!ec.injector.get($n,!1))throw new jn(400,"");ec=n.get(TV);const t=n.get(Rf,null);t&&t.forEach(e=>e())}(ra.create({providers:a,name:r}))}return function Sg(n){const t=mM();if(!t)throw new jn(401,"");return t}()}}function mM(){return ec&&!ec.destroyed?ec:null}let TV=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const a=function Ha(n,t){let e;return e="noop"===n?new ZG:("zone.js"===n?void 0:n)||new Oi({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),e}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),u=[{provide:Oi,useValue:a}];return a.run(()=>{const d=ra.create({providers:u,parent:this.injector,name:e.moduleType.name}),m=e.create(d),y=m.injector.get(Mc,null);if(!y)throw new jn(402,"");return a.runOutsideAngular(()=>{const _=a.onError.subscribe({next:E=>{y.handleError(E)}});m.onDestroy(()=>{Qs(this._modules,m),_.unsubscribe()})}),function zc(n,t,e){try{const r=e();return Fc(r)?r.catch(i=>{throw t.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(y,a,()=>{const _=m.injector.get(lM);return _.runInitializers(),_.donePromise.then(()=>(function zB(n){gs(n,"Expected localeId to be defined"),"string"==typeof n&&(Jx=n.toLowerCase().replace(/_/g,"-"))}(m.injector.get(Th,gg)||gg),this._moduleDoBootstrap(m),m))})})}bootstrapModule(e,r=[]){const i=AV({},r);return function XG(n,t,e){const r=new a_(e);return Promise.resolve(r)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(e){const r=e.injector.get(fl);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!e.instance.ngDoBootstrap)throw new jn(403,"");e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new jn(404,"");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(dn(ra))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();function AV(n,t){return Array.isArray(t)?t.reduce(AV,n):Object.assign(Object.assign({},n),t)}let fl=(()=>{class n{constructor(e,r,i,s,o){this._zone=e,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new $i(d=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{d.next(this._stable),d.complete()})}),u=new $i(d=>{let m;this._zone.runOutsideAngular(()=>{m=this._zone.onStable.subscribe(()=>{Oi.assertNotInAngularZone(),hM(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,d.next(!0))})})});const y=this._zone.onUnstable.subscribe(()=>{Oi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{d.next(!1)}))});return()=>{m.unsubscribe(),y.unsubscribe()}});this.isStable=ei(a,u.pipe(zv()))}bootstrap(e,r){if(!this._initStatus.done)throw new jn(405,"");let i;i=e instanceof AD?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(i.componentType);const s=function Tp(n){return n.isBoundToModule}(i)?void 0:this._injector.get(xp),a=i.create(ra.NULL,[],r||i.selector,s),u=a.location.nativeElement,d=a.injector.get(pM,null),m=d&&a.injector.get(CV);return d&&m&&m.registerApplication(u,d),a.onDestroy(()=>{this.detachView(a.hostView),Qs(this.components,a),m&&m.unregisterApplication(u)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new jn(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;Qs(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(zG,[]).concat(this._bootstrapListeners).forEach(i=>i(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(e){return new(e||n)(dn(Oi),dn(ra),dn(Mc),dn($c),dn(lM))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Qs(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let vM=!0,Eg=(()=>{class n{}return n.__NG_ELEMENT_ID__=yM,n})();function yM(n){return function QG(n,t,e){if(Wr(n)&&!e){const r=ru(n.index,t);return new wp(r,r)}return 47&n.type?new wp(t[P],t):null}(oo(),xn(),16==(16&n))}class PV{constructor(){}supports(t){return ug(t)}create(t){return new LV(t)}}const R1=(n,t)=>t;class LV{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||R1}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,i=0,s=null;for(;e||r;){const o=!r||e&&e.currentIndex<Ho(r,i,s)?e:r,a=Ho(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)i++;else{s||(s=[]);const d=a-i,m=u-i;if(d!=m){for(let _=0;_<d;_++){const E=_<s.length?s[_]:s[_]=0,D=E+_;m<=D&&D<d&&(s[_]=E+1)}s[o.previousIndex]=m-d}}a!==u&&t(o,a,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ug(t))throw new jn(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let i,s,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)s=t[a],o=this._trackByFn(a,s),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,s,o,a)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,o,a),r=!0),e=e._next}else i=0,function oG(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[ag()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,a=>{o=this._trackByFn(i,a),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,a,o,i)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,o,i),r=!0),e=e._next,i++}),this.length=i;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,i){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,i)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,i)):t=this._addAfter(new nj(e,r),s,i),t}_verifyReinsertion(t,e,r,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==s?t=this._reinsertAfter(s,t._prev,i):t.currentIndex!=i&&(t.currentIndex=i,this._addToMoves(t,i)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const i=t._prevRemoved,s=t._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const i=null===e?this._itHead:e._next;return t._next=i,t._prev=e,null===i?this._itTail=t:i._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new $V),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new $V),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class nj{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xM{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class $V{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new xM,this.map.set(e,r)),r.add(t)}get(t,e){const i=this.map.get(t);return i?i.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ho(n,t,e){const r=n.previousIndex;if(null===r)return r;let i=0;return e&&r<e.length&&(i=e[r]),r+t+i}class BV{constructor(){}supports(t){return t instanceof Map||zy(t)}create(){return new rj}}class rj{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||zy(t)))throw new jn(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,i)=>{if(e&&e.key===i)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(i,r);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const i=this._records.get(t);this._maybeAddToChanges(i,e);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const r=new ij(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class ij{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function nc(){return new O1([new PV])}let O1=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const i=r.factories.slice();e=e.concat(i)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||nc()),deps:[[n,new qd,new _h]]}}find(e){const r=this.factories.find(i=>i.supports(e));if(null!=r)return r;throw new jn(901,"")}}return n.\u0275prov=yn({token:n,providedIn:"root",factory:nc}),n})();function VV(){return new Lf([new BV])}let Lf=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const i=r.factories.slice();e=e.concat(i)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||VV()),deps:[[n,new qd,new _h]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new jn(901,"")}}return n.\u0275prov=yn({token:n,providedIn:"root",factory:VV}),n})();const CM=NV(null,"core",[{provide:D1,useValue:"unknown"},{provide:TV,deps:[ra]},{provide:CV,deps:[]},{provide:UG,deps:[]}]);let aj=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(dn(fl))},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({}),n})(),F1=null;function rc(){return F1}const vi=new Qn("DocumentToken");let d_=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:function(){return function WV(){return dn(SM)}()},providedIn:"platform"}),n})(),SM=(()=>{class n extends d_{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return rc().getBaseHref(this._doc)}onPopState(e){const r=rc().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=rc().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,i){fu()?this._history.pushState(e,r,i):this.location.hash=i}replaceState(e,r,i){fu()?this._history.replaceState(e,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(dn(vi))},n.\u0275prov=yn({token:n,factory:function(){return function mj(){return new SM(dn(vi))}()},providedIn:"platform"}),n})();function fu(){return!!window.history.pushState}function GV(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function jV(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function $f(n){return n&&"?"!==n[0]?"?"+n:n}let Tg=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:function(){return function gj(n){const t=dn(vi).location;return new yj(dn(d_),t&&t.origin||"")}()},providedIn:"root"}),n})();const vj=new Qn("appBaseHref");let yj=(()=>{class n extends Tg{constructor(e,r){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return GV(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+$f(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${r}${i}`:r}pushState(e,r,i,s){const o=this.prepareExternalUrl(i+$f(s));this._platformLocation.pushState(e,r,o)}replaceState(e,r,i,s){const o=this.prepareExternalUrl(i+$f(s));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var r,i;null===(i=(r=this._platformLocation).historyGo)||void 0===i||i.call(r,e)}}return n.\u0275fac=function(e){return new(e||n)(dn(d_),dn(vj,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})(),qV=(()=>{class n{constructor(e,r){this._subject=new ho,this._urlChangeListeners=[],this._platformStrategy=e;const i=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=jV(KV(i)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+$f(r))}normalize(e){return n.stripTrailingSlash(function ZV(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,KV(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,r="",i=null){this._platformStrategy.pushState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+$f(r)),i)}replaceState(e,r="",i=null){this._platformStrategy.replaceState(i,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+$f(r)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var r,i;null===(i=(r=this._platformStrategy).historyGo)||void 0===i||i.call(r,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(i=>i(e,r))}subscribe(e,r,i){return this._subject.subscribe({next:e,error:r,complete:i})}}return n.normalizeQueryParams=$f,n.joinWithSlash=GV,n.stripTrailingSlash=jV,n.\u0275fac=function(e){return new(e||n)(dn(Tg),dn(d_))},n.\u0275prov=yn({token:n,factory:function(){return function _j(){return new qV(dn(Tg),dn(d_))}()},providedIn:"root"}),n})();function KV(n){return n.replace(/\/index.html$/,"")}let az=(()=>{class n{constructor(e,r,i,s){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=i,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(ug(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Ni(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}}return n.\u0275fac=function(e){return new(e||n)(nn(O1),nn(Lf),nn(As),nn(Mf))},n.\u0275dir=sr({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})(),Ig=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new Yj,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){lz("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){lz("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(nn(Pu),nn(Bc))},n.\u0275dir=sr({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class Yj{constructor(){this.$implicit=null,this.ngIf=null}}function lz(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Ni(t)}'.`)}class OM{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let X1=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const r=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let r=0;r<this._defaultViews.length;r++)this._defaultViews[r].enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=sr({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),FM=(()=>{class n{constructor(e,r,i){this.ngSwitch=i,i._addCase(),this._view=new OM(e,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(nn(Pu),nn(Bc),nn(X1,9))},n.\u0275dir=sr({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})();class $M{createSubscription(t,e){return t.subscribe({next:e,error:r=>{throw r}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}}class cz{createSubscription(t,e){return t.then(e,r=>{throw r})}dispose(t){}onDestroy(t){}}const hz=new cz,fz=new $M;let dz=(()=>{class n{constructor(e){this._ref=e,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,r=>this._updateLatestValue(e,r))}_selectStrategy(e){if(Fc(e))return hz;if(Lx(e))return fz;throw function ml(n,t){return new jn(2100,"")}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,r){e===this._obj&&(this._latestValue=r,this._ref.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(nn(Eg,16))},n.\u0275pipe=ya({name:"async",type:n,pure:!1}),n})(),Dp=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({}),n})();const GM="browser";class jM extends class d9 extends class HV{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function dj(n){F1||(F1=n)}(new jM)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function p9(){return y_=y_||document.querySelector("base"),y_?y_.getAttribute("href"):null}();return null==e?null:function m9(n){eC=eC||document.createElement("a"),eC.setAttribute("href",n);const t=eC.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){y_=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function oz(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[i,s]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(i.trim()===t)return decodeURIComponent(s)}return null}(document.cookie,t)}}let eC,y_=null;const tC=new Qn("TRANSITION_ID"),kg=[{provide:gV,useFactory:function qM(n,t,e){return()=>{e.get(lM).donePromise.then(()=>{const r=rc(),i=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<i.length;s++)r.remove(i[s])})}},deps:[tC,vi,ra],multi:!0}];class nC{static init(){!function KG(n){Jl=n}(new nC)}addToWindow(t){Si.getAngularTestability=(r,i=!0)=>{const s=t.findTestabilityInTree(r,i);if(null==s)throw new Error("Could not find testability for element.");return s},Si.getAllAngularTestabilities=()=>t.getAllTestabilities(),Si.getAllAngularRootElements=()=>t.getAllRootElements(),Si.frameworkStabilizers||(Si.frameworkStabilizers=[]),Si.frameworkStabilizers.push(r=>{const i=Si.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(u){o=o||u,s--,0==s&&r(o)};i.forEach(function(u){u.whenStable(a)})})}findTestabilityInTree(t,e,r){if(null==e)return null;const i=t.getTestability(e);return null!=i?i:r?rc().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let xz=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();const Rg=new Qn("EventManagerPlugins");let __=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(i=>i.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,i){return this._findPluginFor(r).addEventListener(e,r,i)}addGlobalEventListener(e,r,i){return this._findPluginFor(r).addGlobalEventListener(e,r,i)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const i=this._plugins;for(let s=0;s<i.length;s++){const o=i[s];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(dn(Rg),dn(Oi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();class ZM{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const i=rc().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,r)}}let Cz=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})(),b_=(()=>{class n extends Cz{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,i){e.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,i.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(Sz),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(e,i,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(Sz))}}return n.\u0275fac=function(e){return new(e||n)(dn(vi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();function Sz(n){rc().remove(n)}const KM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},rC=/%COMP%/g;function w_(n,t,e){for(let r=0;r<t.length;r++){let i=t[r];Array.isArray(i)?w_(n,i,e):(i=i.replace(rC,n),e.push(i))}return e}function YM(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let Mp=(()=>{class n{constructor(e,r,i){this.eventManager=e,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new QM(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case Co.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new Tz(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(e),i}case 1:case Co.ShadowDom:return new _9(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const i=w_(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(dn(__),dn(b_),dn(c_))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();class QM{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(KM[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,r){t&&t.insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,i){if(i){e=i+":"+e;const s=KM[i];s?t.setAttributeNS(s,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const i=KM[r];i?t.removeAttributeNS(i,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,i){i&(za.DashCase|za.Important)?t.style.setProperty(e,r,i&za.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&za.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,YM(r)):this.eventManager.addEventListener(t,e,YM(r))}}class Tz extends QM{constructor(t,e,r,i){super(t),this.component=r;const s=w_(i+"-"+r.id,r.styles,[]);e.addStyles(s),this.contentAttr=function g9(n){return"_ngcontent-%COMP%".replace(rC,n)}(i+"-"+r.id),this.hostAttr=function v9(n){return"_nghost-%COMP%".replace(rC,n)}(i+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class _9 extends QM{constructor(t,e,r,i){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=w_(i.id,i.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let b9=(()=>{class n extends ZM{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,i){return e.addEventListener(r,i,!1),()=>this.removeEventListener(e,r,i)}removeEventListener(e,r,i){return e.removeEventListener(r,i)}}return n.\u0275fac=function(e){return new(e||n)(dn(vi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();const Az=["alt","control","meta","shift"],w9={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},x_={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},x9={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Iz=(()=>{class n extends ZM{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,i){const s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>rc().onAndCancel(e,s.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=n._normalizeKey(r.pop());let o="";if(Az.forEach(u=>{const d=r.indexOf(u);d>-1&&(r.splice(d,1),o+=u+".")}),o+=s,0!=r.length||0===s.length)return null;const a={};return a.domEventName=i,a.fullKey=o,a}static getEventFullKey(e){let r="",i=function Dz(n){let t=n.key;if(null==t){if(t=n.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===n.location&&x_.hasOwnProperty(t)&&(t=x_[t]))}return w9[t]||t}(e);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Az.forEach(s=>{s!=i&&x9[s](e)&&(r+=s+".")}),r+=i,r}static eventCallback(e,r,i){return s=>{n.getEventFullKey(s)===e&&i.runGuarded(()=>r(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(dn(vi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();const Oz=NV(CM,"browser",[{provide:D1,useValue:GM},{provide:Rf,useValue:function Mz(){jM.makeCurrent(),nC.init()},multi:!0},{provide:vi,useFactory:function Rz(){return function YF(n){Bb=n}(document),document},deps:[]}]),ek=[{provide:yx,useValue:"root"},{provide:Mc,useFactory:function kz(){return new Mc},deps:[]},{provide:Rg,useClass:b9,multi:!0,deps:[vi,Oi,D1]},{provide:Rg,useClass:Iz,multi:!0,deps:[vi]},{provide:Mp,useClass:Mp,deps:[__,b_,c_]},{provide:_g,useExisting:Mp},{provide:Cz,useExisting:b_},{provide:b_,useClass:b_,deps:[vi]},{provide:pM,useClass:pM,deps:[Oi]},{provide:__,useClass:__,deps:[Rg,Oi]},{provide:class f9{},useClass:xz,deps:[]}];let Fz=(()=>{class n{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:n,providers:[{provide:c_,useValue:e.appId},{provide:tC,useExisting:c_},kg]}}}return n.\u0275fac=function(e){return new(e||n)(dn(n,12))},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({providers:ek,imports:[Dp,aj]}),n})();"undefined"!=typeof window&&window;let S_=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:function(e){let r=null;return r=e?new(e||n):dn(ik),r},providedIn:"root"}),n})(),ik=(()=>{class n extends S_{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case Ai.NONE:return r;case Ai.HTML:return au(r,"HTML")?Ca(r):aT(this._doc,String(r)).toString();case Ai.STYLE:return au(r,"Style")?Ca(r):r;case Ai.SCRIPT:if(au(r,"Script"))return Ca(r);throw new Error("unsafe value used in a script context");case Ai.URL:return KN(r),au(r,"URL")?Ca(r):Xm(String(r));case Ai.RESOURCE_URL:if(au(r,"ResourceURL"))return Ca(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function KP(n){return new GP(n)}(e)}bypassSecurityTrustStyle(e){return function XP(n){return new jP(n)}(e)}bypassSecurityTrustScript(e){return function YP(n){return new qP(n)}(e)}bypassSecurityTrustUrl(e){return function Kd(n){return new Km(n)}(e)}bypassSecurityTrustResourceUrl(e){return function XN(n){return new ZP(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(dn(vi))},n.\u0275prov=yn({token:n,factory:function(e){let r=null;return r=e?new e:function jz(n){return new ik(n.get(vi))}(dn(ra)),r},providedIn:"root"}),n})();const sk=new Qn("cdk-dir-doc",{providedIn:"root",factory:function qz(){return py(vi)}}),ok=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let cC,uC=(()=>{class n{constructor(e){if(this.value="ltr",this.change=new ho,e){const i=e.documentElement?e.documentElement.dir:null;this.value=function Zz(n){const t=(null==n?void 0:n.toLowerCase())||"";return"auto"===t&&"undefined"!=typeof navigator&&(null==navigator?void 0:navigator.language)?ok.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||i||"ltr")}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(e){return new(e||n)(dn(sk,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Dh=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({}),n})();try{cC="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){cC=!1}let Vf,Da=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function a9(n){return n===GM}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!cC)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(e){return new(e||n)(dn(D1))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const uk=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function lk(){if(Vf)return Vf;if("object"!=typeof document||!document)return Vf=new Set(uk),Vf;let n=document.createElement("input");return Vf=new Set(uk.filter(t=>(n.setAttribute("type",t),n.type===t))),Vf}let zf,Mh,Pg;function Fg(n){return function B9(){if(null==zf&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>zf=!0}))}finally{zf=zf||!1}return zf}()?n:!!n.capture}function Kz(){if(null==Mh){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Mh=!1,Mh;if("scrollBehavior"in document.documentElement.style)Mh=!0;else{const n=Element.prototype.scrollTo;Mh=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Mh}function Uc(n){return n.composedPath?n.composedPath()[0]:n.target}function hC(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}class fk extends Qi{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}function Uf(...n){return Cc(n,eu(n))}function a4(n,t){return Pi((e,r)=>{let i=0;e.subscribe(Bn(r,s=>n.call(t,s,i++)&&r.next(s)))})}function tq(n){return a4((t,e)=>n<=e)}function pse(n,t){return n===t}function Lu(n){return Pi((t,e)=>{ro(n).subscribe(Bn(e,()=>e.complete(),et)),!e.closed&&t.subscribe(e)})}function Gf(n){return null!=n&&"false"!=`${n}`}function u4(n,t=0){return function mse(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):t}function xk(n){return Array.isArray(n)?n:[n]}function To(n){return null==n?"":"string"==typeof n?n:`${n}px`}function jf(n){return n instanceof As?n.nativeElement:n}class gse extends mr{constructor(t,e){super()}schedule(t,e=0){return this}}const Ck={setInterval(n,t,...e){const{delegate:r}=Ck;return(null==r?void 0:r.setInterval)?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=Ck;return((null==t?void 0:t.clearInterval)||clearInterval)(n)},delegate:void 0};class l4 extends gse{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,e),this}requestAsyncId(t,e,r=0){return Ck.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&Ck.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i,r=!1;try{this.work(t)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,_r(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const nq={now:()=>(nq.delegate||Date).now(),delegate:void 0};class mC{constructor(t,e=mC.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}mC.now=nq.now;class c4 extends mC{constructor(t,e=mC.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const h4=new c4(l4),vse=h4;function rq(n,t=h4){return Pi((e,r)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const d=s;s=null,r.next(d)}};function u(){const d=o+n,m=t.now();if(m<d)return i=this.schedule(void 0,d-m),void r.add(i);a()}e.subscribe(Bn(r,d=>{s=d,o=t.now(),i||(i=t.schedule(u,n),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}let iq=(()=>{class n{create(e){return"undefined"==typeof MutationObserver?null:new MutationObserver(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),yse=(()=>{class n{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,r)=>this._cleanupObserver(r))}observe(e){const r=jf(e);return new $i(i=>{const o=this._observeElement(r).subscribe(i);return()=>{o.unsubscribe(),this._unobserveElement(r)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const r=new Qi,i=this._mutationObserverFactory.create(s=>r.next(s));i&&i.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:i,stream:r,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:r,stream:i}=this._observedElements.get(e);r&&r.disconnect(),i.complete(),this._observedElements.delete(e)}}}return n.\u0275fac=function(e){return new(e||n)(dn(iq))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),_se=(()=>{class n{constructor(e,r,i){this._contentObserver=e,this._elementRef=r,this._ngZone=i,this.event=new ho,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=Gf(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=u4(e),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(rq(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){var e;null===(e=this._currentSubscription)||void 0===e||e.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(nn(yse),nn(As),nn(Oi))},n.\u0275dir=sr({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),sq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({providers:[iq]}),n})();function Sk(n,t){return(n.getAttribute(t)||"").match(/\S+/g)||[]}const aq="cdk-describedby-message",Ek="cdk-describedby-host";let uq=0,xse=(()=>{class n{constructor(e,r){this._platform=r,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+uq++,this._document=e}describe(e,r,i){if(!this._canBeDescribed(e,r))return;const s=f4(r,i);"string"!=typeof r?(lq(r),this._messageRegistry.set(s,{messageElement:r,referenceCount:0})):this._messageRegistry.has(s)||this._createMessageElement(r,i),this._isElementDescribedByMessage(e,s)||this._addMessageReference(e,s)}removeDescription(e,r,i){var s;if(!r||!this._isElementNode(e))return;const o=f4(r,i);if(this._isElementDescribedByMessage(e,o)&&this._removeMessageReference(e,o),"string"==typeof r){const a=this._messageRegistry.get(o);a&&0===a.referenceCount&&this._deleteMessageElement(o)}0===(null===(s=this._messagesContainer)||void 0===s?void 0:s.childNodes.length)&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){var e;const r=this._document.querySelectorAll(`[${Ek}="${this._id}"]`);for(let i=0;i<r.length;i++)this._removeCdkDescribedByReferenceIds(r[i]),r[i].removeAttribute(Ek);null===(e=this._messagesContainer)||void 0===e||e.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,r){const i=this._document.createElement("div");lq(i),i.textContent=e,r&&i.setAttribute("role",r),this._createMessagesContainer(),this._messagesContainer.appendChild(i),this._messageRegistry.set(f4(e,r),{messageElement:i,referenceCount:0})}_deleteMessageElement(e){var r,i;null===(i=null===(r=this._messageRegistry.get(e))||void 0===r?void 0:r.messageElement)||void 0===i||i.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;const e="cdk-describedby-message-container",r=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let s=0;s<r.length;s++)r[s].remove();const i=this._document.createElement("div");i.style.visibility="hidden",i.classList.add(e),i.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&i.setAttribute("platform","server"),this._document.body.appendChild(i),this._messagesContainer=i}_removeCdkDescribedByReferenceIds(e){const r=Sk(e,"aria-describedby").filter(i=>0!=i.indexOf(aq));e.setAttribute("aria-describedby",r.join(" "))}_addMessageReference(e,r){const i=this._messageRegistry.get(r);(function bse(n,t,e){const r=Sk(n,t);r.some(i=>i.trim()==e.trim())||(r.push(e.trim()),n.setAttribute(t,r.join(" ")))})(e,"aria-describedby",i.messageElement.id),e.setAttribute(Ek,this._id),i.referenceCount++}_removeMessageReference(e,r){const i=this._messageRegistry.get(r);i.referenceCount--,function wse(n,t,e){const i=Sk(n,t).filter(s=>s!=e.trim());i.length?n.setAttribute(t,i.join(" ")):n.removeAttribute(t)}(e,"aria-describedby",i.messageElement.id),e.removeAttribute(Ek)}_isElementDescribedByMessage(e,r){const i=Sk(e,"aria-describedby"),s=this._messageRegistry.get(r),o=s&&s.messageElement.id;return!!o&&-1!=i.indexOf(o)}_canBeDescribed(e,r){if(!this._isElementNode(e))return!1;if(r&&"object"==typeof r)return!0;const i=null==r?"":`${r}`.trim(),s=e.getAttribute("aria-label");return!(!i||s&&s.trim()===i)}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}}return n.\u0275fac=function(e){return new(e||n)(dn(vi),dn(Da))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function f4(n,t){return"string"==typeof n?`${t||""}/${n}`:n}function lq(n){n.id||(n.id=`${aq}-${uq++}`)}function hq(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function fq(n){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const Ase=new Qn("cdk-input-modality-detector-options"),Ise={ignoreKeys:[18,17,224,91,16]},A_=Fg({passive:!0,capture:!0});let Dse=(()=>{class n{constructor(e,r,i,s){this._platform=e,this._mostRecentTarget=null,this._modality=new fk(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,u;(null===(u=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===u?void 0:u.some(d=>d===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Uc(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(hq(o)?"keyboard":"mouse"),this._mostRecentTarget=Uc(o))},this._onTouchstart=o=>{fq(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Uc(o))},this._options=Object.assign(Object.assign({},Ise),s),this.modalityDetected=this._modality.pipe(tq(1)),this.modalityChanged=this.modalityDetected.pipe(function dse(n,t=ko){return n=null!=n?n:pse,Pi((e,r)=>{let i,s=!0;e.subscribe(Bn(r,o=>{const a=t(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}()),e.isBrowser&&r.runOutsideAngular(()=>{i.addEventListener("keydown",this._onKeydown,A_),i.addEventListener("mousedown",this._onMousedown,A_),i.addEventListener("touchstart",this._onTouchstart,A_)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,A_),document.removeEventListener("mousedown",this._onMousedown,A_),document.removeEventListener("touchstart",this._onTouchstart,A_))}}return n.\u0275fac=function(e){return new(e||n)(dn(Da),dn(Oi),dn(vi),dn(Ase,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const kse=new Qn("cdk-focus-monitor-default-options"),Nk=Fg({passive:!0,capture:!0});let pq=(()=>{class n{constructor(e,r,i,s,o){this._ngZone=e,this._platform=r,this._inputModalityDetector=i,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Qi,this._rootNodeFocusAndBlurListener=a=>{const u=Uc(a),d="focus"===a.type?this._onFocus:this._onBlur;for(let m=u;m;m=m.parentElement)d.call(this,a,m)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(e,r=!1){const i=jf(e);if(!this._platform.isBrowser||1!==i.nodeType)return Uf(null);const s=function hk(n){if(function ck(){if(null==Pg){const n="undefined"!=typeof document?document.head:null;Pg=!(!n||!n.createShadowRoot&&!n.attachShadow)}return Pg}()){const t=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(i)||this._getDocument(),o=this._elementInfo.get(i);if(o)return r&&(o.checkChildren=!0),o.subject;const a={checkChildren:r,subject:new Qi,rootNode:s};return this._elementInfo.set(i,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(e){const r=jf(e),i=this._elementInfo.get(r);i&&(i.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(i))}focusVia(e,r,i){const s=jf(e);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,u])=>this._originChanged(a,r,u)):(this._setOrigin(r),"function"==typeof s.focus&&s.focus(i))}ngOnDestroy(){this._elementInfo.forEach((e,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!(null==e?void 0:e.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(e,r){e.classList.toggle("cdk-focused",!!r),e.classList.toggle("cdk-touch-focused","touch"===r),e.classList.toggle("cdk-keyboard-focused","keyboard"===r),e.classList.toggle("cdk-mouse-focused","mouse"===r),e.classList.toggle("cdk-program-focused","program"===r)}_setOrigin(e,r=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&r,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,r){const i=this._elementInfo.get(r),s=Uc(e);!i||!i.checkChildren&&r!==s||this._originChanged(r,this._getFocusOrigin(s),i)}_onBlur(e,r){const i=this._elementInfo.get(r);!i||i.checkChildren&&e.relatedTarget instanceof Node&&r.contains(e.relatedTarget)||(this._setClasses(r),this._emitOrigin(i.subject,null))}_emitOrigin(e,r){this._ngZone.run(()=>e.next(r))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const r=e.rootNode,i=this._rootNodeFocusListenerCount.get(r)||0;i||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,Nk),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,Nk)}),this._rootNodeFocusListenerCount.set(r,i+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Lu(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(e){const r=e.rootNode;if(this._rootNodeFocusListenerCount.has(r)){const i=this._rootNodeFocusListenerCount.get(r);i>1?this._rootNodeFocusListenerCount.set(r,i-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Nk),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Nk),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,r,i){this._setClasses(e,r),this._emitOrigin(i.subject,r),this._lastFocusOrigin=r}_getClosestElementsInfo(e){const r=[];return this._elementInfo.forEach((i,s)=>{(s===e||i.checkChildren&&s.contains(e))&&r.push([s,i])}),r}}return n.\u0275fac=function(e){return new(e||n)(dn(Oi),dn(Da),dn(Dse),dn(vi,8),dn(kse,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const mq="cdk-high-contrast-black-on-white",gq="cdk-high-contrast-white-on-black",d4="cdk-high-contrast-active";let vq=(()=>{class n{constructor(e,r){this._platform=e,this._document=r}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(e):null,s=(i&&i.backgroundColor||"").replace(/ /g,"");switch(e.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(d4),e.remove(mq),e.remove(gq),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?(e.add(d4),e.add(mq)):2===r&&(e.add(d4),e.add(gq))}}}return n.\u0275fac=function(e){return new(e||n)(dn(Da),dn(vi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Rse=(()=>{class n{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(e){return new(e||n)(dn(vq))},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[sq]]}),n})();class yq{}const qf="*";function _q(n,t){return{type:7,name:n,definitions:t,options:{}}}function p4(n,t=null){return{type:4,styles:t,timings:n}}function bq(n,t=null){return{type:2,steps:n,options:t}}function Rh(n){return{type:6,styles:n,offset:null}}function m4(n,t,e){return{type:0,name:n,styles:t,options:e}}function g4(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function wq(n){Promise.resolve(null).then(n)}class gC{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){wq(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class xq{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,i=0;const s=this.players.length;0==s?wq(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(i)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}const pi=!1;function Cq(n){return new jn(3e3,pi)}function moe(){return"undefined"!=typeof window&&void 0!==window.document}function y4(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function kp(n){switch(n.length){case 0:return new gC;case 1:return n[0];default:return new xq(n)}}function Sq(n,t,e,r,i={},s={}){const o=[],a=[];let u=-1,d=null;if(r.forEach(m=>{const y=m.offset,_=y==u,E=_&&d||{};Object.keys(m).forEach(D=>{let O=D,R=m[D];if("offset"!==D)switch(O=t.normalizePropertyName(O,o),R){case"!":R=i[D];break;case qf:R=s[D];break;default:R=t.normalizeStyleValue(D,O,R,o)}E[O]=R}),_||a.push(E),d=E,u=y}),o.length)throw function ioe(n){return new jn(3502,pi)}();return a}function _4(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&b4(e,"start",n)));break;case"done":n.onDone(()=>r(e&&b4(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&b4(e,"destroy",n)))}}function b4(n,t,e){const r=e.totalTime,s=w4(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,null==r?n.totalTime:r,!!e.disabled),o=n._data;return null!=o&&(s._data=o),s}function w4(n,t,e,r,i="",s=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function gl(n,t,e){let r;return n instanceof Map?(r=n.get(t),r||n.set(t,r=e)):(r=n[t],r||(r=n[t]=e)),r}function Eq(n){const t=n.indexOf(":");return[n.substring(1,t),n.substr(t+1)]}let x4=(n,t)=>!1,Nq=(n,t,e)=>[],Tq=null;function C4(n){const t=n.parentNode||n.host;return t===Tq?null:t}(y4()||"undefined"!=typeof Element)&&(moe()?(Tq=(()=>document.documentElement)(),x4=(n,t)=>{for(;t;){if(t===n)return!0;t=C4(t)}return!1}):x4=(n,t)=>n.contains(t),Nq=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let Lg=null,Aq=!1;function Iq(n){Lg||(Lg=function voe(){return"undefined"!=typeof document?document.body:null}()||{},Aq=!!Lg.style&&"WebkitAppearance"in Lg.style);let t=!0;return Lg.style&&!function goe(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Lg.style,!t&&Aq&&(t="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Lg.style)),t}const Dq=x4,Mq=Nq;let kq=(()=>{class n{validateStyleProperty(e){return Iq(e)}matchesElement(e,r){return!1}containsElement(e,r){return Dq(e,r)}getParentElement(e){return C4(e)}query(e,r,i){return Mq(e,r,i)}computeStyle(e,r,i){return i||""}animate(e,r,i,s,o,a=[],u){return new gC(i,s)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})(),S4=(()=>{class n{}return n.NOOP=new kq,n})();const E4="ng-enter",Ak="ng-leave",Ik="ng-trigger",Dk=".ng-trigger",Oq="ng-animating",N4=".ng-animating";function $g(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:T4(parseFloat(t[1]),t[2])}function T4(n,t){return"s"===t?1e3*n:n}function Mk(n,t,e){return n.hasOwnProperty("duration")?n:function boe(n,t,e){let i,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(Cq()),{duration:0,delay:0,easing:""};i=T4(parseFloat(a[1]),a[2]);const u=a[3];null!=u&&(s=T4(parseFloat(u),a[4]));const d=a[5];d&&(o=d)}else i=n;if(!e){let a=!1,u=t.length;i<0&&(t.push(function Pse(){return new jn(3100,pi)}()),a=!0),s<0&&(t.push(function Lse(){return new jn(3101,pi)}()),a=!0),a&&t.splice(u,0,Cq())}return{duration:i,delay:s,easing:o}}(n,t,e)}function I_(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function Rp(n,t,e={}){if(t)for(let r in n)e[r]=n[r];else I_(n,e);return e}function Pq(n,t,e){return e?t+":"+e+";":""}function Lq(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=Pq(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Pq(0,Coe(e),n.style[e]));n.setAttribute("style",t)}function Oh(n,t,e){n.style&&(Object.keys(t).forEach(r=>{const i=I4(r);e&&!e.hasOwnProperty(r)&&(e[r]=n.style[i]),n.style[i]=t[r]}),y4()&&Lq(n))}function Bg(n,t){n.style&&(Object.keys(t).forEach(e=>{const r=I4(e);n.style[r]=""}),y4()&&Lq(n))}function vC(n){return Array.isArray(n)?1==n.length?n[0]:bq(n):n}const A4=new RegExp("{{\\s*(.+?)\\s*}}","g");function $q(n){let t=[];if("string"==typeof n){let e;for(;e=A4.exec(n);)t.push(e[1]);A4.lastIndex=0}return t}function kk(n,t,e){const r=n.toString(),i=r.replace(A4,(s,o)=>{let a=t[o];return t.hasOwnProperty(o)||(e.push(function Bse(n){return new jn(3003,pi)}()),a=""),a.toString()});return i==r?n:i}function Rk(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const xoe=/-+([a-z0-9])/g;function I4(n){return n.replace(xoe,(...t)=>t[1].toUpperCase())}function Coe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function vl(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function Vse(n){return new jn(3004,pi)}()}}function Bq(n,t){return window.getComputedStyle(n)[t]}function Ioe(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function Doe(n,t,e){if(":"==n[0]){const u=function Moe(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function eoe(n){return new jn(3016,pi)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function Jse(n){return new jn(3015,pi)}()),t;const i=r[1],s=r[2],o=r[3];t.push(Vq(i,o));"<"==s[0]&&!("*"==i&&"*"==o)&&t.push(Vq(o,i))}(r,e,t)):e.push(n),e}const Lk=new Set(["true","1"]),$k=new Set(["false","0"]);function Vq(n,t){const e=Lk.has(n)||$k.has(n),r=Lk.has(t)||$k.has(t);return(i,s)=>{let o="*"==n||n==i,a="*"==t||t==s;return!o&&e&&"boolean"==typeof i&&(o=i?Lk.has(n):$k.has(n)),!a&&r&&"boolean"==typeof s&&(a=s?Lk.has(t):$k.has(t)),o&&a}}const koe=new RegExp("s*:selfs*,?","g");function D4(n,t,e,r){return new Roe(n).build(t,e,r)}class Roe{constructor(t){this._driver=t}build(t,e,r){const i=new Poe(e);this._resetContextStyleTimingState(i);const s=vl(this,vC(t),i);return i.unsupportedCSSPropertiesFound.size&&i.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,i=e.depCount=0;const s=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function Use(){return new jn(3006,pi)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const u=a,d=u.name;d.toString().split(/\s*,\s*/).forEach(m=>{u.name=m,s.push(this.visitState(u,e))}),u.name=d}else if(1==a.type){const u=this.visitTransition(a,e);r+=u.queryCount,i+=u.depCount,o.push(u)}else e.errors.push(function Hse(){return new jn(3007,pi)}())}),{type:7,name:t.name,states:s,transitions:o,queryCount:r,depCount:i,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),i=t.options&&t.options.params||null;if(r.containsDynamicStyles){const s=new Set,o=i||{};r.styles.forEach(a=>{if(Bk(a)){const u=a;Object.keys(u).forEach(d=>{$q(u[d]).forEach(m=>{o.hasOwnProperty(m)||s.add(m)})})}}),s.size&&(Rk(s.values()),e.errors.push(function Wse(n,t){return new jn(3008,pi)}()))}return{type:0,name:t.name,style:r,options:i?{params:i}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=vl(this,vC(t.animation),e);return{type:1,matchers:Ioe(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:Vg(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>vl(this,r,e)),options:Vg(t.options)}}visitGroup(t,e){const r=e.currentTime;let i=0;const s=t.steps.map(o=>{e.currentTime=r;const a=vl(this,o,e);return i=Math.max(i,e.currentTime),a});return e.currentTime=i,{type:3,steps:s,options:Vg(t.options)}}visitAnimate(t,e){const r=function $oe(n,t){let e=null;if(n.hasOwnProperty("duration"))e=n;else if("number"==typeof n)return M4(Mk(n,t).duration,0,"");const r=n;if(r.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=M4(0,0,"");return s.dynamic=!0,s.strValue=r,s}return e=e||Mk(r,t),M4(e.duration,e.delay,e.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let i,s=t.styles?t.styles:Rh({});if(5==s.type)i=this.visitKeyframes(s,e);else{let o=t.styles,a=!1;if(!o){a=!0;const d={};r.easing&&(d.easing=r.easing),o=Rh(d)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=a,i=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[];Array.isArray(t.styles)?t.styles.forEach(o=>{"string"==typeof o?o==qf?r.push(o):e.errors.push(function Gse(n){return new jn(3002,pi)}()):r.push(o)}):r.push(t.styles);let i=!1,s=null;return r.forEach(o=>{if(Bk(o)){const a=o,u=a.easing;if(u&&(s=u,delete a.easing),!i)for(let d in a)if(a[d].toString().indexOf("{{")>=0){i=!0;break}}}),{type:6,styles:r,easing:s,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let i=e.currentTime,s=e.currentTime;r&&s>0&&(s-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void e.unsupportedCSSPropertiesFound.add(a);const u=e.collectedStyles[e.currentQuerySelector],d=u[a];let m=!0;d&&(s!=i&&s>=d.startTime&&i<=d.endTime&&(e.errors.push(function jse(n,t,e,r,i){return new jn(3010,pi)}()),m=!1),s=d.startTime),m&&(u[a]={startTime:s,endTime:i}),e.options&&function woe(n,t,e){const r=t.params||{},i=$q(n);i.length&&i.forEach(s=>{r.hasOwnProperty(s)||e.push(function $se(n){return new jn(3001,pi)}())})}(o[a],e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function qse(){return new jn(3011,pi)}()),r;let s=0;const o=[];let a=!1,u=!1,d=0;const m=t.steps.map($=>{const B=this._makeStyleAst($,e);let Q=null!=B.offset?B.offset:function Loe(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(Bk(e)&&e.hasOwnProperty("offset")){const r=e;t=parseFloat(r.offset),delete r.offset}});else if(Bk(n)&&n.hasOwnProperty("offset")){const e=n;t=parseFloat(e.offset),delete e.offset}return t}(B.styles),ie=0;return null!=Q&&(s++,ie=B.offset=Q),u=u||ie<0||ie>1,a=a||ie<d,d=ie,o.push(ie),B});u&&e.errors.push(function Zse(){return new jn(3012,pi)}()),a&&e.errors.push(function Kse(){return new jn(3200,pi)}());const y=t.steps.length;let _=0;s>0&&s<y?e.errors.push(function Xse(){return new jn(3202,pi)}()):0==s&&(_=1/(y-1));const E=y-1,D=e.currentTime,O=e.currentAnimateTimings,R=O.duration;return m.forEach(($,B)=>{const Q=_>0?B==E?1:_*B:o[B],ie=Q*R;e.currentTime=D+O.delay+ie,O.duration=ie,this._validateStyleAst($,e),$.offset=Q,r.styles.push($)}),r}visitReference(t,e){return{type:8,animation:vl(this,vC(t.animation),e),options:Vg(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Vg(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Vg(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,i=t.options||{};e.queryCount++,e.currentQuery=t;const[s,o]=function Ooe(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(koe,"")),n=n.replace(/@\*/g,Dk).replace(/@\w+/g,e=>Dk+"-"+e.substr(1)).replace(/:animating/g,N4),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+s:s,gl(e.collectedStyles,e.currentQuerySelector,{});const a=vl(this,vC(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:t.selector,options:Vg(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function Yse(){return new jn(3013,pi)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:Mk(t.timings,e.errors,!0);return{type:12,animation:vl(this,vC(t.animation),e),timings:r,options:null}}}class Poe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Bk(n){return!Array.isArray(n)&&"object"==typeof n}function Vg(n){return n?(n=I_(n)).params&&(n.params=function Foe(n){return n?I_(n):null}(n.params)):n={},n}function M4(n,t,e){return{duration:n,delay:t,easing:e}}function k4(n,t,e,r,i,s,o=null,a=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class Vk{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const zoe=new RegExp(":enter","g"),Hoe=new RegExp(":leave","g");function R4(n,t,e,r,i,s={},o={},a,u,d=[]){return(new Woe).buildKeyframes(n,t,e,r,i,s,o,a,u,d)}class Woe{buildKeyframes(t,e,r,i,s,o,a,u,d,m=[]){d=d||new Vk;const y=new O4(t,e,d,i,s,m,[]);y.options=u,y.currentTimeline.setStyles([o],null,y.errors,u),vl(this,r,y);const _=y.timelines.filter(E=>E.containsAnimation());if(Object.keys(a).length){let E;for(let D=_.length-1;D>=0;D--){const O=_[D];if(O.element===e){E=O;break}}E&&!E.allowOnlyTimelineStyles()&&E.setStyles([a],null,y.errors,u)}return _.length?_.map(E=>E.buildKeyframes()):[k4(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const i=e.createSubContext(t.options),s=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,i,i.options);s!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,r){let s=e.currentTimeline.currentTime;const o=null!=r.duration?$g(r.duration):null,a=null!=r.delay?$g(r.delay):null;return 0!==o&&t.forEach(u=>{const d=e.appendInstructionToTimeline(u,o,a);s=Math.max(s,d.duration+d.delay)}),s}visitReference(t,e){e.updateOptions(t.options,!0),vl(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let i=e;const s=t.options;if(s&&(s.params||s.delay)&&(i=e.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=zk);const o=$g(s.delay);i.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>vl(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let i=e.currentTimeline.currentTime;const s=t.options&&t.options.delay?$g(t.options.delay):0;t.steps.forEach(o=>{const a=e.createSubContext(t.options);s&&a.delayNextStep(s),vl(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(i),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return Mk(e.params?kk(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),i=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),i.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(r.duration),this.visitStyle(s,e),i.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,i=e.currentAnimateTimings;!i&&r.getCurrentStyleProperties().length&&r.forwardFrame();const s=i&&i.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(s):r.setStyles(t.styles,s,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,i=e.currentTimeline.duration,s=r.duration,a=e.createSubContext().currentTimeline;a.easing=r.easing,t.styles.forEach(u=>{a.forwardTime((u.offset||0)*s),a.setStyles(u.styles,u.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(i+s),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,i=t.options||{},s=i.delay?$g(i.delay):0;s&&(6===e.previousNode.type||0==r&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=zk);let o=r;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!i.optional,e.errors);e.currentQueryTotal=a.length;let u=null;a.forEach((d,m)=>{e.currentQueryIndex=m;const y=e.createSubContext(t.options,d);s&&y.delayNextStep(s),d===e.element&&(u=y.currentTimeline),vl(this,t.animation,y),y.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,y.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,i=e.currentTimeline,s=t.timings,o=Math.abs(s.duration),a=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":u=a-u;break;case"full":u=r.currentStaggerTime}const m=e.currentTimeline;u&&m.delayNextStep(u);const y=m.currentTime;vl(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=i.currentTime-y+(i.startTime-r.currentTimeline.startTime)}}const zk={};class O4{constructor(t,e,r,i,s,o,a,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=zk,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new Uk(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let i=this.options;null!=r.duration&&(i.duration=$g(r.duration)),null!=r.delay&&(i.delay=$g(r.delay));const s=r.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!e||!o.hasOwnProperty(a))&&(o[a]=kk(s[a],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(i=>{r[i]=e[i]})}}return t}createSubContext(t=null,e,r){const i=e||this.element,s=new O4(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=zk,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const i={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=r?r:0)+t.delay,easing:""},s=new Goe(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,i,t.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,i,s,o){let a=[];if(i&&a.push(this.element),t.length>0){t=(t=t.replace(zoe,"."+this._enterClassName)).replace(Hoe,"."+this._leaveClassName);let d=this._driver.query(this.element,t,1!=r);0!==r&&(d=r<0?d.slice(d.length+r,d.length):d.slice(0,r)),a.push(...d)}return!s&&0==a.length&&o.push(function Qse(n){return new jn(3014,pi)}()),a}}class Uk{constructor(t,e,r,i){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Uk(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||qf,this._currentKeyframe[e]=qf}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,i){e&&(this._previousKeyframe.easing=e);const s=i&&i.params||{},o=function joe(n,t){const e={};let r;return n.forEach(i=>{"*"===i?(r=r||Object.keys(t),r.forEach(s=>{e[s]=qf})):Rp(i,!1,e)}),e}(t,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const u=kk(o[a],s,r);this._pendingStyles[a]=u,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:qf),this._updateStyle(a,u)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(r=>{this._currentKeyframe[r]=t[r]}),Object.keys(this._localTimelineStyles).forEach(r=>{this._currentKeyframe.hasOwnProperty(r)||(this._currentKeyframe[r]=this._localTimelineStyles[r])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const r=this._styleSummary[e],i=t._styleSummary[e];(!r||i.time>r.time)&&this._updateStyle(e,i.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,u)=>{const d=Rp(a,!0);Object.keys(d).forEach(m=>{const y=d[m];"!"==y?t.add(m):y==qf&&e.add(m)}),r||(d.offset=u/this.duration),i.push(d)});const s=t.size?Rk(t.values()):[],o=e.size?Rk(e.values()):[];if(r){const a=i[0],u=I_(a);a.offset=0,u.offset=1,i=[a,u]}return k4(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class Goe extends Uk{constructor(t,e,r,i,s,o,a=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],o=r+e,a=e/o,u=Rp(t[0],!1);u.offset=0,s.push(u);const d=Rp(t[0],!1);d.offset=Hq(a),s.push(d);const m=t.length-1;for(let y=1;y<=m;y++){let _=Rp(t[y],!1);_.offset=Hq((e+_.offset*r)/o),s.push(_)}r=o,e=0,i="",t=s}return k4(this.element,t,this.preStyleProps,this.postStyleProps,r,e,i,!0)}}function Hq(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class F4{}class qoe extends F4{normalizePropertyName(t,e){return I4(t)}normalizeStyleValue(t,e,r,i){let s="";const o=r.toString().trim();if(Zoe[e]&&0!==r&&"0"!==r)if("number"==typeof r)s="px";else{const a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function zse(n,t){return new jn(3005,pi)}())}return o+s}}const Zoe=(()=>function Koe(n){const t={};return n.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Wq(n,t,e,r,i,s,o,a,u,d,m,y,_){return{type:0,element:n,triggerName:t,isRemovalTransition:i,fromState:e,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:u,preStyleProps:d,postStyleProps:m,totalTime:y,errors:_}}const P4={};class Gq{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,i){return function Xoe(n,t,e,r,i){return n.some(s=>s(t,e,r,i))}(this.ast.matchers,t,e,r,i)}buildStyles(t,e,r){const i=this._stateStyles["*"],s=this._stateStyles[t],o=i?i.buildStyles(e,r):{};return s?s.buildStyles(e,r):o}build(t,e,r,i,s,o,a,u,d,m){const y=[],_=this.ast.options&&this.ast.options.params||P4,D=this.buildStyles(r,a&&a.params||P4,y),O=u&&u.params||P4,R=this.buildStyles(i,O,y),$=new Set,B=new Map,Q=new Map,ie="void"===i,ye={params:Object.assign(Object.assign({},_),O)},Me=m?[]:R4(t,e,this.ast.animation,s,o,D,R,ye,d,y);let Be=0;if(Me.forEach(st=>{Be=Math.max(st.duration+st.delay,Be)}),y.length)return Wq(e,this._triggerName,r,i,ie,D,R,[],[],B,Q,Be,y);Me.forEach(st=>{const lt=st.element,It=gl(B,lt,{});st.preStyleProps.forEach(Wt=>It[Wt]=!0);const zt=gl(Q,lt,{});st.postStyleProps.forEach(Wt=>zt[Wt]=!0),lt!==e&&$.add(lt)});const He=Rk($.values());return Wq(e,this._triggerName,r,i,ie,D,R,Me,He,B,Q,Be)}}class Yoe{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r={},i=I_(this.defaultParams);return Object.keys(t).forEach(s=>{const o=t[s];null!=o&&(i[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let u=o[a];u.length>1&&(u=kk(u,i,e));const d=this.normalizer.normalizePropertyName(a,e);u=this.normalizer.normalizeStyleValue(a,d,u,e),r[d]=u})}}),r}}class Joe{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states={},e.states.forEach(i=>{this.states[i.name]=new Yoe(i.style,i.options&&i.options.params||{},r)}),jq(this.states,"true","1"),jq(this.states,"false","0"),e.transitions.forEach(i=>{this.transitionFactories.push(new Gq(t,i,this.states))}),this.fallbackTransition=function eae(n,t,e){return new Gq(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,i){return this.transitionFactories.find(o=>o.match(t,e,r,i))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function jq(n,t,e){n.hasOwnProperty(t)?n.hasOwnProperty(e)||(n[e]=n[t]):n.hasOwnProperty(e)&&(n[t]=n[e])}const tae=new Vk;class nae{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}register(t,e){const r=[],s=D4(this._driver,e,r,[]);if(r.length)throw function soe(n){return new jn(3503,pi)}();this._animations[t]=s}_buildPlayer(t,e,r){const i=t.element,s=Sq(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(i,s,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const i=[],s=this._animations[t];let o;const a=new Map;if(s?(o=R4(this._driver,e,s,E4,Ak,{},{},r,tae,i),o.forEach(m=>{const y=gl(a,m.element,{});m.postStyleProps.forEach(_=>y[_]=null)})):(i.push(function ooe(){return new jn(3300,pi)}()),o=[]),i.length)throw function aoe(n){return new jn(3504,pi)}();a.forEach((m,y)=>{Object.keys(m).forEach(_=>{m[_]=this._driver.computeStyle(y,_,qf)})});const d=kp(o.map(m=>{const y=a.get(m.element);return this._buildPlayer(m,{},y)}));return this._playersById[t]=d,d.onDestroy(()=>this.destroy(t)),this.players.push(d),d}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw function uoe(n){return new jn(3301,pi)}();return e}listen(t,e,r,i){const s=w4(e,"","","");return _4(this._getPlayer(t),r,s,i),()=>{}}command(t,e,r,i){if("register"==r)return void this.register(t,i[0]);if("create"==r)return void this.create(t,e,i[0]||{});const s=this._getPlayer(t);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(t)}}}const qq="ng-animate-queued",L4="ng-animate-disabled",aae=[],Zq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},uae={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},oc="__ng_removed";class $4{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function fae(n){return null!=n?n:null}(r?t.value:t),r){const s=I_(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(i=>{null==r[i]&&(r[i]=e[i])})}}}const yC="void",B4=new $4(yC);class lae{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,ac(e,this._hostClassName)}listen(t,e,r,i){if(!this._triggers.hasOwnProperty(e))throw function loe(n,t){return new jn(3302,pi)}();if(null==r||0==r.length)throw function coe(n){return new jn(3303,pi)}();if(!function dae(n){return"start"==n||"done"==n}(r))throw function hoe(n,t){return new jn(3400,pi)}();const s=gl(this._elementListeners,t,[]),o={name:e,phase:r,callback:i};s.push(o);const a=gl(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(ac(t,Ik),ac(t,Ik+"-"+e),a[e]=B4),()=>{this._engine.afterFlush(()=>{const u=s.indexOf(o);u>=0&&s.splice(u,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw function foe(n){return new jn(3401,pi)}();return e}trigger(t,e,r,i=!0){const s=this._getTrigger(e),o=new V4(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(ac(t,Ik),ac(t,Ik+"-"+e),this._engine.statesByElement.set(t,a={}));let u=a[e];const d=new $4(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&d.absorbOptions(u.options),a[e]=d,u||(u=B4),d.value!==yC&&u.value===d.value){if(!function gae(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let i=0;i<e.length;i++){const s=e[i];if(!t.hasOwnProperty(s)||n[s]!==t[s])return!1}return!0}(u.params,d.params)){const O=[],R=s.matchStyles(u.value,u.params,O),$=s.matchStyles(d.value,d.params,O);O.length?this._engine.reportError(O):this._engine.afterFlush(()=>{Bg(t,R),Oh(t,$)})}return}const _=gl(this._engine.playersByElement,t,[]);_.forEach(O=>{O.namespaceId==this.id&&O.triggerName==e&&O.queued&&O.destroy()});let E=s.matchTransition(u.value,d.value,t,d.params),D=!1;if(!E){if(!i)return;E=s.fallbackTransition,D=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:E,fromState:u,toState:d,player:o,isFallbackTransition:D}),D||(ac(t,qq),o.onStart(()=>{D_(t,qq)})),o.onDone(()=>{let O=this.players.indexOf(o);O>=0&&this.players.splice(O,1);const R=this._engine.playersByElement.get(t);if(R){let $=R.indexOf(o);$>=0&&R.splice($,1)}}),this.players.push(o),_.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,r)=>{delete e[t]}),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(i=>i.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,Dk,!0);r.forEach(i=>{if(i[oc])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,e,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(t,e,r,i){const s=this._engine.statesByElement.get(t),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(u=>{if(o.set(u,s[u].value),this._triggers[u]){const d=this.trigger(t,u,yC,i);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&kp(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const i=new Set;e.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const u=this._triggers[o].fallbackTransition,d=r[o]||B4,m=new $4(yC),y=new V4(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:d,toState:m,player:y,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let i=!1;if(r.totalAnimations){const s=r.players.length?r.playersByQueriedElement.get(t):[];if(s&&s.length)i=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(t),i)r.markElementAsRemoved(this.id,t,!1,e);else{const s=t[oc];(!s||s===Zq)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){ac(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const s=r.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==r.triggerName){const u=w4(s,r.triggerName,r.fromState.value,r.toState.value);u._data=t,_4(r.player,a.phase,u,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):e.push(r)}),this._queue=[],e.sort((r,i)=>{const s=r.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class cae{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new lae(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,i=this.namespacesByHostElement,s=r.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(e);for(;a;){const u=i.get(a);if(u){const d=r.indexOf(u);r.splice(d+1,0,t),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(r[a].hostElement,e)){r.splice(a+1,0,t),o=!0;break}o||r.unshift(t)}else r.push(t);return i.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let i=this._namespaceLookup[t];i&&i.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r){const i=Object.keys(r);for(let s=0;s<i.length;s++){const o=r[i[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&e.add(a)}}}return e}trigger(t,e,r,i){if(Hk(e)){const s=this._fetchNamespace(t);if(s)return s.trigger(e,r,i),!0}return!1}insertNode(t,e,r,i){if(!Hk(e))return;const s=e[oc];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}i&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),ac(t,L4)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),D_(t,L4))}removeNode(t,e,r,i){if(Hk(e)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(e,i):this.markElementAsRemoved(t,e,!1,i),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,i)}}else this._onRemovalComplete(e,i)}markElementAsRemoved(t,e,r,i,s){this.collectedLeaveElements.push(e),e[oc]={namespaceId:t,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,e,r,i,s){return Hk(e)?this._fetchNamespace(t).listen(e,r,i,s):()=>{}}_buildInstruction(t,e,r,i,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,i,t.fromState.options,t.toState.options,e,s)}destroyInnerAnimations(t){let e=this.driver.query(t,Dk,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,N4,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return kp(this.players).onDone(()=>t());t()})}processLeaveNode(t){var e;const r=t[oc];if(r&&r.setForRemoval){if(t[oc]=Zq,r.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(r.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,r.setForRemoval)}(null===(e=t.classList)||void 0===e?void 0:e.contains(L4))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)ac(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?kp(e).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(t){throw function doe(n){return new jn(3402,pi)}()}_flushAnimations(t,e){const r=new Vk,i=[],s=new Map,o=[],a=new Map,u=new Map,d=new Map,m=new Set;this.disabledNodes.forEach(Tt=>{m.add(Tt);const Rt=this.driver.query(Tt,".ng-animate-queued",!0);for(let Dt=0;Dt<Rt.length;Dt++)m.add(Rt[Dt])});const y=this.bodyNode,_=Array.from(this.statesByElement.keys()),E=Yq(_,this.collectedEnterElements),D=new Map;let O=0;E.forEach((Tt,Rt)=>{const Dt=E4+O++;D.set(Rt,Dt),Tt.forEach(Ht=>ac(Ht,Dt))});const R=[],$=new Set,B=new Set;for(let Tt=0;Tt<this.collectedLeaveElements.length;Tt++){const Rt=this.collectedLeaveElements[Tt],Dt=Rt[oc];Dt&&Dt.setForRemoval&&(R.push(Rt),$.add(Rt),Dt.hasAnimation?this.driver.query(Rt,".ng-star-inserted",!0).forEach(Ht=>$.add(Ht)):B.add(Rt))}const Q=new Map,ie=Yq(_,Array.from($));ie.forEach((Tt,Rt)=>{const Dt=Ak+O++;Q.set(Rt,Dt),Tt.forEach(Ht=>ac(Ht,Dt))}),t.push(()=>{E.forEach((Tt,Rt)=>{const Dt=D.get(Rt);Tt.forEach(Ht=>D_(Ht,Dt))}),ie.forEach((Tt,Rt)=>{const Dt=Q.get(Rt);Tt.forEach(Ht=>D_(Ht,Dt))}),R.forEach(Tt=>{this.processLeaveNode(Tt)})});const ye=[],Me=[];for(let Tt=this._namespaceList.length-1;Tt>=0;Tt--)this._namespaceList[Tt].drainQueuedTransitions(e).forEach(Dt=>{const Ht=Dt.player,ln=Dt.element;if(ye.push(Ht),this.collectedEnterElements.length){const Un=ln[oc];if(Un&&Un.setForMove){if(Un.previousTriggersValues&&Un.previousTriggersValues.has(Dt.triggerName)){const lr=Un.previousTriggersValues.get(Dt.triggerName),ir=this.statesByElement.get(Dt.element);ir&&ir[Dt.triggerName]&&(ir[Dt.triggerName].value=lr)}return void Ht.destroy()}}const vn=!y||!this.driver.containsElement(y,ln),An=Q.get(ln),Tn=D.get(ln),In=this._buildInstruction(Dt,r,Tn,An,vn);if(In.errors&&In.errors.length)return void Me.push(In);if(vn)return Ht.onStart(()=>Bg(ln,In.fromStyles)),Ht.onDestroy(()=>Oh(ln,In.toStyles)),void i.push(Ht);if(Dt.isFallbackTransition)return Ht.onStart(()=>Bg(ln,In.fromStyles)),Ht.onDestroy(()=>Oh(ln,In.toStyles)),void i.push(Ht);const kn=[];In.timelines.forEach(Un=>{Un.stretchStartingKeyframe=!0,this.disabledNodes.has(Un.element)||kn.push(Un)}),In.timelines=kn,r.append(ln,In.timelines),o.push({instruction:In,player:Ht,element:ln}),In.queriedElements.forEach(Un=>gl(a,Un,[]).push(Ht)),In.preStyleProps.forEach((Un,lr)=>{const ir=Object.keys(Un);if(ir.length){let Cr=u.get(lr);Cr||u.set(lr,Cr=new Set),ir.forEach($r=>Cr.add($r))}}),In.postStyleProps.forEach((Un,lr)=>{const ir=Object.keys(Un);let Cr=d.get(lr);Cr||d.set(lr,Cr=new Set),ir.forEach($r=>Cr.add($r))})});if(Me.length){const Tt=[];Me.forEach(Rt=>{Tt.push(function poe(n,t){return new jn(3505,pi)}())}),ye.forEach(Rt=>Rt.destroy()),this.reportError(Tt)}const Be=new Map,He=new Map;o.forEach(Tt=>{const Rt=Tt.element;r.has(Rt)&&(He.set(Rt,Rt),this._beforeAnimationBuild(Tt.player.namespaceId,Tt.instruction,Be))}),i.forEach(Tt=>{const Rt=Tt.element;this._getPreviousPlayers(Rt,!1,Tt.namespaceId,Tt.triggerName,null).forEach(Ht=>{gl(Be,Rt,[]).push(Ht),Ht.destroy()})});const st=R.filter(Tt=>Jq(Tt,u,d)),lt=new Map;Xq(lt,this.driver,B,d,qf).forEach(Tt=>{Jq(Tt,u,d)&&st.push(Tt)});const zt=new Map;E.forEach((Tt,Rt)=>{Xq(zt,this.driver,new Set(Tt),u,"!")}),st.forEach(Tt=>{const Rt=lt.get(Tt),Dt=zt.get(Tt);lt.set(Tt,Object.assign(Object.assign({},Rt),Dt))});const Wt=[],qt=[],Kt={};o.forEach(Tt=>{const{element:Rt,player:Dt,instruction:Ht}=Tt;if(r.has(Rt)){if(m.has(Rt))return Dt.onDestroy(()=>Oh(Rt,Ht.toStyles)),Dt.disabled=!0,Dt.overrideTotalTime(Ht.totalTime),void i.push(Dt);let ln=Kt;if(He.size>1){let An=Rt;const Tn=[];for(;An=An.parentNode;){const In=He.get(An);if(In){ln=In;break}Tn.push(An)}Tn.forEach(In=>He.set(In,ln))}const vn=this._buildAnimation(Dt.namespaceId,Ht,Be,s,zt,lt);if(Dt.setRealPlayer(vn),ln===Kt)Wt.push(Dt);else{const An=this.playersByElement.get(ln);An&&An.length&&(Dt.parentPlayer=kp(An)),i.push(Dt)}}else Bg(Rt,Ht.fromStyles),Dt.onDestroy(()=>Oh(Rt,Ht.toStyles)),qt.push(Dt),m.has(Rt)&&i.push(Dt)}),qt.forEach(Tt=>{const Rt=s.get(Tt.element);if(Rt&&Rt.length){const Dt=kp(Rt);Tt.setRealPlayer(Dt)}}),i.forEach(Tt=>{Tt.parentPlayer?Tt.syncPlayerEvents(Tt.parentPlayer):Tt.destroy()});for(let Tt=0;Tt<R.length;Tt++){const Rt=R[Tt],Dt=Rt[oc];if(D_(Rt,Ak),Dt&&Dt.hasAnimation)continue;let Ht=[];if(a.size){let vn=a.get(Rt);vn&&vn.length&&Ht.push(...vn);let An=this.driver.query(Rt,N4,!0);for(let Tn=0;Tn<An.length;Tn++){let In=a.get(An[Tn]);In&&In.length&&Ht.push(...In)}}const ln=Ht.filter(vn=>!vn.destroyed);ln.length?pae(this,Rt,ln):this.processLeaveNode(Rt)}return R.length=0,Wt.forEach(Tt=>{this.players.push(Tt),Tt.onDone(()=>{Tt.destroy();const Rt=this.players.indexOf(Tt);this.players.splice(Rt,1)}),Tt.play()}),Wt}elementContainsData(t,e){let r=!1;const i=e[oc];return i&&i.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,i,s){let o=[];if(e){const a=this.playersByQueriedElement.get(t);a&&(o=a)}else{const a=this.playersByElement.get(t);if(a){const u=!s||s==yC;a.forEach(d=>{d.queued||!u&&d.triggerName!=i||o.push(d)})}}return(r||i)&&(o=o.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(t,e,r){const s=e.element,o=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const d=u.element,m=d!==s,y=gl(r,d,[]);this._getPreviousPlayers(d,m,o,a,e.toState).forEach(E=>{const D=E.getRealPlayer();D.beforeDestroy&&D.beforeDestroy(),E.destroy(),y.push(E)})}Bg(s,e.fromStyles)}_buildAnimation(t,e,r,i,s,o){const a=e.triggerName,u=e.element,d=[],m=new Set,y=new Set,_=e.timelines.map(D=>{const O=D.element;m.add(O);const R=O[oc];if(R&&R.removedBeforeQueried)return new gC(D.duration,D.delay);const $=O!==u,B=function mae(n){const t=[];return Qq(n,t),t}((r.get(O)||aae).map(Be=>Be.getRealPlayer())).filter(Be=>!!Be.element&&Be.element===O),Q=s.get(O),ie=o.get(O),ye=Sq(0,this._normalizer,0,D.keyframes,Q,ie),Me=this._buildPlayer(D,ye,B);if(D.subTimeline&&i&&y.add(O),$){const Be=new V4(t,a,O);Be.setRealPlayer(Me),d.push(Be)}return Me});d.forEach(D=>{gl(this.playersByQueriedElement,D.element,[]).push(D),D.onDone(()=>function hae(n,t,e){let r;if(n instanceof Map){if(r=n.get(t),r){if(r.length){const i=r.indexOf(e);r.splice(i,1)}0==r.length&&n.delete(t)}}else if(r=n[t],r){if(r.length){const i=r.indexOf(e);r.splice(i,1)}0==r.length&&delete n[t]}return r}(this.playersByQueriedElement,D.element,D))}),m.forEach(D=>ac(D,Oq));const E=kp(_);return E.onDestroy(()=>{m.forEach(D=>D_(D,Oq)),Oh(u,e.toStyles)}),y.forEach(D=>{gl(i,D,[]).push(E)}),E}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new gC(t.duration,t.delay)}}class V4{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new gC,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(r=>_4(t,e,void 0,r))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){gl(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Hk(n){return n&&1===n.nodeType}function Kq(n,t){const e=n.style.display;return n.style.display=null!=t?t:"none",e}function Xq(n,t,e,r,i){const s=[];e.forEach(u=>s.push(Kq(u)));const o=[];r.forEach((u,d)=>{const m={};u.forEach(y=>{const _=m[y]=t.computeStyle(d,y,i);(!_||0==_.length)&&(d[oc]=uae,o.push(d))}),n.set(d,m)});let a=0;return e.forEach(u=>Kq(u,s[a++])),o}function Yq(n,t){const e=new Map;if(n.forEach(a=>e.set(a,[])),0==t.length)return e;const i=new Set(t),s=new Map;function o(a){if(!a)return 1;let u=s.get(a);if(u)return u;const d=a.parentNode;return u=e.has(d)?d:i.has(d)?1:o(d),s.set(a,u),u}return t.forEach(a=>{const u=o(a);1!==u&&e.get(u).push(a)}),e}function ac(n,t){var e;null===(e=n.classList)||void 0===e||e.add(t)}function D_(n,t){var e;null===(e=n.classList)||void 0===e||e.remove(t)}function pae(n,t,e){kp(e).onDone(()=>n.processLeaveNode(t))}function Qq(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof xq?Qq(r.players,t):t.push(r)}}function Jq(n,t,e){const r=e.get(n);if(!r)return!1;let i=t.get(n);return i?r.forEach(s=>i.add(s)):t.set(n,r),e.delete(n),!0}class Wk{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new cae(t,e,r),this._timelineEngine=new nae(t,e,r),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(t,e,r,i,s){const o=t+"-"+i;let a=this._triggerCache[o];if(!a){const u=[],m=D4(this._driver,s,u,[]);if(u.length)throw function roe(n,t){return new jn(3404,pi)}();a=function Qoe(n,t,e){return new Joe(n,t,e)}(i,m,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(e,i,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,i){this._transitionEngine.insertNode(t,e,r,i)}onRemove(t,e,r,i){this._transitionEngine.removeNode(t,e,i||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,i){if("@"==r.charAt(0)){const[s,o]=Eq(r);this._timelineEngine.command(s,e,o,i)}else this._transitionEngine.trigger(t,e,r,i)}listen(t,e,r,i,s){if("@"==r.charAt(0)){const[o,a]=Eq(r);return this._timelineEngine.listen(o,e,a,s)}return this._transitionEngine.listen(t,e,r,i,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let yae=(()=>{class n{constructor(e,r,i){this._element=e,this._startStyles=r,this._endStyles=i,this._state=0;let s=n.initialStylesByElement.get(e);s||n.initialStylesByElement.set(e,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Oh(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Oh(this._element,this._initialStyles),this._endStyles&&(Oh(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Bg(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Bg(this._element,this._endStyles),this._endStyles=null),Oh(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function z4(n){let t=null;const e=Object.keys(n);for(let r=0;r<e.length;r++){const i=e[r];_ae(i)&&(t=t||{},t[i]=n[i])}return t}function _ae(n){return"display"===n||"position"===n}class e7{constructor(t,e,r,i){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,r){return t.animate(e,r)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(r=>{"offset"!=r&&(t[r]=this._finished?e[r]:Bq(this.element,r))})}this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class bae{validateStyleProperty(t){return Iq(t)}matchesElement(t,e){return!1}containsElement(t,e){return Dq(t,e)}getParentElement(t){return C4(t)}query(t,e,r){return Mq(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,i,s,o=[]){const u={duration:r,delay:i,fill:0==i?"both":"forwards"};s&&(u.easing=s);const d={},m=o.filter(_=>_ instanceof e7);(function Soe(n,t){return 0===n||0===t})(r,i)&&m.forEach(_=>{let E=_.currentSnapshot;Object.keys(E).forEach(D=>d[D]=E[D])}),e=function Eoe(n,t,e){const r=Object.keys(e);if(r.length&&t.length){let s=t[0],o=[];if(r.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=e[a]}),o.length)for(var i=1;i<t.length;i++){let a=t[i];o.forEach(function(u){a[u]=Bq(n,u)})}}return t}(t,e=e.map(_=>Rp(_,!1)),d);const y=function vae(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=z4(t[0]),t.length>1&&(r=z4(t[t.length-1]))):t&&(e=z4(t)),e||r?new yae(n,e,r):null}(t,e);return new e7(t,e,u,y)}}let wae=(()=>{class n extends yq{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Co.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(e)?bq(e):e;return t7(this._renderer,null,r,"register",[i]),new xae(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(dn(_g),dn(vi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();class xae extends class Ose{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new Cae(this._id,t,e||{},this._renderer)}}class Cae{constructor(t,e,r,i){this.id=t,this.element=e,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return t7(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function t7(n,t,e,r,i){return n.setProperty(t,`@@${e}:${r}`,i)}const n7="@.disabled";let Sae=(()=>{class n{constructor(e,r,i){this.delegate=e,this.engine=r,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(e,r){const s=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let m=this._rendererCache.get(s);return m||(m=new r7("",s,this.engine),this._rendererCache.set(s,m)),m}const o=r.id,a=r.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const u=m=>{Array.isArray(m)?m.forEach(u):this.engine.registerTrigger(o,a,e,m.name,m)};return r.data.animation.forEach(u),new Eae(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,i){e>=0&&e<this._microtaskId?this._zone.run(()=>r(i)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(dn(_g),dn(Wk),dn(Oi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();class r7{constructor(t,e,r){this.namespaceId=t,this.delegate=e,this.engine=r,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,i=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,i)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,i){this.delegate.setAttribute(t,e,r,i)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,i){this.delegate.setStyle(t,e,r,i)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==n7?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class Eae extends r7{constructor(t,e,r,i){super(e,r,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==n7?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.substr(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const i=function Nae(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let s=e.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Tae(n){const t=n.indexOf(".");return[n.substring(0,t),n.substr(t+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,r,a)})}return this.delegate.listen(t,e,r)}}let Aae=(()=>{class n extends Wk{constructor(e,r,i){super(e.body,r,i)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(dn(vi),dn(S4),dn(F4))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();const zg=new Qn("AnimationModuleType"),i7=[{provide:yq,useClass:wae},{provide:F4,useFactory:function Iae(){return new qoe}},{provide:Wk,useClass:Aae},{provide:_g,useFactory:function Dae(n,t,e){return new Sae(n,t,e)},deps:[Mp,Wk,Oi]}],s7=[{provide:S4,useFactory:()=>new bae},{provide:zg,useValue:"BrowserAnimations"},...i7],Mae=[{provide:S4,useClass:kq},{provide:zg,useValue:"NoopAnimations"},...i7];let kae=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?Mae:s7}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({providers:s7,imports:[Fz]}),n})();const Oae=new Qn("mat-sanity-checks",{providedIn:"root",factory:function Rae(){return!0}});let Hc=(()=>{class n{constructor(e,r,i){this._sanityChecks=r,this._document=i,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!hC()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return n.\u0275fac=function(e){return new(e||n)(dn(vq),dn(Oae,8),dn(vi))},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[Dh],Dh]}),n})();function Fae(n){return class extends n{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=Gf(t)}}}function U4(n,t){return class extends n{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const r=e||this.defaultColor;r!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),r&&this._elementRef.nativeElement.classList.add(`mat-${r}`),this._color=r)}}}function Pae(n){return class extends n{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Gf(t)}}}function Lae(n){return class extends n{constructor(...t){super(...t),this.stateChanges=new Qi,this.errorState=!1}updateErrorState(){const t=this.errorState,s=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);s!==t&&(this.errorState=s,this.stateChanges.next())}}}let a7=(()=>{class n{isErrorState(e,r){return!!(e&&e.invalid&&(e.touched||r&&r.submitted))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Bae{constructor(t,e,r){this._renderer=t,this.element=e,this.config=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const u7={enterDuration:225,exitDuration:150},H4=Fg({passive:!0}),l7=["mousedown","touchstart"],c7=["mouseup","mouseleave","touchend","touchcancel"];class zae{constructor(t,e,r,i){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=jf(r))}fadeInRipple(t,e,r={}){const i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},u7),r.animation);r.centered&&(t=i.left+i.width/2,e=i.top+i.height/2);const o=r.radius||function Hae(n,t,e){const r=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),i=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(r*r+i*i)}(t,e,i),a=t-i.left,u=e-i.top,d=s.enterDuration,m=document.createElement("div");m.classList.add("mat-ripple-element"),m.style.left=a-o+"px",m.style.top=u-o+"px",m.style.height=2*o+"px",m.style.width=2*o+"px",null!=r.color&&(m.style.backgroundColor=r.color),m.style.transitionDuration=`${d}ms`,this._containerElement.appendChild(m),function Uae(n){window.getComputedStyle(n).getPropertyValue("opacity")}(m),m.style.transform="scale(1)";const y=new Bae(this,m,r);return y.state=0,this._activeRipples.add(y),r.persistent||(this._mostRecentTransientRipple=y),this._runTimeoutOutsideZone(()=>{const _=y===this._mostRecentTransientRipple;y.state=1,!r.persistent&&(!_||!this._isPointerDown)&&y.fadeOut()},d),y}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const r=t.element,i=Object.assign(Object.assign({},u7),t.config.animation);r.style.transitionDuration=`${i.exitDuration}ms`,r.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,r.remove()},i.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=jf(t);!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(l7))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(c7),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const e=hq(t),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!r&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!fq(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let r=0;r<e.length;r++)this.fadeInRipple(e[r].clientX,e[r].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(e=>{this._triggerElement.addEventListener(e,this,H4)})})}_removeTriggerEvents(){this._triggerElement&&(l7.forEach(t=>{this._triggerElement.removeEventListener(t,this,H4)}),this._pointerUpEventsRegistered&&c7.forEach(t=>{this._triggerElement.removeEventListener(t,this,H4)}))}}const Wae=new Qn("mat-ripple-global-options");let h7=(()=>{class n{constructor(e,r,i,s,o){this._elementRef=e,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new zae(this,r,e,i)}get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,r=0,i){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,r,Object.assign(Object.assign({},this.rippleConfig),i)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),e))}}return n.\u0275fac=function(e){return new(e||n)(nn(As),nn(Oi),nn(Da),nn(Wae,8),nn(zg,8))},n.\u0275dir=sr({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,r){2&e&&Ua("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),Gae=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[Hc],Hc]}),n})();const jae=["mat-button",""],qae=["*"],Kae=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],Xae=U4(Fae(Pae(class{constructor(n){this._elementRef=n}})));let Yae=(()=>{class n extends Xae{constructor(e,r,i){super(e),this._focusMonitor=r,this._animationMode=i,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of Kae)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);e.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,r){e?this._focusMonitor.focusVia(this._getHostElement(),e,r):this._getHostElement().focus(r)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...e){return e.some(r=>this._getHostElement().hasAttribute(r))}}return n.\u0275fac=function(e){return new(e||n)(nn(As),nn(pq),nn(zg,8))},n.\u0275cmp=Vl({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,r){if(1&e&&Ii(h7,5),2&e){let i;mn(i=Aa())&&(r.ripple=i.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(e,r){2&e&&(Na("disabled",r.disabled||null),Ua("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-button-disabled",r.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[oi],attrs:jae,ngContentSelectors:qae,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,r){1&e&&(Bx(),Kr(0,"span",0),Ou(1),Gr(),lo(2,"span",1)(3,"span",2)),2&e&&(Li(2),Ua("mat-button-ripple-round",r.isRoundButton||r.isIconButton),Ri("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",r.isIconButton)("matRippleTrigger",r._getHostElement()))},directives:[h7],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),n})(),Qae=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[Gae,Hc],Hc]}),n})();const{isArray:Jae}=Array;function W4(n){return qs(t=>function eue(n,t){return Jae(t)?n(...t):n(t)}(n,t))}const tue=["addListener","removeListener"],nue=["addEventListener","removeEventListener"],rue=["on","off"];function jk(n,t,e,r){if(pt(e)&&(r=e,e=void 0),r)return jk(n,t,e).pipe(W4(r));const[i,s]=function oue(n){return pt(n.addEventListener)&&pt(n.removeEventListener)}(n)?nue.map(o=>a=>n[o](t,a,e)):function iue(n){return pt(n.addListener)&&pt(n.removeListener)}(n)?tue.map(f7(n,t)):function sue(n){return pt(n.on)&&pt(n.off)}(n)?rue.map(f7(n,t)):[];if(!i&&pn(n))return bc(o=>jk(o,t,e))(ro(n));if(!i)throw new TypeError("Invalid event target");return new $i(o=>{const a=(...u)=>o.next(1<u.length?u:u[0]);return i(a),()=>s(a)})}function f7(n,t){return e=>r=>n[e](t,r)}function G4(...n){return function aue(){return Dr(1)}()(Cc(n,eu(n)))}function qk(...n){const t=eu(n);return Pi((e,r)=>{(t?G4(n,e,t):G4(n,e)).subscribe(r)})}function bC(n){return n<=0?()=>ma:Pi((t,e)=>{let r=0;t.subscribe(Bn(e,i=>{++r<=n&&(e.next(i),n<=r&&e.complete())}))})}const uue=["connectionContainer"],lue=["inputContainer"],cue=["label"];function hue(n,t){1&n&&(fg(0),Kr(1,"div",14),lo(2,"div",15)(3,"div",16)(4,"div",17),Gr(),Kr(5,"div",18),lo(6,"div",15)(7,"div",16)(8,"div",17),Gr(),hp())}function fue(n,t){if(1&n){const e=dg();Kr(0,"div",19),Vs("cdkObserveContent",function(){return Fm(e),cu().updateOutlineGap()}),Ou(1,1),Gr()}2&n&&Ri("cdkObserveContentDisabled","outline"!=cu().appearance)}function due(n,t){if(1&n&&(fg(0),Ou(1,2),Kr(2,"span"),zs(3),Gr(),hp()),2&n){const e=cu(2);Li(3),pp(e._control.placeholder)}}function pue(n,t){1&n&&Ou(0,3,["*ngSwitchCase","true"])}function mue(n,t){1&n&&(Kr(0,"span",23),zs(1," *"),Gr())}function gue(n,t){if(1&n){const e=dg();Kr(0,"label",20,21),Vs("cdkObserveContent",function(){return Fm(e),cu().updateOutlineGap()}),So(2,due,4,1,"ng-container",12),So(3,pue,1,0,"ng-content",12),So(4,mue,2,0,"span",22),Gr()}if(2&n){const e=cu();Ua("mat-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-form-field-empty",e._control.empty&&!e._shouldAlwaysFloat())("mat-accent","accent"==e.color)("mat-warn","warn"==e.color),Ri("cdkObserveContentDisabled","outline"!=e.appearance)("id",e._labelId)("ngSwitch",e._hasLabel()),Na("for",e._control.id)("aria-owns",e._control.id),Li(2),Ri("ngSwitchCase",!1),Li(1),Ri("ngSwitchCase",!0),Li(1),Ri("ngIf",!e.hideRequiredMarker&&e._control.required&&!e._control.disabled)}}function vue(n,t){1&n&&(Kr(0,"div",24),Ou(1,4),Gr())}function yue(n,t){if(1&n&&(Kr(0,"div",25),lo(1,"span",26),Gr()),2&n){const e=cu();Li(1),Ua("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)}}function _ue(n,t){1&n&&(Kr(0,"div"),Ou(1,5),Gr()),2&n&&Ri("@transitionMessages",cu()._subscriptAnimationState)}function bue(n,t){if(1&n&&(Kr(0,"div",30),zs(1),Gr()),2&n){const e=cu(2);Ri("id",e._hintLabelId),Li(1),pp(e.hintLabel)}}function wue(n,t){if(1&n&&(Kr(0,"div",27),So(1,bue,2,2,"div",28),Ou(2,6),lo(3,"div",29),Ou(4,7),Gr()),2&n){const e=cu();Ri("@transitionMessages",e._subscriptAnimationState),Li(1),Ri("ngIf",e.hintLabel)}}const xue=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Cue=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"];let Sue=0;const d7=new Qn("MatError");let Eue=(()=>{class n{constructor(e,r){this.id="mat-error-"+Sue++,e||r.nativeElement.setAttribute("aria-live","polite")}}return n.\u0275fac=function(e){return new(e||n)(jm("aria-live"),nn(As))},n.\u0275dir=sr({type:n,selectors:[["mat-error"]],hostAttrs:["aria-atomic","true",1,"mat-error"],hostVars:1,hostBindings:function(e,r){2&e&&Na("id",r.id)},inputs:{id:"id"},features:[Hi([{provide:d7,useExisting:n}])]}),n})();const Nue={transitionMessages:_q("transitionMessages",[m4("enter",Rh({opacity:1,transform:"translateY(0%)"})),g4("void => enter",[Rh({opacity:0,transform:"translateY(-5px)"}),p4("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let j4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=sr({type:n}),n})();const Tue=new Qn("MatHint");let q4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=sr({type:n,selectors:[["mat-label"]]}),n})(),Aue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=sr({type:n,selectors:[["mat-placeholder"]]}),n})();const Iue=new Qn("MatPrefix"),p7=new Qn("MatSuffix");let Due=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=sr({type:n,selectors:[["","matSuffix",""]],features:[Hi([{provide:p7,useExisting:n}])]}),n})(),m7=0;const kue=U4(class{constructor(n){this._elementRef=n}},"primary"),Rue=new Qn("MAT_FORM_FIELD_DEFAULT_OPTIONS"),v7=new Qn("MatFormField");let Oue=(()=>{class n extends kue{constructor(e,r,i,s,o,a,u){super(e),this._changeDetectorRef=r,this._dir=i,this._defaults=s,this._platform=o,this._ngZone=a,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new Qi,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+m7++,this._labelId="mat-form-field-label-"+m7++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==u,this.appearance=s&&s.appearance?s.appearance:"legacy",this._hideRequiredMarker=!(!s||null==s.hideRequiredMarker)&&s.hideRequiredMarker}get appearance(){return this._appearance}set appearance(e){const r=this._appearance;this._appearance=e||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&r!==e&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=Gf(e)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(e){this._explicitFormFieldControl=e}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${e.controlType}`),e.stateChanges.pipe(qk(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(Lu(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Lu(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),ei(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(qk(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(qk(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(Lu(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(e){const r=this._control?this._control.ngControl:null;return r&&r[e]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,jk(this._label.nativeElement,"transitionend").pipe(bC(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const r=this._hintChildren?this._hintChildren.find(s=>"start"===s.align):null,i=this._hintChildren?this._hintChildren.find(s=>"end"===s.align):null;r?e.push(r.id):this._hintLabel&&e.push(this._hintLabelId),i&&e.push(i.id)}else this._errorChildren&&e.push(...this._errorChildren.map(r=>r.id));this._control.setDescribedByIds(e)}}_validateControlChild(){}updateOutlineGap(){const e=this._label?this._label.nativeElement:null,r=this._connectionContainerRef.nativeElement,i=".mat-form-field-outline-start",s=".mat-form-field-outline-gap";if("outline"!==this.appearance||!this._platform.isBrowser)return;if(!e||!e.children.length||!e.textContent.trim()){const m=r.querySelectorAll(`${i}, ${s}`);for(let y=0;y<m.length;y++)m[y].style.width="0";return}if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let o=0,a=0;const u=r.querySelectorAll(i),d=r.querySelectorAll(s);if(this._label&&this._label.nativeElement.children.length){const m=r.getBoundingClientRect();if(0===m.width&&0===m.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const y=this._getStartEnd(m),_=e.children,E=this._getStartEnd(_[0].getBoundingClientRect());let D=0;for(let O=0;O<_.length;O++)D+=_[O].offsetWidth;o=Math.abs(E-y)-5,a=D>0?.75*D+10:0}for(let m=0;m<u.length;m++)u[m].style.width=`${o}px`;for(let m=0;m<d.length;m++)d[m].style.width=`${a}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(e){return this._dir&&"rtl"===this._dir.value?e.right:e.left}_isAttachedToDOM(){const e=this._elementRef.nativeElement;if(e.getRootNode){const r=e.getRootNode();return r&&r!==e}return document.documentElement.contains(e)}}return n.\u0275fac=function(e){return new(e||n)(nn(As),nn(Eg),nn(uC,8),nn(Rue,8),nn(Da),nn(Oi),nn(zg,8))},n.\u0275cmp=Vl({type:n,selectors:[["mat-form-field"]],contentQueries:function(e,r,i){if(1&e&&(Vc(i,j4,5),Vc(i,j4,7),Vc(i,q4,5),Vc(i,q4,7),Vc(i,Aue,5),Vc(i,d7,5),Vc(i,Tue,5),Vc(i,Iue,5),Vc(i,p7,5)),2&e){let s;mn(s=Aa())&&(r._controlNonStatic=s.first),mn(s=Aa())&&(r._controlStatic=s.first),mn(s=Aa())&&(r._labelChildNonStatic=s.first),mn(s=Aa())&&(r._labelChildStatic=s.first),mn(s=Aa())&&(r._placeholderChild=s.first),mn(s=Aa())&&(r._errorChildren=s),mn(s=Aa())&&(r._hintChildren=s),mn(s=Aa())&&(r._prefixChildren=s),mn(s=Aa())&&(r._suffixChildren=s)}},viewQuery:function(e,r){if(1&e&&(Ii(uue,7),Ii(lue,5),Ii(cue,5)),2&e){let i;mn(i=Aa())&&(r._connectionContainerRef=i.first),mn(i=Aa())&&(r._inputContainerRef=i.first),mn(i=Aa())&&(r._label=i.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(e,r){2&e&&Ua("mat-form-field-appearance-standard","standard"==r.appearance)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-appearance-legacy","legacy"==r.appearance)("mat-form-field-invalid",r._control.errorState)("mat-form-field-can-float",r._canLabelFloat())("mat-form-field-should-float",r._shouldLabelFloat())("mat-form-field-has-label",r._hasFloatingLabel())("mat-form-field-hide-placeholder",r._hideControlPlaceholder())("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-focused",r._control.focused)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))("_mat-animation-noopable",!r._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[Hi([{provide:v7,useExisting:n}]),oi],ngContentSelectors:Cue,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(e,r){1&e&&(Bx(xue),Kr(0,"div",0)(1,"div",1,2),Vs("click",function(s){return r._control.onContainerClick&&r._control.onContainerClick(s)}),So(3,hue,9,0,"ng-container",3),So(4,fue,2,1,"div",4),Kr(5,"div",5,6),Ou(7),Kr(8,"span",7),So(9,gue,5,16,"label",8),Gr()(),So(10,vue,2,0,"div",9),Gr(),So(11,yue,2,4,"div",10),Kr(12,"div",11),So(13,_ue,2,1,"div",12),So(14,wue,5,2,"div",13),Gr()()),2&e&&(Li(3),Ri("ngIf","outline"==r.appearance),Li(1),Ri("ngIf",r._prefixChildren.length),Li(5),Ri("ngIf",r._hasFloatingLabel()),Li(1),Ri("ngIf",r._suffixChildren.length),Li(1),Ri("ngIf","outline"!=r.appearance),Li(1),Ri("ngSwitch",r._getDisplayedMessages()),Li(1),Ri("ngSwitchCase","error"),Li(1),Ri("ngSwitchCase","hint"))},directives:[Ig,_se,X1,FM],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.cdk-high-contrast-active .mat-form-field-disabled .mat-form-field-label{color:GrayText}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px;border-top-color:GrayText}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{color:GrayText}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[Nue.transitionMessages]},changeDetection:0}),n})(),Z4=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[Dp,Hc,sq],Hc]}),n})();var Fue=z(56),Nt=z(5861);class K4{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class Zk{refCount(t){return $u("refCount")}incRef(t){return $u("incRef")}timerAvailable(){return!0}time(t){return $u("time")}read(t){return $u("read")}readSync(t){return $u("readSync")}readToGPU(t,e){return $u("readToGPU")}numDataIds(){return $u("numDataIds")}disposeData(t,e){return $u("disposeData")}write(t,e,r){return $u("write")}move(t,e,r,i,s){return $u("move")}createTensorFromGPUData(t,e,r){return $u("createTensorFromGPUData")}memory(){return $u("memory")}floatPrecision(){return $u("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return $u("dispose")}}function $u(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function X4(n){let t=n.length,e=0;for(;t>0;)e=Math.random()*t|0,t--,Zf(n,t,e)}function $ue(n,t){if(n.length!==t.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${t.length}`);let e=n.length,r=0;for(;e>0;)r=Math.random()*e|0,e--,Zf(n,e,r),Zf(t,e,r)}function Op(n,t,e){return Math.max(n,Math.min(t,e))}function Kk(n){return n%2==0?n:n+1}function Zf(n,t,e){const r=n[t];n[t]=n[e],n[e]=r}function y7(n){let t=0;for(let e=0;e<n.length;e++)t+=n[e];return t}function Bue(n,t){const e=Math.random();return t*e+(1-e)*n}function Vue(n,t){let e=0;for(let r=0;r<n.length;r++){const i=Number(n[r])-Number(t[r]);e+=i*i}return e}function De(n,t){if(!n)throw new Error("string"==typeof t?t:t())}function sa(n,t,e=""){De(ri(n,t),()=>e+` Shapes ${n} and ${t} must match`)}function Ug(n){De(null!=n,()=>"The input to the tensor constructor must be a non-null value.")}function Xt(n){if(0===n.length)return 1;let t=n[0];for(let e=1;e<n.length;e++)t*=n[e];return t}function zue(n){return 0===n.length}function ri(n,t){if(n===t)return!0;if(null==n||null==t||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Hg(n){return n%1==0}function Uue(n){if(null!=Math.tanh)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const t=Math.exp(2*n);return(t-1)/(t+1)}}function Xk(n){const t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function Hue(n){const t=new Uint32Array(n);for(let e=0;e<n;++e)t[e]=e;return X4(t),t}function Wg(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function Y4(n,t=(i=>0),e,r){return new Promise((i,s)=>{let o=0;const a=()=>{if(n())return void i();o++;const u=t(o);null!=e&&o>=e?s():null!=r?r(a,u):setTimeout(a,u)};a()})}function Q4(n,t){let e=1,r=-1;for(let s=0;s<n.length;++s)if(n[s]>=0)e*=n[s];else if(-1===n[s]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(n[s]<0)throw Error(`Shapes can not be < 0. Found ${n[s]} at dim ${s}`);if(-1===r){if(t>0&&t!==e)throw Error(`Size(${t}) must match the product of shape ${n}`);return n}if(0===e)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(t%e!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${e}`);const i=n.slice();return i[r]=t/e,i}function Yr(n,t){const e=t.length;return De((n=null==n?t.map((r,i)=>i):[].concat(n)).every(r=>r>=-e&&r<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${n}`),De(n.every(r=>Hg(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?e+r:r)}function Kf(n,t){const e=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,s=null==t||i?null:Yr(t,n).sort();let o=0;for(let a=0;a<n.length;++a){if(null!=s){if(s[o]===a&&1!==n[a])throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(null==s[o]||s[o]>a)&&1===n[a]&&(e.push(n[a]),r.push(a)),s[o]<=a&&o++}1!==n[a]&&(e.push(n[a]),r.push(a))}return{newShape:e,keptDims:r}}function Wo(n,t){return Ws(n,t)}function Ws(n,t){let e=null;if(null==n||"float32"===n)e=new Float32Array(t);else if("int32"===n)e=new Int32Array(t);else if("bool"===n)e=new Uint8Array(t);else{if("string"!==n)throw new Error(`Unknown data type ${n}`);e=new Array(t)}return e}function _7(n,t){for(let e=0;e<n.length;e++){const r=n[e];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function b7(n){return"bool"===n||"complex64"===n||"float32"===n||"int32"===n||"string"===n}function J4(n,t){return!("complex64"===t||"float32"===t&&"complex64"!==n||"int32"===t&&"float32"!==n&&"complex64"!==n||"bool"===t&&"bool"===n)}function wC(n){if("float32"===n||"int32"===n)return 4;if("complex64"===n)return 8;if("bool"===n)return 1;throw new Error(`Unknown dtype ${n}`)}function w7(n){if(null==n)return 0;let t=0;return n.forEach(e=>t+=e.length),t}function Fh(n){return"string"==typeof n||n instanceof String}function x7(n){return"boolean"==typeof n}function Yk(n){return"number"==typeof n}function Gg(n){return Array.isArray(n)?Gg(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Yk(n)?"float32":Fh(n)?"string":x7(n)?"bool":"float32"}function Fp(n){return!!(n&&n.constructor&&n.call&&n.apply)}function Qk(n,t){for(let e=t;e<n;++e)if(n%e==0)return e;return n}function ur(n){const t=n.length;if(t<2)return[];const e=new Array(t-1);e[t-2]=n[t-1];for(let r=t-3;r>=0;--r)e[r]=e[r+1]*n[r+1];return e}function C7(n,t,e,r=!1){const i=new Array;if(1===t.length){const s=t[0]*(r?2:1);for(let o=0;o<s;o++)i[o]=e[n+o]}else{const s=t[0],o=t.slice(1),a=o.reduce((u,d)=>u*d)*(r?2:1);for(let u=0;u<s;u++)i[u]=C7(n+u*a,o,e,r)}return i}function yl(n,t,e=!1){if(0===n.length)return t[0];const r=n.reduce((i,s)=>i*s)*(e?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${n}] does not match the input size ${t.length}${e?" for a complex tensor":""}.`);return C7(0,n,t,e)}function S7(n,t){if(Array.isArray(n))return n;if("float32"===t)return n instanceof Float32Array?n:new Float32Array(n);if("int32"===t)return n instanceof Int32Array?n:new Int32Array(n);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${t}`)}function Jk(n,t){const e=oa(n,t);for(let r=0;r<e.length;r++)e[r]=1;return e}function oa(n,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t)return new Uint8Array(n);throw new Error(`Unknown data type ${t}`)}function eU(n,t){const e=n.reduce((r,i)=>r*i,1);if(null==t||"float32"===t)return yl(n,new Float32Array(e));if("int32"===t)return yl(n,new Int32Array(e));if("bool"===t)return yl(n,new Uint8Array(e));throw new Error(`Unknown data type ${t}`)}function Bu(n){n.forEach(t=>{De(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Wc(n,t,e){if(0===t)return 0;if(1===t)return n[0];let r=n[n.length-1];for(let i=0;i<n.length-1;++i)r+=e[i]*n[i];return r}function jg(n,t,e){if(0===t)return[];if(1===t)return[n];const r=new Array(t);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(n/e[i]),n-=r[i]*e[i];return r[r.length-1]=n,r}function Xf(n){return n&&n.then&&"function"==typeof n.then}const E7="tfjsflags";class N7{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Wue,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(Ft().getBool("IS_TEST")||Ft().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,r){if(this.flagRegistry[t]={evaluationFn:e,setHook:r},null!=this.urlFlags[t]){const i=this.urlFlags[t];Ft().getBool("IS_TEST")||Ft().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}getAsync(t){var e=this;return(0,Nt.Z)(function*(){return t in e.flags||(e.flags[t]=yield e.evaluateFlag(t)),e.flags[t]})()}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Xf(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);E7 in t&&t[E7].split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=function jue(n,t){const e=t.toLowerCase();return"true"===e||"false"===e?"true"===e:""+ +e===e?+e:t}(0,s)})}}function Wue(n){const t={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...r)=>(function Gue(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}(t,r[0],r[1]),r.join("="))),t}function Ft(){return tU}let nU,tU=null;function T7(){if(null==nU){let n;if("undefined"!=typeof window)n=window;else if("undefined"!=typeof global)n=global;else if("undefined"!=typeof process)n=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");n=self}nU=n}return nU}function rU(n,t){const e=function Zue(){const n=T7();return null==n._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals}();if(e.has(n))return e.get(n);{const r=t();return e.set(n,r),e.get(n)}}const xC="Abs",M_="Acos",k_="Acosh",qg="Add",CC="AddN",e2="All",t2="Any",SC="ArgMax",EC="ArgMin",R_="Asin",O_="Asinh",F_="Atan",P_="Atanh",L_="Atan2",NC="AvgPool",n2="AvgPoolGrad",TC="AvgPool3D",r2="AvgPool3DGrad",AC="BatchMatMul",IC="BatchToSpaceND",s2="Bincount",A7="BroadcastTo",o2="BroadcastArgs",$_="Cast",B_="Ceil",V_="ClipByValue",a2="Complex",DC="ComplexAbs",MC="Concat",kC="Conv2D",u2="Conv2DBackpropFilter",RC="Conv2DBackpropInput",OC="Conv3D",l2="Conv3DBackpropFilterV2",c2="Conv3DBackpropInputV2",z_="Cos",U_="Cosh",h2="Cumprod",FC="Cumsum",f2="CropAndResize",d2="DenseBincount",p2="DepthToSpace",PC="DepthwiseConv2dNative",m2="DepthwiseConv2dNativeBackpropFilter",g2="DepthwiseConv2dNativeBackpropInput",v2="Diag",LC="Dilation2D",y2="Dilation2DBackpropInput",_2="Dilation2DBackpropFilter",H_="RealDiv",b2="Einsum",W_="Elu",w2="EluGrad",G_="Erf",$C="Equal",j_="Exp",BC="ExpandDims",q_="Expm1",x2="FFT",C2="Fill",S2="FlipLeftRight",Z_="Floor",K_="FloorDiv",VC="FusedBatchNorm",zC="GatherV2",E2="GatherNd",UC="Greater",X_="GreaterEqual",Y_="Identity",N2="IFFT",T2="Imag",Q_="IsFinite",J_="IsInf",e0="IsNan",HC="LeakyRelu",WC="Less",GC="LessEqual",A2="LinSpace",t0="Log",n0="Log1p",jC="LogicalAnd",qC="LogicalNot",ZC="LogicalOr",Kue="LogicalXor",I7="LogSoftmax",Xue="LowerBound",KC="LRN",I2="LRNGrad",Yue="MatrixBandPart",XC="Max",r0="Maximum",YC="MaxPool",D2="MaxPoolGrad",QC="MaxPool3D",M2="MaxPool3DGrad",k2="MaxPoolWithArgmax",JC="Mean",eS="Min",s0="Minimum",tS="MirrorPad",o0="Mod",R2="Multinomial",a0="Multiply",nS="Neg",rS="NotEqual",O2="NonMaxSuppressionV3",F2="NonMaxSuppressionV4",P2="NonMaxSuppressionV5",iS="OnesLike",sS="OneHot",oS="Pack",aS="PadV2",Que="Pool",u0="Pow",uS="Prelu",lS="Prod",L2="RaggedGather",$2="RaggedRange",B2="RaggedTensorToTensor",V2="Range",z2="Real",l0="Reciprocal",c0="Relu",cS="Reshape",hS="ResizeNearestNeighbor",U2="ResizeNearestNeighborGrad",fS="ResizeBilinear",H2="ResizeBilinearGrad",h0="Relu6",dS="Reverse",f0="Round",d0="Rsqrt",W2="ScatterNd",G2="TensorScatterUpdate",j2="SearchSorted",pS="Select",p0="Selu",mS="Slice",m0="Sin",g0="Sinh",v0="Sign",y0="Sigmoid",_0="Softplus",b0="Sqrt",gS="Sum",vS="SpaceToBatchND",yS="SplitV",_S="Softmax",q2="SparseFillEmptyRows",Z2="SparseReshape",K2="SparseSegmentMean",X2="SparseSegmentSum",Y2="SparseToDense",w0="SquaredDifference",Q2="Square",bS="StaticRegexReplace",J2="StridedSlice",eR="StringNGrams",tR="StringSplit",nR="StringToHashBucketFast",x0="Sub",C0="Tan",S0="Tanh",E0="Tile",rR="TopK",iR="Transform",Zg="Transpose",sR="Unique",wS="Unpack",xS="UnsortedSegmentSum",Jue="UpperBound",CS="ZerosLike",N0="Step",oR="FromPixels",aR="RotateWithOffset",SS="_FusedMatMul",ES="FusedConv2D",NS="FusedDepthwiseConv2D";function _l(...n){Ft().getBool("IS_TEST")||Ft().getBool("PROD")||console.warn(...n)}function ele(...n){Ft().getBool("IS_TEST")||Ft().getBool("PROD")||console.log(...n)}const T0=rU("kernelRegistry",()=>new Map),TS=rU("gradRegistry",()=>new Map);function uR(n,t){const e=sU(n,t);return T0.get(e)}function iU(n){return TS.get(n)}function lR(n){const t=T0.entries(),e=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[s,o]=i,[a]=s.split("_");a===n&&e.push(o)}return e}function cR(n){const{kernelName:t,backendName:e}=n,r=sU(t,e);T0.has(r)&&_l(`The kernel '${t}' for backend '${e}' is already registered`),T0.set(r,n)}function D7(n){const{kernelName:t}=n;TS.has(t)&&Ft().getBool("DEBUG")&&_l(`Overriding the gradient for '${t}'`),TS.set(t,n)}function tle(n,t){const e=sU(n,t);if(!T0.has(e))throw new Error(`The kernel '${n}' for backend '${t}' is not registered`);T0.delete(e)}function nle(n){if(!TS.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);TS.delete(n)}function rle(n,t){lR(n).forEach(r=>{cR(Object.assign({},r,{backendName:t}))})}function sU(n,t){return`${t}_${n}`}function M7(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var k7=z(7658);const Kg=z.n(k7)()||k7;function AS(n){return Kg.fromString(n,!0,16)}const R7=AS("c3a5c85c97cb3127"),Xg=AS("b492b66fbe98f273"),ja=AS("9ae16a3b2f90404f");function oU(n){return n.xor(n.shru(47))}function O7(n,t,e){const r=n.slice(t,t+e);return Kg.fromBytes(Array.from(r),!0,!0)}function is(n,t){return O7(n,t,8)}function F7(n,t){return O7(n,t,4)}function Go(n,t){return 0===t?n:n.shru(t).or(n.shl(64-t))}function Pp(n,t,e=AS("9ddfea08eb382d69")){let r=n.xor(t).mul(e);r=r.xor(r.shru(47));let i=t.xor(r).mul(e);return i=i.xor(i.shru(47)),i=i.mul(e),i}function hR(n,t,e,r){return function sle(n,t,e,r,i,s){i=i.add(n),s=Go(s.add(i).add(r),21);const o=i;return i=(i=i.add(t)).add(e),s=s.add(Go(i,44)),[i.add(r),s.add(o)]}(is(n,t),is(n,t+8),is(n,t+16),is(n,t+24),e,r)}function P7(n,t=n.length){const e=Kg.fromNumber(81,!0);if(t<=32)return t<=16?function ole(n,t=n.length){if(t>=8){const e=ja.add(2*t),r=is(n,0).add(ja),i=is(n,t-8);return Pp(Go(i,37).mul(e).add(r),Go(r,25).add(i).mul(e),e)}if(t>=4){const e=ja.add(2*t);return Pp(F7(n,0).shl(3).add(t),F7(n,t-4),e)}if(t>0){const o=t+(n[t-1]<<2);return oU(ja.mul(n[0]+(n[t>>1]<<8)).xor(R7.mul(o))).mul(ja)}return ja}(n,t):function ale(n,t=n.length){const e=ja.add(2*t),r=is(n,0).mul(Xg),i=is(n,8),s=is(n,t-8).mul(e),o=is(n,t-16).mul(ja);return Pp(Go(r.add(i),43).add(Go(s,30)).add(o),r.add(Go(i.add(ja),18)).add(s),e)}(n,t);if(t<=64)return function ule(n,t=n.length){const e=ja.add(2*t),r=is(n,0).mul(ja),i=is(n,8),s=is(n,t-8).mul(e),o=is(n,t-16).mul(ja),a=Go(r.add(i),43).add(Go(s,30)).add(o),u=Pp(a,r.add(Go(i.add(ja),18)).add(s),e),d=is(n,16).mul(e),m=is(n,24),y=a.add(is(n,t-32)).mul(e),_=u.add(is(n,t-24)).mul(e);return Pp(Go(d.add(m),43).add(Go(y,30)).add(_),d.add(Go(m.add(r),18)).add(y),e)}(n,t);let r=e,i=e.mul(Xg).add(113),s=oU(i.mul(ja).add(113)).mul(ja),o=[Kg.UZERO,Kg.UZERO],a=[Kg.UZERO,Kg.UZERO];r=r.mul(ja).add(is(n,0));let u=0;const d=64*(t-1>>6),m=d+(t-1&63)-63;do{r=Go(r.add(i).add(o[0]).add(is(n,u+8)),37).mul(Xg),i=Go(i.add(o[1]).add(is(n,u+48)),42).mul(Xg),r=r.xor(a[1]),i=i.add(o[0]).add(is(n,u+40)),s=Go(s.add(a[0]),33).mul(Xg),o=hR(n,u,o[1].mul(Xg),r.add(a[0])),a=hR(n,u+32,s.add(a[1]),i.add(is(n,u+16))),[s,r]=[r,s],u+=64}while(u!==d);const y=Xg.add(s.and(255).shl(1));return u=m,a[0]=a[0].add(t-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),r=Go(r.add(i).add(o[0]).add(is(n,u+8)),37).mul(y),i=Go(i.add(o[1]).add(is(n,u+48)),42).mul(y),r=r.xor(a[1].mul(9)),i=i.add(o[0].mul(9).add(is(n,u+40))),s=Go(s.add(a[0]),33).mul(y),o=hR(n,u,o[1].mul(y),r.add(a[0])),a=hR(n,u+32,s.add(a[1]),i.add(is(n,u+16))),[s,r]=[r,s],Pp(Pp(o[0],a[0],y).add(oU(i).mul(R7)).add(s),Pp(o[1],a[1],y).add(r),y)}function Yf(n,t){return"string"===t?Ph(n):Lp([n],t)}function Lp(n,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Lh(n)),Ft().getBool("DEBUG")&&_7(n,t),function lle(n,t){return n instanceof Float32Array&&"float32"===t||n instanceof Int32Array&&"int32"===t||n instanceof Uint8Array&&"bool"===t}(n,t))return n;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(n);if("int32"===t)return new Int32Array(n);if("bool"===t){const e=new Uint8Array(n.length);for(let r=0;r<e.length;++r)0!==Math.round(n[r])&&(e[r]=1);return e}throw new Error(`Unknown data type ${t}`)}function aa(){return Ft().platform.now()}function L7(n,t){return Ft().platform.fetch(n,t)}function Ph(n,t="utf-8"){return t=t||"utf-8",Ft().platform.encode(n,t)}function Qf(n,t="utf-8"){return t=t||"utf-8",Ft().platform.decode(n,t)}function jo(n){return null!=Ft().platform.isTypedArray?Ft().platform.isTypedArray(n):M7(n)}function Lh(n,t=[],e=!1){if(null==t&&(t=[]),"boolean"==typeof n||"number"==typeof n||"string"==typeof n||Xf(n)||null==n||jo(n)&&e)t.push(n);else if(Array.isArray(n)||jo(n))for(let r=0;r<n.length;++r)Lh(n[r],t,e);else{let r=-1;for(const i of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)Lh(n[i],t,e)}return t}class cle{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new fle)}profileKernel(t,e,r){let i;const s=()=>{i=r()};let o;const a=aa();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();for(const d of i)d.dataSync();o=Promise.resolve({kernelMs:aa()-a})}if(Ft().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let d=0;d<i.length;d++){const m=i[d];m.data().then(y=>{hle(y,m.dtype,t)})}return{kernelName:t,outputs:i,inputs:e,timeMs:o.then(d=>d.kernelMs),extraInfo:o.then(d=>null!=d.getExtraProfileInfo?d.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:r,timeMs:i,inputs:s,extraInfo:o}=t;r.forEach(a=>{Promise.all([a.data(),i,o]).then(u=>{this.logger.logKernelProfile(e,a,u[0],u[1],s,u[2])})})}}function hle(n,t,e){if("float32"!==t)return!1;for(let r=0;r<n.length;r++){const i=n[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${e}'`),!0}return!1}class fle{logKernelProfile(t,e,r,i,s,o){const a="number"==typeof i?Wg(`${i}ms`,9):i.error,u=Wg(t,25),d=e.rank,m=e.size,y=Wg(e.shape.toString(),14);let _="";for(const E in s){const D=s[E];if(null!=D){const O=D.shape||e.shape,R=O.length;_+=`${E}: ${R}D ${R>0?O:""} `}}console.log(`%c${u}\t%c${a}\t%c${d}D ${y}\t%c${m}\t%c${_}\t%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function mle(n,t,e,r){const i=ur(t),s=function gle(n,t,e,r){const i=Xt(t),s=r[r.length-1],o=new Array(s).fill(0),a=t.length,u="complex64"===e?MS(n):n;if(a>1)for(let d=0;d<i/s;d++){const m=d*s;for(let y=0;y<s;y++)o[y]=Math.max(o[y],DS(u[m+y],0,e).length)}return o}(n,t,e,i),o=t.length,a=fR(n,t,e,i,s),u=["Tensor"];return r&&(u.push(`  dtype: ${e}`),u.push(`  rank: ${o}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(a.map(d=>"    "+d).join("\n")),u.join("\n")}function DS(n,t,e){let r;return r=Array.isArray(n)?`${parseFloat(n[0].toFixed(7))} + ${parseFloat(n[1].toFixed(7))}j`:Fh(n)?`'${n}'`:"bool"===e?B7(n):parseFloat(n.toFixed(7)).toString(),Wg(r,t)}function B7(n){return 0===n?"false":"true"}function fR(n,t,e,r,i,s=!0){const o="complex64"===e?2:1,a=t[0],u=t.length;if(0===u)return"complex64"===e?[DS(MS(n)[0],0,e)]:"bool"===e?[B7(n[0])]:[n[0].toString()];if(1===u){if(a>20){let $=Array.from(n.slice(0,3*o)),B=Array.from(n.slice((a-3)*o,a*o));return"complex64"===e&&($=MS($),B=MS(B)),["["+$.map((Q,ie)=>DS(Q,i[ie],e)).join(", ")+", ..., "+B.map((Q,ie)=>DS(Q,i[a-3+ie],e)).join(", ")+"]"]}return["["+("complex64"===e?MS(n):Array.from(n)).map((R,$)=>DS(R,i[$],e)).join(", ")+"]"]}const d=t.slice(1),m=r.slice(1),y=r[0]*o,_=[];if(a>20){for(let O=0;O<3;O++){const R=O*y;_.push(...fR(n.slice(R,R+y),d,e,m,i,!1))}_.push("...");for(let O=a-3;O<a;O++){const R=O*y;_.push(...fR(n.slice(R,R+y),d,e,m,i,O===a-1))}}else for(let O=0;O<a;O++){const R=O*y;_.push(...fR(n.slice(R,R+y),d,e,m,i,O===a-1))}const E=2===u?",":"";_[0]="["+(a>0?_[0]+E:"");for(let O=1;O<_.length-1;O++)_[O]=" "+_[O]+E;let D=",\n";for(let O=2;O<u;O++)D+="\n";return _[_.length-1]=" "+_[_.length-1]+"]"+(s?"":D),_}function MS(n){const t=[];for(let e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}class po{constructor(t,e,r){if(this.dtype=e,this.shape=t.slice(),this.size=Xt(t),null!=r){const i=r.length;De(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Ws(e,this.size),this.strides=ur(t)}set(t,...e){0===e.length&&(e=[0]),De(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const r=this.locToIndex(e);this.values[r]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const i of t){if(i<0||i>=this.shape[e])throw new Error(`Requested out of range element at ${t}.   Buffer shape=${this.shape}`);e++}let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=this.strides[i]*t[i];return this.values[r]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let r=0;r<t.length-1;++r)e+=this.strides[r]*t[r];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let r=0;r<e.length-1;++r)e[r]=Math.floor(t/this.strides[r]),t-=e[r]*this.strides[r];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Gc().makeTensor(this.values,this.shape,this.dtype)}}let Gc=null,A0=null,V7=null;class yi{constructor(t,e,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Xt(t),this.strides=ur(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.data();return A0.buffer(t.shape,t.dtype,e)})()}bufferSync(){return A0.buffer(this.shape,this.dtype,this.dataSync())}array(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.data();return yl(t.shape,e,"complex64"===t.dtype)})()}arraySync(){return yl(this.shape,this.dataSync(),"complex64"===this.dtype)}data(){var t=this;return(0,Nt.Z)(function*(){t.throwIfDisposed();const e=Gc().read(t.dataId);if("string"===t.dtype){const r=yield e;try{return r.map(i=>Qf(i))}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e})()}dataToGPU(t){return this.throwIfDisposed(),Gc().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Gc().readSync(this.dataId);if("string"===this.dtype)try{return t.map(e=>Qf(e))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){var t=this;return(0,Nt.Z)(function*(){t.throwIfDisposed();const e=yield Gc().read(t.dataId);return"string"===t.dtype?e:new Uint8Array(e.buffer)})()}dispose(){this.isDisposed||(Gc().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return A0.print(this,t)}clone(){return this.throwIfDisposed(),A0.clone(this)}toString(t=!1){return mle(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),A0.cast(this,t)}variable(t=!0,e,r){return this.throwIfDisposed(),Gc().makeVariable(this,t,e,r)}}function en(){return rU("Tensor",()=>yi)}Object.defineProperty(yi,Symbol.hasInstance,{value:n=>!!n&&null!=n.data&&null!=n.dataSync&&null!=n.throwIfDisposed}),en();class kS extends yi{constructor(t,e,r,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=e,this.name=r}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!ri(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Gc().disposeTensor(this),this.dataId=t.dataId,Gc().incRef(this,null)}dispose(){Gc().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(kS,Symbol.hasInstance,{value:n=>n instanceof yi&&null!=n.assign&&n.assign instanceof Function});var dR=(()=>{return(n=dR||(dR={})).R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6",dR;var n})(),pR=(()=>{return(n=pR||(pR={})).float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64",pR;var n})(),mR=(()=>{return(n=mR||(mR={})).float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64",mR;var n})(),gR=(()=>{return(n=gR||(gR={})).float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64",gR;var n})(),vR=(()=>{return(n=vR||(vR={})).float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64",vR;var n})();const ble={float32:gR,int32:pR,bool:mR,complex64:vR};function pu(n,t){if("string"===n||"string"===t){if("string"===n&&"string"===t)return"string";throw new Error(`Can not upcast ${n} with ${t}`)}return ble[n][t]}function yR(n){return pu(n,"int32")}function z7(n){return null!=n&&"object"==typeof n&&"texture"in n&&n.texture instanceof WebGLTexture}function U7(n){return"undefined"!=typeof GPUBuffer&&null!=n&&"object"==typeof n&&"buffer"in n&&n.buffer instanceof GPUBuffer}function Ds(n,t){if(n.dtype===t.dtype)return[n,t];const e=pu(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function H7(n,t){De(n.dtype===t.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${t.dtype}) input must match`)}function _R(n,t){return t.some(e=>e.id===n.id)}function Jf(n){const t=[];return W7(n,t,new Set),t}function W7(n,t,e){if(null==n)return;if(n instanceof yi)return void t.push(n);if(!function wle(n){return Array.isArray(n)||"object"==typeof n}(n))return;const r=n;for(const i in r){const s=r[i];e.has(s)||(e.add(s),W7(s,t,e))}}function uU(n){return null!=n.kernelName}class G7{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}let xle=(()=>{class n{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new G7}ready(){var e=this;return(0,Nt.Z)(function*(){if(null!=e.pendingBackendInit)return e.pendingBackendInit.then(()=>{});if(null!=e.backendInstance)return;const r=e.getSortedBackends();for(let i=0;i<r.length;i++){const s=r[i];if(yield e.initializeBackend(s).success)return void(yield e.setBackend(s))}throw new Error("Could not initialize any backends, all backend initializations failed.")})()}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:r}=this.initializeBackend(e);if(r)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,r,i=1){return e in this.registryFactory?(_l(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:r,priority:i},!0)}setBackend(e){var r=this;return(0,Nt.Z)(function*(){if(null==r.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(r.backendName=e,null==r.registry[e]){r.backendInstance=null;const{success:i,asyncInit:s}=r.initializeBackend(e);if(!(s?yield i:i))return!1}return r.backendInstance=r.registry[e],r.setupRegisteredKernels(),r.profiler=new cle(r.backendInstance),!0})()}setupRegisteredKernels(){lR(this.backendName).forEach(r=>{null!=r.setupFunc&&r.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){lR(e).forEach(i=>{null!=i.disposeFunc&&i.disposeFunc(this.registry[e])})}initializeBackend(e){const r=this.registryFactory[e];if(null==r)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const i=r.factory();if(!i||i instanceof Zk||"function"!=typeof i.then)return this.registry[e]=i,{success:!0,asyncInit:!1};{const s=++this.pendingBackendInitId,o=i.then(a=>!(s<this.pendingBackendInitId||(this.registry[e]=a,this.pendingBackendInit=null,0))).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,_l(`Initialization of backend ${e} failed`),_l(a.stack||a.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}}catch(i){return _l(`Initialization of backend ${e} failed`),_l(i.stack||i.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,r)=>this.registryFactory[r].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let r=0;r<e.length;r++){const i=e[r],{success:s,asyncInit:o}=this.initializeBackend(i);if(o||s)return{name:i,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,r){const i=this.state.tensorInfo.get(r),s=i.backend,o=this.readSync(r),a=s.refCount(r);s.disposeData(r,!0),i.backend=e,e.move(r,o,i.shape,i.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,r){let s,i=null;if(null==r){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");r=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof r)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(()=>this.startScope(i),()=>this.endScope(s),()=>(s=r(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,r,i){e();try{const s=i();return r(),s}catch(s){throw r(),s}}nextTensorId(){return n.nextTensorId++}nextVariableId(){return n.nextVariableId++}clone(e){const r=ot.runKernel(Y_,{x:e});return this.addTapeNode(this.state.activeScope.name,{x:e},[r],a=>({x:()=>ot.runKernel($_,{x:a},{dtype:"float32"})}),[],{}),r}runKernel(e,r,i){if(null==uR(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:r,attrs:i})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,r,i){const s=this.backend.numDataIds();let o=0;i.forEach(d=>{o+="complex64"===d.dtype?3:1});const u=s-r-o-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(u>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${u} data ids) after running '${e}'`)}runKernelFunc(e){let r,i=[];const s=this.isTapeOn(),o=this.state.numBytes,a=this.state.numTensors;let u,d;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const m=uU(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(uU(e)){const{kernelName:O,inputs:R,attrs:$}=e,B=uR(O,this.backendName);De(null!=B,()=>`Cannot find registered kernel '${O}' for backend '${this.backendName}'`),u=()=>{const Q=this.backend.numDataIds();d=B.kernelFunc({inputs:R,attrs:$,backend:this.backend});const ie=Array.isArray(d)?d:[d];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(O,Q,ie);const ye=ie.map(Me=>null!=Me.rank?Me:this.makeTensorFromTensorInfo(Me));if(s){const Me=this.getTensorsForGradient(O,R,ye);i=this.saveTensorsForBackwardMode(Me)}return ye}}else{const{forwardFunc:O}=e,R=$=>{!s||(i=$.map(B=>this.keep(this.clone(B))))};u=()=>{const $=this.backend.numDataIds();d=this.tidy(()=>O(this.backend,R));const B=Array.isArray(d)?d:[d];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,$,B),B}}const{inputs:y,attrs:_}=e,E=uU(e)?null:e.backwardsFunc;let D;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(D=this.profiler.profileKernel(m,y,()=>u()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(D),r=D.outputs):r=u()}),s&&this.addTapeNode(m,y,r,E,i,_),this.state.profiling&&this.state.activeProfile.kernels.push({name:m,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(y).map(O=>null!=y[O]?y[O].shape:null),outputShapes:r.map(O=>O.shape),kernelTimeMs:D.timeMs,extraInfo:D.extraInfo}),Array.isArray(d)?r:r[0]}saveTensorsForBackwardMode(e){return e.map(i=>this.keep(this.clone(i)))}getTensorsForGradient(e,r,i){const s=iU(e);if(null!=s){const o=s.inputsToSave||[],a=s.outputsToSave||[];let u;s.saveAllInputs?(De(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),u=Object.keys(r).map(m=>r[m])):u=o.map(m=>r[m]);const d=i.filter((m,y)=>a[y]);return u.concat(d)}return[]}makeTensor(e,r,i,s){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");s=s||this.backend;let o=e;"string"===(i=i||"float32")&&Fh(e[0])&&(o=e.map(d=>Ph(d)));const a=s.write(o,r,i),u=new yi(r,i,a,this.nextTensorId());if(this.trackTensor(u,s),"string"===i){const d=this.state.tensorInfo.get(a),m=w7(o);this.state.numBytes+=m-d.bytes,d.bytes=m}return u}makeTensorFromDataId(e,r,i,s){return this.makeTensorFromTensorInfo({dataId:e,shape:r,dtype:i=i||"float32"},s)}makeTensorFromTensorInfo(e,r){const{dataId:i,shape:s,dtype:o}=e,a=new yi(s,o,i,this.nextTensorId());return this.trackTensor(a,r),a}makeVariable(e,r=!0,i,s){i=i||this.nextVariableId().toString(),null!=s&&s!==e.dtype&&(e=e.cast(s));const o=new kS(e,r,i,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,r){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let i=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(i=e.size*wC(e.dtype)),this.state.numBytes+=i,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:r||this.backend,dtype:e.dtype,shape:e.shape,bytes:i})),e instanceof kS||this.track(e)}incRef(e,r){this.trackTensor(e,r),this.backend.incRef(e.dataId)}removeDataId(e,r){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===r&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const r=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=r.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const i=e.size*wC(e.dtype);this.state.numBytes-=i}r.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,r.backend)}disposeVariables(){for(const e in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[e])}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}profile(e){var r=this;return(0,Nt.Z)(function*(){r.state.profiling=!0;const i=r.state.numBytes,s=r.state.numTensors;r.state.activeProfile.kernels=[],r.state.activeProfile.result=yield e(),r.state.profiling=!1,r.state.activeProfile.peakBytes=Math.max(...r.state.activeProfile.kernels.map(o=>o.totalBytesSnapshot)),r.state.activeProfile.newBytes=r.state.numBytes-i,r.state.activeProfile.newTensors=r.state.numTensors-s;for(const o of r.state.activeProfile.kernels)o.kernelTimeMs=yield o.kernelTimeMs,o.extraInfo=yield o.extraInfo;return r.state.activeProfile})()}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,r,i,s,o,a){const u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:r,outputs:i,saved:o},d=iU(e);null!=d&&(s=d.gradFunc),null!=s&&(u.gradient=m=>(m=m.map((y,_)=>{if(null==y){const E=i[_],D=oa(E.size,E.dtype);return this.makeTensor(D,E.shape,E.dtype)}return y}),s(m.length>1?m:m[0],o,a))),this.state.activeTape.push(u)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(r.name=e),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(e){const r=Jf(e),i=new Set(r.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const a=this.state.activeScope.track[o];!a.kept&&!i.has(a.id)&&a.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,r,i,s=!1){if(De(r.length>0,()=>"gradients() received an empty list of xs."),null!=i&&"float32"!==i.dtype)throw new Error(`dy must have 'float32' dtype, but has '${i.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));De(o instanceof yi,()=>"The result y returned by f() must be a tensor.");const a=function dle(n,t,e){const r={},i={};for(let u=0;u<t.length;u++)r[t[u].id]=!0;for(let u=0;u<n.length;u++){const d=n[u],m=d.inputs;for(const y in m){const _=m[y];let E=!1;for(let D=0;D<t.length;D++)if(r[_.id]){d.outputs.forEach(O=>r[O.id]=!0),E=!0,i[d.id]=!0;break}if(E)break}}const s={};s[e.id]=!0;const o={};for(let u=n.length-1;u>=0;u--){const d=n[u],m=d.inputs;for(let y=0;y<d.outputs.length;y++)if(s[d.outputs[y].id]){for(const _ in m)s[m[_].id]=!0,o[d.id]=!0;break}}const a=[];for(let u=0;u<n.length;u++){const d=n[u];if(i[d.id]&&o[d.id]){const m={};for(const _ in d.inputs){const E=d.inputs[_];r[E.id]&&(m[_]=E)}const y=Object.assign({},d);y.inputs=m,y.outputs=d.outputs,a.push(y)}}return a}(this.state.activeTape,r,o);if(!s&&0===a.length&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const u={};u[o.id]=null==i?function Cle(n){const t=Jk(Xt(n),"float32");return ot.makeTensor(t,n,"float32")}(o.shape):i,function ple(n,t,e,r){for(let i=t.length-1;i>=0;i--){const s=t[i],o=[];if(s.outputs.forEach(u=>{const d=n[u.id];o.push(null!=d?d:null)}),null==s.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const a=s.gradient(o);for(const u in s.inputs){if(!(u in a))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(a)}.`);const d=e(()=>a[u]());if("float32"!==d.dtype)throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${d.dtype}'`);const m=s.inputs[u];if(!ri(d.shape,m.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${u}' has shape '${d.shape}', which does not match the shape of the input '${m.shape}'`);if(null==n[m.id])n[m.id]=d;else{const y=n[m.id];n[m.id]=r(y,d),y.dispose()}}}}(u,a,m=>this.tidy(m),Sle);const d=r.map(m=>u[m.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(m=>{for(const y of m.saved)y.dispose()}),this.state.activeTape=null),{value:o,grads:d}})}customGrad(e){return De(Fp(e),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{let i;De(r.every(u=>u instanceof yi),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const s={};return r.forEach((u,d)=>{s[d]=u}),this.runKernelFunc({forwardFunc:(u,d)=>(i=e(...r,d),De(i.value instanceof yi,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),De(Fp(i.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),i.value),backwardsFunc:(u,d)=>{const m=i.gradFunc(u,d),y=Array.isArray(m)?m:[m];De(y.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),De(y.every(E=>E instanceof yi),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const _={};return y.forEach((E,D)=>{_[D]=()=>E}),_},inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,r){return this.state.tensorInfo.get(e).backend.readToGPU(e,r)}time(e){var r=this;return(0,Nt.Z)(function*(){const i=aa(),s=yield r.backend.time(e);return s.wallMs=aa()-i,s})()}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new G7;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}return n.nextTensorId=0,n.nextVariableId=0,n})();function j7(){const n=T7();if(null==n._tfengine){const t=new N7(n);n._tfengine=new xle(t)}return function que(n){tU=n}(n._tfengine.ENV),function vle(n){Gc=n}(()=>n._tfengine),n._tfengine}const ot=j7();function Sle(n,t){return ot.runKernel(qg,{a:n,b:t})}let lU;function Nle(n){lU=n}function cU(n){if(void 0!==lU)return lU;if(n||function Ele(){return"undefined"!=typeof navigator&&null!=navigator}()){if(n||(n=navigator),"ReactNative"===n.product)return!0;const t=n.userAgent||n.vendor||("undefined"!=typeof window?window.opera:"");if(!t){const e=n;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function hU(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}const mu=Ft();function $h(n,t){let e=n;if(jo(n))return"string"===t?[]:[n.length];if(z7(n))return[n.height,n.width*(n.channels||"RGBA").length];if(U7(n))return[n.buffer.size/(null==t?4:wC(t))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(e)||jo(e)&&"string"!==t;)r.push(e.length),e=e[0];return Array.isArray(n)&&Ft().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&q7(n,r,[]),r}function q7(n,t,e){if(e=e||[],!Array.isArray(n)&&!jo(n))return void De(0===t.length,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);De(t.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${n.length} elements`),De(n.length===t[0],()=>`Element arr[${e.join("][")}] should have ${t[0]} elements, but has ${n.length} elements`);const r=t.slice(1);for(let i=0;i<n.length;++i)q7(n[i],r,e.concat(i))}function Z7(n,t,e,r){if("string_or_numeric"!==n){if(null==n)throw new Error("Expected dtype cannot be null.");if("numeric"!==n&&n!==t||"numeric"===n&&"string"===t)throw new Error(`Argument '${e}' passed to '${r}' must be ${n} tensor, but got ${t} tensor`)}}function Le(n,t,e,r="numeric"){if(n instanceof yi)return Z7(r,n.dtype,t,e),n;let i=Gg(n);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Z7(r,i,t,e),null==n||!jo(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error(`Argument '${t}' passed to '${e}' must be a Tensor or TensorLike, but got '${null==n?"null":n.constructor.name}'`);const s=$h(n,i);!jo(n)&&!Array.isArray(n)&&(n=[n]);const a="string"!==i?Lp(n,i):Lh(n,[],!0);return ot.makeTensor(a,s,i)}function RS(n,t,e,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${t} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((s,o)=>Le(s,`${t}[${o}]`,e,r))}mu.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),mu.registerFlag("IS_BROWSER",()=>hU()),mu.registerFlag("IS_NODE",()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node),mu.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),mu.registerFlag("IS_SAFARI",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),mu.registerFlag("PROD",()=>!1),mu.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>mu.getBool("DEBUG")),mu.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),mu.registerFlag("IS_TEST",()=>!1),mu.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>mu.getBool("DEBUG")),mu.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),mu.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),mu.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);const fU="__op";function ut(n){const t=Object.keys(n);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let e=t[0];const r=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e+=fU;const i=(...s)=>{ot.startScope(e);try{const o=r(...s);return Xf(o)&&console.error("Cannot return a Promise inside of tidy."),ot.endScope(o),o}catch(o){throw ot.endScope(null),o}};return Object.defineProperty(i,"name",{value:e,configurable:!0}),i}const ed=ut({complex_:function Tle(n,t){const e=Le(n,"real","complex"),r=Le(t,"imag","complex");return sa(e.shape,r.shape,`real and imag shapes, ${e.shape} and ${r.shape}, must match in call to tf.complex().`),ot.runKernel(a2,{real:e,imag:r})}});function $p(n,t,e,r){if(null==r)r=Gg(n);else if("complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(U7(n)||z7(n)){if("float32"!==r&&"int32"!==r)throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return ot.backend.createTensorFromGPUData(n,t||e,r)}if(!jo(n)&&!Array.isArray(n)&&"number"!=typeof n&&"boolean"!=typeof n&&"string"!=typeof n)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Bu(t);const i=Xt(t),s=Xt(e);De(i===s,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${s}`);for(let o=0;o<e.length;++o){const a=e[o],u=o!==e.length-1||a!==Xt(t.slice(o));De(e[o]===t[o]||!u,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${t}). `)}}return!jo(n)&&!Array.isArray(n)&&(n=[n]),t=t||e,n="string"!==r?Lp(n,r):Lh(n,[],!0),ot.makeTensor(n,t,r)}function Vu(n,t,e){return $p(n,t,$h(n,e),e)}const dU={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function pU(n,t){return mU.apply(this,arguments)}function mU(){return mU=(0,Nt.Z)(function*(n,t){const e=[],r=[],i=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<i.length;++o){const a=i[o],u=Array.isArray(n)?n[o].tensor:n[a];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype&&"complex64"!==u.dtype)throw new Error(`Unsupported dtype in weight '${a}': ${u.dtype}`);const d={name:a,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){const m=new Promise(function(){var y=(0,Nt.Z)(function*(_){const E=yield u.bytes(),D=E.reduce(($,B)=>$+B.length,0)+4*E.length,O=new Uint8Array(D);let R=0;for(let $=0;$<E.length;$++){const B=E[$],Q=new Uint8Array(new Uint32Array([B.length]).buffer);O.set(Q,R),R+=4,O.set(B,R),R+=B.length}_(O)});return function(_){return y.apply(this,arguments)}}());r.push(m)}else r.push(u.data());null!=t&&(d.group=t),e.push(d)}return{data:Ale(yield Promise.all(r)),specs:e}}),mU.apply(this,arguments)}function gU(n,t){const e={};let r,i=0;for(const s of t){const o=s.name,a=s.dtype,u=s.shape,d=Xt(u);let m;if("quantization"in s){const y=s.quantization;if("uint8"===y.dtype||"uint16"===y.dtype){if(!("min"in y)||!("scale"in y))throw new Error(`Weight ${s.name} with quantization ${y.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==y.dtype)throw new Error(`Weight ${s.name} has unknown quantization dtype ${y.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==a)throw new Error(`Weight ${s.name} is quantized with ${y.dtype} which only supports weights of type float32 not ${a}.`)}const _=dU[y.dtype],E=n.slice(i,i+d*_),D="uint8"===y.dtype?new Uint8Array(E):new Uint16Array(E);if("float32"===a)if("uint8"===y.dtype||"uint16"===y.dtype){m=new Float32Array(D.length);for(let O=0;O<D.length;O++)m[O]=D[O]*y.scale+y.min}else{if("float16"!==y.dtype)throw new Error(`Unsupported quantization type ${y.dtype} for weight type float32.`);void 0===r&&(r=Ole()),m=r(D)}else{if("int32"!==a)throw new Error(`Unsupported dtype in weight '${o}': ${a}`);if("uint8"!==y.dtype&&"uint16"!==y.dtype)throw new Error(`Unsupported quantization type ${y.dtype} for weight type int32.`);m=new Int32Array(D.length);for(let O=0;O<D.length;O++)m[O]=Math.round(D[O]*y.scale+y.min)}i+=d*_}else if("string"===a){const y=Xt(s.shape);m=[];for(let _=0;_<y;_++){const E=new Uint32Array(n.slice(i,i+4))[0];i+=4;const D=new Uint8Array(n.slice(i,i+E));m.push(D),i+=E}}else{const y=dU[a],_=n.slice(i,i+d*y);if("float32"===a)m=new Float32Array(_);else if("int32"===a)m=new Int32Array(_);else if("bool"===a)m=new Uint8Array(_);else{if("complex64"!==a)throw new Error(`Unsupported dtype in weight '${o}': ${a}`);{m=new Float32Array(_);const E=new Float32Array(m.length/2),D=new Float32Array(m.length/2);for(let $=0;$<E.length;$++)E[$]=m[2*$],D[$]=m[2*$+1];const O=Vu(E,u,"float32"),R=Vu(D,u,"float32");e[o]=ed(O,R),O.dispose(),R.dispose()}}i+=d*y}"complex64"!==a&&(e[o]=Vu(m,u,a))}return e}function Ale(n){if(null===n)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let t=0;const e=[];n.forEach(s=>{if(t+=s.byteLength,e.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(t);let i=0;return e.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}const vU="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function K7(n){return vU?Buffer.byteLength(n):new Blob([n]).size}function wR(n){if(1===n.length)return n[0];let t=0;n.forEach(i=>{t+=i.byteLength});const e=new Uint8Array(t);let r=0;return n.forEach(i=>{e.set(new Uint8Array(i),r),r+=i.byteLength}),e.buffer}function X7(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const e=n.split("/");return e[e.length-1]}function Y7(n,t){const e={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:t};return null!=n.signature&&(e.signature=n.signature),null!=n.userDefinedMetadata&&(e.userDefinedMetadata=n.userDefinedMetadata),null!=n.modelInitializer&&(e.modelInitializer=n.modelInitializer),null!=n.initializerSignature&&(e.initializerSignature=n.initializerSignature),null!=n.trainingConfig&&(e.trainingConfig=n.trainingConfig),e}function yU(n,t,e){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(null!=n.trainingConfig&&(r.trainingConfig=n.trainingConfig),null!=n.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!e)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=e}return null!=n.signature&&(r.signature=n.signature),null!=n.userDefinedMetadata&&(r.userDefinedMetadata=n.userDefinedMetadata),null!=n.modelInitializer&&(r.modelInitializer=n.modelInitializer),null!=n.initializerSignature&&(r.initializerSignature=n.initializerSignature),r}function _U(n,t){return bU.apply(this,arguments)}function bU(){return(bU=(0,Nt.Z)(function*(n,t){let e,r;return null!=n.weightsManifest&&([e,r]=yield t(n.weightsManifest)),yU(n,e,r)})).apply(this,arguments)}function OS(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==n.modelTopology?0:K7(JSON.stringify(n.modelTopology)),weightSpecsBytes:null==n.weightSpecs?0:K7(JSON.stringify(n.weightSpecs)),weightDataBytes:null==n.weightData?0:n.weightData.byteLength}}function wU(n){const t=[];for(const e of n)t.push(...e.weights);return t}function Ole(){const n=function Mle(){const n=e=>{let r=e<<13,i=0;for(;0==(8388608&r);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},t=new Uint32Array(2048);t[0]=0;for(let e=1;e<1024;e++)t[e]=n(e);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function kle(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let t=1;t<31;t++)n[t]=t<<23;for(let t=33;t<63;t++)n[t]=2147483648+(t-32<<23);return n}(),e=function Rle(){const n=new Uint32Array(64);for(let t=0;t<64;t++)n[t]=1024;return n[0]=n[32]=0,n}();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let o=0;o<r.length;o++){const a=r[o];s[o]=n[e[a>>10]+(1023&a)]+t[a>>10]}return new Float32Array(i)}}class Ms{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Ms.instance&&(Ms.instance=new Ms),Ms.instance}static registerSaveRouter(t){Ms.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Ms.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Ms.getHandlers(t,"save")}static getLoadHandlers(t,e){return Ms.getHandlers(t,"load",e)}static getHandlers(t,e,r){const i=[];return("load"===e?Ms.getInstance().loadRouters:Ms.getInstance().saveRouters).forEach(o=>{const a=o(t,r);null!==a&&i.push(a)}),i}}const Fle=n=>Ms.registerSaveRouter(n),Ple=n=>Ms.registerLoadRouter(n),Q7=n=>Ms.getSaveHandlers(n),J7=(n,t)=>Ms.getLoadHandlers(n,t),xR="tensorflowjs",Yg="models_store",Bp="model_info_store";function SU(){if(!Ft().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n="undefined"==typeof window?self:window,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function EU(n){const t=n.result;t.createObjectStore(Yg,{keyPath:"modelPath"}),t.createObjectStore(Bp,{keyPath:"modelPath"})}let I0=(()=>{class n{constructor(e){if(this.indexedDB=SU(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}save(e){var r=this;return(0,Nt.Z)(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return r.databaseAction(r.modelPath,e)})()}load(){var e=this;return(0,Nt.Z)(function*(){return e.databaseAction(e.modelPath)})()}databaseAction(e,r){return new Promise((i,s)=>{const o=this.indexedDB.open(xR,1);o.onupgradeneeded=()=>EU(o),o.onsuccess=()=>{const a=o.result;if(null==r){const u=a.transaction(Yg,"readonly"),m=u.objectStore(Yg).get(this.modelPath);m.onsuccess=()=>{if(null==m.result)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));i(m.result.modelArtifacts)},m.onerror=y=>(a.close(),s(m.error)),u.oncomplete=()=>a.close()}else{const u=OS(r),d=a.transaction(Bp,"readwrite");let y,_,m=d.objectStore(Bp);try{y=m.put({modelPath:this.modelPath,modelArtifactsInfo:u})}catch(E){return s(E)}y.onsuccess=()=>{_=a.transaction(Yg,"readwrite");const E=_.objectStore(Yg);let D;try{D=E.put({modelPath:this.modelPath,modelArtifacts:r,modelArtifactsInfo:u})}catch(O){return s(O)}D.onsuccess=()=>i({modelArtifactsInfo:u}),D.onerror=O=>{m=d.objectStore(Bp);const R=m.delete(this.modelPath);R.onsuccess=()=>(a.close(),s(D.error)),R.onerror=$=>(a.close(),s(D.error))}},y.onerror=E=>(a.close(),s(y.error)),d.oncomplete=()=>{null==_?a.close():_.oncomplete=()=>a.close()}}},o.onerror=a=>s(o.error)})}}return n.URL_SCHEME="indexeddb://",n})();const eZ=n=>Ft().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(I0.URL_SCHEME)?function Lle(n){return new I0(n)}(n.slice(I0.URL_SCHEME.length)):null;Ms.registerSaveRouter(eZ),Ms.registerLoadRouter(eZ);class Ble{constructor(){this.indexedDB=SU()}listModels(){var t=this;return(0,Nt.Z)(function*(){return new Promise((e,r)=>{const i=t.indexedDB.open(xR,1);i.onupgradeneeded=()=>EU(i),i.onsuccess=()=>{const s=i.result,o=s.transaction(Bp,"readonly"),u=o.objectStore(Bp).getAll();u.onsuccess=()=>{const d={};for(const m of u.result)d[m.modelPath]=m.modelArtifactsInfo;e(d)},u.onerror=d=>(s.close(),r(u.error)),o.oncomplete=()=>s.close()},i.onerror=s=>r(i.error)})})()}removeModel(t){var e=this;return(0,Nt.Z)(function*(){return t=function $le(n){return n.startsWith(I0.URL_SCHEME)?n.slice(I0.URL_SCHEME.length):n}(t),new Promise((r,i)=>{const s=e.indexedDB.open(xR,1);s.onupgradeneeded=()=>EU(s),s.onsuccess=()=>{const o=s.result,a=o.transaction(Bp,"readwrite"),u=a.objectStore(Bp),d=u.get(t);let m;d.onsuccess=()=>{if(null==d.result)return o.close(),i(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const y=u.delete(t),_=()=>{m=o.transaction(Yg,"readwrite");const D=m.objectStore(Yg).delete(t);D.onsuccess=()=>r(d.result.modelArtifactsInfo),D.onerror=O=>i(d.error)};y.onsuccess=_,y.onerror=E=>(_(),o.close(),i(d.error))}},d.onerror=y=>(o.close(),i(d.error)),a.oncomplete=()=>{null==m?o.close():m.oncomplete=()=>o.close()}},s.onerror=o=>i(s.error)})})()}}const Bh="/",Qg="tensorflowjs_models",tZ="info",Vle="model_topology",zle="weight_specs",Ule="weight_data",Hle="model_metadata";function nZ(n){return{info:[Qg,n,tZ].join(Bh),topology:[Qg,n,Vle].join(Bh),weightSpecs:[Qg,n,zle].join(Bh),weightData:[Qg,n,Ule].join(Bh),modelMetadata:[Qg,n,Hle].join(Bh)}}function rZ(n){for(const t of Object.values(n))window.localStorage.removeItem(t)}function iZ(n){const t=n.split(Bh);if(t.length<3)throw new Error(`Invalid key format: ${n}`);return t.slice(1,t.length-1).join(Bh)}let D0=(()=>{class n{constructor(e){if(!Ft().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=nZ(this.modelPath)}save(e){var r=this;return(0,Nt.Z)(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const i=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),o=OS(e);try{return r.LS.setItem(r.keys.info,JSON.stringify(o)),r.LS.setItem(r.keys.topology,i),r.LS.setItem(r.keys.weightSpecs,s),r.LS.setItem(r.keys.weightData,function Ile(n){if(vU)return Buffer.from(n).toString("base64");const t=new Uint8Array(n);let e="";for(let r=0,i=t.length;r<i;r++)e+=String.fromCharCode(t[r]);return btoa(e)}(e.weightData)),r.LS.setItem(r.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,initializerSignature:null!=e.initializerSignature?e.initializerSignature:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0})),{modelArtifactsInfo:o}}catch(a){throw rZ(r.keys),new Error(`Failed to save model '${r.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${o.modelTopologyBytes}, weightSpecsBytes=${o.weightSpecsBytes}, weightDataBytes=${o.weightDataBytes}.`)}}})()}load(){var e=this;return(0,Nt.Z)(function*(){const r=JSON.parse(e.LS.getItem(e.keys.info));if(null==r)throw new Error(`In local storage, there is no model with name '${e.modelPath}'`);if("JSON"!==r.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const i={},s=JSON.parse(e.LS.getItem(e.keys.topology));if(null==s)throw new Error(`In local storage, the topology of model '${e.modelPath}' is missing.`);i.modelTopology=s;const o=JSON.parse(e.LS.getItem(e.keys.weightSpecs));if(null==o)throw new Error(`In local storage, the weight specs of model '${e.modelPath}' are missing.`);i.weightSpecs=o;const a=e.LS.getItem(e.keys.modelMetadata);if(null!=a){const d=JSON.parse(a);i.format=d.format,i.generatedBy=d.generatedBy,i.convertedBy=d.convertedBy,null!=d.signature&&(i.signature=d.signature),null!=d.userDefinedMetadata&&(i.userDefinedMetadata=d.userDefinedMetadata),null!=d.modelInitializer&&(i.modelInitializer=d.modelInitializer),null!=d.initializerSignature&&(i.initializerSignature=d.initializerSignature),null!=d.trainingConfig&&(i.trainingConfig=d.trainingConfig)}const u=e.LS.getItem(e.keys.weightData);if(null==u)throw new Error(`In local storage, the binary weight values of model '${e.modelPath}' are missing.`);return i.weightData=function Dle(n){if(vU){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const t=atob(n),e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e.set([t.charCodeAt(r)],r);return e.buffer}(u),i})()}}return n.URL_SCHEME="localstorage://",n})();const sZ=n=>Ft().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(D0.URL_SCHEME)?function Gle(n){return new D0(n)}(n.slice(D0.URL_SCHEME.length)):null;Ms.registerSaveRouter(sZ),Ms.registerLoadRouter(sZ);class jle{constructor(){De(Ft().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),De("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){var t=this;return(0,Nt.Z)(function*(){const e={},r=Qg+Bh,i=Bh+tZ;for(let s=0;s<t.LS.length;++s){const o=t.LS.key(s);o.startsWith(r)&&o.endsWith(i)&&(e[iZ(o)]=JSON.parse(t.LS.getItem(o)))}return e})()}removeModel(t){var e=this;return(0,Nt.Z)(function*(){const r=nZ(t=function Wle(n){return n.startsWith(D0.URL_SCHEME)?n.slice(D0.URL_SCHEME.length):n}(t));if(null==e.LS.getItem(r.info))throw new Error(`Cannot find model at path '${t}'`);const i=JSON.parse(e.LS.getItem(r.info));return rZ(r),i})()}}const M0="://";class qa{constructor(){this.managers={}}static getInstance(){return null==qa.instance&&(qa.instance=new qa),qa.instance}static registerManager(t,e){De(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(M0)&&(t=t.slice(0,t.indexOf(M0))),De(t.length>0,()=>"scheme must not be an empty string.");const r=qa.getInstance();De(null==r.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=e}static getManager(t){const e=qa.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(qa.getInstance().managers)}}function CR(n){if(-1===n.indexOf(M0))throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${qa.getSchemes().join(",")}`);return{scheme:n.split(M0)[0],path:n.split(M0)[1]}}function oZ(n,t){return NU.apply(this,arguments)}function NU(){return(NU=(0,Nt.Z)(function*(n,t,e=!1){De(n!==t,()=>`Old path and new path are the same: '${n}'`);const r=Ms.getLoadHandlers(n);De(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),De(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);const i=r[0],s=Ms.getSaveHandlers(t);De(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),De(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${t}.`);const o=s[0],a=CR(n).scheme,u=CR(n).path,d=a===CR(n).scheme,m=yield i.load();e&&d&&(yield qa.getManager(a).removeModel(u));const y=yield o.save(m);return e&&!d&&(yield qa.getManager(a).removeModel(u)),y.modelArtifactsInfo})).apply(this,arguments)}function qle(){return TU.apply(this,arguments)}function TU(){return(TU=(0,Nt.Z)(function*(){const n=qa.getSchemes(),t={};for(const e of n){const r=yield qa.getManager(e).listModels();for(const i in r)t[e+M0+i]=r[i]}return t})).apply(this,arguments)}function Zle(n){return AU.apply(this,arguments)}function AU(){return(AU=(0,Nt.Z)(function*(n){const t=CR(n);return qa.getManager(t.scheme).removeModel(t.path)})).apply(this,arguments)}function Kle(n,t){return IU.apply(this,arguments)}function IU(){return(IU=(0,Nt.Z)(function*(n,t){return oZ(n,t,!1)})).apply(this,arguments)}function Xle(n,t){return DU.apply(this,arguments)}function DU(){return(DU=(0,Nt.Z)(function*(n,t){return oZ(n,t,!0)})).apply(this,arguments)}class Yle{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){"undefined"!=typeof window&&Ft().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{r.source===window&&r.data.name===this.messageName&&(r.stopPropagation(),this.functionRefs[r.data.index](),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))},!0))):setTimeout(t,e)}isTypedArray(t){return M7(t)}}if(Ft().get("IS_BROWSER")){Ft().setPlatform("browser",new Yle);try{qa.registerManager(D0.URL_SCHEME,new jle)}catch(n){}try{qa.registerManager(I0.URL_SCHEME,new Ble)}catch(n){}}let k0;function Zr(n,t="float32",e){return t=t||"float32",Bu(n),new po(n,t,e)}Ft().get("IS_NODE")&&!Ft().get("IS_BROWSER")&&Ft().setPlatform("node",new class Jle{constructor(){this.util=z(8628),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=Ft().global.fetch?Ft().global.fetch(t,e):(null==k0&&(k0=z(5410)),k0(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}});const Fn=ut({cast_:function ece(n,t){const e=Le(n,"x","cast");if(!b7(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==e.dtype||"string"!==t&&"string"===e.dtype)throw new Error("Only strings can be casted to strings");return ot.runKernel($_,{x:e},{dtype:t})}}),Vh=ut({clone_:function tce(n){const e={x:Le(n,"x","clone","string_or_numeric")};return ot.runKernel(Y_,e)}});function MU(n,t=!1){console.log(n.toString(t))}function nce(){Ft().set("PROD",!0)}function rce(){Ft().set("DEBUG",!0)}function ice(){Ft().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function aZ(n){Ft().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function sce(){ot.disposeVariables()}function jc(){return ot}function SR(){return ot.memory()}function oce(n){return ot.profile(n)}function Ot(n,t){return ot.tidy(n,t)}function Or(n){Jf(n).forEach(e=>e.dispose())}function Ao(n){return ot.keep(n)}function ace(n){return ot.time(n)}function uce(n){return ot.setBackend(n)}function lce(){return ot.ready()}function cce(){return ot.backendName}function hce(n){ot.removeBackend(n)}function fce(n){return ot.findBackend(n)}function dce(n){return ot.findBackendFactory(n)}function kU(n,t,e=1){return ot.registerBackend(n,t,e)}function uZ(){return ot.backend}function pce(n,t){Ft().setPlatform(n,t)}j7(),function yle(n){A0=n}({buffer:Zr,cast:Fn,clone:Vh,print:MU}),function _le(n){V7=n}(aZ);const _n=ut({add_:function mce(n,t){let e=Le(n,"a","add"),r=Le(t,"b","add");return[e,r]=Ds(e,r),ot.runKernel(qg,{a:e,b:r})}}),ER=ut({floorDiv_:function gce(n,t){let e=Le(n,"a","floorDiv"),r=Le(t,"b","floorDiv");return[e,r]=Ds(e,r),ot.runKernel(K_,{a:e,b:r})}}),nr=ut({div_:function vce(n,t){let e=Le(n,"a","div"),r=Le(t,"b","div");return[e,r]=Ds(e,r),"int32"===e.dtype&&"int32"===r.dtype?ER(e,r):ot.runKernel(H_,{a:e,b:r},{})}}),vt=ut({mul_:function yce(n,t){let e=Le(n,"a","mul"),r=Le(t,"b","mul");return[e,r]=Ds(e,r),ot.runKernel(a0,{a:e,b:r})}}),ua=ut({sqrt_:function _ce(n){const e={x:Le(n,"x","sqrt","float32")};return ot.runKernel(b0,e)}}),Zi=ut({square_:function bce(n){const t=Le(n,"x","square");return ot.runKernel("Square",{x:t},{})}}),ai=ut({zerosLike_:function wce(n){const e={x:Le(n,"x","zerosLike")};return ot.runKernel(CS,e)}});function xce(n){return De(Fp(n),()=>"The f passed in grad(f) must be a function"),(t,e)=>{const r=Le(t,"x","tf.grad","string_or_numeric"),i=null!=e?Le(e,"dy","tf.grad"):null;return ot.tidy(()=>{const{value:s,grads:o}=ot.gradients(()=>n(r),[r],i);return null!=i&&sa(s.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),NR(o),o[0]})}}function Cce(n){return De(Fp(n),()=>"The f passed in grads(f) must be a function"),(t,e)=>{De(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=RS(t,"args","tf.grads","string_or_numeric"),i=null!=e?Le(e,"dy","tf.grads"):null;return ot.tidy(()=>{const{value:s,grads:o}=ot.gradients(()=>n(...r),r,i);return null!=i&&sa(s.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),NR(o),o})}}function Sce(n){return De(Fp(n),()=>"The f passed in valueAndGrad(f) must be a function"),(t,e)=>{De(t instanceof yi,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),De(null==e||e instanceof yi,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:i}=ot.gradients(()=>n(t),[t],e);return NR(r),{grad:r[0],value:i}}}function Ece(n){return De(Fp(n),()=>"The f passed in valueAndGrads(f) must be a function"),(t,e)=>{De(Array.isArray(t)&&t.every(i=>i instanceof yi),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),De(null==e||e instanceof yi,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=ot.gradients(()=>n(...t),t,e);return null!=e&&sa(r.value.shape,e.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),NR(r.grads),r}}function lZ(n,t){De(Fp(n),()=>"The f passed in variableGrads(f) must be a function"),De(null==t||Array.isArray(t)&&t.every(d=>d instanceof kS),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const e=null!=t;if(!e){t=[];for(const d in ot.registeredVariables)t.push(ot.registeredVariables[d])}const r=e?t.filter(d=>!d.trainable):null,i=t.length;De((t=t.filter(d=>d.trainable)).length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const{value:o,grads:a}=ot.gradients(n,t,null,!0);De(a.some(d=>null!=d),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),De(0===o.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const u={};return t.forEach((d,m)=>{null!=a[m]&&(u[d.name]=a[m])}),null!=r&&r.forEach(d=>u[d.name]=null),{value:o,grads:u}}function zh(n){return ot.customGrad(n)}function NR(n){if(n.filter(e=>null==e).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}function hr(n,t){if((jo(n)&&"string"!==t||Array.isArray(n))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&jo(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return $p(n,[],[],t)}class Jg{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class bl{constructor(){this.classNameMap={}}static getMap(){return null==bl.instance&&(bl.instance=new bl),bl.instance}static register(t){bl.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Nn(n){De(null!=n.className,()=>"Class being registered does not have the static className property defined."),De("string"==typeof n.className,()=>"className is required to be a string, but got type "+typeof n.className),De(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),bl.register(n)}class td extends Jg{minimize(t,e=!1,r){const{value:i,grads:s}=this.computeGradients(t,r);if(null!=r){const o=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(o)}else this.applyGradients(s);return Or(s),e?i:(i.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return lZ(t,e)}dispose(){null!=this.iterations_&&Or(this.iterations_)}saveIterations(){var t=this;return(0,Nt.Z)(function*(){return null==t.iterations_&&(t.iterations_=0),{name:"iter",tensor:hr(t.iterations_,"int32")}})()}getWeights(){return(0,Nt.Z)(function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})()}setWeights(t){var e=this;return(0,Nt.Z)(function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${e.getClassName()}`)})()}extractIterations(t){var e=this;return(0,Nt.Z)(function*(){return e.iterations_=(yield t[0].tensor.data())[0],t.slice(1)})()}}Object.defineProperty(td,Symbol.hasInstance,{value:n=>null!=n.minimize&&null!=n.computeGradients&&null!=n.applyGradients});class RU extends td{static get className(){return"Adadelta"}constructor(t,e,r=null){super(),this.learningRate=t,this.rho=e,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==r&&(this.epsilon=ot.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ot.registeredVariables[r];null==this.accumulatedGrads[i]&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:Ot(()=>ai(s).variable(!1))}),null==this.accumulatedUpdates[i]&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:Ot(()=>ai(s).variable(!1))});const a=Array.isArray(t)?t[i].tensor:t[r];if(null==a)return;const u=this.accumulatedGrads[i].variable,d=this.accumulatedUpdates[i].variable;Ot(()=>{const m=_n(vt(u,this.rho),vt(Zi(a),1-this.rho)),y=vt(nr(ua(_n(d,this.epsilon)),ua(_n(u,this.epsilon))),a),_=_n(vt(d,this.rho),vt(Zi(y),1-this.rho));u.assign(m),d.assign(_);const E=_n(vt(y,-this.learningRate),s);s.assign(E)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Or(this.accumulatedGrads.map(t=>t.variable)),Or(this.accumulatedUpdates.map(t=>t.variable)))}getWeights(){var t=this;return(0,Nt.Z)(function*(){const e=[...t.accumulatedGrads,...t.accumulatedUpdates];return[yield t.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})()}setWeights(t){var e=this;return(0,Nt.Z)(function*(){const r=(t=yield e.extractIterations(t)).length/2;e.accumulatedGrads=t.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)})),e.accumulatedUpdates=t.slice(r,2*r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}function ev(n,t,e){return Bu(n),e=e||Gg(t),ot.runKernel(C2,{},{shape:n,value:t,dtype:e})}class OU extends td{static get className(){return"Adagrad"}constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ot.registeredVariables[r];null==this.accumulatedGrads[i]&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:Ot(()=>ev(s.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[i].tensor:t[r];if(null==o)return;const a=this.accumulatedGrads[i].variable;Ot(()=>{const u=_n(a,Zi(o));a.assign(u);const d=_n(vt(nr(o,ua(_n(u,ot.backend.epsilon()))),-this.learningRate),s);s.assign(d)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Or(this.accumulatedGrads.map(t=>t.variable))}getWeights(){var t=this;return(0,Nt.Z)(function*(){return[yield t.saveIterations()].concat(t.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))})()}setWeights(t){var e=this;return(0,Nt.Z)(function*(){t=yield e.extractIterations(t),e.accumulatedGrads=t.map(i=>({originalName:i.name,variable:i.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}const nd=ut({pow_:function Nce(n,t){let e=Le(n,"base","pow"),r=Le(t,"exp","pow");return[e,r]=Ds(e,r),ot.runKernel(u0,{a:e,b:r})}}),qn=ut({sub_:function Tce(n,t){let e=Le(n,"a","sub"),r=Le(t,"b","sub");return[e,r]=Ds(e,r),ot.runKernel(x0,{a:e,b:r})}});class FU extends td{static get className(){return"Adam"}constructor(t,e,r,i=null){super(),this.learningRate=t,this.beta1=e,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ot(()=>{this.accBeta1=hr(e).variable(),this.accBeta2=hr(r).variable()}),null==i&&(this.epsilon=ot.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);Ot(()=>{const r=qn(1,this.accBeta1),i=qn(1,this.accBeta2);e.forEach((s,o)=>{const a=ot.registeredVariables[s];null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:Ot(()=>ai(a).variable(!1))}),null==this.accumulatedSecondMoment[o]&&(this.accumulatedSecondMoment[o]={originalName:`${s}/v`,variable:Ot(()=>ai(a).variable(!1))});const d=Array.isArray(t)?t[o].tensor:t[s];if(null==d)return;const m=this.accumulatedFirstMoment[o].variable,y=this.accumulatedSecondMoment[o].variable,_=_n(vt(m,this.beta1),vt(d,1-this.beta1)),E=_n(vt(y,this.beta2),vt(Zi(d),1-this.beta2)),D=nr(_,r),O=nr(E,i);m.assign(_),y.assign(E);const R=_n(vt(nr(D,_n(ua(O),this.epsilon)),-this.learningRate),a);a.assign(R)}),this.accBeta1.assign(vt(this.accBeta1,this.beta1)),this.accBeta2.assign(vt(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Or(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&Or(this.accumulatedSecondMoment.map(t=>t.variable))}getWeights(){var t=this;return(0,Nt.Z)(function*(){const e=[...t.accumulatedFirstMoment,...t.accumulatedSecondMoment];return[yield t.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})()}setWeights(t){var e=this;return(0,Nt.Z)(function*(){t=yield e.extractIterations(t),Ot(()=>{e.accBeta1.assign(nd(e.beta1,e.iterations_+1)),e.accBeta2.assign(nd(e.beta2,e.iterations_+1))});const r=t.length/2;e.accumulatedFirstMoment=t.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)})),e.accumulatedSecondMoment=t.slice(r,2*r).map(s=>({originalName:s.name,variable:s.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}const mo=ut({abs_:function Ace(n){const t=Le(n,"x","abs");return ot.runKernel("complex64"===t.dtype?DC:xC,{x:t})}});function tv(n,t){const e=n.length,r=[];for(let i=0;i<e;i++){const s=e-1-i,o=n[s]||1;(t[t.length-1-i]||1)>1&&1===o&&r.unshift(s)}return r}function go(n,t){const e=[];for(let r=0;r<t.length;r++){const i=n[n.length-r-1],s=t.length-r-1,o=t[s];(null==i||1===i&&o>1)&&e.unshift(s)}return e}function Fr(n,t){const e=Math.max(n.length,t.length),r=new Array(e);for(let i=0;i<e;i++){let s=n[n.length-i-1];null==s&&(s=1);let o=t[t.length-i-1];if(null==o&&(o=1),1===s)r[e-i-1]=o;else if(1===o)r[e-i-1]=s;else{if(s!==o)throw Error(`Operands could not be broadcast together with shapes ${n} and ${t}.`);r[e-i-1]=s}}return r}const Uh=ut({maximum_:function Ice(n,t){let e=Le(n,"a","maximum"),r=Le(t,"b","maximum");return[e,r]=Ds(e,r),"bool"===e.dtype&&(e=Fn(e,"int32"),r=Fn(r,"int32")),Fr(e.shape,r.shape),ot.runKernel(r0,{a:e,b:r})}});class PU extends td{static get className(){return"Adamax"}constructor(t,e,r,i=null,s=0){super(),this.learningRate=t,this.beta1=e,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ot(()=>{this.iteration=hr(0).variable(),this.accBeta1=hr(e).variable()}),null==i&&(this.epsilon=ot.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(r=>r.name):Object.keys(t);Ot(()=>{const r=qn(1,this.accBeta1),i=nr(-this.learningRate,_n(vt(this.iteration,this.decay),1));e.forEach((s,o)=>{const a=ot.registeredVariables[s];null==this.accumulatedFirstMoment[o]&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:ai(a).variable(!1)}),null==this.accumulatedWeightedInfNorm[o]&&(this.accumulatedWeightedInfNorm[o]={originalName:`${s}/v`,variable:ai(a).variable(!1)});const d=Array.isArray(t)?t[o].tensor:t[s];if(null==d)return;const m=this.accumulatedFirstMoment[o].variable,y=this.accumulatedWeightedInfNorm[o].variable,_=_n(vt(m,this.beta1),vt(d,1-this.beta1)),E=vt(y,this.beta2),D=mo(d),O=Uh(E,D);m.assign(_),y.assign(O);const R=_n(vt(nr(i,r),nr(_,_n(O,this.epsilon))),a);a.assign(R)}),this.iteration.assign(_n(this.iteration,1)),this.accBeta1.assign(vt(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Or(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&Or(this.accumulatedWeightedInfNorm.map(t=>t.variable))}getWeights(){return(0,Nt.Z)(function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})()}setWeights(t){return(0,Nt.Z)(function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})()}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}class TR extends td{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=Array.isArray(t)?t[i].tensor:t[r];if(null==s)return;const o=ot.registeredVariables[r];Ot(()=>{const a=_n(vt(this.c,s),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Ao(hr(-t))}dispose(){this.c.dispose()}getWeights(){var t=this;return(0,Nt.Z)(function*(){return[yield t.saveIterations()]})()}setWeights(t){var e=this;return(0,Nt.Z)(function*(){if(0!==(t=yield e.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")})()}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}class LU extends TR{static get className(){return"Momentum"}constructor(t,e,r=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=r,this.accumulations=[],this.m=hr(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ot.registeredVariables[r];null==this.accumulations[i]&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:Ot(()=>ai(s).variable(!1))});const o=this.accumulations[i].variable,a=Array.isArray(t)?t[i].tensor:t[r];null!=a&&Ot(()=>{let u;const d=_n(vt(this.m,o),a);u=_n(vt(this.c,this.useNesterov?_n(a,vt(d,this.m)):d),s),o.assign(d),s.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Or(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}getWeights(){var t=this;return(0,Nt.Z)(function*(){return[yield t.saveIterations()].concat(t.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))})()}setWeights(t){var e=this;return(0,Nt.Z)(function*(){t=yield e.extractIterations(t),e.accumulations=t.map(i=>({originalName:i.name,variable:i.tensor.variable(!1)}))})()}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}class $U extends td{static get className(){return"RMSProp"}constructor(t,e=.9,r=0,i=null,s=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,null==i&&(this.epsilon=ot.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(r=>r.name):Object.keys(t)).forEach((r,i)=>{const s=ot.registeredVariables[r],o=!1;null==this.accumulatedMeanSquares[i]&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:Ot(()=>ai(s).variable(o))}),null==this.accumulatedMoments[i]&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:Ot(()=>ai(s).variable(o))}),null==this.accumulatedMeanGrads[i]&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:Ot(()=>ai(s).variable(o))});const a=Array.isArray(t)?t[i].tensor:t[r];if(null==a)return;const u=this.accumulatedMeanSquares[i].variable,d=this.accumulatedMoments[i].variable;Ot(()=>{const m=_n(vt(u,this.decay),vt(Zi(a),1-this.decay));if(this.centered){const y=this.accumulatedMeanGrads[i].variable,_=_n(vt(y,this.decay),vt(a,1-this.decay)),E=nr(vt(a,this.learningRate),ua(qn(m,_n(Zi(_),this.epsilon)))),D=_n(vt(d,this.momentum),E);u.assign(m),y.assign(_),d.assign(D);const O=qn(s,D);s.assign(O)}else{const y=_n(vt(u,this.decay),vt(Zi(a),1-this.decay)),_=_n(vt(d,this.momentum),nr(vt(a,this.learningRate),ua(_n(y,this.epsilon))));u.assign(y),d.assign(_);const E=qn(s,_);s.assign(E)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Or(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&Or(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&Or(this.accumulatedMoments.map(t=>t.variable))}getWeights(){var t=this;return(0,Nt.Z)(function*(){const e=[...t.accumulatedMeanSquares,...t.accumulatedMoments];return t.centered&&e.push(...t.accumulatedMeanGrads),[yield t.saveIterations()].concat(e.map(r=>({name:r.originalName,tensor:r.variable})))})()}setWeights(t){var e=this;return(0,Nt.Z)(function*(){t=yield e.extractIterations(t);const r=e.centered?t.length/3:t.length/2,i=!1;e.accumulatedMeanSquares=t.slice(0,r).map(s=>({originalName:s.name,variable:s.tensor.variable(i)})),e.accumulatedMoments=t.slice(r,2*r).map(s=>({originalName:s.name,variable:s.tensor.variable(i)})),e.centered&&(e.accumulatedMeanGrads=t.slice(2*r,3*r).map(s=>({originalName:s.name,variable:s.tensor.variable(i)})))})()}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}const Dce=[RU,OU,FU,PU,LU,$U,TR];function cZ(n){return new Promise(t=>setTimeout(t)).then(n)}let BU=(()=>{class n{constructor(e){if(!Ft().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(n.URL_SCHEME)&&(e=e.slice(n.URL_SCHEME.length)),(null==e||0===e.length)&&(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}save(e){var r=this;return(0,Nt.Z)(function*(){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const i=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const o=Y7(e,[{paths:["./"+r.weightDataFileName],weights:e.weightSpecs}]),a=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),u=null==r.modelJsonAnchor?document.createElement("a"):r.modelJsonAnchor;if(u.download=r.modelJsonFileName,u.href=a,yield cZ(()=>u.dispatchEvent(new MouseEvent("click"))),null!=e.weightData){const d=null==r.weightDataAnchor?document.createElement("a"):r.weightDataAnchor;d.download=r.weightDataFileName,d.href=i,yield cZ(()=>d.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:OS(e)}}})()}}return n.URL_SCHEME="downloads://",n})();class Fce{constructor(t){if(null==t||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}load(){var t=this;return(0,Nt.Z)(function*(){return new Promise((e,r)=>{const i=new FileReader;i.onload=s=>{const o=JSON.parse(s.target.result),a=o.modelTopology;if(null==a)return void r(new Error(`modelTopology field is missing from file ${t.jsonFile.name}`));if(null==o.weightsManifest)return void r(new Error(`weightManifest field is missing from file ${t.jsonFile.name}`));if(0===t.weightsFiles.length)return void e({modelTopology:a});const d=_U(o,m=>t.loadWeights(m));e(d)},i.onerror=s=>r(`Failed to read model topology and weights manifest JSON from file '${t.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),i.readAsText(t.jsonFile)})})()}loadWeights(t){const e=[],r=[];for(const o of t)e.push(...o.weights),r.push(...o.paths);const i=this.checkManifestAndWeightFiles(t),s=r.map(o=>this.loadWeightsFile(o,i[o]));return Promise.all(s).then(o=>[e,wR(o)])}loadWeightsFile(t,e){return new Promise((r,i)=>{const s=new FileReader;s.onload=o=>{r(o.target.result)},s.onerror=o=>i(`Failed to weights data from file of path '${t}'.`),s.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(t){const e=[],r=this.weightsFiles.map(s=>X7(s.name)),i={};for(const s of t)s.paths.forEach(o=>{const a=X7(o);if(-1!==e.indexOf(a))throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(e.push(a),-1===r.indexOf(a))throw new Error(`Weight file with basename '${a}' is not provided.`);i[o]=this.weightsFiles[r.indexOf(a)]});if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}function $ce(n){return new Fce(n)}function hZ(n,t,e,r){(function o(u){De(null!=u&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")})(n),function a(u,d){De(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),De(d>=0&&d<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${d}`),De(d>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${d}`)}(e=null==e?0:e,r=null==r?1:r);let i=0;return Promise.all(n.map(u=>(u.then(d=>{const m=e+ ++i/n.length*(r-e);return t(m),d}),u)))}function fZ(n,t){return VU.apply(this,arguments)}function VU(){return(VU=(0,Nt.Z)(function*(n,t){null==t&&(t={});const e=null==t.fetchFunc?Ft().platform.fetch:t.fetchFunc,r=n.map(y=>e(y,t.requestInit,{isBinary:!0})),a=(null==t.onProgress?yield Promise.all(r):yield hZ(r,t.onProgress,0,.5)).map(y=>y.arrayBuffer());return null==t.onProgress?yield Promise.all(a):yield hZ(a,t.onProgress,.5,1)})).apply(this,arguments)}function dZ(n){return zU.apply(this,arguments)}function zU(){return(zU=(0,Nt.Z)(function*(n,t="",e,r){return pZ(o=>fZ(o,{requestInit:r}))(n,t,e)})).apply(this,arguments)}function pZ(n){return function(){var t=(0,Nt.Z)(function*(e,r="",i){const s=e.map(()=>!1),o={},a=null!=i?i.map(()=>!1):[],u=[];if(e.forEach((D,O)=>{let R=0;D.weights.forEach($=>{const Q=dU["quantization"in $?$.quantization.dtype:$.dtype]*Xt($.shape),ie=()=>{s[O]=!0,null==o[O]&&(o[O]=[]),o[O].push({manifestEntry:$,groupOffset:R,sizeBytes:Q})};null!=i?i.forEach((ye,Me)=>{ye===$.name&&(ie(),a[Me]=!0)}):ie(),u.push($.name),R+=Q})}),!a.every(D=>D)){const D=i.filter((O,R)=>!a[R]);throw new Error(`Could not find weights in manifest with names: ${D.join(", ")}. \nManifest JSON has weights with names: ${u.join(", ")}.`)}const d=s.reduce((D,O,R)=>(O&&D.push(R),D),[]),m=[];d.forEach(D=>{e[D].paths.forEach(O=>{const R=r+(r.endsWith("/")?"":"/")+O;m.push(R)})});const y=yield n(m),_={};let E=0;return d.forEach(D=>{const O=e[D].paths.length;let R=0;for(let ye=0;ye<O;ye++)R+=y[E+ye].byteLength;const $=new ArrayBuffer(R),B=new Uint8Array($);let Q=0;for(let ye=0;ye<O;ye++){const Me=new Uint8Array(y[E+ye]);B.set(Me,Q),Q+=Me.byteLength}o[D].forEach(ye=>{const Be=gU($.slice(ye.groupOffset,ye.groupOffset+ye.sizeBytes),[ye.manifestEntry]);for(const He in Be)_[He]=Be[He]}),E+=O}),_});return function(e){return t.apply(this,arguments)}}()}Ms.registerSaveRouter(n=>Ft().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(BU.URL_SCHEME)?function Lce(n="model"){return new BU(n)}(n.slice(BU.URL_SCHEME.length)):null);let mZ=(()=>{class n{constructor(e,r){if(this.DEFAULT_METHOD="POST",null==r&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.onProgress=r.onProgress,this.weightUrlConverter=r.weightUrlConverter,null!=r.fetchFunc?(De("function"==typeof r.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=r.fetchFunc):this.fetch=Ft().platform.fetch,De(null!=e&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&De(2===e.length,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,null!=r.requestInit&&null!=r.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{}}save(e){var r=this;return(0,Nt.Z)(function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const i=Object.assign({method:r.DEFAULT_METHOD},r.requestInit);i.body=new FormData;const o=Y7(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);i.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),null!=e.weightData&&i.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin");const a=yield r.fetch(r.path,i);if(a.ok)return{modelArtifactsInfo:OS(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)})()}load(){var e=this;return(0,Nt.Z)(function*(){const r=yield e.fetch(e.path,e.requestInit);if(!r.ok)throw new Error(`Request to ${e.path} failed with status code ${r.status}. Please verify this URL points to the model JSON of the model to load.`);let i;try{i=yield r.json()}catch(a){let u=`Failed to parse model JSON of response from ${e.path}.`;throw e.path.endsWith(".pb")?u+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":u+=" Please make sure the server is serving valid JSON for this request.",new Error(u)}if(null==i.modelTopology&&null==i.weightsManifest)throw new Error(`The JSON from HTTP path ${e.path} contains neither model topology or manifest for weights.`);return _U(i,a=>e.loadWeights(a))})()}loadWeights(e){var r=this;return(0,Nt.Z)(function*(){const i=Array.isArray(r.path)?r.path[1]:r.path,[s,o]=function zce(n){const t=n.lastIndexOf("/"),e=n.lastIndexOf("?");return[n.substring(0,t)+"/",e>t?n.substring(e):""]}(i),a=r.weightPathPrefix||s,u=wU(e),d=[],m=[];for(const _ of e)for(const E of _.paths)null!=r.weightUrlConverter?m.push(r.weightUrlConverter(E)):d.push(a+E+o);return r.weightUrlConverter&&d.push(...yield Promise.all(m)),[u,wR(yield fZ(d,{requestInit:r.requestInit,fetchFunc:r.fetch,onProgress:r.onProgress}))]})()}}return n.URL_SCHEME_REGEX=/^https?:\/\//,n})();function UU(n){return null!=n.match(mZ.URL_SCHEME_REGEX)}const gZ=(n,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let e=!0;if(e=Array.isArray(n)?n.every(r=>UU(r)):UU(n),e)return HU(n,t)}return null};function HU(n,t){return new mZ(n,t)}function vZ(n,t){return HU(n,t)}Ms.registerSaveRouter(gZ),Ms.registerLoadRouter(gZ);class WU{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class yZ{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class Uce{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function Hce(n,t,e,r){const i=arguments;return new Uce(AR(...i))}function AR(n,t,e,r){return 1===arguments.length?null!=n.modelTopology||null!=n.weightSpecs?new WU(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new WU({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new WU({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:r}))}function Wce(n){return new yZ(n)}function Gce(n){return new yZ(n)}const Qr=ut({matMul_:function jce(n,t,e=!1,r=!1){let i=Le(n,"a","matMul"),s=Le(t,"b","matMul");return[i,s]=Ds(i,s),ot.runKernel(AC,{a:i,b:s},{transposeA:e,transposeB:r})}}),R0=ut({oneHot_:function qce(n,t,e=1,r=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:Le(n,"indices","oneHot","int32")};return ot.runKernel(sS,o,{dtype:i,depth:t,onValue:e,offValue:r})}}),FS=ut({imag_:function Zce(n){const e={input:Le(n,"input","imag")};return ot.runKernel(T2,e)}}),ss=ut({neg_:function Kce(n){const e={x:Le(n,"x","neg")};return ot.runKernel(nS,e)}}),O0=ut({real_:function Xce(n){const e={input:Le(n,"input","real")};return ot.runKernel(z2,e)}}),ii=ut({transpose_:function Yce(n,t,e){const r=Le(n,"x","transpose");if(null==t&&(t=r.shape.map((o,a)=>a).reverse()),De(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(o=>{De(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:t};return"complex64"===r.dtype?Ot(()=>{let o=O0(r),a=FS(r);return o=ot.runKernel(Zg,{x:o},s),a=ot.runKernel(Zg,{x:a},s),e&&(a=ss(a)),ed(o,a)}):ot.runKernel(Zg,i,s)}}),Jce=ut({confusionMatrix_:function Qce(n,t,e){const r=Le(n,"labels","confusionMatrix"),i=Le(t,"predictions","confusionMatrix");De(null==e||e>0&&Number.isInteger(e),()=>`If provided, numClasses must be a positive integer, but got ${e}`),De(1===r.rank,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),De(1===i.rank,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),De(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),De(e>0&&Number.isInteger(e),()=>`numClasses is required to be a positive integer, but got ${e}`);const s=R0(Fn(r,"int32"),e),o=R0(Fn(i,"int32"),e),a=ii(s),u=Qr(a,o);return Fn(u,"int32")}});function GU(n,t,e){if(Ug(n),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=$h(n,e);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return $p(n,t,r,e)}let nv;function _Z(n,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==n)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let e=!1,r=!1,i=!1,s=!1,o=!1,a=!1;if(n.data instanceof Uint8Array)e=!0;else if("undefined"!=typeof ImageData&&n instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement)s=!0;else if(null!=n.getContext)o=!0;else{if(!("undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);a=!0}if(null!=uR(oR,ot.backendName))return ot.runKernel(oR,{pixels:n},{numChannels:t});const[d,m]=i?[n.videoWidth,n.videoHeight]:[n.width,n.height];let y,_;if(o)y=n.getContext("2d").getImageData(0,0,d,m).data;else if(r||e)y=n.data;else if(s||i||a){if(null==nv)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");nv=new OffscreenCanvas(1,1).getContext("2d")}else nv=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});nv.canvas.width=d,nv.canvas.height=m,nv.drawImage(n,0,0,d,m),y=nv.getImageData(0,0,d,m).data}if(4===t)_=new Int32Array(y);else{const D=d*m;_=new Int32Array(D*t);for(let O=0;O<D;O++)for(let R=0;R<t;++R)_[O*t+R]=y[4*O+R]}return GU(_,[m,d,t],"int32")}function rhe(n){return function the(){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")}()&&!(n instanceof ImageBitmap)&&function nhe(n){return null!=n&&0!==n.width&&0!==n.height}(n)&&!function ehe(n){return null!=n&&n.data instanceof Uint8Array}(n)}function ihe(n){return jU.apply(this,arguments)}function jU(){return(jU=(0,Nt.Z)(function*(n,t=3){let e=null;if(Ft().getBool("WRAP_TO_IMAGEBITMAP")&&rhe(n)){let r;try{r=yield createImageBitmap(n,{premultiplyAlpha:"none"})}catch(i){r=null}e=null!=r&&r.width===n.width&&r.height===n.height?r:n}else e=n;return _Z(e,t)})).apply(this,arguments)}function she(n,t){return qU.apply(this,arguments)}function qU(){return(qU=(0,Nt.Z)(function*(n,t){let e=Le(n,"img","toPixels");if(!(n instanceof yi)){const d=e;e=Fn(d,"int32"),d.dispose()}if(2!==e.rank&&3!==e.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const[r,i]=e.shape.slice(0,2),s=2===e.rank?1:e.shape[2];if(s>4||2===s)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${s}`);if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`);const o=yield e.data(),a="float32"===e.dtype?255:1,u=new Uint8ClampedArray(i*r*4);for(let d=0;d<r*i;++d){const m=[0,0,0,255];for(let _=0;_<s;_++){const E=o[d*s+_];if("float32"===e.dtype){if(E<0||E>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${E}.`)}else if("int32"===e.dtype&&(E<0||E>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${E}.`);1===s?(m[0]=E*a,m[1]=E*a,m[2]=E*a):m[_]=E*a}const y=4*d;u[y+0]=Math.round(m[0]),u[y+1]=Math.round(m[1]),u[y+2]=Math.round(m[2]),u[y+3]=Math.round(m[3])}if(null!=t){t.width=i,t.height=r;const d=t.getContext("2d"),m=new ImageData(u,i,r);d.putImageData(m,0,0)}return e!==n&&e.dispose(),u})).apply(this,arguments)}const bZ=ut({fromPixels_:_Z});function IR(n,t){const e=n.shape.length,r=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${e}`);if(0===Xt(n.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const i=t.shape,s=i[i.length-1];let o=1;for(let y=0;y<i.length-1;++y)o*=i[y];const a=n.shape,u=i.slice();u.pop();let d=1;for(let y=s;y<e;++y)d*=a[y],u.push(a[y]);const m=[...ur(n.shape).map(y=>y/d),1].slice(0,s);return[u,o,d,m]}function ZU(n,t,e){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${t.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${i}.`;if(e.rank<i)throw new Error(s+` update.rank < ${i}. `);if(n.length<r+(e.rank-i))throw new Error(s+` Output shape length < ${r+(e.rank-i)}`);if(e.rank!==i+n.length-r)throw new Error(s+" update.rank != "+(i+n.length-r));for(let o=0;o<i;++o)if(e.shape[o]!==t.shape[o])throw new Error(s+` updates.shape[${o}] (${e.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<e.rank-i;++o)if(e.shape[o+i]!==n[o+r])throw new Error(s+` updates.shape[${o+i}] (${e.shape[o+i]}) != shape[${o+i}] (${n[o+i]})`)}function DR(n,t,e){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(0===e.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===n.size)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}ZU(e,t,n)}function Vp(n,t,e){const r=t.shape.length,i=r>1?t.shape[r-1]:1,s=e.length;let o=1;for(let y=i;y<s;++y)o*=e[y];const a=i<1?1:i;return{sliceRank:i,numUpdates:Xt(t.shape)/a,sliceSize:o,strides:[...ur(e.slice(0,i)),1],outputSize:Xt(e)}}function XU(n,t,e){const r=n.shape.length;De(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),De(r===e.length,()=>`Error in slice${r}D: Length of size ${e} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)De(t[i]+e[i]<=n.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+e[i]}) would overflow input.shape[${i}] (${n.shape[i]})`)}function ahe(n){const t=[];let e=0;for(;n>0;)1&n&&t.push(e),n/=2,e++;return t}function YU(n,t,e){const r=[];for(let i=0;i<n.length;i++)r[i]=Math.ceil((t[i]-n[i])/e[i]);return r}function wZ(n,t,e,r){const i=[...n];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<e;s++)0===s?i[t]=1:(i.splice(t,0,1),i.pop());return i}function xZ(n,t,e){return e<=n?e:e-(t-1)}function CZ(n,t){const e=[];for(let r=0;r<n;r++)e.push(t+r);return e}function uhe(n,t,e,r,i,s,o,a,u){const d=n.length;let m=new Array(d),y=new Array(d),_=new Array(d);if(t.length&&e>0){const E=t[0],D=e+1;m=SZ(o,E,D,r,n),y=EZ(a,E,D,i,n),_=wZ(s,E,D,n)}else for(let E=0;E<d;E++)m[E]=TZ(o,r,s,n,E,u),y[E]=AZ(a,i,s,n,E,u),_[E]=NZ(s,E,u);return{begin:m,end:y,strides:_}}function SZ(n,t,e,r,i){const s=[...i],o=CZ(e,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=0;else{const u=xZ(t,e,a);let d=r[u];n&1<<u&&(d=0),s[a]=d}return s}function EZ(n,t,e,r,i){const s=[...i],o=CZ(e,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const u=xZ(t,e,a);let d=r[u];n&1<<u&&(d=Number.MAX_SAFE_INTEGER),s[a]=d}for(let a=0;a<s.length;a++){const u=i[a];s[a]<0&&(s[a]+=u),s[a]=Op(0,s[a],i[a])}return s}function NZ(n,t,e){let r=n[t];return(e&1<<t||null==r)&&(r=1),r}function TZ(n,t,e,r,i,s){let o=t[i];(n&1<<i||s&1<<i||null==o)&&(o=(e[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),o=Op(0,o,u-1),o}function AZ(n,t,e,r,i,s){let o=t[i];const a=e[i]||1;(n&1<<i||s&1<<i||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=r[i];return o<0&&(o+=u),o=a>0?Op(0,o,u):Op(-1,o,u-1),o}function QU(n,t,e){let r=e.length;for(let i=0;i<e.length;i++)if(e[i]>1){r=i;break}for(let i=r+1;i<e.length;i++)if(t[i]>0||e[i]!==n[i])return!1;return!0}function JU(n,t){let e=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)e+=n[r]*t[r];return e}function MR(n,t,e){let r;const i=n.shape.length;let s;return r="number"==typeof t?[t,...new Array(i-1).fill(0)]:t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice(),r.forEach(o=>{De(-1!==o,()=>"slice() does not support negative begin indexing.")}),s=null==e?new Array(i).fill(-1):"number"==typeof e?[e,...new Array(i-1).fill(-1)]:e.length<i?e.concat(new Array(i-e.length).fill(-1)):e,s=s.map((o,a)=>o>=0?o:(De(-1===o,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),n.shape[a]-r[a])),[r,s]}function e5(n,t,e,r,i,s,o,a,u){let d;if(null==r?(d=new Array(t.length),d.fill(1)):d=r,null!=o&&0!=(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");let m=!1;const y={dims:d.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:e.slice(),strides:d.slice(),beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u};for(let Q=0;Q<y.dims;Q++)m&&0!=(1<<Q&a)&&y.numAddAxisAfterEllipsis++,1<<Q&o&&(m=!0);m||(y.ellipsisMask|=1<<y.dims,y.dims++);const _={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function lhe(n,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let e=0;t.beginValid=null!=n.begin,t.endValid=null!=n.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const i=Math.min(t.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,t.dims);for(;e<i;e++)t.begin[e]=0,t.end[e]=0,t.strides[e]=1,t.beginMask|=1<<e,t.endMask|=1<<e,t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[e]=r}else if(1<<r&n.newAxisMask)t.finalShapeGatherIndices.push(-2),t.finalShapeGatherIndicesSparse.push(-1);else{if(e===t.begin.length)throw Error(`Index out of range using input dim ${e}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=n.begin&&(t.begin[e]=n.begin[r]),null!=n.end&&(t.end[e]=n.end[r]),t.strides[e]=n.strides[r],n.beginMask&1<<r&&(t.beginMask|=1<<e),n.endMask&1<<r&&(t.endMask|=1<<e),n.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(-1),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<e):(t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[e]=r,e++}}(y,_);let E=!0,D=!0,O=!0;const R=[],$=[];for(let Q=0;Q<n.length;++Q){if(0===_.strides[Q])throw Error(`strides[${Q}] must be non-zero`);const ie=!!(_.shrinkAxisMask&1<<Q),ye=n[Q];if(-1===ye){R.push(ie?1:-1);continue}const Me=[_.beginMask&1<<Q,_.endMask&1<<Q],Be=[_.strides[Q]>0?0:-1,_.strides[Q]>0?ye:ye-1];if(ie&&_.strides[Q]<=0)throw Error("only stride 1 allowed on non-range indexing.");O=O&&1===_.strides[Q];const He=!!(_.beginMask&1<<Q&&_.endMask&1<<Q);if(_.beginValid&&_.endValid){if(ie){const zt=_.begin[Q]<0?ye+_.begin[Q]:_.begin[Q];if(_.begin[Q]=zt,_.end[Q]=_.begin[Q]+1,zt<0||zt>=ye)throw Error(`slice index ${_.begin[Q]} of dimension ${Q} out of bounds.`)}else _.begin[Q]=IZ(_.begin[Q],0,_.strides[Q],ye,Me,Be),_.end[Q]=IZ(_.end[Q],1,_.strides[Q],ye,Me,Be);const It=1===_.strides[Q]&&0===_.begin[Q]&&_.end[Q]===ye;E=E&&It,D=D&&(0===Q&&1===_.strides[Q]||It)}else E=E&&1===_.strides[Q]&&He,D=D&&(0===Q&&1===_.strides[Q]||He);let st,lt=!1;if(_.beginValid&&_.endValid?(st=_.end[Q]-_.begin[Q],lt=!0):ie?(st=1,lt=!0):He&&ye>=0&&(st=_.strides[Q]<0?-ye:ye,lt=!0),lt){let It;It=0===st||st<0!=_.strides[Q]<0?0:Math.trunc(st/_.strides[Q])+(st%_.strides[Q]!=0?1:0),R.push(It)}else R.push(-1)}for(let Q=0;Q<_.finalShapeGatherIndices.length;++Q){const ie=_.finalShapeGatherIndices[Q];ie>=0?$.push(R[ie]):-2===ie&&$.push(1)}return{finalShapeSparse:$.filter((Q,ie)=>-2!==_.finalShapeGatherIndices[ie]),finalShape:$,isIdentity:E,sliceDim0:D,isSimpleSlice:O,begin:_.begin,end:_.end,strides:_.strides}}function IZ(n,t,e,r,i,s){if(i[t])return e>0?s[t]:s[t+1&1];{const o=n<0?r+n:n;return o<s[0]?s[0]:o>s[1]?s[1]:o}}const DZ=.1;function hhe(n,t,e){return null==e&&(e=t5()),n5(n,t,(r,i)=>r5(r,i,e))}function t5(){return 32===ot.backend.floatPrecision()?.001:DZ}function n5(n,t,e){let r=!0;if((jo(n)||jo(t))&&(r=!1),jo(n)&&jo(t)&&(r=!0),r){const o=n.constructor.name,a=t.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(n)&&Array.isArray(t)){const o=$h(n),a=$h(t);if(!ri(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const i=jo(n)?n:Lh(n),s=jo(t)?t:Lh(t);if(i.length!==s.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${s.length}.\nActual:   ${i}.\nExpected: ${s}.`);for(let o=0;o<s.length;++o){const a=i[o],u=s[o];if(!e(a,u))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${u}.\nActual:   ${i}.\nExpected: ${s}.`)}"undefined"!=typeof expect&&expect().nothing()}function fhe(n,t){n().then(()=>t.fail(),()=>t()),"undefined"!=typeof expect&&expect().nothing()}function dhe(n,t){const e="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return Fh(n)||Fh(n[0])||Fh(t)||Fh(t[0])?n5(n,e,(r,i)=>r==i):n5(n,t,(r,i)=>r5(r,i,0))}function phe(n,t,e){if(null==e&&(e=t5()),!r5(n,t,e))throw new Error(`Numbers differ: actual === ${n}, expected === ${t}`);"undefined"!=typeof expect&&expect().nothing()}function r5(n,t,e){return!isFinite(n)&&!isFinite(t)||!(isNaN(n)||isNaN(t)||Math.abs(n-t)>e)}function mhe(n,t,e){for(let r=0;r<n.length;r++)if(n[r]<t||n[r]>e)throw new Error(`Value out of range:${n[r]} low: ${t}, high: ${e}`)}function ghe(n,t){const e=new Float32Array(n),r=new Float32Array(t);if(e.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${e.length}`);for(let i=0;i<r.length;i++)if(e[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${e[i]} instead`)}function MZ(n){for(let t=0;t<n.length;t++){const e=n[t];Array.isArray(e)?MZ(e):n[t]=Ph(e)}return n}function vhe(n){const t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(n),new Promise(e=>{t.addEventListener("loadeddata",r=>e(t)),t.load()})}function yhe(n){return s5.apply(this,arguments)}function s5(){return(s5=(0,Nt.Z)(function*(n){yield n.play(),"requestVideoFrameCallback"in n&&(yield new Promise(t=>{n.requestVideoFrameCallback(t)}))})).apply(this,arguments)}const kZ="4.4.0";class RZ{static sgd(t){return new TR(t)}static momentum(t,e,r=!1){return new LU(t,e,r)}static rmsprop(t,e=.9,r=0,i=null,s=!1){return new $U(t,e,r,i,s)}static adam(t=.001,e=.9,r=.999,i=null){return new FU(t,e,r,i)}static adadelta(t=.001,e=.95,r=null){return new RU(t,e,r)}static adamax(t=.002,e=.9,r=.999,i=null,s=0){return new PU(t,e,r,i,s)}static adagrad(t,e=.1){return new OU(t,e)}}const o5=ut({acos_:function _he(n){const e={x:Le(n,"x","acos")};return ot.runKernel(M_,e)}}),a5=ut({acosh_:function bhe(n){const e={x:Le(n,"x","acosh")};return ot.runKernel(k_,e)}}),OZ=ut({addN_:function whe(n){De(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),De(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const t=n.map((i,s)=>Le(i,`tensors${s}`,"addN")),e=t[0];return t.forEach(i=>{if(i.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!ri(i.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),ot.runKernel(CC,t)}}),kR=ut({all_:function xhe(n,t=null,e=!1){const i={x:Le(n,"x","all","bool")};return ot.runKernel(e2,i,{axis:t,keepDims:e})}}),PS=ut({any_:function Che(n,t=null,e=!1){const i={x:Le(n,"x","any","bool")};return ot.runKernel(t2,i,{axis:t,keepDims:e})}}),rv=ut({argMax_:function She(n,t=0){const r={x:Le(n,"x","argMax")};return ot.runKernel(SC,r,{axis:t})}}),u5=ut({argMin_:function Ehe(n,t=0){const r={x:Le(n,"x","argMin")};return ot.runKernel(EC,r,{axis:t})}}),l5=ut({asin_:function Nhe(n){const e={x:Le(n,"x","asin")};return ot.runKernel(R_,e)}}),c5=ut({asinh_:function The(n){const e={x:Le(n,"x","asinh")};return ot.runKernel(O_,e)}}),h5=ut({atan_:function Ahe(n){const e={x:Le(n,"x","atan")};return ot.runKernel(F_,e)}}),f5=ut({atan2_:function Ihe(n,t){let e=Le(n,"a","atan2"),r=Le(t,"b","atan2");return[e,r]=Ds(e,r),ot.runKernel(L_,{a:e,b:r})}}),d5=ut({atanh_:function Dhe(n){const e={x:Le(n,"x","atanh")};return ot.runKernel(P_,e)}});function LS(n,t,e,r,i="NHWC",s){return qo(n,[...t,n[3]],e,s,r,null,null,id(i))}function uc(n,t,e,r,i,s,o="channelsLast"){const[a,u]=$S(t);let d;if("channelsLast"===o)d=[a,u,n[3],n[3]];else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);d=[a,u,n[1],n[1]]}return qo(n,d,e,r,i,s,!1,o)}function rd(n,t,e,r,i,s,o="NDHWC"){const[a,u,d]=m5(t);let m,y;if("NDHWC"===o)y="channelsLast",m=[a,u,d,n[4],n[4]];else{if("NCDHW"!==o)throw new Error(`Unknown dataFormat ${o}`);y="channelsFirst",m=[a,u,d,n[1],n[1]]}return zp(n,m,e,r,i,!1,y,s)}function qo(n,t,e,r,i,s,o=!1,a="channelsLast"){let[u,d,m,y]=[-1,-1,-1,-1];if("channelsLast"===a)[u,d,m,y]=n;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[u,y,d,m]=n}const[_,E,,D]=t,[O,R]=$S(e),[$,B]=$S(r),Q=F0(_,$),ie=F0(E,B),{padInfo:ye,outHeight:Me,outWidth:Be}=function Rhe(n,t,e,r,i,s,o,a,u){let d,m,y;if("number"==typeof n){d={top:n,bottom:n,left:n,right:n,type:0===n?"VALID":"NUMBER"};const E=function Mhe(n,t,e,r,i){null==r&&(r=p5(n,t,e));const o=n[1];return[BS((n[0]-t+2*r)/e+1,i),BS((o-t+2*r)/e+1,i)]}([t,e],s,r,n,a);m=E[0],y=E[1]}else if("same"===n){m=Math.ceil(t/r),y=Math.ceil(e/i);const _=Math.max(0,(m-1)*r+s-t),E=Math.max(0,(y-1)*i+o-e),D=Math.floor(_/2),O=_-D,R=Math.floor(E/2);d={top:D,bottom:O,left:R,right:E-R,type:"SAME"}}else if("valid"===n)d={top:0,bottom:0,left:0,right:0,type:"VALID"},m=Math.ceil((t-s+1)/r),y=Math.ceil((e-o+1)/i);else{if("object"!=typeof n)throw Error(`Unknown padding parameter: ${n}`);{const _="channelsLast"===u?n[1][0]:n[2][0],E="channelsLast"===u?n[1][1]:n[2][1],D="channelsLast"===u?n[2][0]:n[3][0],O="channelsLast"===u?n[2][1]:n[3][1];d={top:_,bottom:E,left:D,right:O,type:0===_&&0===E&&0===D&&0===O?"VALID":"EXPLICIT"},m=BS((t-s+_+E)/r+1,a),y=BS((e-o+D+O)/i+1,a)}}return{padInfo:d,outHeight:m,outWidth:y}}(i,d,m,O,R,Q,ie,s,a),He=o?D*y:D;let st;return"channelsFirst"===a?st=[u,He,Me,Be]:"channelsLast"===a&&(st=[u,Me,Be,He]),{batchSize:u,dataFormat:a,inHeight:d,inWidth:m,inChannels:y,outHeight:Me,outWidth:Be,outChannels:He,padInfo:ye,strideHeight:O,strideWidth:R,filterHeight:_,filterWidth:E,effectiveFilterHeight:Q,effectiveFilterWidth:ie,dilationHeight:$,dilationWidth:B,inShape:n,outShape:st,filterShape:t}}function zp(n,t,e,r,i,s=!1,o="channelsLast",a){let[u,d,m,y,_]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[u,d,m,y,_]=n;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[u,_,d,m,y]=n}const[E,D,O,,R]=t,[$,B,Q]=m5(e),[ie,ye,Me]=m5(r),Be=F0(E,ie),He=F0(D,ye),st=F0(O,Me),{padInfo:lt,outDepth:It,outHeight:zt,outWidth:Wt}=function Ohe(n,t,e,r,i,s,o,a,u,d,m){let y,_,E,D;if("valid"===n&&(n=0),"number"==typeof n){y={top:n,bottom:n,left:n,right:n,front:n,back:n,type:0===n?"VALID":"NUMBER"};const R=function khe(n,t,e,r,i,s){null==i&&(i=p5(n,t[0],r[0]));const o=[0,0,0,e];for(let a=0;a<3;a++)n[a]+2*i>=t[a]&&(o[a]=BS((n[a]-t[a]+2*i)/r[a]+1,s));return o}([t,e,r,1],[a,u,d],1,[i,s,o],n,m);_=R[0],E=R[1],D=R[2]}else{if("same"!==n)throw Error(`Unknown padding parameter: ${n}`);{_=Math.ceil(t/i),E=Math.ceil(e/s),D=Math.ceil(r/o);const O=(_-1)*i+a-t,R=(E-1)*s+u-e,$=(D-1)*o+d-r,B=Math.floor(O/2),Q=O-B,ie=Math.floor(R/2),ye=R-ie,Me=Math.floor($/2);y={top:ie,bottom:ye,left:Me,right:$-Me,front:B,back:Q,type:"SAME"}}}return{padInfo:y,outDepth:_,outHeight:E,outWidth:D}}(i,d,m,y,$,B,Q,Be,He,st,a),qt=s?R*_:R;let Kt;return"channelsFirst"===o?Kt=[u,qt,It,zt,Wt]:"channelsLast"===o&&(Kt=[u,It,zt,Wt,qt]),{batchSize:u,dataFormat:o,inDepth:d,inHeight:m,inWidth:y,inChannels:_,outDepth:It,outHeight:zt,outWidth:Wt,outChannels:qt,padInfo:lt,strideDepth:$,strideHeight:B,strideWidth:Q,filterDepth:E,filterHeight:D,filterWidth:O,effectiveFilterDepth:Be,effectiveFilterHeight:He,effectiveFilterWidth:st,dilationDepth:ie,dilationHeight:ye,dilationWidth:Me,inShape:n,outShape:Kt,filterShape:t}}function p5(n,t,e,r=1){const i=F0(t,r);return Math.floor((n[0]*(e-1)-e+i)/2)}function $S(n){return"number"==typeof n?[n,n,n]:2===n.length?[n[0],n[1],1]:n}function m5(n){return"number"==typeof n?[n,n,n]:n}function F0(n,t){return t<=1?n:n+(n-1)*(t-1)}function BS(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function Up(n){const[t,e,r]=$S(n);return 1===t&&1===e&&1===r}function la(n,t){return Up(n)||Up(t)}function iv(n){return $S(n).every(t=>t>0)}function id(n){if("NHWC"===n)return"channelsLast";if("NCHW"===n)return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Za(n,t,e){if(null!=e){if("string"==typeof t)throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);if("number"==typeof t)De(Hg(t),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);else{if("object"!=typeof t)throw Error(`Error in ${n}: Unknown padding parameter: ${t}`);t.forEach(r=>{r.forEach(i=>{De(Hg(i),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${i}.`)})})}}}const wt=ut({reshape_:function Fhe(n,t){const r={x:Le(n,"x","reshape","string_or_numeric")};return ot.runKernel(cS,r,{shape:t})}}),VS=ut({avgPool_:function Phe(n,t,e,r,i){const s=Le(n,"x","avgPool","float32");De(la(e,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`);let a=s,u=!1;3===s.rank&&(u=!0,a=wt(s,[1,s.shape[0],s.shape[1],s.shape[2]])),De(4===a.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Za("avgPool",r,i);let y=ot.runKernel(NC,{x:a},{filterSize:t,strides:e,pad:r,dimRoundingMode:i});return y=Fn(y,s.dtype),u?wt(y,[y.shape[1],y.shape[2],y.shape[3]]):y}}),g5=ut({avgPool3d_:function Lhe(n,t,e,r,i,s="NDHWC"){const o=Le(n,"x","avgPool3d","float32");let a=o,u=!1;4===o.rank&&(u=!0,a=wt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),De(5===a.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),De("NDHWC"===s,()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),De("number"==typeof e&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`),Za("avgPool3d",r,i);let y=ot.runKernel(TC,{x:a},{filterSize:t,strides:e,pad:r,dimRoundingMode:i,dataFormat:s});return y=Fn(y,a.dtype),u?wt(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}}),Js=ut({concat_:function $he(n,t=0){De(n.length>=1,()=>"Pass at least one tensor to concat");const e=RS(n,"tensors","concat","string_or_numeric");return"complex64"===e[0].dtype&&e.forEach(s=>{if("complex64"!==s.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${s.dtype}. `)}),1===e.length?Vh(e[0]):ot.runKernel(MC,e,{axis:t})}}),qc=ut({sigmoid_:function Bhe(n){const e={x:Le(n,"x","sigmoid","float32")};return ot.runKernel(y0,e)}}),ui=ut({slice_:function Vhe(n,t,e){const r=Le(n,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");return ot.runKernel(mS,{x:r},{begin:t,size:e})}}),sv=ut({tanh_:function zhe(n){const e={x:Le(n,"x","tanh","float32")};return ot.runKernel(S0,e)}}),FZ=ut({basicLSTMCell_:function Uhe(n,t,e,r,i,s){const o=Le(n,"forgetBias","basicLSTMCell"),a=Le(t,"lstmKernel","basicLSTMCell"),u=Le(e,"lstmBias","basicLSTMCell"),d=Le(r,"data","basicLSTMCell"),m=Le(i,"c","basicLSTMCell"),y=Le(s,"h","basicLSTMCell"),_=Js([d,y],1),E=Qr(_,a),D=_n(E,u),R=D.shape[1]/4,$=[D.shape[0],R],B=ui(D,[0,0],$),Q=ui(D,[0,R],$),ie=ui(D,[0,2*R],$),ye=ui(D,[0,3*R],$),Me=_n(vt(qc(B),sv(Q)),vt(m,qc(_n(o,ie))));return[Me,vt(sv(Me),qc(ye))]}}),zS=ut({batchToSpaceND_:function Hhe(n,t,e){const r=Le(n,"x","batchToSpaceND"),i=t.reduce((a,u)=>a*u);return De(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),De(e.length===t.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`),De(r.shape[0]%i==0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`),ot.runKernel(IC,{x:r},{blockShape:t,crops:e})}});function Whe(n){let t;return t=0===n.rank||1===n.rank?wt(n,[1,1,1,n.size]):2===n.rank?wt(n,[1,1,n.shape[0],n.shape[1]]):3===n.rank?wt(n,[1,n.shape[0],n.shape[1],n.shape[2]]):n,t}const P0=ut({batchNorm_:function Ghe(n,t,e,r,i,s){null==s&&(s=.001);const o=Le(n,"x","batchNorm"),a=Le(t,"mean","batchNorm"),u=Le(e,"variance","batchNorm");let d,m;null!=i&&(d=Le(i,"scale","batchNorm")),null!=r&&(m=Le(r,"offset","batchNorm")),De(a.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),De(null==m||a.rank===m.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),De(null==d||a.rank===d.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const _={x:Whe(o),scale:d,offset:m,mean:a,variance:u},D=ot.runKernel(VC,_,{varianceEpsilon:s});return wt(D,o.shape)}}),v5=ut({batchNorm2d_:function jhe(n,t,e,r,i,s){const o=Le(n,"x","batchNorm"),a=Le(t,"mean","batchNorm"),u=Le(e,"variance","batchNorm");let d,m;return null!=i&&(d=Le(i,"scale","batchNorm")),null!=r&&(m=Le(r,"offset","batchNorm")),De(2===o.rank,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),De(2===a.rank||1===a.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),De(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),null!=d&&De(2===d.rank||1===d.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${d.rank}.`),null!=m&&De(2===m.rank||1===m.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${m.rank}.`),P0(o,a,u,m,d,s)}}),y5=ut({batchNorm3d_:function qhe(n,t,e,r,i,s){const o=Le(n,"x","batchNorm"),a=Le(t,"mean","batchNorm"),u=Le(e,"variance","batchNorm");let d,m;return null!=i&&(d=Le(i,"scale","batchNorm")),null!=r&&(m=Le(r,"offset","batchNorm")),De(3===o.rank,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),De(3===a.rank||1===a.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),De(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),null!=d&&De(3===d.rank||1===d.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${d.rank}.`),null!=m&&De(3===m.rank||1===m.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${m.rank}.`),P0(o,a,u,m,d,s)}}),_5=ut({batchNorm4d_:function Zhe(n,t,e,r,i,s){const o=Le(n,"x","batchNorm"),a=Le(t,"mean","batchNorm"),u=Le(e,"variance","batchNorm");let d,m;return null!=i&&(d=Le(i,"scale","batchNorm")),null!=r&&(m=Le(r,"offset","batchNorm")),De(4===o.rank,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),De(4===a.rank||1===a.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),De(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),null!=d&&De(4===d.rank||1===d.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${d.rank}.`),null!=m&&De(4===m.rank||1===m.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${m.rank}.`),P0(o,a,u,m,d,s)}}),b5=ut({bincount_:function Khe(n,t,e){const r=Le(n,"x","bincount"),i=Le(t,"weights","bincount");return De("int32"===r.dtype,()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),De(e>=0,()=>`size must be non-negative, but got ${e}.`),De(i.size===r.size||0===i.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`),ot.runKernel(s2,{x:r,weights:i},{size:e})}}),PZ=ut({broadcastArgs_:function Xhe(n,t){const e=Le(n,"s0","broadcastArgs","int32"),r=Le(t,"s1","broadcastArgs","int32");if(1!==e.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${e.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);return ot.runKernel(o2,{s0:e,s1:r})}}),ov=ut({broadcastTo_:function Yhe(n,t){let e=Le(n,"broadcastTo","x");const r=e.shape;if(Bu(t),t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){const d=e.shape.slice();for(;d.length<t.length;)d.unshift(1);e=wt(e,d)}const i=e.shape,s=Array.from(t);for(let d=t.length-1;d>=0;d--)if(i[d]===t[d])s[d]=1;else if(1!==e.shape[d])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);return 0===s.map((d,m)=>d>1?m:-1).filter(d=>d>=0).length?Vh(e):ot.runKernel(E0,{x:e},{reps:s})}}),w5=ut({ceil_:function Qhe(n){const e={x:Le(n,"x","ceil","float32")};return ot.runKernel(B_,e)}}),gu=ut({clipByValue_:function Jhe(n,t,e){const r=Le(n,"x","clipByValue");return De(t<=e,()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`),t===e?ev(r.shape,t,r.dtype):ot.runKernel(V_,{x:r},{clipValueMin:t,clipValueMax:e})}}),x5=ut({concat1d_:function efe(n){return Js(n,0)}}),C5=ut({concat2d_:function tfe(n,t){return Js(n,t)}}),S5=ut({concat3d_:function nfe(n,t){return Js(n,t)}}),E5=ut({concat4d_:function rfe(n,t){return Js(n,t)}}),sd=ut({conv2d_:function ife(n,t,e,r,i="NHWC",s=[1,1],o){const a=Le(n,"x","conv2d","float32"),u=Le(t,"filter","conv2d","float32");let d=a,m=!1;3===a.rank&&(m=!0,d=wt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),De(4===d.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${d.rank}.`),De(4===u.rank,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),Za("conv2d",r,o);const y="NHWC"===i?d.shape[3]:d.shape[1];De(y===u.shape[2],()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${u.shape[2]}.`),De(la(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),De(iv(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),De(iv(e),()=>"Error in conv2D: Strides should be larger than 0.");const D=ot.runKernel(kC,{x:d,filter:u},{strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o});return m?wt(D,[D.shape[1],D.shape[2],D.shape[3]]):D}}),RR=ut({conv1d_:function sfe(n,t,e,r,i="NWC",s=1,o){const a=Le(n,"x","conv1d"),u=Le(t,"filter","conv1d");let d=a,m=!1;2===a.rank&&(m=!0,d=wt(a,[1,a.shape[0],a.shape[1]])),De(3===d.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${d.rank}.`),De(3===u.rank,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),Za("conv1d",r,o),De(d.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${d.shape[2]}) must match input depth for filter ${u.shape[1]}.`),De(la(e,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${s}'`),De(iv(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),De(iv(e),()=>"Error in conv1D: Stride should be larger than 0."),De("NWC"===i,()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const y=wt(u,[1,u.shape[0],u.shape[1],u.shape[2]]),_=wt(d,[d.shape[0],1,d.shape[1],d.shape[2]]),R=sd(_,y,[1,e],r,"NHWC",[1,s],o);return wt(R,m?[R.shape[2],R.shape[3]]:[R.shape[0],R.shape[2],R.shape[3]])}}),N5=ut({conv2DBackpropInput_:function ofe(n,t,e,r,i,s="NHWC",o){De(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let a=n,u=t,d=!1;3===t.rank&&(d=!0,u=wt(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,n[0],n[1],n[2]]),De(4===a.length,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),De(4===u.rank,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),De(4===e.rank,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);const m="NHWC"===s?a[3]:a[1],y="NHWC"===s?u.shape[3]:u.shape[1];De(m===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${m}) must match input depth for filter ${e.shape[2]}.`),De(y===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${y}) must match output depth for filter ${e.shape[3]}.`),Za("conv2dDerInput",i,o);const D=ot.runKernel(RC,{dy:u,filter:e},{strides:r,pad:i,dataFormat:s,dimRoundingMode:o,inputShape:a});return d?wt(D,[D.shape[1],D.shape[2],D.shape[3]]):D}}),OR=ut({conv2dTranspose_:function afe(n,t,e,r,i,s){const o=Le(n,"x","conv2dTranspose"),a=Le(t,"filter","conv2dTranspose");return N5(e,o,a,r,i,"NHWC",s)}}),T5=ut({conv3d_:function ufe(n,t,e,r,i="NDHWC",s=[1,1,1]){const o=Le(n,"x","conv3d"),a=Le(t,"filter","conv3d");let u=o,d=!1;4===o.rank&&(d=!0,u=wt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),De(5===u.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),De(5===a.rank,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),De(u.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${a.shape[3]}.`),De(la(e,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),De("NDHWC"===i,()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),De(iv(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),De(iv(e),()=>"Error in conv3D: Strides should be larger than 0.");const _=ot.runKernel(OC,{x:u,filter:a},{strides:e,pad:r,dataFormat:i,dilations:s});return d?wt(_,[_.shape[1],_.shape[2],_.shape[3],_.shape[4]]):_}}),LZ=ut({conv3DBackpropInput_:function lfe(n,t,e,r,i){De(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let s=n,o=t,a=!1;4===t.rank&&(a=!0,o=wt(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,n[0],n[1],n[2],n[3]]);const u=s[4],d=o.shape[4];De(5===s.length,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),De(5===o.rank,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),De(5===e.rank,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),De(u===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${e.shape[3]}.`),De(d===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${d}) must match output depth for filter ${e.shape[4]}.`);const _=ot.runKernel(c2,{dy:o,filter:e},{pad:i,strides:r,inputShape:s});return a?wt(_,[_.shape[1],_.shape[2],_.shape[3],_.shape[4]]):_}}),A5=ut({conv3dTranspose_:function cfe(n,t,e,r,i){const s=Le(n,"x","conv3dTranspose"),o=Le(t,"filter","conv3dTranspose");return LZ(e,s,o,r,i)}}),US=ut({cos_:function hfe(n){const e={x:Le(n,"x","cos","float32")};return ot.runKernel(z_,e)}}),FR=ut({cosh_:function ffe(n){const e={x:Le(n,"x","cosh","float32")};return ot.runKernel(U_,e)}}),HS=ut({cumprod_:function dfe(n,t=0,e=!1,r=!1){const s={x:Le(n,"x","cumprod")};return ot.runKernel(h2,s,{axis:t,exclusive:e,reverse:r})}}),PR=ut({cumsum_:function pfe(n,t=0,e=!1,r=!1){const s={x:Le(n,"x","cumsum")};return ot.runKernel(FC,s,{axis:t,exclusive:e,reverse:r})}}),LR=ut({denseBincount_:function mfe(n,t,e,r=!1){const i=Le(n,"x","denseBincount"),s=Le(t,"weights","denseBincount");return De("int32"===i.dtype,()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),De(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),De(e>=0,()=>`size must be non-negative, but got ${e}.`),De(s.size===i.size||0===s.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`),ot.runKernel(d2,{x:i,weights:s},{size:e,binaryOutput:r})}}),I5=ut({depthToSpace_:function gfe(n,t,e="NHWC"){const r=Le(n,"x","depthToSpace","float32"),i="NHWC"===e?r.shape[1]:r.shape[2],s="NHWC"===e?r.shape[2]:r.shape[3],o="NHWC"===e?r.shape[3]:r.shape[1];return De(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),De(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${t}  for depthToSpace with input shape\n    ${r.shape}`),De(s*t>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${t} for depthToSpace with input shape\n        ${r.shape}`),De(o%(t*t)==0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${r.shape}`),ot.runKernel(p2,{x:r},{blockSize:t,dataFormat:e})}}),L0=ut({depthwiseConv2d_:function vfe(n,t,e,r,i="NHWC",s=[1,1],o){const a=Le(n,"x","depthwiseConv2d","float32"),u=Le(t,"filter","depthwiseConv2d","float32");let d=a,m=!1;3===a.rank&&(m=!0,d=wt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),De(4===d.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),De(4===u.rank,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const y="NHWC"===i?d.shape[3]:d.shape[1];De(y===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${y}) must match the inChannels dimension in filter ${u.shape[2]}.`),Za("depthwiseConv2d",r,o);const D=ot.runKernel(PC,{x:d,filter:u},{strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o});return m?wt(D,[D.shape[1],D.shape[2],D.shape[3]]):D}}),$Z=ut({diag_:function yfe(n){const e={x:Le(n,"x","diag")};return ot.runKernel(v2,e)}}),D5=ut({dilation2d_:function _fe(n,t,e,r,i=[1,1],s="NHWC"){const o=Le(n,"x","dilation2d"),a=Le(t,"filter","dilation2d");De(3===o.rank||4===o.rank,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),De(3===a.rank,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),De("NHWC"===s,()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let u=o,d=!1;3===o.rank&&(u=wt(o,[1,o.shape[0],o.shape[1],o.shape[2]]),d=!0),De(u.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${a.shape[2]}`);const _=ot.runKernel(LC,{x:u,filter:a},{strides:e,pad:r,dilations:i});return d?wt(_,[_.shape[1],_.shape[2],_.shape[3]]):_}}),zu=ut({equal_:function bfe(n,t){let e=Le(n,"a","equal","string_or_numeric"),r=Le(t,"b","equal","string_or_numeric");return[e,r]=Ds(e,r),Fr(e.shape,r.shape),ot.runKernel($C,{a:e,b:r})}}),Zo=ut({where_:function wfe(n,t,e){const r=Le(t,"a","where"),i=Le(e,"b","where"),s=Le(n,"condition","where","bool"),o=Fr(Fr(s.shape,r.shape),i.shape),a=ov(s,o),u=ov(r,o),d=ov(i,o);return ot.runKernel(pS,{condition:a,t:u,e:d})}}),M5=ut({divNoNan_:function xfe(n,t){let e=Le(n,"a","div"),r=Le(t,"b","div");[e,r]=Ds(e,r);const i=nr(e,r),s=ai(i),o=zu(r,s);return Zo(o,s,i)}}),k5=ut({dot_:function Cfe(n,t){const e=Le(n,"t1","dot"),r=Le(t,"t2","dot");De(!(1!==e.rank&&2!==e.rank||1!==r.rank&&2!==r.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${r.rank}.`);const i=1===e.rank?e.size:e.shape[1],s=1===r.rank?r.size:r.shape[0];if(De(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),1===e.rank&&1===r.rank){const o=wt(e,[1,-1]),a=wt(r,[-1,1]),u=Qr(o,a);return wt(u,[])}if(1===e.rank&&2===r.rank){const o=wt(e,[1,-1]),a=wt(r,[r.shape[0],r.shape[1]]),u=Qr(o,a);return wt(u,[u.size])}if(2===e.rank&&1===r.rank){const o=wt(r,[-1,1]),a=Qr(e,o);return wt(a,[a.size])}{const o=wt(r,[r.shape[0],r.shape[1]]);return Qr(e,o)}}}),BZ=ut({einsum_:function Sfe(n,...t){const e=t.map((i,s)=>Le(i,`tensors${s}`,"einsum"));return ot.runKernel(b2,e,{equation:n})}}),$0=ut({elu_:function Efe(n){const e={x:Le(n,"x","elu","float32")};return ot.runKernel(W_,e)}}),R5=ut({erf_:function Nfe(n){let t=Le(n,"x","erf");return De("int32"===t.dtype||"float32"===t.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===t.dtype&&(t=Fn(t,"float32")),ot.runKernel(G_,{x:t})}});function O5(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function VZ(n,t,e){const r=n.length+t.length,i=[];let s=0,o=0;for(let a=0;a<r;a++)-1===e.indexOf(a)?i.push(n[s++]):i.push(t[o++]);return i}function Ko(n,t){const e=[],r=n.length;for(let s=0;s<r;s++)-1===t.indexOf(s)&&e.push(n[s]);return[e,t.map(s=>n[s])]}function eo(n,t){return VZ(n,t.map(r=>1),t)}function ca(n,t,e){De(O5(t,e),()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`)}function ks(n,t){if(O5(n,t))return null;const e=[];for(let r=0;r<t;++r)-1===n.indexOf(r)&&e.push(r);return n.forEach(r=>e.push(r)),e}function Hp(n){return n.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function to(n,t){const e=[];for(let r=t-n;r<t;++r)e.push(r);return e}const wl=ut({max_:function Tfe(n,t=null,e=!1){const i={x:Le(n,"x","max")};return ot.runKernel(XC,i,{reductionIndices:t,keepDims:e})}}),B0=ut({min_:function Afe(n,t=null,e=!1){const i={x:Le(n,"x","min")};return ot.runKernel(eS,i,{axis:t,keepDims:e})}}),Yn=ut({sum_:function Ife(n,t=null,e=!1){let r=Le(n,"x","sum");return"bool"===r.dtype&&(r=Fn(r,"int32")),ot.runKernel(gS,{x:r},{axis:t,keepDims:e})}});function zZ(n,t,e=null){if(0===n.rank)return mo(n);if(1!==n.rank&&null===e)return zZ(wt(n,[-1]),t,e);if(1===n.rank||"number"==typeof e||Array.isArray(e)&&1===e.length){if(1===t)return Yn(mo(n),e);if(t===1/0)return wl(mo(n),e);if(t===-1/0)return B0(mo(n),e);if("euclidean"===t||2===t)return ua(Yn(nd(mo(n),hr(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(e)&&2===e.length){if(1===t)return wl(Yn(mo(n),e[0]),e[1]-1);if(t===1/0)return wl(Yn(mo(n),e[1]),e[0]);if(t===-1/0)return B0(Yn(mo(n),e[1]),e[0]);if("fro"===t||"euclidean"===t)return ua(Yn(Zi(n),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}const V0=ut({norm_:function Dfe(n,t="euclidean",e=null,r=!1){const i=zZ(n=Le(n,"x","norm"),t,e);let s=i.shape;if(r){const o=Yr(e,n.shape);s=eo(i.shape,o)}return wt(i,s)}}),F5=ut({euclideanNorm_:function Mfe(n,t=null,e=!1){return V0(n,"euclidean",t,e)}}),Uu=ut({exp_:function kfe(n){const e={x:Le(n,"x","exp")};return ot.runKernel(j_,e)}}),Ma=ut({expandDims_:function Rfe(n,t=0){const e=Le(n,"x","expandDims","string_or_numeric");return De(t<=e.rank,()=>"Axis must be <= rank of the tensor"),ot.runKernel(BC,{input:e},{dim:t})}}),P5=ut({expm1_:function Ofe(n){const e={x:Le(n,"x","expm1")};return ot.runKernel(q_,e)}}),xl=ut({tile_:function Ffe(n,t){const e=Le(n,"x","tile","string_or_numeric");return De(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${t}.`),ot.runKernel(E0,{x:e},{reps:t})}}),$R=ut({eye_:function Pfe(n,t,e,r="float32"){null==t&&(t=n);const i=Zr([n,t],r),s=n<=t?n:t;for(let a=0;a<s;++a)i.set(1,a,a);const o=wt(i.toTensor(),[n,t]);if(null==e)return o;if(1===e.length)return xl(Ma(o,0),[e[0],1,1]);if(2===e.length)return xl(Ma(Ma(o,0),0),[e[0],e[1],1,1]);if(3===e.length)return xl(Ma(Ma(Ma(o,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}}),z0=ut({floor_:function Lfe(n){const e={x:Le(n,"x","floor","float32")};return ot.runKernel(Z_,e)}}),U0=ut({gather_:function $fe(n,t,e=0,r=0){const i=Le(n,"x","gather"),s=Le(t,"indices","gather","int32");return ot.runKernel(zC,{x:i,indices:s},{axis:e,batchDims:r})}}),Ka=ut({greater_:function Bfe(n,t){let e=Le(n,"a","greater","string_or_numeric"),r=Le(t,"b","greater","string_or_numeric");return[e,r]=Ds(e,r),Fr(e.shape,r.shape),ot.runKernel(UC,{a:e,b:r})}}),od=ut({greaterEqual_:function Vfe(n,t){let e=Le(n,"a","greaterEqual","string_or_numeric"),r=Le(t,"b","greaterEqual","string_or_numeric");return[e,r]=Ds(e,r),Fr(e.shape,r.shape),ot.runKernel(X_,{a:e,b:r})}}),L5=ut({isFinite_:function zfe(n){const e={x:Le(n,"x","isFinite")};return ot.runKernel(Q_,e)}}),$5=ut({isInf_:function Ufe(n){const e={x:Le(n,"x","isInf")};return ot.runKernel(J_,e)}}),B5=ut({isNaN_:function Hfe(n){const e={x:Le(n,"x","isNaN")};return ot.runKernel(e0,e)}}),WS=ut({leakyRelu_:function Wfe(n,t=.2){const r={x:Le(n,"x","leakyRelu")};return ot.runKernel(HC,r,{alpha:t})}}),H0=ut({less_:function Gfe(n,t){let e=Le(n,"a","less","string_or_numeric"),r=Le(t,"b","less","string_or_numeric");return[e,r]=Ds(e,r),Fr(e.shape,r.shape),ot.runKernel(WC,{a:e,b:r})}}),Wp=ut({lessEqual_:function jfe(n,t){let e=Le(n,"a","lessEqual","string_or_numeric"),r=Le(t,"b","lessEqual","string_or_numeric");return[e,r]=Ds(e,r),Fr(e.shape,r.shape),ot.runKernel(GC,{a:e,b:r})}});function UZ(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");return ot.runKernel(A2,{},{start:n,stop:t,num:e})}const V5=ut({localResponseNormalization_:function qfe(n,t=5,e=1,r=1,i=.5){const s=Le(n,"x","localResponseNormalization");De(4===s.rank||3===s.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${s.rank}.`),De(Hg(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=s,a=!1;3===s.rank&&(a=!0,o=wt(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const m=ot.runKernel(KC,{x:o},{depthRadius:t,bias:e,alpha:r,beta:i});return a?wt(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),Hu=ut({log_:function Zfe(n){const e={x:Le(n,"x","log","float32")};return ot.runKernel(t0,e)}}),GS=ut({log1p_:function Kfe(n){const e={x:Le(n,"x","log1p")};return ot.runKernel(n0,e)}}),av=ut({softplus_:function Xfe(n){const e={x:Le(n,"x","softplus")};return ot.runKernel(_0,e)}}),z5=ut({logSigmoid_:function Yfe(n){const t=Le(n,"x","logSigmoid");return zh(r=>({value:ss(av(ss(r))),gradFunc:o=>vt(o,qc(ss(r)))}))(t)}}),BR=ut({logSoftmax_:function Qfe(n,t=-1){const e=Le(n,"logits","logSoftmax");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return zh((i,s)=>{const a=wl(i,t,!0),u=qn(i,a),d=qn(Fn(u,"float32"),Hu(Yn(Uu(u),t,!0)));return s([d]),{value:d,gradFunc:(y,_)=>{const[E]=_,O=Uu(E);return qn(y,vt(Yn(y,t,!0),O))}}})(e)}}),VR=ut({logSumExp_:function Jfe(n,t=null,e=!1){const r=Le(n,"x","logSumExp"),i=Yr(t,r.shape),s=wl(r,i,!0),o=qn(r,s),a=Uu(o),u=Yn(a,i),d=Hu(u),m=_n(wt(s,d.shape),d);if(e){const y=eo(m.shape,i);return wt(m,y)}return m}}),lc=ut({logicalAnd_:function ede(n,t){const e=Le(n,"a","logicalAnd","bool"),r=Le(t,"b","logicalAnd","bool");return Fr(e.shape,r.shape),ot.runKernel(jC,{a:e,b:r})}}),jS=ut({logicalNot_:function tde(n){const e={x:Le(n,"x","logicalNot","bool")};return ot.runKernel(qC,e)}}),zR=ut({logicalOr_:function nde(n,t){const e=Le(n,"a","logicalOr","bool"),r=Le(t,"b","logicalOr","bool");return Fr(e.shape,r.shape),ot.runKernel(ZC,{a:e,b:r})}}),U5=ut({logicalXor_:function rde(n,t){const e=Le(n,"a","logicalXor","bool"),r=Le(t,"b","logicalXor","bool");return Fr(e.shape,r.shape),lc(zR(n,t),jS(lc(n,t)))}}),UR=2147483648,HR=ut({searchSorted_:function ide(n,t,e="left"){const r=Le(n,"sortedSequence","searchSorted"),i=Le(t,"values","searchSorted"),o=i.shape[i.shape.length-1],a=wt(r,[-1,r.shape[r.shape.length-1]]),u=wt(i,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Xt(u.shape)>=UR)throw new Error(`values tensor size must less than ${UR}`);if(a.shape[1]>=UR)throw new Error(`trailing dim_size must less than ${UR} for int32 output type, was ${a.shape[1]}`);return ot.runKernel(j2,{sortedSequence:a,values:u},{side:e})}});function HZ(n,t){return HR(n,t,"left")}const qS=ut({maxPool_:function sde(n,t,e,r,i){const s=Le(n,"x","maxPool");let a=s,u=!1;3===s.rank&&(u=!0,a=wt(s,[1,s.shape[0],s.shape[1],s.shape[2]])),De(4===a.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),De(la(e,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`),Za("maxPool",r,i);const y=ot.runKernel(YC,{x:a},{filterSize:t,strides:e,pad:r,dimRoundingMode:i});return u?wt(y,[y.shape[1],y.shape[2],y.shape[3]]):y}}),H5=ut({maxPool3d_:function ode(n,t=[1,1,1],e,r,i,s="NDHWC"){const o=Le(n,"x","maxPool3d");let a=o,u=!1;4===o.rank&&(u=!0,a=wt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),De(5===a.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),De("NDHWC"===s,()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Za("maxPool3d",r,i);const y=ot.runKernel(QC,{x:a},{filterSize:t,strides:e,pad:r,dimRoundingMode:i,dataFormat:s});return u?wt(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}}),WZ=ut({maxPoolWithArgmax_:function ade(n,t,e,r,i=!1){const o={x:Le(n,"x","maxPoolWithArgmax")},u=ot.runKernel(k2,o,{filterSize:t,strides:e,pad:r,includeBatchInIndex:i});return{result:u[0],indexes:u[1]}}}),Rs=ut({mean_:function ude(n,t=null,e=!1){const i={x:Le(n,"x","mean")};return ot.runKernel(JC,i,{axis:t,keepDims:e})}});function vo(n,t="float32"){if(Bu(n),"complex64"===t){const r=vo(n,"float32"),i=vo(n,"float32");return ed(r,i)}const e=oa(Xt(n),t);return ot.makeTensor(e,n,t)}function Wu(n,t="float32"){if(Bu(n),"complex64"===t){const r=Wu(n,"float32"),i=vo(n,"float32");return ed(r,i)}const e=Jk(Xt(n),t);return ot.makeTensor(e,n,t)}function GZ(n,t,{indexing:e="xy"}={}){if("xy"!==e&&"ij"!==e)throw new TypeError(`${e} is not a valid third argument to meshgrid`);if(void 0===n)return[];let r=Le(n,"x","meshgrid",n instanceof yi?n.dtype:"float32");if(void 0===t)return[r];let i=Le(t,"y","meshgrid",t instanceof yi?t.dtype:"float32");const s=Xt(r.shape),o=Xt(i.shape);return"xy"===e?(r=wt(r,[1,-1]),i=wt(i,[-1,1]),[Qr(Wu([o,1],r.dtype),r),Qr(i,Wu([1,s],i.dtype))]):(r=wt(r,[-1,1]),i=wt(i,[1,-1]),[Qr(r,Wu([1,o],r.dtype)),Qr(Wu([s,1],i.dtype),i)])}const Gp=ut({minimum_:function lde(n,t){let e=Le(n,"a","minimum"),r=Le(t,"b","minimum");return[e,r]=Ds(e,r),"bool"===e.dtype&&(e=Fn(e,"int32"),r=Fn(r,"int32")),Fr(e.shape,r.shape),ot.runKernel(s0,{a:e,b:r})}}),W5=ut({mirrorPad_:function cde(n,t,e){De("reflect"===e||"symmetric"===e,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);const r=Le(n,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");De(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);const i="reflect"===e?1:0;for(let a=0;a<r.rank;a++)De(2===t[a].length,()=>"Invalid number of paddings. Must be length of 2 each."),De(t[a][0]>=0&&t[a][0]<=r.shape[a]-i&&t[a][1]>=0&&t[a][1]<=r.shape[a]-i,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-i} or less than 0 for input of shape ${r.shape}`);return ot.runKernel(tS,{x:r},{paddings:t,mode:e})}}),G5=ut({mod_:function hde(n,t){let e=Le(n,"a","mod"),r=Le(t,"b","mod");return[e,r]=Ds(e,r),ot.runKernel(o0,{a:e,b:r})}}),ZS=ut({moments_:function fde(n,t=null,e=!1){const r=Yr(t,(n=Le(n,"x","moments")).shape),i=Rs(n,r,e);let s=i.shape;e||(s=eo(i.shape,r));const o=Zi(qn(Fn(n,"float32"),wt(i,s)));return{mean:i,variance:Rs(o,r,e)}}}),jZ=ut({multiRNNCell_:function dde(n,t,e,r){const i=Le(t,"data","multiRNNCell"),s=RS(e,"c","multiRNNCell"),o=RS(r,"h","multiRNNCell");let a=i;const u=[];for(let y=0;y<n.length;y++){const _=n[y](a,s[y],o[y]);u.push(_[0]),u.push(_[1]),a=_[1]}const d=[],m=[];for(let y=0;y<u.length;y+=2)d.push(u[y]),m.push(u[y+1]);return[d,m]}}),qZ=ut({multinomial_:function pde(n,t,e,r=!1){const i=Le(n,"logits","multinomial"),s=i.size,o=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);e=e||Math.random();const u={logits:1===o?wt(i,[1,-1]):i},m=ot.runKernel(R2,u,{numSamples:t,seed:e,normalized:r});return 1===o?wt(m,[m.size]):m}}),uv=ut({notEqual_:function mde(n,t){let e=Le(n,"a","notEqual","string_or_numeric"),r=Le(t,"b","notEqual","string_or_numeric");return[e,r]=Ds(e,r),Fr(e.shape,r.shape),ot.runKernel(rS,{a:e,b:r})}}),Gu=ut({onesLike_:function gde(n){const e={x:Le(n,"x","onesLike")};return ot.runKernel(iS,e)}}),ZZ=ut({outerProduct_:function vde(n,t){const e=Le(n,"v1","outerProduct"),r=Le(t,"v2","outerProduct");De(1===e.rank&&1===r.rank,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${e.rank} and ${r.rank}.`);const i=wt(e,[-1,1]),s=wt(r,[1,-1]);return Qr(i,s)}}),ad=ut({pad_:function yde(n,t,e=0){const r=Le(n,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return ot.runKernel(aS,{x:r},{paddings:t,constantValue:e})}}),KZ=ut({pad1d_:function _de(n,t,e=0){return De(2===t.length,()=>"Invalid number of paddings. Must be length of 2."),ad(n,[t],e)}}),XZ=ut({pad2d_:function bde(n,t,e=0){return De(2===t.length&&2===t[0].length&&2===t[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),ad(n,t,e)}}),YZ=ut({pad3d_:function wde(n,t,e=0){return De(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),ad(n,t,e)}}),QZ=ut({pad4d_:function xde(n,t,e=0){return De(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),ad(n,t,e)}}),KS=ut({spaceToBatchND_:function Cde(n,t,e){const r=Le(n,"x","spaceToBatchND");return De(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),De(e.length===t.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${t.length}`),De(r.shape.reduce((o,a,u)=>u>0&&u<=t.length?o&&(a+e[u-1][0]+e[u-1][1])%t[u-1]==0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${t.toString()}`),ot.runKernel(vS,{x:r},{blockShape:t,paddings:e})}}),j5=ut({pool_:function Sde(n,t,e,r,i,s,o){null==i&&(i=[1,1]),null==s&&(s=1),0===r&&(r="valid");const a=Le(n,"x","maxPool");let u=a,d=!1;3===a.rank&&(d=!0,u=wt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),De(la(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const m=uc(u.shape,t,s,i,r),y=[m.dilationHeight,m.dilationWidth];let _;_="same"===r?function Nde(n,t){const r=n.map((o,a)=>o+(o-1)*(t[a]-1)).map(o=>o-1),i=r.map(o=>Math.floor(o/2)),s=r.map((o,a)=>o-i[a]);return r.map((o,a)=>[i[a],s[a]])}([m.filterHeight,m.filterWidth],y):[[0,0],[0,0]];const E=1===y[0]&&1===y[1],[D,O]=function Ede(n,t,e){const r=e.map(m=>m[0]),i=e.map(m=>m[1]),s=n.concat(r,i),o=t.map((m,y)=>(m-s[y]%m)%m),a=i.map((m,y)=>m+o[y]),u=t.map((m,y)=>[r[y],a[y]]),d=t.map((m,y)=>[0,o[y]]);return[u,d]}([m.inHeight,m.inWidth],y,_),R=E?r:"valid",$=E?u:KS(u,y,D),Q=("avg"===e?()=>VS($,t,s,R,o):()=>qS($,t,s,R,o))(),ie=E?Q:zS(Q,y,O);return d?wt(ie,[ie.shape[1],ie.shape[2],ie.shape[3]]):ie}}),XS=ut({prelu_:function Tde(n,t){const e=Le(n,"x","prelu"),r=Le(t,"alpha","prelu");return ot.runKernel(uS,{x:e,alpha:r})}}),q5=ut({prod_:function Ade(n,t=null,e=!1){let r=Le(n,"x","prod");return"bool"===r.dtype&&(r=Fn(r,"int32")),ot.runKernel(lS,{x:r},{axis:t,keepDims:e})}}),JZ=ut({raggedGather_:function Ide(n,t,e,r){const i=n.map((m,y)=>Le(m,`tensors${y}`,"raggedGather","int32")),s=Le(t,"paramsDenseValues","raggedGather"),o=Le(e,"indices","raggedGather","int32"),d=ot.runKernel(L2,{paramsNestedSplits:i,paramsDenseValues:s,indices:o},{outputRaggedRank:r});return{outputNestedSplits:d.slice(0,d.length-1),outputDenseValues:d[d.length-1]}}}),eK=ut({raggedRange_:function Dde(n,t,e){const r=Le(n,"starts","raggedRange"),i=Le(t,"limits","raggedRange",r.dtype),s=Le(e,"deltas","raggedRange",r.dtype),a=ot.runKernel($2,{starts:r,limits:i,deltas:s});return{rtNestedSplits:a[0],rtDenseValues:a[1]}}}),tK=ut({raggedTensorToTensor_:function Mde(n,t,e,r,i){const s=Le(n,"shape","raggedTensorToTensor","int32"),o=Le(t,"values","raggedTensorToTensor"),a=Le(e,"defaultValue","raggedTensorToTensor",o.dtype),u=r.map((y,_)=>Le(y,`tensors${_}`,"raggedTensorToTensor","int32"));return ot.runKernel(B2,{shape:s,values:o,defaultValue:a,rowPartitionTensors:u},{rowPartitionTypes:i})}}),nK=ut({rand_:function kde(n,t,e){Bu(n);const r=Xt(n);let i=null;if(null==e||"float32"===e)i=new Float32Array(r);else if("int32"===e)i=new Int32Array(r);else{if("bool"!==e)throw new Error(`Unknown data type ${e}`);i=new Uint8Array(r)}for(let s=0;s<r;s++)i[s]=t();return ot.makeTensor(i,n,e)}});var W0=z(340);class Z5{constructor(t,e,r,i,s){this.mean=t,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=s||Math.random();this.random=W0.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,e,r=!1;for(;!r;){let i,s,o;do{i=2*this.random()-1,s=2*this.random()-1,o=i*i+s*s}while(o>=1||0===o);const a=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*i*a,e=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(t))&&(r=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Rde{constructor(t,e,r,i){this.alpha=t,this.beta=1/e,this.dtype=r;const s=i||Math.random();this.randu=W0.alea(s.toString()),this.randn=new Z5(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,r,i,s,o;for(;;){do{i=this.randn.nextValue(),o=1+this.c*i}while(o<=0);if(o*=o*o,t=i*i,e=1-.331*t*t,r=.5*t+this.d*(1-o+Math.log(o)),s=this.randu(),s<e||Math.log(s)<r)break}return o*=1/this.beta*this.d,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class Ode{constructor(t=0,e=1,r,i){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=r,null==i&&(i=Math.random()),"number"==typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=W0.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const rK=ut({randomGamma_:function $de(n,t,e=1,r="float32",i){if(Bu(n),null==e&&(e=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error(`Unsupported data type ${r}`);const s=new Rde(t,e,r,i),o=Zr(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),WR=ut({randomNormal_:function Bde(n,t=0,e=1,r,i){if(Bu(n),null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const s=new Z5(t,e,r,!1,i),o=Zr(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),iK=ut({randomStandardNormal_:function Vde(n,t,e){if(null!=t&&"bool"===t)throw new Error(`Unsupported data type ${t}`);return WR(n,0,1,t,e)}}),lv=ut({randomUniform_:function zde(n,t=0,e=1,r="float32",i){Bu(n);const s=Zr(n,r),o=new Ode(t,e,null,i);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}});function cv(n,t,e=1,r="float32"){if(0===e)throw new Error("Cannot have a step of zero");return ot.runKernel(V2,{},{start:n,stop:t,step:e,dtype:r})}const X5=ut({reciprocal_:function Ude(n){const e={x:Le(n,"x","reciprocal")};return ot.runKernel(l0,e)}}),Zc=ut({relu_:function Hde(n){const e={x:Le(n,"x","relu")};return ot.runKernel(c0,e)}}),GR=ut({relu6_:function Wde(n){const e={x:Le(n,"x","relu6")};return ot.runKernel(h0,e)}}),Cl=ut({reverse_:function Gde(n,t){const r={x:Le(n,"x","reverse")};return ot.runKernel(dS,r,{dims:t})}}),sK=ut({reverse1d_:function jde(n){const t=Le(n,"x","reverse");return De(1===t.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Cl(t,0)}}),oK=ut({reverse2d_:function qde(n,t){const e=Le(n,"x","reverse");return De(2===e.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${e.rank}.`),Cl(e,t)}}),aK=ut({reverse3d_:function Zde(n,t){const e=Le(n,"x","reverse");return De(3===e.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${e.rank}.`),Cl(e,t)}}),uK=ut({reverse4d_:function Kde(n,t){const e=Le(n,"x","reverse");return De(4===e.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${e.rank}.`),Cl(e,t)}}),jR=ut({round_:function Xde(n){const e={x:Le(n,"x","round")};return ot.runKernel(f0,e)}}),qR=ut({rsqrt_:function Yde(n){const e={x:Le(n,"x","rsqrt","float32")};return ot.runKernel(d0,e)}}),ZR=ut({selu_:function Qde(n){const e={x:Le(n,"x","selu")};return ot.runKernel(p0,e)}}),KR=ut({separableConv2d_:function Jde(n,t,e,r,i,s=[1,1],o="NHWC"){const a=Le(n,"x","separableConv2d"),u=Le(t,"depthwiseFilter","separableConv2d"),d=Le(e,"pointwiseFilter","separableConv2d");let m=a,y=!1;if(3===a.rank&&(y=!0,m=wt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");De(4===m.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${m.rank}.`),De(4===u.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),De(4===d.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),De(1===d.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${d.shape[0]}.`),De(1===d.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${d.shape[1]}.`);const _=u.shape[2],E=u.shape[3];De(d.shape[2]===_*E,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${_*E}, but got ${d.shape[2]}.`);const D=L0(m,u,r,i,o,s),R=sd(D,d,1,"valid",o);return y?wt(R,[R.shape[1],R.shape[2],R.shape[3]]):R}});function Y5(){return(Y5=(0,Nt.Z)(function*(n,t){const e=Le(n,"x","setdiff1d"),r=Le(t,"y","setdiff1d");De(e.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${e.dtype}) and y (${r.dtype}).`),De(1===e.rank,()=>`x should be 1D tensor, but got x (${e.shape}).`),De(1===r.rank,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=yield e.data(),s=yield r.data(),o=new Set(s);let a=0;for(let m=0;m<i.length;m++)o.has(i[m])||a++;const u=new po([a],e.dtype),d=new po([a],"int32");for(let m=0,y=0;m<i.length;m++)o.has(i[m])||(u.values[y]=i[m],d.values[y]=m,y++);return[u.toTensor(),d.toTensor()]})).apply(this,arguments)}const lK=function epe(n,t){return Y5.apply(this,arguments)},Q5=ut({sign_:function tpe(n){const e={x:Le(n,"x","sign")};return ot.runKernel(v0,e)}}),XR=ut({sin_:function npe(n){const e={x:Le(n,"x","sin","float32")};return ot.runKernel(m0,e)}}),YR=ut({sinh_:function rpe(n){const e={x:Le(n,"x","sinh")};return ot.runKernel(g0,e)}}),YS=ut({slice1d_:function ipe(n,t,e){const r=Le(n,"x","slice1d");return De(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),ui(r,[t],[e])}}),QR=ut({slice2d_:function spe(n,t,e){const r=Le(n,"x","slice2d");return De(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),ui(r,t,e)}}),QS=ut({slice3d_:function ope(n,t,e){const r=Le(n,"x","slice3d");return De(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),ui(r,t,e)}}),G0=ut({slice4d_:function ape(n,t,e){const r=Le(n,"x","slice4d");return De(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),ui(r,t,e)}}),JS=ut({softmax_:function upe(n,t=-1){const e=Le(n,"logits","softmax","float32");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${t}`);return ot.runKernel(_S,{logits:e},{dim:t})}}),eE=ut({fft_:function lpe(n){return De("complex64"===n.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`),ot.runKernel(x2,{input:n})}}),j0=ut({ifft_:function cpe(n){return De("complex64"===n.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`),ot.runKernel(N2,{input:n})}}),JR=ut({irfft_:function hpe(n){const t=n.shape[n.shape.length-1],e=n.size/t;let r;if(t<=2){const i=wt(n,[e,t]);r=j0(i)}else{const i=[e,2*(t-1)],s=wt(O0(n),[e,t]),o=wt(FS(n),[e,t]),a=Cl(ui(s,[0,1],[e,t-2]),1),u=vt(Cl(ui(o,[0,1],[e,t-2]),1),hr(-1)),d=Js([s,a],1),m=Js([o,u],1),y=wt(ed(d,m),[i[0],i[1]]);r=j0(y)}if(r=O0(r),3===n.rank&&0!==n.shape[0]){const i=r,s=n.shape[0];r=wt(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}}),vu=ut({split_:function fpe(n,t,e=0){const i={x:Le(n,"x","split")};return ot.runKernel(yS,i,{numOrSizeSplits:t,axis:e})}}),tE=ut({rfft_:function dpe(n,t){De("float32"===n.dtype,()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let e=n.shape[n.shape.length-1];const r=n.size/e;let i;if(null!=t&&t<e){const D=n.shape.map(R=>0),O=n.shape.map(R=>R);O[n.shape.length-1]=t,i=ui(n,D,O),e=t}else if(null!=t&&t>e){const D=n.shape.map(O=>O);D[n.shape.length-1]=t-e,i=Js([n,vo(D)],n.shape.length-1),e=t}else i=n;const s=ai(i),o=wt(ed(i,s),[r,e]),a=eE(o),u=Math.floor(e/2)+1,d=O0(a),m=FS(a),y=vu(d,[u,e-u],d.shape.length-1),_=vu(m,[u,e-u],m.shape.length-1),E=i.shape.slice();return E[i.shape.length-1]=u,wt(ed(y[0],_[0]),E)}}),eO=ut({squaredDifference_:function ppe(n,t){let e=Le(n,"a","squaredDifference"),r=Le(t,"b","squaredDifference");return[e,r]=Ds(e,r),Fr(e.shape,r.shape),ot.runKernel(w0,{a:e,b:r},{})}}),jp=ut({squeeze_:function mpe(n,t){const e=Le(n,"x","squeeze","string_or_numeric");return wt(e,Kf(e.shape,t).newShape)}}),yu=ut({stack_:function gpe(n,t=0){const e=RS(n,"tensors","stack","string_or_numeric");return De(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&De(t<=e[0].rank,()=>"Axis must be <= rank of the tensor"),ot.runKernel(oS,e,{axis:t})}}),hv=ut({step_:function vpe(n,t=0){const r={x:Le(n,"x","step")};return ot.runKernel(N0,r,{alpha:t})}}),J5=ut({stridedSlice_:function ype(n,t,e,r,i=0,s=0,o=0,a=0,u=0){const m={x:Le(n,"x","stridedSlice","string_or_numeric")};return ot.runKernel(J2,m,{begin:t,end:e,strides:r,beginMask:i,endMask:s,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:u})}}),eH=ut({tan_:function _pe(n){const e={x:Le(n,"x","tan","float32")};return ot.runKernel(C0,e)}});function ka(n,t){Ug(n);const e=$h(n,t);if(1!==e.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return $p(n,null,e,t)}function qp(n,t,e){if(Ug(n),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=$h(n,e);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return $p(n,t,r,e)}function cK(n,t,e){if(Ug(n),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const r=$h(n,e);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return $p(n,t,r,e)}function hK(n,t,e){if(Ug(n),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const r=$h(n,e);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return $p(n,t,r,e)}function fK(n,t,e){if(Ug(n),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const r=$h(n,e);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return $p(n,t=t||r,r,e)}const dK=ut({tensorScatterUpdate_:function bpe(n,t,e){const r=Le(n,"tensor","tensorScatterupdate"),i=Le(t,"indices","tensorScatterupdate","int32"),s=Le(e,"updates","tensorScatterupdate");if(DR(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);return ot.runKernel(G2,{tensor:r,indices:i,updates:s},{})}}),tH=ut({topk_:function wpe(n,t=1,e=!0){const r=Le(n,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const s={x:r},o={k:t,sorted:e},[a,u]=ot.runKernel(rR,s,o);return{values:a,indices:u}}}),tO=ut({truncatedNormal_:function xpe(n,t=0,e=1,r,i){if(Bu(n),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const s=new Z5(t,e,r,!0,i),o=Zr(n,r);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),nH=ut({unique_:function Cpe(n,t=0){const e=Le(n,"x","unique","string_or_numeric");De(e.rank>0,()=>"The input tensor must be at least 1D");const r={x:e},i={axis:t},[s,o]=ot.runKernel(sR,r,i);return{values:s,indices:o}}}),nO=ut({unsortedSegmentSum_:function Spe(n,t,e){const r=Le(n,"x","unsortedSegmentSum"),i=Le(t,"segmentIds","unsortedSegmentSum","int32");return De(Hg(e),()=>"numSegments must be of dtype int"),ot.runKernel(xS,{x:r,segmentIds:i},{numSegments:e})}}),Sl=ut({unstack_:function Epe(n,t=0){const e=Le(n,"x","unstack","string_or_numeric");return De(t>=-e.shape.length&&t<e.shape.length,()=>`Axis = ${t} is not in [-${e.shape.length}, ${e.shape.length})`),ot.runKernel(wS,{value:e},{axis:t})}});function pK(n,t){return HR(n,t,"right")}function rH(n,t=!0,e,r){return ot.makeVariable(n,t,e,r)}function rO(n,t){const e=[];for(let s=0;s<t.length;s++)t[s]&&e.push(s);const r=Zr(n,"int32"),i=Zr([e.length,n.length],"int32");for(let s=0;s<e.length;s++){const o=r.indexToLoc(e[s]);i.values.set(o,s*n.length)}return i.toTensor()}function iH(){return(iH=(0,Nt.Z)(function*(n){const t=Le(n,"condition","whereAsync","bool"),e=yield t.data(),r=rO(t.shape,e);return n!==t&&t.dispose(),r})).apply(this,arguments)}const sH=function Npe(n){return iH.apply(this,arguments)};function oH(){return(oH=(0,Nt.Z)(function*(n,t,e){const r=Le(n,"tensor","boolMask"),i=Le(t,"mask","boolMask","bool"),s=null==e?0:e,o=i.rank,a=r.shape;De(o>0,()=>"mask cannot be scalar"),sa(a.slice(s,s+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let O=s;O<s+o;O++)u*=a[O];const d=a.slice(0,s).concat([u],a.slice(s+o)),m=wt(r,d),y=wt(i,[-1]),_=yield sH(y),E=jp(_,[1]),D=U0(m,E,s);return n!==r&&r.dispose(),t!==i&&i.dispose(),E.dispose(),m.dispose(),y.dispose(),_.dispose(),D})).apply(this,arguments)}const mK=function Tpe(n,t,e){return oH.apply(this,arguments)},gK=ut({movingAverage_:function Ape(n,t,e,r,i=!0){const s=Le(n,"v","movingAverage"),o=Le(t,"x","movingAverage"),a=Le(e,"decay","movingAverage");H7(s,o),De(ri(s.shape,o.shape),()=>"Shape mismatch in v and x");const u=hr(1),d=qn(u,a);let m=vt(qn(o,s),d);if(i){De(null!=r,()=>"When using zeroDebias: true, step is required.");const y=Le(r,"step","movingAverage");m=nr(m,qn(u,nd(a,y)))}return _n(s,m)}}),vK=ut({scatterND_:function Ipe(n,t,e){Bu(e);const r=Le(n,"indices","scatterND","int32"),i=Le(t,"updates","scatterND");return DR(i,r,e),ot.runKernel(W2,{indices:r,updates:i},{shape:e})}}),yK=ut({sparseToDense_:function Mpe(n,t,e,r=0){Bu(e);const i=Le(n,"sparseIndices","sparseToDense","int32"),s=Le(t,"sparseValues","sparseToDense","string_or_numeric"),o=Le(r,"defaultValue","sparseToDense",s.dtype);return function Dpe(n,t,e,r){if("int32"!==n.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const i=n.rank>0?n.shape[0]:1,s=n.rank>1?n.shape[1]:1;if(e.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${e.length}, should be: ${s}.`);if(0!==t.rank&&(1!==t.rank||t.size!==i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,s,e,o),ot.runKernel(Y2,{sparseIndices:i,sparseValues:s,defaultValue:o},{outputShape:e})}}),_K=ut({gatherND_:function kpe(n,t){const e=Le(t,"indices","gatherND","int32"),i={params:Le(n,"x","gatherND","string_or_numeric"),indices:e};return ot.runKernel(E2,i)}}),aH=ut({dropout_:function Ope(n,t,e,r){const i=Le(n,"x","dropout");if(De("float32"===i.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),De(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),0===t)return n instanceof yi?i.clone():i;const s=function Rpe(n,t){if(null==t)return n.shape.slice();if(ri(n.shape,t))return t;if(n.shape.length===t.length){const e=[];for(let r=0;r<n.shape.length;r++)e.push(null==t[r]&&null!=n.shape[r]?n.shape[r]:t[r]);return e}return t}(i,e),o=1-t,a=nr(z0(_n(lv(s,0,1,"float32",r),o)),o);return vt(i,a)}});function uH(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function iO(n,t,e){const r=1-n%2,i=new Float32Array(n);for(let s=0;s<n;++s){const o=2*Math.PI*s/(n+r-1);i[s]=t-e*Math.cos(o)}return ka(i,"float32")}function lH(){return(lH=(0,Nt.Z)(function*(n,t,e=1){const r=Le(n,"predictions","inTopK"),i=Le(t,"targets","inTopK");De(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),De(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),sa(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];De(e>0&&e<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${e}`);const o=yield r.data(),a=yield i.data(),[u,d]=[o.length/s,s],m=Wo("bool",u);for(let y=0;y<u;y++){const _=y*d,E=o.subarray(_,_+d),D=[];for(let O=0;O<E.length;O++)D.push({value:E[O],index:O});D.sort((O,R)=>R.value-O.value),m[y]=0;for(let O=0;O<e;O++)if(D[O].index===a[y]){m[y]=1;break}}return n!==r&&r.dispose(),t!==i&&i.dispose(),Vu(m,i.shape,"bool")})).apply(this,arguments)}const bK=function Fpe(n,t){return lH.apply(this,arguments)},cH=ut({conv2DBackpropFilter_:function Ppe(n,t,e,r,i,s="NHWC",o){let a=n;3===n.rank&&(a=wt(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=t;3===u.rank&&(u=wt(t,[1,t.shape[0],t.shape[1],t.shape[2]])),De(4===a.rank,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),De(4===u.rank,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),De(4===e.length,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);const d="NHWC"===s?a.shape[3]:a.shape[1],m="NHWC"===s?u.shape[3]:u.shape[1];return De(d===e[2],()=>`Error in conv2dDerFilter: depth of input ${d}) must match input depth in filter (${e[2]}.`),De(m===e[3],()=>`Error in conv2dDerFilter: depth of dy (${m}) must match output depth for filter (${e[3]}).`),Za("conv2dDerFilter",i,o),ot.runKernel(u2,{x:a,dy:u},{strides:r,pad:i,dataFormat:s,dimRoundingMode:o,filterShape:e})}});function sO(n,t,e){if(null==e||"linear"===e)return n;if("relu"===e)return vt(n,hv(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function oO(n,t){let e=t;const r=go(n.shape,t.shape);return r.length>0&&(e=Yn(e,r)),wt(e,n.shape)}function aO(n,t,e,r){if("linear"===t)return n;if("relu"===t)return Zc(n);if("elu"===t)return $0(n);if("relu6"===t)return GR(n);if("prelu"===t)return XS(n,e);if("leakyrelu"===t)return WS(n,r);if("sigmoid"===t)return qc(n);throw new Error(`Unknown fused activation ${t}.`)}const uO=(n,t)=>!(n>0)||"linear"===t,wK=ut({fusedConv2d_:function Lpe({x:n,filter:t,strides:e,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:d,leakyreluAlpha:m}){if(!1===uO(ot.state.gradientDepth,u=u||"linear")){De("NHWC"===i,()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let Me=sd(n,t,e,r,i,s,o);return null!=a&&(Me=_n(Me,a)),aO(Me,u,d,m)}const y=Le(n,"x","conv2d","float32"),_=Le(t,"filter","conv2d","float32");let E=y,D=!1;3===y.rank&&(D=!0,E=wt(y,[1,y.shape[0],y.shape[1],y.shape[2]])),De(4===E.rank,()=>`Error in fused conv2d: input must be rank 4, but got rank ${E.rank}.`),De(4===_.rank,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${_.rank}.`),Za("fused conv2d",r,o);const O="NHWC"===i?E.shape[3]:E.shape[1];De(_.shape[2]===O,()=>`Error in conv2d: depth of input (${O}) must match input depth for filter ${_.shape[2]}.`),De(la(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`);const R=qo(E.shape,_.shape,e,s,r,o);let $,B;if(null!=a&&($=Le(a,"bias","fused conv2d"),[$]=Ds($,y),"NHWC"===i?Fr(R.outShape,$.shape):(De($.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${$.shape.length}.`),De(0===$.shape.length||$.shape[0]===R.outChannels||1===$.shape[0],()=>`Error in fused conv2d: bias shape (${$.shape}) is not compatible with the number of output channels (${R.outChannels})`))),null!=d){const Me=d.shape;if(De(Me.length<=1||3===Me.length,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${Me.length}.`),1===Me.length)De(1===Me[0]||Me[0]===R.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${Me}) is not compatible with the number of output channels (${R.outChannels}).`);else if(3===Me.length)try{Fr(Me,R.outShape)}catch(Be){throw Error(`Error in fused conv2d: PReLU activation weights (${Me}) is not compatible with the output shape of the conv2d (${R.outShape}).`)}B=Le(d,"prelu weights","fused conv2d")}const Q=(Me,Be)=>{De("NHWC"===i,()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[He,st,lt,It]=Be,zt=sO(Me,lt,u);De(Up(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const Kt=[N5(st.shape,zt,He,e,r),cH(st,zt,He.shape,e,r)];if(null!=It){const Tt=oO(It,zt);Kt.push(Tt)}return Kt},ie={x:E,filter:_,bias:$,preluActivationWeights:B},ye={strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:m};return null==a?zh((Be,He,st)=>{let lt=ot.runKernel(ES,ie,ye);return st([He,Be,lt]),D&&(lt=wt(lt,[lt.shape[1],lt.shape[2],lt.shape[3]])),{value:lt,gradFunc:Q}})(E,_):zh((Be,He,st,lt)=>{let It=ot.runKernel(ES,ie,ye);return lt([He,Be,It,st]),D&&(It=wt(It,[It.shape[1],It.shape[2],It.shape[3]])),{value:It,gradFunc:Q}})(E,_,$)}}),xK=ut({depthwiseConv2dNativeBackpropFilter_:function $pe(n,t,e,r,i,s=[1,1],o){let a=n;3===n.rank&&(a=wt(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=t;return 3===u.rank&&(u=wt(t,[1,t.shape[0],t.shape[1],t.shape[2]])),ot.runKernel(m2,{x:a,dy:u},{strides:r,pad:i,dimRoundingMode:o,dilations:s,filterShape:e})}}),CK=ut({depthwiseConv2dNativeBackpropInput_:function Bpe(n,t,e,r,i,s=[1,1],o){let a=t,u=!1;3===t.rank&&(u=!0,a=wt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const y=ot.runKernel(g2,{dy:a,filter:e},{strides:r,pad:i,dimRoundingMode:o,dilations:s,inputShape:n});return u?wt(y,[y.shape[1],y.shape[2],y.shape[3]]):y}}),zpe=ut({fusedDepthwiseConv2d_:function Vpe({x:n,filter:t,strides:e,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:d,leakyreluAlpha:m}){if(!1===uO(ot.state.gradientDepth,u)){let ye=L0(n,t,e,r,i,s,o);return null!=a&&(ye=_n(ye,a)),aO(ye,u,d,m)}const y=Le(n,"x","depthwiseConv2d","float32"),_=Le(t,"filter","depthwiseConv2d","float32");let E=y,D=!1;3===y.rank&&(D=!0,E=wt(y,[1,y.shape[0],y.shape[1],y.shape[2]])),De(4===E.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${E.rank}.`),De(4===_.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${_.rank}.`),De(E.shape[3]===_.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${E.shape[3]}) must match the inChannels dimension in filter ${_.shape[2]}.`),null==s&&(s=[1,1]),De(la(e,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),Za("fused depthwiseConv2d",r,o);const O=qo(E.shape,_.shape,e,s,r,o,!0);let R,$;null!=a&&(R=Le(a,"bias","fused conv2d"),[R]=Ds(R,y),Fr(O.outShape,R.shape)),null!=d&&($=Le(d,"prelu weights","fused depthwiseConv2d"));const B=(ye,Me)=>{De(Up(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[Be,He,st,lt]=Me,It=sO(ye,st,u),zt=CK(He.shape,It,Be,e,r,s,o),Wt=xK(He,It,Be.shape,e,r,s,o);return null!=lt?[zt,Wt,oO(R,It)]:[zt,Wt]},Q={x:E,filter:_,bias:R,preluActivationWeights:$},ie={strides:e,pad:r,dataFormat:i,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:m};return null==a?zh((Me,Be,He)=>{let st=ot.runKernel(NS,Q,ie);return He([Be,Me,st]),D&&(st=wt(st,[st.shape[1],st.shape[2],st.shape[3]])),{value:st,gradFunc:B}})(E,_):zh((Me,Be,He,st)=>{let lt=ot.runKernel(NS,Q,ie);return st([Be,Me,lt,He]),D&&(lt=wt(lt,[lt.shape[1],lt.shape[2],lt.shape[3]])),{value:lt,gradFunc:B}})(E,_,R)}}),hH=ut({fusedMatMul_:function Upe({a:n,b:t,transposeA:e=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(!1===uO(ot.state.gradientDepth,s)){let It=Qr(n,t,e,r);return null!=i&&(It=_n(It,i)),aO(It,s,o,a)}let u=Le(n,"a","fused matMul"),d=Le(t,"b","fused matMul");[u,d]=Ds(u,d);const m=e?u.shape[u.rank-2]:u.shape[u.rank-1],y=r?d.shape[d.rank-1]:d.shape[d.rank-2],_=e?u.shape[u.rank-1]:u.shape[u.rank-2],E=r?d.shape[d.rank-2]:d.shape[d.rank-1],D=u.shape.slice(0,-2),O=d.shape.slice(0,-2),R=Xt(D),$=Xt(O);De(m===y,()=>`Error in fused matMul: inner shapes (${m}) and (${y}) of Tensors with shapes ${u.shape} and ${d.shape} and transposeA=${e} and transposeB=${r} must match.`);const Q=Fr(u.shape.slice(0,-2),d.shape.slice(0,-2)).concat([_,E]),ie=wt(u,e?[R,m,_]:[R,_,m]),ye=wt(d,r?[$,E,y]:[$,y,E]);let Me,Be;null!=i&&(Me=Le(i,"bias","fused matMul"),[Me]=Ds(Me,u),Fr(Q,Me.shape)),null!=o&&(Be=Le(o,"prelu weights","fused matMul"));const He=(It,zt)=>{const[Wt,qt,Kt,Tt]=zt,Rt=sO(wt(It,Kt.shape),Kt,s);let Dt,Ht;return e||r?!e&&r?(Dt=Qr(Rt,qt,!1,!1),Ht=Qr(Rt,Wt,!0,!1)):e&&!r?(Dt=Qr(qt,Rt,!1,!0),Ht=Qr(Wt,Rt,!1,!1)):(Dt=Qr(qt,Rt,!0,!0),Ht=Qr(Rt,Wt,!0,!0)):(Dt=Qr(Rt,qt,!1,!0),Ht=Qr(Wt,Rt,!0,!1)),null!=i?[Dt,Ht,oO(Tt,Rt)]:[Dt,Ht]},st={a:ie,b:ye,bias:Me,preluActivationWeights:Be},lt={transposeA:e,transposeB:r,activation:s,leakyreluAlpha:a};return null==i?zh((zt,Wt,qt)=>{const Kt=ot.runKernel(SS,st,lt);return qt([zt,Wt,Kt]),{value:wt(Kt,Q),gradFunc:He}})(ie,ye):zh((zt,Wt,qt,Kt)=>{const Tt=ot.runKernel(SS,st,lt);return Kt([zt,Wt,Tt,qt]),{value:wt(Tt,Q),gradFunc:He}})(ie,ye,Me)}}),Wpe=ut({hammingWindow_:function Hpe(n){return iO(n,.54,.46)}}),SK=ut({hannWindow_:function Gpe(n){return iO(n,.5,.5)}}),EK=ut({frame_:function jpe(n,t,e,r=!1,i=0){let s=0;const o=[];for(;s+t<=n.size;)o.push(ui(n,s,t)),s+=e;if(r)for(;s<n.size;){const a=s+t-n.size,u=Js([ui(n,s,t-a),ev([a],i)]);o.push(u),s+=e}return 0===o.length?qp([],[0,t]):wt(Js(o),[o.length,t])}}),Zpe=ut({stft_:function qpe(n,t,e,r,i=SK){null==r&&(r=uH(t));const s=EK(n,t,e),o=vt(s,i(t));return tE(o,r)}}),Xpe=ut({cropAndResize_:function Kpe(n,t,e,r,i="bilinear",s=0){const o=Le(n,"image","cropAndResize"),a=Le(t,"boxes","cropAndResize","float32"),u=Le(e,"boxInd","cropAndResize","int32"),d=a.shape[0];return De(4===o.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),De(2===a.rank&&4===a.shape[1],()=>`Error in cropAndResize: boxes must be have size [${d},4] but had shape ${a.shape}.`),De(1===u.rank&&u.shape[0]===d,()=>`Error in cropAndResize: boxInd must be have size [${d}] but had shape ${a.shape}.`),De(2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),De(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),De("bilinear"===i||"nearest"===i,()=>`method must be bilinear or nearest, but was ${i}`),ot.runKernel(f2,{image:o,boxes:a,boxInd:u},{method:i,extrapolationValue:s,cropSize:r})}}),Qpe=ut({flipLeftRight_:function Ype(n){const t=Le(n,"image","flipLeftRight","float32");return De(4===t.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`),ot.runKernel(S2,{image:t},{})}}),eme=ut({grayscaleToRGB_:function Jpe(n){const t=Le(n,"image","grayscaleToRGB"),e=t.rank-1,r=t.shape[e];De(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),De(1===r,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(t.rank);return i.fill(1,0,e),i[e]=3,xl(t,i)}}),nme=ut({rotateWithOffset_:function tme(n,t,e=0,r=.5){const i=Le(n,"image","rotateWithOffset","float32");return De(4===i.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`),ot.runKernel(aR,{image:i},{radians:t,fillValue:e,center:r})}});function q0(n,t,e,r,i,s){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=n.shape[0];return e=Math.min(e,o),De(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),De(2===n.rank,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),De(4===n.shape[1],()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),De(1===t.rank,()=>"scores must be a 1D tensor"),De(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),De(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:e,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}const ime=ut({nonMaxSuppression_:function rme(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY){const s=Le(n,"boxes","nonMaxSuppression","float32"),o=Le(t,"scores","nonMaxSuppression","float32"),a=q0(s,o,e,r,i);return ot.runKernel(O2,{boxes:s,scores:o},{maxOutputSize:e=a.maxOutputSize,iouThreshold:r=a.iouThreshold,scoreThreshold:i=a.scoreThreshold})}});function sme(n,t,e){const r=function ome(n,t,e){return function ume(n,t,e){let r=0,i=n.length,s=0,o=!1;for(;r<i;){s=r+(i-r>>>1);const a=e(t,n[s]);a>0?r=s+1:(i=s,o=!a)}return o?r:-r-1}(n,t,e||ame)}(n,t,e);n.splice(r<0?-(r+1):r,0,t)}function ame(n,t){return n>t?1:n<t?-1:0}function lO(n,t,e,r,i){return fH(n,t,e,r,i,0)}function cO(n,t,e,r,i,s){return fH(n,t,e,r,i,0,!1,s,!0)}function hO(n,t,e,r,i,s){return fH(n,t,e,r,i,s,!0)}function fH(n,t,e,r,i,s,o=!1,a=!1,u=!1){const d=[];for(let R=0;R<t.length;R++)t[R]>i&&d.push({score:t[R],boxIndex:R,suppressBeginIndex:0});d.sort(NK);const m=s>0?-.5/s:0,y=[],_=[];for(;y.length<e&&d.length>0;){const R=d.pop(),{score:$,boxIndex:B,suppressBeginIndex:Q}=R;if($<i)break;let ie=!1;for(let ye=y.length-1;ye>=Q;--ye){const Me=lme(n,B,y[ye]);if(Me>=r){ie=!0;break}if(R.score=R.score*cme(r,m,Me),R.score<=i)break}R.suppressBeginIndex=y.length,ie||(R.score===$?(y.push(B),_.push(R.score)):R.score>i&&sme(d,R,NK))}const E=y.length,D=e-E;a&&D>0&&(y.push(...new Array(D).fill(0)),_.push(...new Array(D).fill(0)));const O={selectedIndices:y};return o&&(O.selectedScores=_),u&&(O.validOutputs=E),O}function lme(n,t,e){const r=n.subarray(4*t,4*t+4),i=n.subarray(4*e,4*e+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),d=Math.min(i[0],i[2]),m=Math.min(i[1],i[3]),y=Math.max(i[0],i[2]),_=Math.max(i[1],i[3]),E=(a-s)*(u-o),D=(y-d)*(_-m);if(E<=0||D<=0)return 0;const O=Math.max(s,d),R=Math.max(o,m),$=Math.min(a,y),B=Math.min(u,_),Q=Math.max($-O,0)*Math.max(B-R,0);return Q/(E+D-Q)}function cme(n,t,e){const r=Math.exp(t*e*e);return e<=n?r:0}function NK(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}function dH(){return(dH=(0,Nt.Z)(function*(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY){const s=Le(n,"boxes","nonMaxSuppressionAsync"),o=Le(t,"scores","nonMaxSuppressionAsync"),a=q0(s,o,e,r,i);e=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const u=yield Promise.all([s.data(),o.data()]),d=u[0],m=u[1],{selectedIndices:y}=lO(d,m,e,r,i);return s!==n&&s.dispose(),o!==t&&o.dispose(),ka(y,"int32")})).apply(this,arguments)}const pme=ut({nonMaxSuppressionWithScore_:function dme(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=Le(n,"boxes","nonMaxSuppression"),a=Le(t,"scores","nonMaxSuppression"),u=q0(o,a,e,r,i,s),y=ot.runKernel(P2,{boxes:o,scores:a},{maxOutputSize:e=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:s=u.softNmsSigma});return{selectedIndices:y[0],selectedScores:y[1]}}});function pH(){return(pH=(0,Nt.Z)(function*(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const o=Le(n,"boxes","nonMaxSuppressionAsync"),a=Le(t,"scores","nonMaxSuppressionAsync"),u=q0(o,a,e,r,i,s);e=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,s=u.softNmsSigma;const d=yield Promise.all([o.data(),a.data()]),m=d[0],y=d[1],{selectedIndices:_,selectedScores:E}=hO(m,y,e,r,i,s);return o!==n&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:ka(_,"int32"),selectedScores:ka(E)}})).apply(this,arguments)}const yme=ut({nonMaxSuppressionPadded_:function vme(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=Le(n,"boxes","nonMaxSuppression"),a=Le(t,"scores","nonMaxSuppression"),u=q0(o,a,e,r,i,null),D=ot.runKernel(F2,{boxes:o,scores:a},{maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:s});return{selectedIndices:D[0],validOutputs:D[1]}}});function mH(){return(mH=(0,Nt.Z)(function*(n,t,e,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const o=Le(n,"boxes","nonMaxSuppressionAsync"),a=Le(t,"scores","nonMaxSuppressionAsync"),u=q0(o,a,e,r,i,null),d=u.maxOutputSize,m=u.iouThreshold,y=u.scoreThreshold,[_,E]=yield Promise.all([o.data(),a.data()]),{selectedIndices:D,validOutputs:O}=cO(_,E,d,m,y,s);return o!==n&&o.dispose(),a!==t&&a.dispose(),{selectedIndices:ka(D,"int32"),validOutputs:hr(O,"int32")}})).apply(this,arguments)}const TK=ut({resizeBilinear_:function wme(n,t,e=!1,r=!1){const i=Le(n,"images","resizeBilinear");De(3===i.rank||4===i.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),De(2===t.length,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),De(!1===r||!1===e,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;3===i.rank&&(o=!0,s=wt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=t,d=ot.runKernel(fS,{images:s},{alignCorners:e,halfPixelCenters:r,size:t});return o?wt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),AK=ut({resizeNearestNeighbor_:function xme(n,t,e=!1,r=!1){const i=Le(n,"images","resizeNearestNeighbor");De(3===i.rank||4===i.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),De(2===t.length,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),De("float32"===i.dtype||"int32"===i.dtype,()=>"`images` must have `int32` or `float32` as dtype"),De(!1===r||!1===e,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,o=!1;3===i.rank&&(o=!0,s=wt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=t,d=ot.runKernel(hS,{images:s},{alignCorners:e,halfPixelCenters:r,size:t});return o?wt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Eme=ut({threshold_:function Cme(n,t="binary",e=!1,r=.5){const i=Le(n,"image","threshold"),u=i.shape[0]*i.shape[1];let m,y,_,E,d=vt(ka([r]),255);if(De(3===i.rank,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),De(3===i.shape[2]||1===i.shape[2],()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),De("int32"===i.dtype||"float32"===i.dtype,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),De("otsu"===t||"binary"===t,()=>`Method must be binary or otsu, but was ${t}`),3===i.shape[2]){[m,y,_]=vu(i,[1,1,1],-1);const R=vt(m,.2989),$=vt(y,.587),B=vt(_,.114);E=_n(_n(R,$),B)}else E=n;"otsu"===t&&(d=function Sme(n,t){let s,o,a,u,d,m,e=ka([-1]),r=ka([0]),i=ka([0]);for(let y=0;y<n.size-1;y++){s=ui(n,0,y+1),o=ui(n,y+1),d=nr(Yn(s),t),m=nr(Yn(o),t);const _=Yn(vt(s,cv(0,s.size)));a=nr(_,Yn(s));const E=ev(o.shape,s.size),D=_n(cv(0,o.size),E),O=vt(o,D);u=nr(Yn(O),Yn(o));const R=qn(a,u),$=qn(a,u),B=vt(d,m);i=vt(vt(B,R),$);const Q=Ka(i,r);r=Zo(Q,i,r),e=Zo(Q,ka([y]),e)}return e}(b5(Fn(jR(E),"int32"),Vu([]),256),u));const D=e?Wp(E,d):Ka(E,d);return Fn(vt(D,255),"int32")}}),Tme=ut({transform_:function Nme(n,t,e="nearest",r="constant",i=0,s){const o=Le(n,"image","transform","float32"),a=Le(t,"transforms","transform","float32");return De(4===o.rank,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),De(2===a.rank&&(a.shape[0]===o.shape[0]||1===a.shape[0])&&8===a.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),De(null==s||2===s.length,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`),ot.runKernel(iR,{image:o,transforms:a},{interpolation:e,fillMode:r,fillValue:i,outputShape:s})}}),Ime=ut({bandPart_:function Ame(n,t,e){const r=Le(n,"a","bandPart");De(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,o]=r.shape.slice(-2);let a,u;"number"==typeof t?(De(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),De(t<=s,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`),a=Le(t<0?s:t,"numLower","bandPart")):(De("int32"===t.dtype,()=>"bandPart(): numLower's dtype must be an int32."),a=Zo(H0(t,0),s,Gp(t,s))),"number"==typeof e?(De(e%1==0,()=>`bandPart(): numUpper must be an integer, got ${e}.`),De(e<=o,()=>`bandPart(): numUpper (${e}) must not be greater than the number of columns (${o}).`),u=Le(e<0?o:e,"numUpper","bandPart")):(De("int32"===e.dtype,()=>"bandPart(): numUpper's dtype must be an int32."),u=Zo(H0(e,0),o,Gp(e,o)));const d=wt(cv(0,s,1,"int32"),[-1,1]),m=cv(0,o,1,"int32"),y=qn(d,m),_=lc(Wp(y,a),od(y,ss(u))),E=vo([s,o],r.dtype);return wt(yu(Sl(wt(r,[-1,s,o])).map(D=>Zo(_,D,E))),i)}}),Mme=ut({gramSchmidt_:function Dme(n){let t;if(Array.isArray(n)){t=!1,De(null!=n&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=n[0].shape[0];for(let s=1;s<n.length;++s)De(n[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[s].shape[0]} vs. ${i})`)}else t=!0,n=vu(n,n.shape[0],0).map(i=>jp(i,[0]));De(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const e=[],r=n;for(let i=0;i<n.length;++i)e.push(ot.tidy(()=>{let s=r[i];if(i>0)for(let o=0;o<i;++o){const a=vt(Yn(vt(e[o],s)),e[o]);s=qn(s,a)}return nr(s,V0(s,"euclidean"))}));return t?yu(e,0):e}});function IK(n,t=!1){return ot.tidy(()=>{De(2===n.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const e=n.shape[0],r=n.shape[1];let i=$R(e),s=Vh(n);const o=qp([[1]],[1,1]);let a=Vh(o);const u=e>=r?r:e;for(let d=0;d<u;++d){const m=s,y=a,_=i;[a,s,i]=ot.tidy(()=>{const E=ui(s,[d,d],[e-d,1]),D=V0(E),O=ui(s,[d,d],[1,1]),R=Zo(Ka(O,0),qp([[-1]]),qp([[1]])),$=qn(O,vt(R,D)),B=nr(E,$);a=1===B.shape[0]?Vh(o):Js([o,ui(B,[1,0],[B.shape[0]-1,B.shape[1]])],0);const Q=ss(nr(Qr(R,$),D)),ie=ui(s,[d,0],[e-d,r]),ye=vt(Q,a),Me=ii(a);if(0===d)s=qn(ie,Qr(ye,Qr(Me,ie)));else{const st=qn(ie,Qr(ye,Qr(Me,ie)));s=Js([ui(s,[0,0],[d,r]),st],0)}const Be=ii(ye),He=ui(i,[0,d],[e,i.shape[1]-d]);if(0===d)i=qn(He,Qr(Qr(He,a),Be));else{const st=qn(He,Qr(Qr(He,a),Be));i=Js([ui(i,[0,0],[e,d]),st],1)}return[a,s,i]}),Or([m,y,_])}return!t&&e>r&&(i=ui(i,[0,0],[e,r]),s=ui(s,[0,0],[r,r])),[i,s]})}const Rme=ut({qr_:function kme(n,t=!1){if(De(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),2===n.rank)return IK(n,t);{const e=n.shape.slice(0,n.shape.length-2).reduce((u,d)=>u*d),r=Sl(wt(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],s=[];return r.forEach(u=>{const[d,m]=IK(u,t);i.push(d),s.push(m)}),[wt(yu(i,0),n.shape),wt(yu(s,0),n.shape)]}}});var Ra=(()=>{return(n=Ra||(Ra={}))[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS",Ra;var n})();const ud=ut({computeWeightedLoss_:function Ome(n,t,e=Ra.SUM_BY_NONZERO_WEIGHTS){const r=Le(n,"losses","computeWeightedLoss");let i=null;null!=t&&(i=Le(t,"weights","computeWeightedLoss"));const s=null==i?r:vt(r,i);if(e===Ra.NONE)return s;if(e===Ra.SUM)return Yn(s);if(e===Ra.MEAN){if(null==i)return Rs(s);{const o=r.size/i.size,a=nr(Yn(s),Yn(i));return o>1?nr(a,hr(o)):a}}if(e===Ra.SUM_BY_NONZERO_WEIGHTS){if(null==i)return nr(Yn(s),hr(r.size));{const o=vt(i,Wu(r.shape)),a=Fn(Yn(uv(o,hr(0))),"float32");return nr(Yn(s),a)}}throw Error(`Unknown reduction: ${e}`)}}),Pme=ut({absoluteDifference_:function Fme(n,t,e,r=Ra.SUM_BY_NONZERO_WEIGHTS){const i=Le(n,"labels","absoluteDifference"),s=Le(t,"predictions","absoluteDifference");let o=null;null!=e&&(o=Le(e,"weights","absoluteDifference")),sa(i.shape,s.shape,"Error in absoluteDifference: ");const a=mo(qn(i,s));return ud(a,o,r)}}),$me=ut({cosineDistance_:function Lme(n,t,e,r,i=Ra.SUM_BY_NONZERO_WEIGHTS){const s=Le(n,"labels","cosineDistance"),o=Le(t,"predictions","cosineDistance");let a=null;null!=r&&(a=Le(r,"weights","cosineDistance")),sa(s.shape,o.shape,"Error in cosineDistance: ");const u=hr(1),d=qn(u,Yn(vt(s,o),e,!0));return ud(d,a,i)}}),Vme=ut({hingeLoss_:function Bme(n,t,e,r=Ra.SUM_BY_NONZERO_WEIGHTS){let i=Le(n,"labels","hingeLoss");const s=Le(t,"predictions","hingeLoss");let o=null;null!=e&&(o=Le(e,"weights","hingeLoss")),sa(i.shape,s.shape,"Error in hingeLoss: ");const a=hr(1);i=qn(vt(hr(2),i),a);const u=Zc(qn(a,vt(i,s)));return ud(u,o,r)}}),Ume=ut({huberLoss_:function zme(n,t,e,r=1,i=Ra.SUM_BY_NONZERO_WEIGHTS){const s=Le(n,"labels","huberLoss"),o=Le(t,"predictions","huberLoss");let a=null;null!=e&&(a=Le(e,"weights","huberLoss")),sa(s.shape,o.shape,"Error in huberLoss: ");const u=hr(r),d=mo(qn(o,s)),m=Gp(d,u),y=qn(d,m),_=_n(vt(hr(.5),Zi(m)),vt(u,y));return ud(_,a,i)}}),Wme=ut({logLoss_:function Hme(n,t,e,r=1e-7,i=Ra.SUM_BY_NONZERO_WEIGHTS){const s=Le(n,"labels","logLoss"),o=Le(t,"predictions","logLoss");let a=null;null!=e&&(a=Le(e,"weights","logLoss")),sa(s.shape,o.shape,"Error in logLoss: ");const u=hr(1),d=hr(r),m=ss(vt(s,Hu(_n(o,d)))),y=vt(qn(u,s),Hu(_n(qn(u,o),d))),_=qn(m,y);return ud(_,a,i)}}),jme=ut({meanSquaredError_:function Gme(n,t,e,r=Ra.SUM_BY_NONZERO_WEIGHTS){const i=Le(n,"labels","meanSquaredError"),s=Le(t,"predictions","meanSquaredError");let o=null;null!=e&&(o=Le(e,"weights","meanSquaredError")),sa(i.shape,s.shape,"Error in meanSquaredError: ");const a=eO(i,s);return ud(a,o,r)}}),Kme=ut({sigmoidCrossEntropy_:function Zme(n,t,e,r=0,i=Ra.SUM_BY_NONZERO_WEIGHTS){let s=Le(n,"multiClassLabels","sigmoidCrossEntropy");const o=Le(t,"logits","sigmoidCrossEntropy");let a=null;if(null!=e&&(a=Le(e,"weights","sigmoidCrossEntropy")),sa(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const d=hr(r),m=hr(1),y=hr(.5);s=_n(vt(s,qn(m,d)),vt(y,d))}const u=function qme(n,t){const e=Le(n,"labels","sigmoidCrossEntropyWithLogits"),r=Le(t,"logits","sigmoidCrossEntropyWithLogits");sa(e.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=Zc(r),s=vt(r,e),o=GS(Uu(ss(mo(r))));return _n(qn(i,s),o)}(s,o);return ud(u,a,i)}}),Qme=ut({softmaxCrossEntropy_:function Yme(n,t,e,r=0,i=Ra.SUM_BY_NONZERO_WEIGHTS){let s=Le(n,"onehotLabels","softmaxCrossEntropy");const o=Le(t,"logits","softmaxCrossEntropy");let a=null;if(null!=e&&(a=Le(e,"weights","softmaxCrossEntropy")),sa(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const d=hr(r),m=hr(1),y=hr(s.shape[1]);s=_n(vt(s,qn(m,d)),nr(d,y))}const u=function Xme(n,t,e=-1){if(-1===e&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${e}`);return zh((i,s,o)=>{const u=VR(s,[e],!0),d=qn(Fn(s,"float32"),u);o([i,d]);const m=ss(vt(d,i));return{value:Yn(m,[e]),gradFunc:(E,D)=>{const[O,R]=D,$=eo(E.shape,[e]);return[vt(wt(E,$),qn(Fn(O,"float32"),Uu(R))),vt(wt(E,$),qn(Uu(R),Fn(O,"float32")))]}}})(n,t)}(s,o);return ud(u,a,i)}}),DK={fft:eE,ifft:j0,rfft:tE,irfft:JR},MK={hammingWindow:Wpe,hannWindow:SK,frame:EK,stft:Zpe},cc={flipLeftRight:Qpe,grayscaleToRGB:eme,resizeNearestNeighbor:AK,resizeBilinear:TK,rotateWithOffset:nme,cropAndResize:Xpe,nonMaxSuppression:ime,nonMaxSuppressionAsync:function hme(n,t,e){return dH.apply(this,arguments)},nonMaxSuppressionWithScore:pme,nonMaxSuppressionWithScoreAsync:function mme(n,t,e){return pH.apply(this,arguments)},nonMaxSuppressionPadded:yme,nonMaxSuppressionPaddedAsync:function _me(n,t,e){return mH.apply(this,arguments)},threshold:Eme,transform:Tme},gH={bandPart:Ime,gramSchmidt:Mme,qr:Rme},kK={absoluteDifference:Pme,computeWeightedLoss:ud,cosineDistance:$me,hingeLoss:Vme,huberLoss:Ume,logLoss:Wme,meanSquaredError:jme,sigmoidCrossEntropy:Kme,softmaxCrossEntropy:Qme},RK={sparseFillEmptyRows:ut({sparseFillEmptyRows_:function Jme(n,t,e,r){const i=Le(n,"indices","sparseFillEmptyRows","int32"),s=Le(t,"values","sparseFillEmptyRows"),o=Le(e,"denseShape","sparseFillEmptyRows","int32"),a=Le(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(2!==i.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${i.shape}`);if(1!==s.rank)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(1!==o.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(0!==a.rank)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const d=ot.runKernel(q2,{indices:i,values:s,denseShape:o,defaultValue:a});return{outputIndices:d[0],outputValues:d[1],emptyRowIndicator:d[2],reverseIndexMap:d[3]}}}),sparseReshape:ut({sparseReshape_:function tge(n,t,e){const r=Le(n,"inputIndices","sparseReshape","int32"),i=Le(t,"inputShape","sparseReshape","int32"),s=Le(e,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==i.rank)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(1!==s.rank)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const a=ot.runKernel(Z2,{inputIndices:r,inputShape:i,newShape:s});return{outputIndices:a[0],outputShape:a[1]}}}),sparseSegmentMean:ut({sparseSegmentMean_:function rge(n,t,e){const r=Le(n,"data","sparseSegmentMean"),i=Le(t,"indices","sparseSegmentMean","int32"),s=Le(e,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${i.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${s.shape}`);return ot.runKernel(K2,{data:r,indices:i,segmentIds:s})}}),sparseSegmentSum:ut({sparseSegmentSum_:function sge(n,t,e){const r=Le(n,"data","sparseSegmentSum"),i=Le(t,"indices","sparseSegmentSum","int32"),s=Le(e,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${i.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${s.shape}`);return ot.runKernel(X2,{data:r,indices:i,segmentIds:s})}})},OK={stringNGrams:ut({stringNGrams_:function age(n,t,e,r,i,s,o,a){const u=Le(n,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error(`Data must be a vector, saw: ${u.shape}`);const d=Le(t,"dataSplits","stringNGrams");if("int32"!==d.dtype)throw new Error("Data splits must be of datatype int32");const _=ot.runKernel(eR,{data:u,dataSplits:d},{separator:e,nGramWidths:r,leftPad:i,rightPad:s,padWidth:o,preserveShortSequences:a});return{nGrams:_[0],nGramsSplits:_[1]}}}),stringSplit:ut({stringSplit_:function lge(n,t,e=!0){const r=Le(n,"input","stringSplit","string"),i=Le(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==i.rank)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const a=ot.runKernel(tR,{input:r,delimiter:i},{skipEmpty:e});return{indices:a[0],values:a[1],shape:a[2]}}}),stringToHashBucketFast:ut({stringToHashBucketFast_:function hge(n,t){const e=Le(n,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");return ot.runKernel(nR,{input:e},r)}}),staticRegexReplace:ut({staticRegexReplace_:function dge(n,t,e,r=!0){const i=Le(n,"input","staticRegexReplace","string");return ot.runKernel(bS,{x:i},{pattern:t,rewrite:e,replaceGlobal:r})}})},fv=RZ,mge="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:n=>n();function vH(){return new Promise(n=>mge(()=>n()))}function yH(n,t){const e=n[0].length;n.forEach((i,s)=>{De(i.length===e,()=>`Error in concat${e}D: rank of tensors[${s}] must be the same as the rank of the rest (${e})`)}),De(t>=0&&t<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);const r=n[0];n.forEach((i,s)=>{for(let o=0;o<e;o++)De(o===t||i[o]===r[o],()=>`Error in concat${e}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function Hh(n,t){const e=n[0].slice();for(let r=1;r<n.length;r++)e[t]+=n[r][t];return e}var hc=(()=>{return(n=hc||(hc={}))[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS",hc;var n})();function FK(n,t,e){let r=new Array;if(null==e&&null==t)return r;if(null==t)for(;r.length<n+e.length;)r.push(-1);else r=t.slice();if(null==e)return r;if(n+e.length!==r.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${n+e.length}, but shape.rank = ${r.length}`);for(let i=1;i<e.length;++i){const s=e[i],o=r[r.length-e.length+i],a=r[o];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+n}] = ${s} but shape[${i+n}] = ${a}`)}else r[o]=s}return r}function PK(n){const t={FIRST_DIM_SIZE:hc.FIRST_DIM_SIZE,VALUE_ROWIDS:hc.VALUE_ROWIDS,ROW_LENGTHS:hc.ROW_LENGTHS,ROW_SPLITS:hc.ROW_SPLITS,ROW_LIMITS:hc.ROW_LIMITS,ROW_STARTS:hc.ROW_STARTS},e=[];for(const r of n){if(!(r in t))break;e.push(t[r])}return e}function LK(n){return 0===n.length?0:n[0]===hc.FIRST_DIM_SIZE?n.length-1:n.length}function $K(n,t){if(null==n||null==t)return;const e=n.length,r=t.length;if(e>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${e} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(e,r-1);++i){const s=n[i],o=t[i+1];if(s>=0&&o>=0&&1!==s&&s!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-n.length}] = ${s} but ragged tensor input.flatValues.shape[${i-n.length}] = ${o}`)}}const _H=30;function fO(n){return n<=_H?n:Qk(n,Math.floor(Math.sqrt(n)))}function bH(n,t,e){return[e*("number"==typeof n?n:n[0]),t*("number"==typeof n?n:n[1])]}function nE(n,t,e,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(n[0]/e),i=i.concat(n.slice(1));else{i=i.concat(n[0]);const s=t.length;for(let o=0;o<s;++o)i=i.concat([n[o+1]/t[o],t[o]]);i=i.concat(n.slice(s+1))}return i}function rE(n,t,e=!0){const r=[];if(e){r.push(t);for(let i=t+1;i<n;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{const i=[],s=[];for(let o=1;o<n;++o)o>=2*t+1||o%2==1?s.push(o):i.push(o);r.push(...i),r.push(0),r.push(...s)}return r}function iE(n,t,e,r=!0){const i=[];i.push(r?n[0]/e:n[0]*e);for(let s=1;s<n.length;++s)i.push(s<=t.length?r?t[s-1]*n[s]:n[s]/t[s-1]:n[s]);return i}function wH(n,t){const e=[0];for(let r=0;r<t;++r)e.push(n[r][0]);return e}function xH(n,t,e){const r=n.slice(0,1);for(let i=0;i<e;++i)r.push(n[i+1]-t[i][0]-t[i][1]);return r}const dO=1.7580993408473768,pO=1.0507009873554805,CH=.3275911,SH=.254829592,EH=-.284496736,NH=1.421413741,TH=-1.453152027,AH=1.061405429;function ld(n,t){if(n.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${t.length}.`);const e=new Float32Array(2*n.length);for(let r=0;r<e.length;r+=2)e[r]=n[r/2],e[r+1]=t[r/2];return e}function BK(n){const t=new Float32Array(n.length/2),e=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)t[r/2]=n[r],e[r/2]=n[r+1];return{real:t,imag:e}}function VK(n){const t=Math.ceil(n.length/4),e=new Float32Array(t),r=new Float32Array(t);for(let i=0;i<n.length;i+=4)e[Math.floor(i/4)]=n[i],r[Math.floor(i/4)]=n[i+1];return{real:e,imag:r}}function zK(n){const t=Math.floor(n.length/4),e=new Float32Array(t),r=new Float32Array(t);for(let i=2;i<n.length;i+=4)e[Math.floor(i/4)]=n[i],r[Math.floor(i/4)]=n[i+1];return{real:e,imag:r}}function IH(n,t){return{real:n[2*t],imag:n[2*t+1]}}function UK(n,t,e,r){n[2*r]=t,n[2*r+1]=e}function HK(n,t){const e=new Float32Array(n/2),r=new Float32Array(n/2);for(let i=0;i<Math.ceil(n/2);i++){const s=(t?2:-2)*Math.PI*(i/n);e[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:e,imag:r}}function WK(n,t,e){const r=(e?2:-2)*Math.PI*(n/t);return{real:Math.cos(r),imag:Math.sin(r)}}const gge=/->/g;function MH(n,t){const e=((n=n.replace(/\s/g,"")).length-n.replace(gge,"").length)/"->".length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error('Equation must contain exactly one arrow ("->").');const[r,i]=n.split("->");De(-1===r.indexOf("..."),()=>'The ellipsis notation ("...") is not supported yet.');const s=r.split(","),o=s.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let _=0;_<i.length;++_){const E=i[_];if(!s.some(D=>-1!==D.indexOf(E)))throw new Error(`Output subscripts contain the label ${E} not present in the input subscripts.`);-1===a.indexOf(E)&&a.push(E)}for(let _=0;_<r.length;++_){const E=r[_];-1===a.indexOf(E)&&","!==E&&a.push(E)}const u=new Array(s.length);for(let _=0;_<o;++_){if(new Set(s[_].split("")).size!==s[_].length)throw new Error(`Found duplicate axes in input component ${s[_]}. Support for duplicate axes in input is not implemented yet.`);u[_]=[];for(let E=0;E<s[_].length;++E)u[_].push(a.indexOf(s[_][E]))}const d=a.length,y=[];for(let _=i.length;_<d;++_)y.push(_);return{allDims:a,summedDims:y,idDims:u}}function kH(n,t){let e=new Array(n);e.fill(-1);for(let i=0;i<t.length;++i)e[t[i]]=i;const r=[];for(let i=0;i<n;++i)-1===e[i]&&r.push(i);return e=e.filter(i=>-1!==i),{permutationIndices:e,expandDims:r}}function RH(n,t,e){const r=new Array(n);for(let i=0;i<e.length;++i){const s=e[i].shape;for(let o=0;o<t[i].length;++o)void 0===r[t[i][o]]?r[t[i][o]]=s[o]:De(r[t[i][o]]===s[o],()=>`Expected dimension ${r[t[i][o]]} at axis ${o} of input shaped ${JSON.stringify(s)}, but got dimension ${s[o]}`)}}function OH(n,t){const e=n,r=[];let i=0;0===n.length&&e.push(-1),i=n.length+1;for(let o=0;o<i;++o)r.push([]);const s=[];for(let o=0;o<e.length;++o){const u=vge(t,e[o]);for(const d of u)-1===s.indexOf(d)&&(r[o].push(d),s.push(d))}return{path:e,steps:r}}function FH(n){return n.every((t,e)=>t===e)}function vge(n,t){const e=[];for(let r=0;r<n.length;++r)(0===n[r].length||-1!==n[r].indexOf(t)||-1===t)&&e.push(r);return e}function PH(n,t,e=0){let r=[];if("number"==typeof t)De(n.shape[e]%t==0,()=>"Number of splits must evenly divide the axis."),r=new Array(t).fill(n.shape[e]/t);else{De(t.reduce((o,a)=>(-1===a&&(o+=1),o),0)<=1,()=>"There should be only one negative value in split array.");const s=t.indexOf(-1);if(-1!==s){const o=t.reduce((a,u)=>u>0?a+u:a);t[s]=n.shape[e]-o}De(n.shape[e]===t.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),r=t}return r}function qK(n){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${n}`}function ZK(n,t){return`indices(${n}, 0) is invalid: ${t} < 0`}function KK(n,t,e){return`indices(${n}, 0) is invalid: ${t} >= ${e}`}function XK(n,t){return`only one output dimension may be -1, not both ${n} and ${t}`}function YK(n,t){return`size ${n} must be non-negative, not ${t}`}function QK(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function JK(n,t){return`Input to reshape is a SparseTensor with ${Xt(n)}\n  dense values, but the requested shape requires a multiple of ${Xt(t)}. inputShape=${n} outputShape= ${t}`}function eX(n,t){return`Input to reshape is a tensor with ${Xt(n)} dense values, but the requested shape has ${Xt(t)}. inputShape=${n} outputShape=${t}`}function LH(){return"segment ids must be >= 0"}function tX(){return"segment ids are not increasing"}function nX(n,t){return`Segment id ${n} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function rX(n,t,e){return`Bad: indices[${n}] == ${t} out of range [0, ${e})`}function iX(n,t){let r,e=!1;for(n<=_H?(r=n,e=!0):r=Qk(n,Math.floor(Math.sqrt(n)));!e;)r>t||r===n?e=!0:r=Qk(n,r+1);return r}function sX(n,t,e){const r=[],i=n.length;for(let s=0;s<i;s++)r.push(s!==t?n[s]:e);return r}function $H(n,t,e,r){const i=t.shape.length,s=n.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${s}).`);if(e<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${e}).`);for(let y=0;y<r;++y)if(n.shape[y]!==t.shape[y])throw new Error(`x.shape[${y}]: ${n.shape[y]} should be equal to indices.shape[${y}]: ${t.shape[y]}.`);const o=n.shape[e],a=[];let u=1,d=1,m=1;for(let y=0;y<r;++y)a.push(n.shape[y]),u*=n.shape[y];for(let y=r;y<e;y++)a.push(n.shape[y]),d*=n.shape[y];for(let y=r;y<i;y++)a.push(t.shape[y]);for(let y=e+1;y<s;y++)a.push(n.shape[y]),m*=n.shape[y];return{batchSize:u,sliceSize:m,outerSize:d,dimSize:o,outputShape:a}}function cd(n){try{return n.map(t=>Qf(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function oX(n){return n.map(t=>Ph(t))}!function Mce(){for(const n of Dce)Nn(n)}();const aX={kernelName:xC,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(n,hv(Fn(e,"float32"),-1))}}},yge={kernelName:M_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=Zi(Fn(e,"float32")),i=ua(qn(hr(1),r));return ss(nr(n,i))}}}},_ge={kernelName:k_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=ua(qn(Zi(Fn(e,"float32")),1));return nr(n,r)}}}},bge={kernelName:qg,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Fr(e.shape,r.shape);return{a:()=>{let a=n;const u=go(e.shape,i);return u.length>0&&(a=Yn(a,u)),wt(a,e.shape)},b:()=>{let a=n;const u=go(r.shape,i);return u.length>0&&(a=Yn(a,u)),wt(a,r.shape)}}}},wge={kernelName:CC,saveAllInputs:!0,gradFunc:(n,t)=>{const e={};return t.forEach((r,i)=>{e[i]=()=>n.clone()}),e}},xge={kernelName:SC,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ai(e)}}},Cge={kernelName:EC,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ai(e)}}},Sge={kernelName:R_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,ua(qn(hr(1),Zi(Fn(e,"float32")))))}}},Ege={kernelName:O_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=ua(_n(hr(1),Zi(Fn(e,"float32"))));return nr(n,r)}}}},Nge={kernelName:L_,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Fr(e.shape,r.shape);return{a:()=>{const a=_n(Zi(e),Zi(r));let u=vt(n,nr(r,a));const d=go(e.shape,i);return d.length>0&&(u=Yn(u,d)),wt(u,e.shape)},b:()=>{const a=_n(Zi(e),Zi(r));let u=ss(vt(n,nr(e,a)));const d=go(r.shape,i);return d.length>0&&(u=Yn(u,d)),wt(u,r.shape)}}}},Tge={kernelName:F_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,_n(Zi(Fn(e,"float32")),1))}}},Age={kernelName:P_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,qn(hr(1),Zi(Fn(e,"float32"))))}}},Dge=ut({avgPool3dGrad_:function Ige(n,t,e,r,i,s){const o=Le(n,"dy","avgPool3dGrad"),a=Le(t,"input","avgPool3dGrad");let u=o,d=a,m=!1;4===a.rank&&(m=!0,u=wt(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=wt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),De(5===u.rank,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),De(5===d.rank,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),Za("avgPool3dGrad",i,s);const E=ot.runKernel(r2,{dy:u,input:d},{filterSize:e,strides:r,pad:i,dimRoundingMode:s});return m?wt(E,[E.shape[1],E.shape[2],E.shape[3],E.shape[4]]):E}}),Mge={kernelName:TC,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{filterSize:i,strides:s,pad:o,dimRoundingMode:a}=e;return{x:()=>Dge(n,r,i,s,o,a)}}},Rge=ut({avgPoolGrad_:function kge(n,t,e,r,i){const s=Le(n,"dy","avgPoolGrad"),o=Le(t,"input","avgPoolGrad");De(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`);let a=o,u=s,d=!1;3===o.rank&&(d=!0,a=wt(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=wt(s,[1,s.shape[0],s.shape[1],s.shape[2]])),De(4===u.rank,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),De(4===a.rank,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const _=ot.runKernel(n2,{dy:u,input:a},{filterSize:e,strides:r,pad:i});return d?wt(_,[_.shape[1],_.shape[2],_.shape[3]]):_}}),Oge={kernelName:NC,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{filterSize:i,strides:s,pad:o}=e;return{x:()=>Rge(n,r,i,s,o)}}},Fge={kernelName:AC,inputsToSave:["a","b"],gradFunc:(n,t,e)=>{const[r,i]=t,{transposeA:s,transposeB:o}=e;return s||o?!s&&o?{a:()=>Qr(n,i,!1,!1),b:()=>Qr(n,r,!0,!1)}:s&&!o?{a:()=>Qr(i,n,!1,!0),b:()=>Qr(r,n,!1,!1)}:{a:()=>Qr(i,n,!0,!0),b:()=>Qr(n,r,!0,!0)}:{a:()=>Qr(n,i,!1,!0),b:()=>Qr(r,n,!0,!1)}}},Pge={kernelName:IC,gradFunc:(n,t,e)=>{const{blockShape:r,crops:i}=e;return{x:()=>KS(n,r,i)}}},Lge={kernelName:A7,gradFunc:(n,t,e)=>{const i=e.inputShape,s=e.shape,o=Array.from(s);for(let u=i.length-1;u>=0;u--)if(i[u]===s[u])o[u]=1;else if(1!==i[u])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const a=[];for(let u=0;u<o.length;u++)o[u]>1&&a.push(u);return{x:()=>Yn(n,a,!0)}}},$ge={kernelName:$_,gradFunc:n=>({x:()=>n.clone()})},Bge={kernelName:B_,gradFunc:n=>({x:()=>ai(n)})},Vge={kernelName:V_,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{clipValueMin:i,clipValueMax:s}=e;return{x:()=>Zo(lc(od(r,i),Wp(r,s)),n,ai(n))}}},zge={kernelName:DC,inputsToSave:["x"],gradFunc:aX.gradFunc},Uge={kernelName:MC,saveAllInputs:!0,gradFunc:(n,t,e)=>{const r=t.map(u=>u.shape),{axis:i}=e,s=Yr(i,t[0].shape)[0],o=r.map(u=>u[s]);return vu(n,o,s).map(u=>()=>u)}},Hge={kernelName:kC,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[r,i]=t,{dilations:s,strides:o,pad:a,dataFormat:u}=e;return De(Up(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>N5(r.shape,n,i,o,a,u),filter:()=>cH(r,n,i.shape,o,a,u)}}},Wge={kernelName:RC,inputsToSave:["dy","filter"],gradFunc:(n,t,e)=>{const[r,i]=t,{strides:s,pad:o,dataFormat:a,dimRoundingMode:u}=e;return{dy:()=>sd(n,i,s,o,a,1,u),filter:()=>cH(n,r,i.shape,s,o,a,u)}}},jge=ut({conv3DBackpropFilter_:function Gge(n,t,e,r,i){let s=n;4===n.rank&&(s=wt(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let o=t;return 4===o.rank&&(o=wt(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),De(5===s.rank,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),De(5===o.rank,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),De(5===e.length,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),De(s.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${e[3]}.`),De(o.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${e[4]}).`),ot.runKernel(l2,{x:s,dy:o},{strides:r,pad:i,filterShape:e})}}),qge={kernelName:OC,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:r,strides:i,pad:s}=e;De(Up(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,a]=t;return{x:()=>LZ(o.shape,n,a,i,s),filter:()=>jge(o,n,a.shape,i,s)}}},Zge={kernelName:z_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(ss(XR(Fn(e,"float32"))),n)}}},Kge={kernelName:U_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(YR(Fn(e,"float32")),n)}}},Xge={kernelName:FC,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{axis:i,exclusive:s,reverse:o}=e;return{x:()=>{const a=ks([i],r.rank);let u=PR(n,i,s,!o);return null!=a&&(u=ii(u,a)),u}}}},Yge={kernelName:PC,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:o}=e,a=null==r?[1,1]:r;De(Up(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[u,d]=t;return De(4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),De(4===d.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${d.rank}.`),De(u.shape[3]===d.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),De(la(i,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${a}'.`),Za("depthwiseConv2d",s,o),{x:()=>CK(u.shape,n,d,i,s,a,o),filter:()=>xK(u,n,d.shape,i,s,a,o)}}},Qge={kernelName:LC,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[r,i]=t,s={x:r,filter:i,dy:n},o={x:r,filter:i,dy:n};return{x:()=>ot.runKernel(y2,s,e),filter:()=>ot.runKernel(_2,o,e)}}},Jge={kernelName:W_,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t,r={dy:n,y:e};return{x:()=>ot.runKernel(w2,r)}}},eve={kernelName:G_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,r=vt(Uu(ss(Zi(e))),2/Math.sqrt(Math.PI));return{x:()=>vt(n,r)}}},tve={kernelName:j_,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(n,e)}}},nve={kernelName:BC,inputsToSave:["input"],gradFunc:(n,t)=>{const[e]=t;return{input:()=>wt(n,e.shape)}}},rve={kernelName:q_,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(n,Uu(e))}}},ive={kernelName:Z_,gradFunc:n=>({x:()=>ai(n)})},sve={kernelName:K_,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Fr(e.shape,r.shape);return{a:()=>{const a=nr(n,Fn(r,"float32")),u=go(e.shape,i);return u.length>0?wt(Yn(a,u),e.shape):a},b:()=>{let a=vt(n,Fn(e,"float32"));const u=go(r.shape,i);u.length>0&&(a=wt(Yn(a,u),r.shape));const d=Zi(r);return ss(nr(a,Fn(d,"float32")))}}}},ove={kernelName:VC,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,t,e)=>{const{varianceEpsilon:r}=e,[i,s,o,a]=t,u=null==a?hr(1):a,d=go(s.shape,i.shape),m=[];if(1===s.rank){for(let ie=0;ie<i.shape.length-1;++ie)m.push(i.shape[ie]);m.push(1)}const y=qn(i,s),_=vt(n,u),E=qR(_n(o,hr(r))),D=vt(vt(vt(E,E),E),hr(-.5));return{x:()=>wt(vt(vt(n,1===s.rank?xl(wt(E,[1,1,1,s.shape[0]]),m):E),u),i.shape),mean:()=>{let ie=vt(vt(E,hr(-1)),_);return 1===s.rank&&(ie=Yn(ie,d)),wt(ie,s.shape)},variance:()=>{let ie=vt(vt(D,y),_);return 1===s.rank&&(ie=Yn(ie,d)),wt(ie,s.shape)},scale:()=>{const ie=vt(y,E);let ye=vt(n,ie);return 1===s.rank&&(ye=Yn(ye,d)),wt(ye,s.shape)},offset:()=>{let ie=n;return 1===s.rank&&(ie=Yn(ie,d)),wt(ie,s.shape)}}}},ave={kernelName:zC,inputsToSave:["x","indices"],gradFunc:(n,t,e)=>{const[r,i]=t,{axis:s}=e,o=Yr(s,r.shape)[0];return{x:()=>{const u=r.shape,d=i.size,m=u.slice(0,o),y=m.length,_=u.slice(s,u.length).slice(1),E=_.length,D=uX(0,y),O=uX(y+1,y+1+E),R=lX([m,[d],_]),$=wt(n,R),B=wt(i,[d]),Q=lX([[y],D,O]),ie=ii($,Q);let ye=nO(ie,B,r.shape[o]);const Me=Hp(Q);return ye=ii(ye,Me),ye},indices:()=>i}}};function uX(n,t){const e=[];for(let r=n;r<t;++r)e.push(r);return e}function lX(n){const t=[];for(let e=0;e<n.length;++e)for(let r=0;r<n[e].length;++r)t.push(n[e][r]);return t}const uve={kernelName:X_,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t;return{a:()=>ai(e),b:()=>ai(r)}}},lve={kernelName:Y_,gradFunc:n=>({x:()=>Fn(n,"float32")})},cve={kernelName:Q_,gradFunc:n=>({x:()=>ai(n)})},hve={kernelName:J_,gradFunc:n=>({x:()=>ai(n)})},fve={kernelName:e0,gradFunc:n=>({x:()=>ai(n)})},dve={kernelName:HC,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{alpha:i}=e,s=Ka(r,0);return{x:()=>Zo(s,n,vt(n,i))}}},pve={kernelName:n0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,_n(e,1))}}},mve={kernelName:t0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,Fn(e,"float32"))}}},gve={kernelName:I7,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r]=t,{axis:i}=e;return{logits:()=>{const o=Uu(r);return qn(n,vt(Yn(n,i,!0),o))}}}},yve=ut({localResponseNormalizationBackprop_:function vve(n,t,e,r=5,i=1,s=1,o=.5){return ot.runKernel(I2,{x:n,y:t,dy:e},{depthRadius:r,bias:i,alpha:s,beta:o})}}),_ve={kernelName:KC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r,i]=t,{depthRadius:s,bias:o,alpha:a,beta:u}=e;return{x:()=>yve(r,i,n,s,o,a,u)}}};function cX(n,t,e,r){return t.rank<e.rank&&(t=wt(t,eo(t.shape,r))),n.rank<e.rank&&(n=wt(n,eo(n.shape,r))),{x:()=>vt(n,Fn(zu(e,t),n.dtype))}}const hX={kernelName:XC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const r=e,{reductionIndices:i}=r,s=t[0],u=cX(n,t[1],s,Yr(i,s.shape));return{x:()=>u.x()}}},bve={kernelName:r0,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t;return{a:()=>vt(n,Fn(od(e,r),"float32")),b:()=>vt(n,Fn(H0(e,r),"float32"))}}},xve=ut({maxPool3dGrad_:function wve(n,t,e,r,i,s,o){const a=Le(n,"dy","maxPool3dGrad"),u=Le(t,"input","maxPool3dGrad"),d=Le(e,"output","maxPool3dGrad");let m=a,y=u,_=d,E=!1;4===u.rank&&(E=!0,m=wt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),y=wt(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),_=wt(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),De(5===m.rank,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${m.rank}.`),De(5===y.rank,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${y.rank}.`),De(5===_.rank,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${_.rank}.`),Za("maxPool3dGrad",s,o);const R=ot.runKernel(M2,{dy:m,input:y,output:_},{filterSize:r,strides:i,pad:s,dimRoundingMode:o});return E?wt(R,[R.shape[1],R.shape[2],R.shape[3],R.shape[4]]):R}}),Cve={kernelName:QC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=e;return{x:()=>xve(n,r,i,s,o,a,u)}}},Eve=ut({maxPoolGrad_:function Sve(n,t,e,r,i,s,o){const a=Le(n,"dy","maxPoolGrad"),u=Le(t,"input","maxPoolGrad"),d=Le(e,"output","maxPoolGrad");return De(u.rank===a.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${a.rank})`),De(4===a.rank,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),De(4===u.rank,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`),Za("maxPoolGrad",s,o),ot.runKernel(D2,{dy:a,input:u,output:d},{filterSize:r,strides:i,pad:s,dimRoundingMode:o})}}),fX={kernelName:aS,inputsToSave:["x"],gradFunc:(n,t,e)=>{const r=t[0],{paddings:i}=e,s=i.map(o=>o[0]);return{x:()=>ui(n,s,r.shape)}}};const dX={kernelName:vS,gradFunc:(n,t,e)=>{const{blockShape:r,paddings:i}=e;return{x:()=>zS(n,r,i)}}},pX={kernelName:yS,gradFunc:(n,t,e)=>{const{axis:r}=e;return{x:()=>Js(n,r)}}},wye=[aX,yge,_ge,bge,wge,xge,Cge,Sge,Ege,Nge,Tge,Age,Mge,Oge,Fge,Pge,Lge,$ge,Bge,Vge,zge,Uge,Wge,Hge,qge,Zge,Kge,Xge,Yge,Qge,{kernelName:H_,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Fr(e.shape,r.shape);return{a:()=>{const a=nr(n,Fn(r,"float32")),u=go(e.shape,i);return u.length>0?wt(Yn(a,u),e.shape):a},b:()=>{let a=vt(n,Fn(e,"float32"));const u=go(r.shape,i);u.length>0&&(a=wt(Yn(a,u),r.shape));const d=Zi(r);return ss(nr(a,Fn(d,"float32")))}}}},Jge,eve,tve,nve,rve,sve,ive,ove,ave,uve,lve,cve,hve,fve,dve,pve,mve,gve,_ve,hX,hX,bve,Cve,{kernelName:YC,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r,i]=t,{filterSize:s,strides:o,pad:a}=e;return{x:()=>Eve(n,r,i,s,o,a)}}},{kernelName:JC,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{axis:i}=e,s=Yr(i,r.shape),u=Xt(Ko(r.shape,s)[1]);return{x:()=>{const m=r.shape.slice();s.forEach(E=>{m[E]=1});const y=wt(n,m);return nr(vt(y,Wu(r.shape,"float32")),u)}}}},{kernelName:eS,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const r=e,{axis:i}=r,[s,o]=t,u=cX(n,o,s,Yr(i,s.shape));return{x:()=>u.x()}}},{kernelName:s0,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t;return{a:()=>vt(n,Fn(Wp(e,r),"float32")),b:()=>vt(n,Fn(Ka(e,r),"float32"))}}},{kernelName:tS,inputsToSave:["x"],gradFunc:(n,t,e)=>{const r=t[0],{paddings:i}=e,s=i.map(o=>o[0]);return{x:()=>ui(n,s,r.shape)}}},{kernelName:o0,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Fr(e.shape,r.shape);return{a:()=>{const a=go(e.shape,i);return a.length>0?wt(Yn(n,a),e.shape):n},b:()=>{const a=vt(n,ss(z0(nr(e,r)))),u=go(r.shape,i);return u.length>0?wt(Yn(a,u),r.shape):a}}}},{kernelName:a0,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Fr(e.shape,r.shape);return{a:()=>{const a=vt(n,Fn(r,"float32")),u=go(e.shape,i);return u.length>0?wt(Yn(a,u),e.shape):a},b:()=>{const a=vt(n,Fn(e,"float32")),u=go(r.shape,i);return u.length>0?wt(Yn(a,u),r.shape):a}}}},{kernelName:nS,gradFunc:n=>({x:()=>ss(n)})},{kernelName:sS,inputsToSave:["indices"],gradFunc:(n,t)=>{const e=t[0];return{indices:()=>vo(e.shape,"float32")}}},{kernelName:iS,gradFunc:n=>({x:()=>ai(n)})},{kernelName:oS,saveAllInputs:!0,gradFunc:(n,t,e)=>{const{axis:r}=e;return Sl(n,r).map(s=>()=>s)}},fX,fX,{kernelName:u0,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,t)=>{const[e,r,i]=t,s=e,o=r,a=Fr(s.shape,o.shape);return{a:()=>{const m=Fn(o,"float32");let y=vt(n,vt(m,nd(s,qn(m,hr(1)))));const _=go(s.shape,a);return _.length>0&&(y=Yn(y,_)),wt(y,s.shape)},b:()=>{const m=Ka(s,0),y=Zo(m,Hu(s),ai(s));let _=vt(n,vt(i,y));const E=go(o.shape,a);return E.length>0&&(_=Yn(_,E)),wt(_,o.shape)}}}},{kernelName:uS,inputsToSave:["x","alpha"],gradFunc:(n,t)=>{const[e,r]=t,i=Ka(e,0);return{x:()=>Zo(i,n,vt(n,r)),alpha:()=>{let s=Zo(i,ai(n),vt(n,e));const o=go(r.shape,n.shape);return o.length>0&&(s=Yn(s,o)),wt(s,r.shape)}}}},{kernelName:lS,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{axis:i}=e;let s=[];return s=null==i?r.shape.map((o,a)=>a):"number"==typeof i?[i]:i,{x:()=>function Vve(n,t,e){const r=n.shape.length,i=r-e.length,s=ks(e,r);let o=n;null!=s&&(o=ii(n,s));const a=o.shape.slice(),d=a.splice(r-e.length,e.length).reduce((_,E)=>_*E,1);a.push(d);let y=function Bve(n,t,e){const r=n.shape.slice();r[e]=1;const i=wt(t,r),s=HS(n,e,!0,!1),o=HS(n,e,!0,!0),a=vt(s,o);return vt(i,a)}(o.reshape(a),t,i);if(y=y.reshape(o.shape),null!=s){const _=Hp(s);y=ii(y,_)}return y}(r,n,s)}}},{kernelName:l0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,ss(Zi(e)))}}},{kernelName:h0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,r=vt(Wp(e,6),hv(e));return{x:()=>vt(n,Fn(r,"float32"))}}},{kernelName:c0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(n,Fn(hv(e),"float32"))}}},{kernelName:cS,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>wt(n,e.shape)}}},{kernelName:fS,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[r]=t,i={dy:n,images:r};return{images:()=>ot.runKernel(H2,i,e)}}},{kernelName:hS,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[r]=t,i={dy:n,images:r};return{images:()=>ot.runKernel(U2,i,e)}}},{kernelName:dS,gradFunc:(n,t,e)=>{const{dims:r}=e,i=Yr(r,n.shape);return{x:()=>Cl(n,i)}}},{kernelName:f0,gradFunc:n=>({x:()=>ai(n)})},{kernelName:d0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>ss(nr(n,vt(nd(e,1.5),2)))}}},{kernelName:pS,inputsToSave:["condition"],gradFunc:(n,t)=>{const[e]=t;return{condition:()=>Fn(ai(e),"float32"),t:()=>vt(n,Fn(e,n.dtype)),e:()=>vt(n,Fn(jS(e),n.dtype))}}},{kernelName:p0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const r=Ka(e,hr(0)),i=hr(dO),s=hr(pO),o=vt(n,s),a=vt(vt(n,i),Uu(Fn(e,"float32")));return Zo(r,o,a)}}}},{kernelName:y0,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(n,vt(e,qn(hr(1),e)))}}},{kernelName:v0,gradFunc:n=>({x:()=>ai(n)})},{kernelName:m0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(US(Fn(e,"float32")),n)}}},{kernelName:g0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(FR(Fn(e,"float32")),n)}}},{kernelName:mS,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{begin:i,size:s}=e,o=r.shape,[a,u]=MR(r,i,s),d=[];for(let m=0;m<n.rank;m++)d.push([a[m],o[m]-a[m]-u[m]]);return{x:()=>ad(n,d)}}},{kernelName:_S,outputsToSave:[!0],gradFunc:(n,t,e)=>{const[r]=t,{dim:i}=e,o=vt(n,r);return{logits:()=>qn(o,vt(Yn(o,[i],!0),r))}}},{kernelName:_0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(n,qc(e))}}},dX,dX,pX,pX,{kernelName:b0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,vt(ua(Fn(e,"float32")),2))}}},{kernelName:w0,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=hr(2);return{a:()=>vt(n,vt(i,qn(e,r))),b:()=>vt(n,vt(i,qn(r,e)))}}},{kernelName:Q2,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(n,vt(Fn(e,"float32"),2))}}},{kernelName:N0,gradFunc:n=>({x:()=>ai(n)})},{kernelName:x0,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,r]=t,i=Fr(e.shape,r.shape);return{a:()=>{let a=n;const u=go(e.shape,i);return u.length>0&&(a=Yn(a,u)),wt(a,e.shape)},b:()=>{let a=n;const u=go(r.shape,i);return u.length>0&&(a=Yn(a,u)),wt(ss(a),r.shape)}}}},{kernelName:gS,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,i=r.shape.slice(),{axis:s}=e;Yr(s,r.shape).forEach(d=>{i[d]=1});const a=wt(n,i),u=vt(a,Wu(r.shape,"float32"));return{x:()=>u}}},{kernelName:C0,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>nr(n,Zi(US(e)))}}},{kernelName:S0,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>vt(qn(hr(1),Zi(e)),n)}}},{kernelName:E0,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[r]=t,{reps:i}=e;return{x:()=>{let o=ai(r);if(1===r.rank)for(let a=0;a<i[0];++a)o=_n(o,ui(n,[a*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)o=_n(o,ui(n,[a*r.shape[0],u*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)for(let d=0;d<i[2];++d)o=_n(o,ui(n,[a*r.shape[0],u*r.shape[1],d*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let a=0;a<i[0];++a)for(let u=0;u<i[1];++u)for(let d=0;d<i[2];++d)for(let m=0;m<i[3];++m)o=_n(o,ui(n,[a*r.shape[0],u*r.shape[1],d*r.shape[2],m*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return o}}}},{kernelName:Zg,gradFunc:(n,t,e)=>{const r=e,{perm:i}=r,s=Hp(i);return{x:()=>ii(n,s)}}},{kernelName:wS,gradFunc:(n,t,e)=>{const r=e,{axis:i}=r;return{value:()=>yu(n,i)}}},{kernelName:xS,inputsToSave:["segmentIds"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>function _ye(n,t){const e=Uh(t,ai(t)),r=U0(n,e);let i=od(t,hr(0,"int32"));const s=r.rank-i.rank;for(let a=0;a<s;++a)i=Ma(i,a+1);i=lc(i,Wu(r.shape,"bool"));const o=ai(r);return Zo(i,r,o)}(n,e)}}},{kernelName:CS,gradFunc:n=>({x:()=>ai(n)})}];for(const n of wye)D7(n);en().prototype.abs=function(){return this.throwIfDisposed(),mo(this)},en().prototype.acos=function(){return this.throwIfDisposed(),o5(this)},en().prototype.acosh=function(){return this.throwIfDisposed(),a5(this)},en().prototype.add=function(n){return this.throwIfDisposed(),_n(this,n)},en().prototype.all=function(n,t){return this.throwIfDisposed(),kR(this,n,t)},en().prototype.any=function(n,t){return this.throwIfDisposed(),PS(this,n,t)},en().prototype.argMax=function(n){return this.throwIfDisposed(),rv(this,n)},en().prototype.argMin=function(n){return this.throwIfDisposed(),u5(this,n)},en().prototype.asScalar=function(){return this.throwIfDisposed(),De(1===this.size,()=>"The array must have only 1 element."),wt(this,[])},en().prototype.asType=function(n){return this.throwIfDisposed(),Fn(this,n)},en().prototype.as1D=function(){return this.throwIfDisposed(),wt(this,[this.size])},en().prototype.as2D=function(n,t){return this.throwIfDisposed(),wt(this,[n,t])},en().prototype.as3D=function(n,t,e){return this.throwIfDisposed(),wt(this,[n,t,e])},en().prototype.as4D=function(n,t,e,r){return this.throwIfDisposed(),wt(this,[n,t,e,r])},en().prototype.as5D=function(n,t,e,r,i){return this.throwIfDisposed(),wt(this,[n,t,e,r,i])},en().prototype.asin=function(){return this.throwIfDisposed(),l5(this)},en().prototype.asinh=function(){return this.throwIfDisposed(),c5(this)},en().prototype.atan=function(){return this.throwIfDisposed(),h5(this)},en().prototype.atan2=function(n){return this.throwIfDisposed(),f5(this,n)},en().prototype.atanh=function(){return this.throwIfDisposed(),d5(this)},en().prototype.avgPool=function(n,t,e,r){return this.throwIfDisposed(),VS(this,n,t,e,r)},en().prototype.batchToSpaceND=function(n,t){return this.throwIfDisposed(),zS(this,n,t)},en().prototype.batchNorm=function(n,t,e,r,i){return this.throwIfDisposed(),P0(this,n,t,e,r,i)},en().prototype.broadcastTo=function(n){return this.throwIfDisposed(),ov(this,n)},en().prototype.cast=function(n){return this.throwIfDisposed(),Fn(this,n)},en().prototype.ceil=function(){return this.throwIfDisposed(),w5(this)},en().prototype.clipByValue=function(n,t){return this.throwIfDisposed(),gu(this,n,t)},en().prototype.concat=function(n,t){return this.throwIfDisposed(),n instanceof yi&&(n=[n]),Js([this,...n],t)},en().prototype.conv1d=function(n,t,e,r,i,s){return this.throwIfDisposed(),RR(this,n,t,e,r,i,s)},en().prototype.conv2dTranspose=function(n,t,e,r,i){return this.throwIfDisposed(),OR(this,n,t,e,r,i)},en().prototype.conv2d=function(n,t,e,r,i,s){return this.throwIfDisposed(),sd(this,n,t,e,r,i,s)},en().prototype.cos=function(){return this.throwIfDisposed(),US(this)},en().prototype.cosh=function(){return this.throwIfDisposed(),FR(this)},en().prototype.cumprod=function(n,t,e){return this.throwIfDisposed(),HS(this,n,t,e)},en().prototype.cumsum=function(n,t,e){return this.throwIfDisposed(),PR(this,n,t,e)},en().prototype.depthToSpace=function(n,t){return this.throwIfDisposed(),I5(this,n,t)},en().prototype.depthwiseConv2d=function(n,t,e,r,i,s){return this.throwIfDisposed(),L0(this,n,t,e,r,i,s)},en().prototype.dilation2d=function(n,t,e,r,i){return this.throwIfDisposed(),D5(this,n,t,e,r,i)},en().prototype.divNoNan=function(n){return this.throwIfDisposed(),M5(this,n)},en().prototype.div=function(n){return this.throwIfDisposed(),nr(this,n)},en().prototype.dot=function(n){return this.throwIfDisposed(),k5(this,n)},en().prototype.elu=function(){return this.throwIfDisposed(),$0(this)},en().prototype.equal=function(n){return this.throwIfDisposed(),zu(this,n)},en().prototype.erf=function(){return this.throwIfDisposed(),R5(this)},en().prototype.euclideanNorm=function(n,t){return this.throwIfDisposed(),F5(this,n,t)},en().prototype.exp=function(){return this.throwIfDisposed(),Uu(this)},en().prototype.expandDims=function(n){return this.throwIfDisposed(),Ma(this,n)},en().prototype.expm1=function(){return this.throwIfDisposed(),P5(this)},en().prototype.fft=function(){return this.throwIfDisposed(),eE(this)},en().prototype.flatten=function(){return this.throwIfDisposed(),wt(this,[this.size])},en().prototype.floor=function(){return this.throwIfDisposed(),z0(this)},en().prototype.floorDiv=function(n){return this.throwIfDisposed(),ER(this,n)},en().prototype.gather=function(n,t,e){return this.throwIfDisposed(),U0(this,n,t,e)},en().prototype.greaterEqual=function(n){return this.throwIfDisposed(),od(this,n)},en().prototype.greater=function(n){return this.throwIfDisposed(),Ka(this,n)},en().prototype.ifft=function(){return this.throwIfDisposed(),j0(this)},en().prototype.irfft=function(){return this.throwIfDisposed(),JR(this)},en().prototype.isFinite=function(){return this.throwIfDisposed(),L5(this)},en().prototype.isInf=function(){return this.throwIfDisposed(),$5(this)},en().prototype.isNaN=function(){return this.throwIfDisposed(),B5(this)},en().prototype.leakyRelu=function(n){return this.throwIfDisposed(),WS(this,n)},en().prototype.lessEqual=function(n){return this.throwIfDisposed(),Wp(this,n)},en().prototype.less=function(n){return this.throwIfDisposed(),H0(this,n)},en().prototype.localResponseNormalization=function(n,t,e,r){return this.throwIfDisposed(),V5(this,n,t,e,r)},en().prototype.logSigmoid=function(){return this.throwIfDisposed(),z5(this)},en().prototype.logSoftmax=function(n){return this.throwIfDisposed(),BR(this,n)},en().prototype.logSumExp=function(n,t){return this.throwIfDisposed(),VR(this,n,t)},en().prototype.log=function(){return this.throwIfDisposed(),Hu(this)},en().prototype.log1p=function(){return this.throwIfDisposed(),GS(this)},en().prototype.logicalAnd=function(n){return this.throwIfDisposed(),lc(this,n)},en().prototype.logicalNot=function(){return this.throwIfDisposed(),jS(this)},en().prototype.logicalOr=function(n){return this.throwIfDisposed(),zR(this,n)},en().prototype.logicalXor=function(n){return this.throwIfDisposed(),U5(this,n)},en().prototype.matMul=function(n,t,e){return this.throwIfDisposed(),Qr(this,n,t,e)},en().prototype.maxPool=function(n,t,e,r){return this.throwIfDisposed(),qS(this,n,t,e,r)},en().prototype.max=function(n,t){return this.throwIfDisposed(),wl(this,n,t)},en().prototype.maximum=function(n){return this.throwIfDisposed(),Uh(this,n)},en().prototype.mean=function(n,t){return this.throwIfDisposed(),Rs(this,n,t)},en().prototype.min=function(n,t){return this.throwIfDisposed(),B0(this,n,t)},en().prototype.minimum=function(n){return this.throwIfDisposed(),Gp(this,n)},en().prototype.mirrorPad=function(n,t){return this.throwIfDisposed(),W5(this,n,t)},en().prototype.mod=function(n){return this.throwIfDisposed(),G5(this,n)},en().prototype.mul=function(n){return this.throwIfDisposed(),vt(this,n)},en().prototype.neg=function(){return this.throwIfDisposed(),ss(this)},en().prototype.norm=function(n,t,e){return this.throwIfDisposed(),V0(this,n,t,e)},en().prototype.notEqual=function(n){return this.throwIfDisposed(),uv(this,n)},en().prototype.oneHot=function(n,t=1,e=0){return this.throwIfDisposed(),R0(this,n,t,e)},en().prototype.onesLike=function(){return this.throwIfDisposed(),Gu(this)},en().prototype.pad=function(n,t){return this.throwIfDisposed(),ad(this,n,t)},en().prototype.pool=function(n,t,e,r,i,s){return this.throwIfDisposed(),j5(this,n,t,e,r,i,s)},en().prototype.pow=function(n){return this.throwIfDisposed(),nd(this,n)},en().prototype.prelu=function(n){return this.throwIfDisposed(),XS(this,n)},en().prototype.prod=function(n,t){return this.throwIfDisposed(),q5(this,n,t)},en().prototype.reciprocal=function(){return this.throwIfDisposed(),X5(this)},en().prototype.relu=function(){return this.throwIfDisposed(),Zc(this)},en().prototype.relu6=function(){return this.throwIfDisposed(),GR(this)},en().prototype.reshapeAs=function(n){return this.throwIfDisposed(),wt(this,n.shape)},en().prototype.reshape=function(n){return this.throwIfDisposed(),wt(this,n)},en().prototype.resizeBilinear=function(n,t,e){return this.throwIfDisposed(),TK(this,n,t,e)},en().prototype.resizeNearestNeighbor=function(n,t,e){return this.throwIfDisposed(),AK(this,n,t,e)},en().prototype.reverse=function(n){return this.throwIfDisposed(),Cl(this,n)},en().prototype.rfft=function(){return this.throwIfDisposed(),tE(this)},en().prototype.round=function(){return this.throwIfDisposed(),jR(this)},en().prototype.rsqrt=function(){return this.throwIfDisposed(),qR(this)},en().prototype.selu=function(){return this.throwIfDisposed(),ZR(this)},en().prototype.separableConv2d=function(n,t,e,r,i,s){return this.throwIfDisposed(),KR(this,n,t,e,r,i,s)},en().prototype.sigmoid=function(){return this.throwIfDisposed(),qc(this)},en().prototype.sign=function(){return this.throwIfDisposed(),Q5(this)},en().prototype.sin=function(){return this.throwIfDisposed(),XR(this)},en().prototype.sinh=function(){return this.throwIfDisposed(),YR(this)},en().prototype.slice=function(n,t){return this.throwIfDisposed(),ui(this,n,t)},en().prototype.softmax=function(n){return this.throwIfDisposed(),JS(this,n)},en().prototype.softplus=function(){return this.throwIfDisposed(),av(this)},en().prototype.spaceToBatchND=function(n,t){return this.throwIfDisposed(),KS(this,n,t)},en().prototype.split=function(n,t){return this.throwIfDisposed(),vu(this,n,t)},en().prototype.sqrt=function(){return this.throwIfDisposed(),ua(this)},en().prototype.square=function(){return this.throwIfDisposed(),Zi(this)},en().prototype.squaredDifference=function(n){return this.throwIfDisposed(),eO(this,n)},en().prototype.squeeze=function(n){return this.throwIfDisposed(),jp(this,n)},en().prototype.stack=function(n,t){this.throwIfDisposed();const e=n instanceof yi?[this,n]:[this,...n];return yu(e,t)},en().prototype.step=function(n){return this.throwIfDisposed(),hv(this,n)},en().prototype.stridedSlice=function(n,t,e,r,i,s,o,a){return this.throwIfDisposed(),J5(this,n,t,e,r,i,s,o,a)},en().prototype.sub=function(n){return this.throwIfDisposed(),qn(this,n)},en().prototype.sum=function(n,t){return this.throwIfDisposed(),Yn(this,n,t)},en().prototype.tan=function(){return this.throwIfDisposed(),eH(this)},en().prototype.tanh=function(){return this.throwIfDisposed(),sv(this)},en().prototype.tile=function(n){return this.throwIfDisposed(),xl(this,n)},en().prototype.toBool=function(){return this.throwIfDisposed(),Fn(this,"bool")},en().prototype.toFloat=function(){return this.throwIfDisposed(),Fn(this,"float32")},en().prototype.toInt=function(){return this.throwIfDisposed(),Fn(this,"int32")},en().prototype.topk=function(n,t){return this.throwIfDisposed(),tH(this,n,t)},en().prototype.transpose=function(n){return this.throwIfDisposed(),ii(this,n)},en().prototype.unique=function(n){return this.throwIfDisposed(),nH(this,n)},en().prototype.unsortedSegmentSum=function(n,t){return this.throwIfDisposed(),nO(this,n,t)},en().prototype.unstack=function(n){return this.throwIfDisposed(),Sl(this,n)},en().prototype.where=function(n,t){return this.throwIfDisposed(),Zo(n,this,t)},en().prototype.zerosLike=function(){return this.throwIfDisposed(),ai(this)};class Wh extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Wh.prototype)}}class fc extends Error{constructor(t){super(t),Object.setPrototypeOf(this,fc.prototype)}}class St extends Error{constructor(t){super(t),Object.setPrototypeOf(this,St.prototype)}}class Ur extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Ur.prototype)}}class BH extends Error{constructor(t){super(t),Object.setPrototypeOf(this,BH.prototype)}}Error;class gX{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=t}}function dv(n,t){if(Array.isArray(n)){let e=[];for(let r=0;r<t;r++)e=e.concat(n);return e}{const e=new Array(t);return e.fill(n),e}}function El(n,t){if(!n)throw new BH(t)}function vX(n,t){let e=0;for(const r of n)r===t&&e++;return e}function _u(n){return 1===n.length?n[0]:n}function os(n){return Array.isArray(n)?n:[n]}function hd(n){const e=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function pv(n){return n.length<=1||-1===n.indexOf("_")?n:n.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let dc={};function VH(n){if(null==n)return null;const t={};return t.className=n.getClassName(),t.config=n.getConfig(),t}function zH(n){if(null!=n&&"object"==typeof n)if(Array.isArray(n))n.forEach(t=>zH(t));else{const t=Object.keys(n);for(const e of t){const r=n[e];null!=r&&"object"==typeof r&&(Array.isArray(r)||"ndarray"!==r.type||"number"!=typeof r.value?zH(r):n[e]=r.value)}}}function sE(n,t={},e={},r="object",i=!1){if("string"==typeof n){const s=n;let o;if(s in e)o=e[s];else if(s in dc)o=dc[s];else if(o=t[s],null==o)throw new St(`Unknown ${r}: ${n}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}{const s=n;if(null==s.className||null==s.config)throw new St(`${r}: Improper config format: ${JSON.stringify(s)}.\n'className' and 'config' must set.`);const o=s.className;let a,u;if(o in e?[a,u]=e[o]:o in dc?[a,u]=dc.className:o in t&&([a,u]=t[o]),null==a)throw new St(`Unknown ${r}: ${o}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=u){const d={};for(const E of Object.keys(dc))d[E]=dc[E];for(const E of Object.keys(e))d[E]=e[E];s.config.customObjects=d;const y=Object.assign({},dc);for(const E of Object.keys(e))dc[E]=e[E];zH(s.config);const _=u(a,s.config,e,i);return dc=Object.assign({},y),_}{const d=Object.assign({},dc);for(const y of Object.keys(e))dc[y]=e[y];const m=new a(s.config);return dc=Object.assign({},d),m}}}function mO(n,t){return-1*function xye(n,t){return n<t?-1:n>t?1:0}(n,t)}function Zp(n){if(null==n)return n;const t=[];for(const e of n)-1===t.indexOf(e)&&t.push(e);return t}function Cye(n){if(null==n)throw new St(`Invalid value in obj: ${JSON.stringify(n)}`);for(const t in n)if(n.hasOwnProperty(t))return!1;return!0}function mv(n,t,e){if(null!=e&&n.indexOf(e)<0)throw new St(`${e} is not a valid ${t}.  Valid values are ${n} or null/undefined.`)}function UH(n,t,e=0,r=1/0){return El(e>=0),El(r>=e),Array.isArray(n)&&n.length>=e&&n.length<=r&&n.every(i=>typeof i===t)}function Xo(n,t){Array.isArray(n)?(De(n.length>0,()=>`${t} is unexpectedly an empty array.`),n.forEach((e,r)=>Xo(e,`element ${r+1} of ${t}`))):De(Number.isInteger(n)&&n>0,()=>`Expected ${t} to be a positive integer, but got ${yX(n)}.`)}function yX(n){return null===n?"null":Array.isArray(n)?"["+n.map(t=>yX(t)).join(",")+"]":"string"==typeof n?`"${n}"`:`${n}`}function _X(n){return"relu"===n?"relu":"linear"===n?"linear":"elu"===n?"elu":null}let Eye=0;function bX(){return Eye++}const gO={};function vO(n=""){return n in gO||(gO[n]=0),gO[n]+=1,n+gO[n].toString()}const Nye=["channelsFirst","channelsLast"],Tye=["nearest","bilinear"],Aye=["valid","same","causal"],Iye=["max","avg"],Dye=["sum","mul","concat","ave"],Z0=new Map;function no(n){mv(Nye,"DataFormat",n)}function Nl(n){mv(Aye,"PaddingMode",n)}function wX(n){mv(Iye,"PoolMode",n)}const oE=[];function gv(n,t){oE.push(n);try{const e=t();return oE.pop(),e}catch(e){throw oE.pop(),e}}function CX(n){if(!EX(n))throw new Error("Not a valid tensor name: '"+n+"'");return function kye(){return 0===oE.length?"":oE.join("/")+"/"}()+n}function SX(n){if(!EX(n))throw new Error("Not a valid tensor name: '"+n+"'");Z0.has(n)||Z0.set(n,0);const t=Z0.get(n);if(Z0.set(n,Z0.get(n)+1),t>0){const e=`${n}_${t}`;return Z0.set(e,1),e}return n}const Rye=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function EX(n){return!!n.match(Rye)}function Oye(n){return n===parseInt(n.toString(),10)}function Kp(n,t,e){null==t&&(t=0),null==e&&(e=n.length);let r=1;for(let i=t;i<e;++i)r*=n[i];return r}function K0(n){if(0===n.length)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let e=0;e<n.length;e++){const r=n[e];r<t&&(t=r)}return t}function Xp(n){if(0===n.length)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let e=0;e<n.length;e++){const r=n[e];r>t&&(t=r)}return t}function Kc(n,t){if(t<n)throw new St(`end (${t}) < begin (${n}) is forbidden.`);const e=[];for(let r=n;r<t;++r)e.push(r);return e}let yO;function Io(){return null==yO&&(yO=uZ().epsilon()),yO}function Gh(n,t){return Fn(n,t)}function aE(n,t=-1){const e=n.shape.slice();return t<0&&(t=e.length+t+1),e.splice(t,0,1),wt(n,e)}function vv(n,t,e){return Ot(()=>{switch(n.rank){case 1:return YS(n,t,e);case 2:return QR(n,[t,0],[e,n.shape[1]]);case 3:return QS(n,[t,0,0],[e,n.shape[1],n.shape[2]]);case 4:return G0(n,[t,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3]]);case 5:return ui(n,[t,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return ui(n,[t,0,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new St(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function HH(n,t,e){return Ot(()=>{switch(n.rank){case 1:return YS(n,t,e);case 2:return QR(n,[0,t],[n.shape[0],e]);case 3:return QS(n,[0,0,t],[n.shape[0],n.shape[1],e]);case 4:return G0(n,[0,0,0,t],[n.shape[0],n.shape[1],n.shape[2],e]);default:throw new St(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function _O(n,t,e,r){return Ot(()=>{switch(n.rank){case 1:return YS(n,t,e);case 2:switch(r){case 1:return vv(n,t,e);case 2:return HH(n,t,e);default:throw new St(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return vv(n,t,e);case 2:return QS(n,[0,t,0],[n.shape[0],e,n.shape[2]]);case 3:return HH(n,t,e);default:throw new St(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return vv(n,t,e);case 2:return G0(n,[0,t,0,0],[n.shape[0],e,n.shape[2],n.shape[3]]);case 3:return G0(n,[0,0,t,0],[n.shape[0],n.shape[1],e,n.shape[3]]);case 4:return HH(n,t,e);default:throw new St(`The axis is not within the rank of the tensor ${r}`)}default:throw new St(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function WH(n,t=-1){let e;return t<0&&(e=n[0].rank,t=0!==e?e:0),t===n[0].rank&&(t=-1),Js(n,t)}function TX(n,t){switch(n.rank){case 1:return x5([n,t]);case 2:return C5([n,t],0);case 3:return S5([n,t],0);case 4:return E5([n,t],0);default:throw new St(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function GH(n,t){if(Array.isArray(t)||(t=[t]),n.rank!==t.length)throw new St(`The length of input n (${t.length}) does not match the number of dimensions in input x (${n.rank})`);return xl(n,t)}function bO(n,t=0,e=1,r,i){return WR(n,t,e,r,i)}function jh(n,t,e,r){if(n.rank<2||t.rank<2)throw new Ur(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${t.shape}`);if(t.rank>=3&&n.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new Ur(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${t.shape}`);if(2===n.rank&&2===t.rank)return hH({a:n,b:t,transposeA:!1,transposeB:!1,bias:r?jH(n.rank,r,"channelsLast"):null,activation:e});{const i=n.shape.slice(),s=i.pop();n=wt(n,[-1,s]);const o=t.shape.slice(),a=o.pop(),u=o.pop(),d=[...o,a],m=Array.from({length:t.rank},(D,O)=>0===O?t.rank-2:O<=t.rank-2?O-1:O);t=wt(ii(t,m),[u,-1]);const y=[...i,...d];return wt(hH({a:n,b:t,transposeA:!1,transposeB:!1,bias:r?jH(n.rank,r,"channelsLast"):null,activation:e}),y)}}function AX(n,t,e){return Ot(()=>(t=Array.isArray(t)?ka(t,"int32"):Fn(t,"int32"),U0(n,t,e)))}function uE(n){return vt(n,n)}function jH(n,t,e){const r=t.shape;if(1!==t.rank&&t.rank!==n)throw new St(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${n}`);if(5===n){if("channelsFirst"===e)return wt(t,1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===e)return wt(t,1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===n){if("channelsFirst"===e)return wt(t,1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===e)return wt(t,1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===n){if("channelsFirst"===e)return wt(t,1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===e)return wt(t,1===r.length?[1,1,r[0]]:[1].concat(r))}else if(n<3)return t;throw new St(`Unsupported input rank by biasAdd: ${t.rank}`)}function Yc(n,t,e){return Ot(()=>(null==e&&(e="channelsLast"),no(e),_n(n,jH(n.rank,t,e))))}function IX(n,t,e,r){return Ot(()=>aH(n,t,e,r))}function lE(n,t,e=!1){return e?n():t()}const Hye=["fanIn","fanOut","fanAvg"],Wye=["normal","uniform","truncatedNormal"];class pc extends Jg{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}let DX=(()=>{class n extends pc{apply(e,r){return vo(e,r)}}return n.className="Zeros",n})();Nn(DX);let qH=(()=>{class n extends pc{apply(e,r){return Wu(e,r)}}return n.className="Ones",n})();Nn(qH);let MX=(()=>{class n extends pc{constructor(e){if(super(),"object"!=typeof e)throw new St(`Expected argument of type ConstantConfig but got ${e}`);if(void 0===e.value)throw new St(`config must have value set but got ${e}`);this.value=e.value}apply(e,r){return Ot(()=>vt(hr(this.value),Wu(e,r)))}getConfig(){return{value:this.value}}}return n.className="Constant",n})();Nn(MX);let kX=(()=>{class n extends pc{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,r){return lv(e,this.minval,this.maxval,r,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}return n.className="RandomUniform",n})();Nn(kX);let RX=(()=>{class n extends pc{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if("float32"!==(r=r||"float32")&&"int32"!==r)throw new Ur(`randomNormal does not support dType ${r}.`);return bO(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="RandomNormal",n})();Nn(RX);let OX=(()=>{class n extends pc{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if("float32"!==(r=r||"float32")&&"int32"!==r)throw new Ur(`truncatedNormal does not support dType ${r}.`);return tO(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return n.className="TruncatedNormal",n})();Nn(OX);let FX=(()=>{class n extends pc{constructor(e){super(),this.gain=null!=e.gain?e.gain:1}apply(e,r){return Ot(()=>{if(2!==e.length||e[0]!==e[1])throw new St("Identity matrix initializer can only be used for 2D square matrices.");return vt(this.gain,$R(e[0]))})}getConfig(){return{gain:this.gain}}}return n.className="Identity",n})();Nn(FX);let ju=(()=>{class n extends pc{constructor(e){if(super(),e.scale<0)throw new St(`scale must be a positive float. Got: ${e.scale}`);this.scale=null==e.scale?1:e.scale,this.mode=null==e.mode?"fanIn":e.mode,function Gye(n){mv(Hye,"FanMode",n)}(this.mode),this.distribution=null==e.distribution?"normal":e.distribution,function jye(n){mv(Wye,"Distribution",n)}(this.distribution),this.seed=e.seed}apply(e,r){const i=function qye(n,t="channelsLast"){let e,r;if(no(t),2===n.length)e=n[0],r=n[1];else if(-1!==[3,4,5].indexOf(n.length)){if("channelsFirst"===t){const i=Kp(n,2);e=n[1]*i,r=n[0]*i}else if("channelsLast"===t){const i=Kp(n,0,n.length-2);e=n[n.length-2]*i,r=n[n.length-1]*i}}else{const i=Kp(n);e=Math.sqrt(i),r=Math.sqrt(i)}return[e,r]}(e),s=i[0],o=i[1];let a=this.scale;if(a/="fanIn"===this.mode?Math.max(1,s):"fanOut"===this.mode?Math.max(1,o):Math.max(1,(s+o)/2),"normal"===this.distribution){const u=Math.sqrt(a);if("float32"!==(r=r||"float32")&&"int32"!==r)throw new Ur(`${this.getClassName()} does not support dType ${r}.`);return tO(e,0,u,r,this.seed)}{const u=Math.sqrt(3*a);return lv(e,-u,u,r,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}return n.className="VarianceScaling",n})();Nn(ju);let ZH=(()=>{class n extends ju{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return ju.className}}return n.className="GlorotUniform",n})();Nn(ZH);let KH=(()=>{class n extends ju{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return ju.className}}return n.className="GlorotNormal",n})();Nn(KH);let XH=(()=>{class n extends ju{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return ju.className}}return n.className="HeNormal",n})();Nn(XH);let YH=(()=>{class n extends ju{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return ju.className}}return n.className="HeUniform",n})();Nn(YH);let QH=(()=>{class n extends ju{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}getClassName(){return ju.className}}return n.className="LeCunNormal",n})();Nn(QH);let JH=(()=>{class n extends ju{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}getClassName(){return ju.className}}return n.className="LeCunUniform",n})();Nn(JH);let PX=(()=>{class n extends pc{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==e.gain?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,r){return Ot(()=>{if(e.length<2)throw new Ur("Shape must be at least 2D.");if("int32"!==r&&"float32"!==r&&void 0!==r)throw new TypeError(`Unsupported data type ${r}.`);r=r;const i=Xt(e.slice(0,-1)),s=e[e.length-1],o=i*s;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const u=bO([Math.max(s,i),Math.min(s,i)],0,1,r,this.seed),d=gH.qr(u,!1);let m=d[0];const _=d[1].flatten().stridedSlice([0],[Math.min(s,i)*Math.min(s,i)],[Math.min(s,i)+1]);return m=vt(m,_.sign()),i<s&&(m=m.transpose()),vt(hr(this.gain),m.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}return n.className="Orthogonal",n})();Nn(PX);const LX={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function $X(n,t={}){return sE(n,bl.getMap().classNameMap,t,"initializer")}function Os(n){return VH(n)}function _s(n){if("string"==typeof n){const t=n in LX?LX[n]:n;if("GlorotNormal"===t)return new KH;if("GlorotUniform"===t)return new ZH;if("HeNormal"===t)return new XH;if("HeUniform"===t)return new YH;if("LeCunNormal"===t)return new QH;if("LeCunUniform"===t)return new JH;{const e={};return e.className=t,e.config={},$X(e)}}return n instanceof pc?n:$X(n)}function e6(n){return Array.isArray(n)&&Array.isArray(n[0])}function wO(n){return 0===n.length?[]:Array.isArray(n[0])?n:[n]}function xr(n){let t;if(Array.isArray(n)){if(1!==n.length)throw new St(`Expected Tensor length to be 1; got ${n.length}`);t=n[0]}else t=n;return t}function Ei(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(1===n.length)return(n=n)[0];throw new St(`Expected exactly 1 Shape; got ${n.length}`)}return n}function xO(n){let t=0;for(const e of n)t+=0===e.shape.length?1:e.shape.reduce((r,i)=>r*i);return t}const BX="Variable";class Qc{constructor(t,e="float32",r=BX,i=!0,s=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=bX(),this.originalName=CX(r=null==r?BX:r),this.name=SX(this.originalName),this.trainable_=i,this.constraint=s,this.val=rH(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function Zye(n,t){if(n.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function t6(n){return n.map(t=>t.read())}function n6(n){n.forEach(t=>{t[0].write(t[1])})}class yo{constructor(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Jc{constructor(t,e,r,i,s,o,a){this.dtype=t,this.shape=e,this.sourceLayer=r,this.inputs=i,this.callArgs=s,this.outputTensorIndex=a,this.id=bX(),null!=o&&(this.originalName=CX(o),this.name=SX(this.originalName)),this.rank=e.length}}let Kye=0;class CO{constructor(t,e){this.callArgs=e,this.id=Kye++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const r of t.inboundLayers)null!=r&&r.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)t.push(null!=e?e.name:null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Xye=0;class Jr extends Jg{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Xye++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const r=this.getClassName();e=hd(r)+"_"+vO(r)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let r;if(null!=t.batchInputShape)r=t.batchInputShape;else if(null!=t.inputShape){let s=null;null!=t.batchSize&&(s=t.batchSize),r=[s].concat(t.inputShape)}this.batchInputShape=r;let i=t.dtype;null==i&&(i=t.inputDType),null==i&&(i="float32"),this.dtype=i}this.initialWeights=null!=t.weights?t.weights:null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new fc(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new St(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return _u(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return _u(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Wh(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new Wh(`Layer ${this.name} is not connected, no input to return.`);return _u(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new Wh(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Wh(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return _u(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=os(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=os(this.inputSpec);if(t.length!==e.length)throw new St(`Layer ${this.name} expects ${e.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let r=0;r<t.length;r++){const i=t[r],s=e[r];if(null==s)continue;const o=i.rank;if(null!=s.ndim&&o!==s.ndim)throw new St(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${s.ndim}, found ndim=${o}`);if(null!=s.maxNDim&&o>s.maxNDim)throw new St(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${s.maxNDim}, found ndim=${o}`);if(null!=s.minNDim&&o<s.minNDim)throw new St(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${s.minNDim}, found ndim=${o}.`);if(null!=s.dtype&&i.dtype!==s.dtype)throw new St(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${s.dtype}, found dtype=${i.dtype}.`);if(s.axes){const a=i.shape;for(const u in s.axes){const d=Number(u),m=s.axes[u],y=d>=0?a[d]:a[a.length+d];if(null!=m&&-1===[m,null].indexOf(y))throw new St(`Input ${r} is incompatible with layer ${this.name}: expected axis ${d} of input shape to have value ${m} but got shape ${a}.`)}}if(null!=s.shape)for(let a=0;a<s.shape.length;++a){const u=s.shape[a],d=i.shape[a];if(null!=u&&null!=d&&u!==d)throw new St(`Input ${r} is incompatible with layer ${this.name}: expected shape=${s.shape}, found shape=${i.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const r=os(t);let i=!0;for(const o of r)if(!(o instanceof Jc)){i=!1;break}let s=!0;for(const o of r)if(o instanceof Jc){s=!1;break}if(i===s)throw new St("Arguments to apply() must be all SymbolicTensors or all Tensors");return gv(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const o=[];for(const a of os(t))o.push(a.shape);this.build(_u(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&s&&(this._refCount=1)}if(this.assertInputCompatibility(t),s){let o=this.call(t,e);const a=os(o),u=[];for(let d of a)-1!==r.indexOf(d)&&(d=d.clone()),u.push(d);if(o=_u(u),null!=this.activityRegularizer)throw new Ur("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}{const o=function Yye(n){n=os(n);const t=[];for(const e of n)t.push(e.shape);return _u(t)}(t),a=this.computeOutputShape(o);let u;const d="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?o[0]:o),u=null!=a&&a.length>0&&Array.isArray(a[0])?a.map((m,y)=>new Jc(d,m,this,os(t),e,this.name,y)):new Jc(d,a,this,os(t),e,this.name),this.addInboundNode(t,u,null,null,o,a,e),this._refCount++,null!=this.activityRegularizer)throw new Ur("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return u}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((r,i)=>{null!=r&&null!=t[i]&&t[i]!==r&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Wh(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const r=JSON.stringify(e.outputShapes);-1===t.indexOf(r)&&t.push(r)}if(1===t.length){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&1===e.length?e[0]:e}throw new Wh(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new fc(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return xO(this.weights)}build(t){this.built=!0}getWeights(t=!1){return t6(t?this.trainableWeights:this.weights)}setWeights(t){Ot(()=>{const e=this.weights;if(e.length!==t.length)throw new St(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const r=[],i=t6(e);for(let s=0;s<i.length;++s){const o=i[s],a=e[s],u=t[s];if(!ri(o.shape,u.shape))throw new St(`Layer weight shape ${o.shape} not compatible with provided weight shape ${u.shape}`);r.push([a,u])}n6(r)})}addWeight(t,e,r,i,s,o,a,u){if(-1!==this._addedWeightNames.indexOf(t))throw new St(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==r&&(r="float32"),this.fastWeightInitDuringBuild&&(i=null!=u?u():_s("zeros"));const d=i.apply(e,r),m=new Qc(d,r,t,o,a);return d.dispose(),null!=s&&this.addLoss(()=>s.apply(m.read())),null==o&&(o=!0),o?this._trainableWeights.push(m):this._nonTrainableWeights.push(m),m}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=os(t),null!=this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach(r=>{if(null!=r)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return e}addInboundNode(t,e,r,i,s,o,a=null){const u=os(t);e=os(e),r=os(r),i=os(i),s=wO(s),o=wO(o);const d=[],m=[],y=[];for(const _ of u)d.push(_.sourceLayer),m.push(_.nodeIndex),y.push(_.tensorIndex);new CO({outboundLayer:this,inboundLayers:d,nodeIndices:m,tensorIndices:y,inputTensors:u,outputTensors:e,inputMasks:r,outputMasks:i,inputShapes:s,outputShapes:o},a);for(let _=0;_<e.length;_++)e[_].sourceLayer=this,e[_].nodeIndex=this.inboundNodes.length-1,e[_].tensorIndex=_}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function VX(n,t,e){if((null==t||null!=e&&e>0)&&(t=n.sourceLayer,e=n.nodeIndex),0===t.inboundNodes.length)return[n];{const r=t.inboundNodes[e];if(0===r.inboundLayers.length)return r.inputTensors;{const i=[];for(let s=0;s<r.inboundLayers.length;s++){const d=VX(r.inputTensors[s],r.inboundLayers[s],r.nodeIndices[s]);for(const m of d)-1===i.indexOf(m)&&i.push(m)}return i}}}let cE=(()=>{class n extends Jr{constructor(e){if(super({dtype:e.dtype,name:null!=e.name?e.name:vO("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new St("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let r=e.batchInputShape;if(null==r){if(null==e.inputShape)throw new St("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new St("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const i=e.dtype||"float32";this.batchInputShape=r,this.dtype=i,this.inputSpec=[{shape:r}];const s=new Jc(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new CO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]})}apply(e,r){throw new St(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}return n.className="InputLayer",n})();function zX(n){if(null==n.batchShape&&null==n.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=n.batchShape&&null!=n.shape)throw new St("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=n.batchShape;null!=n.shape&&null==t&&(t=[null].concat(n.shape));let e=n.dtype;return null==e&&(e="float32"),new cE({batchInputShape:t,name:n.name,dtype:e,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}Nn(cE);class Yp{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Yp)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,r){if(null!=this.id2Value[t.id])throw new St(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=function Jye(n,t){if(null==n.dtype||n.dtype===t.dtype)return t;try{return Fn(t,n.dtype)}catch(e){throw new St(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=r&&(this.id2Mask[t.id]=r),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Jc){if(null==this.id2Value[t.id])throw new St(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new St(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof Jc){if(null==this.id2Value[t.id])throw new St(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new St(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Or(this.id2Mask)}}const SO=new gX,EO=new gX;function hE(n,t,e,r){const i=null!=e&&e.training,s=Array.isArray(n),o=s?n:[n],a=o.map(D=>D.name),u=[],d=t.names();for(const D of a)-1!==d.indexOf(D)?u.push(t.getValue(D)):u.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const m=a.join(",")+"|"+t.names().sort().join(",");let _,y=SO.get(m);if(null==y){const D=function t_e(n,t){De(null!=n&&n.length>0,()=>"Expected at least one fetch, got none");let e=[],r={};if(1===n.length){const i=UX(n[0],t);e=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of n){const{sorted:o,recipientMap:a}=UX(s,t);for(const u of o)i.has(u.name)||(e.push(u),i.add(u.name));for(const u in a)null==r[u]&&(r[u]=new Set),a[u].forEach(d=>r[u].add(d))}}return{sorted:e,recipientCounts:n_e(r)}}(o,t);y=D.sorted,_=D.recipientCounts,SO.put(m,y),EO.put(m,_)}_={},i||Object.assign(_,EO.get(m));const E=new Yp(t);for(let D=0;D<y.length;++D){if(null!=r){const st=SR().numTensors;st>r.maxNumTensors&&(r.maxNumTensors=st),st<r.minNumTensors&&(r.minNumTensors=st)}const O=y[D],R=O.sourceLayer;if(R instanceof cE)continue;const $=[],B=[],Q=[];let ie=!1;for(const st of O.inputs){const lt=E.getValue(st),It=E.getMask(st);$.push(lt),B.push(It),null!=It&&(ie=!0),i||(_[st.name]--,0===_[st.name]&&!t.hasKey(st)&&-1===a.indexOf(st.name)&&!lt.isDisposed&&!0!==st.sourceLayer.stateful&&Q.push(lt))}ie&&((e=e||{}).mask=B[0]);const ye=os(R.apply($,e));let Me=null;R.supportsMasking&&(Me=R.computeMask($,B));const Be=r_e(O),He=Array.isArray(Be)?Be:[Be];for(let st=0;st<He.length;++st){E.hasKey(He[st])||E.add(He[st],ye[st],Array.isArray(Me)?Me[0]:Me);const lt=a.indexOf(He[st].name);-1!==lt&&(u[lt]=ye[st])}i||Or(Q)}return E.disposeMasks(),s?u:u[0]}function n_e(n){const t={};for(const e in n)t[e]=n[e].size;return t}function UX(n,t){const e=new Set,r=[],i={};for(const a of t.names())e.add(a);const s=[],o=[];for(s.push(n);s.length>0;){const a=s[s.length-1];if(e.has(a.name)){s.pop();continue}const u=o[o.length-1]===s.length-1;if(0===a.inputs.length||u)s.pop(),r.push(a),e.add(a.name),u&&o.pop();else{o.push(s.length-1);for(const d of a.inputs)null==i[d.name]&&(i[d.name]=new Set),i[d.name].add(a.name),!e.has(d.name)&&s.push(d)}}return{sorted:r,recipientMap:i}}function r_e(n){let t;if(1===n.sourceLayer.inboundNodes.length)t=n.sourceLayer.output;else{let e=null;for(let r=0;r<n.sourceLayer.inboundNodes.length;++r)for(const i of n.sourceLayer.inboundNodes[r].outputTensors)if(i.id===n.id){e=r;break}t=n.sourceLayer.getOutputAt(e)}return t}function r6(n,t){return Ot(()=>ua(Yn(vt(n,n),t,!0)))}Ft().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function e_e(n){null!=SO&&SO.setMaxEntries(n),null!=EO&&EO.setMaxEntries(n)});class fE extends Jg{getConfig(){return{}}}let HX=(()=>{class n extends fE{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ot(()=>{const r=r6(e,this.axis),i=gu(r,0,this.maxValue);return vt(e,nr(i,_n(Io(),r)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}return n.className="MaxNorm",n})();Nn(HX);let WX=(()=>{class n extends fE{constructor(e){super(),this.defaultAxis=0,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ot(()=>nr(e,_n(Io(),r6(e,this.axis))))}getConfig(){return{axis:this.axis}}}return n.className="UnitNorm",n})();Nn(WX);let GX=(()=>{class n extends fE{apply(e){return Zc(e)}}return n.className="NonNeg",n})();Nn(GX);let jX=(()=>{class n extends fE{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=e.minValue?e.minValue:this.defaultMinValue,this.maxValue=null!=e.maxValue?e.maxValue:this.defaultMaxValue,this.rate=null!=e.rate?e.rate:this.defaultRate,this.axis=null!=e.axis?e.axis:this.defaultAxis}apply(e){return Ot(()=>{const r=r6(e,this.axis),i=_n(vt(this.rate,gu(r,this.minValue,this.maxValue)),vt(1-this.rate,r));return vt(e,nr(i,_n(Io(),r)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}return n.className="MinMaxNorm",n})();Nn(jX);const qX={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Do(n){return VH(n)}function ZX(n,t={}){return sE(n,bl.getMap().classNameMap,t,"constraint")}function Mo(n){return null==n?null:"string"==typeof n?ZX({className:n in qX?qX[n]:n,config:{}}):n instanceof fE?n:ZX(n)}function i_e(n){return new HX(n)}function s_e(n){return new WX(n)}function o_e(){return new GX}function a_e(n){return new jX(n)}function u_e(){return new DX}function l_e(){return new qH}function c_e(n){return new MX(n)}function h_e(n){return new kX(n)}function f_e(n){return new RX(n)}function d_e(n){return new OX(n)}function p_e(n){return new FX(n)}function m_e(n){return new ju(n)}function g_e(n){return new ZH(n)}function v_e(n){return new KH(n)}function y_e(n){return new XH(n)}function __e(n){return new YH(n)}function b_e(n){return new QH(n)}function w_e(n){return new JH(n)}function x_e(n){return new PX(n)}function Qp(n){return i6.apply(this,arguments)}function i6(){return(i6=(0,Nt.Z)(function*(n){if(null==n)return;const t=[],e=[],r=[];for(const i in n){const s=n[i];if("number"!=typeof s){const o=s;t.push(o.data()),e.push(i),r.push(o)}}if(t.length>0){const i=yield Promise.all(t);for(let s=0;s<i.length;++s)n[e[s]]=i[s][0];Or(r)}})).apply(this,arguments)}function KX(n){if(null!=n)for(const t in n){const e=n[t];"number"!=typeof e&&e.dispose()}}class X0{constructor(){this.validationData=null}setParams(t){this.params=t}onEpochBegin(t,e){return(0,Nt.Z)(function*(){})()}onEpochEnd(t,e){return(0,Nt.Z)(function*(){})()}onBatchBegin(t,e){return(0,Nt.Z)(function*(){})()}onBatchEnd(t,e){return(0,Nt.Z)(function*(){})()}onTrainBegin(t){return(0,Nt.Z)(function*(){})()}onTrainEnd(t){return(0,Nt.Z)(function*(){})()}setModel(t){}}class XX{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}onEpochBegin(t,e){var r=this;return(0,Nt.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onEpochBegin(t,e)})()}onEpochEnd(t,e){var r=this;return(0,Nt.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onEpochEnd(t,e)})()}onBatchBegin(t,e){var r=this;return(0,Nt.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onBatchBegin(t,e)})()}onBatchEnd(t,e){var r=this;return(0,Nt.Z)(function*(){null==e&&(e={});for(const i of r.callbacks)yield i.onBatchEnd(t,e)})()}onTrainBegin(t){var e=this;return(0,Nt.Z)(function*(){null==t&&(t={});for(const r of e.callbacks)yield r.onTrainBegin(t)})()}onTrainEnd(t){var e=this;return(0,Nt.Z)(function*(){null==t&&(t={});for(const r of e.callbacks)yield r.onTrainEnd(t)})()}}class S_e extends X0{constructor(){super()}onEpochBegin(t){var e=this;return(0,Nt.Z)(function*(){e.seen=0,e.totals={}})()}onBatchEnd(t,e){var r=this;return(0,Nt.Z)(function*(){null==e&&(e={});const i=null==e.size?0:e.size;r.seen+=i;for(const s in e){const o=e[s];if("number"==typeof o)r.totals.hasOwnProperty(s)||(r.totals[s]=0),r.totals[s]=r.totals[s]+o*i;else{let a;s in r.totals?a=r.totals[s]:r.totals[s]=0;const u=Ot(()=>_n(r.totals[s],vt(o,i)));r.totals[s]=u,null!=a&&a.dispose()}}})()}onEpochEnd(t,e){var r=this;return(0,Nt.Z)(function*(){if(null!=e)for(const i of r.params.metrics)null!=r.totals[i]&&("number"==typeof r.totals[i]?e[i]=r.totals[i]/r.seen:Ot(()=>{const s=vt(nr(1,r.seen),r.totals[i]);e[i]=s,r.totals[i].dispose(),Ao(e[i])}))})()}}class YX extends X0{onTrainBegin(t){var e=this;return(0,Nt.Z)(function*(){e.epoch=[],e.history={}})()}onEpochEnd(t,e){var r=this;return(0,Nt.Z)(function*(){null==e&&(e={}),r.epoch.push(t);for(const i in e)null==r.history[i]&&(r.history[i]=[]),r.history[i].push(e[i])})()}syncData(){var t=this;return(0,Nt.Z)(function*(){const e=[],r=[],i=[];for(const o in t.history){const a=t.history[o];for(let u=0;u<a.length;++u)"number"!=typeof a[u]&&(e.push(a[u].data()),r.push(o),i.push(u))}const s=yield Promise.all(e);for(let o=0;o<s.length;++o)t.history[r[o]][i[o]].dispose(),t.history[r[o]][i[o]]=s[o][0]})()}}class QX extends X0{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||vH,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Yk(this.yieldEvery)&&(this.maybeWait=function Sye(n,t,e){let i,r=null!=e?e():aa();return(...o)=>{const a=null!=e?e():aa();return a-r<t||(r=a,i=n(...o)),i}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}maybeWait(t,e,r){var i=this;return(0,Nt.Z)(function*(){const s=[];null!=i.yield&&(yield Qp(r),s.push(i.yield(t,e,r))),s.push(i.nextFrameFunc()),yield Promise.all(s)})()}onEpochBegin(t,e){var r=this;return(0,Nt.Z)(function*(){r.currentEpoch=t,null!=r.epochBegin&&(yield Qp(e),yield r.epochBegin(t,e))})()}onEpochEnd(t,e){var r=this;return(0,Nt.Z)(function*(){const i=[];null!=r.epochEnd&&(yield Qp(e),i.push(r.epochEnd(t,e))),"epoch"===r.yieldEvery&&i.push(r.nextFrameFunc()),yield Promise.all(i)})()}onBatchBegin(t,e){var r=this;return(0,Nt.Z)(function*(){null!=r.batchBegin&&(yield Qp(e),yield r.batchBegin(t,e))})()}onBatchEnd(t,e){var r=this;return(0,Nt.Z)(function*(){const i=[];null!=r.batchEnd&&(yield Qp(e),i.push(r.batchEnd(t,e))),"batch"===r.yieldEvery?i.push(r.nextFrameFunc()):Yk(r.yieldEvery)&&i.push(r.maybeWait(r.currentEpoch,t,e)),yield Promise.all(i)})()}onTrainBegin(t){var e=this;return(0,Nt.Z)(function*(){null!=e.trainBegin&&(yield Qp(t),yield e.trainBegin(t))})()}onTrainEnd(t){var e=this;return(0,Nt.Z)(function*(){null!=e.trainEnd&&(yield Qp(t),yield e.trainEnd(t))})()}}function JX(n,t){return null==n&&(n={}),n instanceof X0?[n]:Array.isArray(n)&&n[0]instanceof X0?n:os(n).map(r=>new QX(r,t))}let eY=(()=>{class n{constructor(){}static registerCallbackConstructor(e,r){De(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),n.checkForDuplicate(r),null==n.constructors[e]&&(n.constructors[e]=[]),n.constructors[e].push(r)}static checkForDuplicate(e){for(const r in n.constructors)n.constructors[+r].forEach(s=>{if(s===e)throw new St("Duplicate callback constructor.")})}static clear(){n.constructors={}}static createCallbacks(e){const r=[];for(const i in n.constructors){const s=+i;e>=s&&r.push(...n.constructors[s])}return r.map(i=>new i)}}return n.constructors={},n})();function tY(n,t,e,r,i,s,o,a,u){const d=new YX,m=[new S_e,...eY.createCallbacks(t)];null!=n&&m.push(...n),m.push(d);const y=new XX(m);return y.setParams({epochs:e,initialEpoch:r,samples:i,steps:s,batchSize:o,verbose:t,doValidation:a,metrics:u}),{callbackList:y,history:d}}function eh(n,t={},e=!1){return sE(n,bl.getMap().classNameMap,t,"layer",e)}function NO(n,t){return Ot(()=>{"float32"!==n.dtype&&(n=Fn(n,"float32"));const e=Yn(uE(n),t,!0),r=ev(e.shape,Io()),i=ua(Uh(e,r));return nr(n,i)})}function yv(n,t){return Ot(()=>Rs(uE(qn(t,n)),-1))}function TO(n,t){return Ot(()=>Rs(mo(qn(t,n)),-1))}function Y0(n,t){return Ot(()=>{const e=qn(n,t),r=gu(mo(n),Io(),Number.MAX_VALUE),i=mo(nr(e,r));return vt(100,Rs(i,-1))})}function dE(n,t,e=!1){return Ot(()=>{if(e)t=JS(t);else{const r=Yn(t,t.shape.length-1,!0);t=nr(t,r)}return t=gu(t,Io(),1-Io()),ss(Yn(vt(Fn(n,"float32"),Hu(t)),t.shape.length-1))})}function AO(n,t,e=!1){return Ot(()=>{const r=Fn(z0(function $ye(n){const t=[Kp(n.shape)];return wt(n,t)}(n)),"int32"),i=(t=gu(t,Io(),1-Io())).shape;return dE(wt(R0(r,i[i.length-1]),i),t,e)})}function IO(n,t){return Ot(()=>{let e;return e=gu(t,Io(),1-Io()),e=Hu(nr(e,qn(1,e))),Rs(function D_e(n,t){if(!ri(n.shape,t.shape))throw new St(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(t.shape)}`);return Ot(()=>{const e=Zc(t),r=ss(mo(t));return _n(qn(e,vt(t,n)),GS(Uu(r)))})}(n,e),-1)})}function s6(n,t){return Ot(()=>{const e=NO(n,-1),r=NO(t,-1),i=vt(e,r);return ss(Yn(i,-1))})}const DO={meanSquaredError:yv,meanAbsoluteError:TO,meanAbsolutePercentageError:Y0,meanSquaredLogarithmicError:function E_e(n,t){return Ot(()=>{const e=gu(t,Io(),Number.MAX_VALUE),r=Hu(_n(1,e)),i=gu(n,Io(),Number.MAX_VALUE),s=Hu(_n(1,i));return Rs(uE(qn(r,s)),-1)})},squaredHinge:function N_e(n,t){return Ot(()=>{const e=Uh(0,qn(1,vt(n,t)));return Rs(uE(e),-1)})},hinge:function T_e(n,t){return Ot(()=>{const e=Uh(0,qn(1,vt(n,t)));return Rs(e,-1)})},categoricalHinge:function A_e(n,t){return Ot(()=>{const e=Yn(vt(n,t),-1),r=wl(vt(qn(1,n),t),-1);return Uh(0,_n(1,qn(r,e)))})},logcosh:function I_e(n,t){return Ot(()=>{const e=Math.log(2),r=qn(t,n),i=qn(_n(r,av(vt(-2,r))),e);return Rs(i,-1)})},categoricalCrossentropy:dE,sparseCategoricalCrossentropy:AO,binaryCrossentropy:IO,kullbackLeiblerDivergence:function M_e(n,t){return Ot(()=>{const e=gu(n,Io(),1),r=gu(t,Io(),1);return Yn(vt(n,Hu(nr(e,r))),-1)})},poisson:function k_e(n,t){return Ot(()=>{const e=Hu(_n(Io(),t));return Rs(qn(t,vt(n,e)),-1)})},cosineProximity:s6};function o6(n){if("string"==typeof n){if(n in DO)return DO[n];let t=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new St(t)}return n}function a6(n,t){return Ot(()=>{const e=vt(.5,Gu(t)),r=Gh(Ka(t,e),n.dtype);return Rs(zu(n,r),-1)})}function u6(n,t){return Ot(()=>Gh(zu(rv(n,-1),rv(t,-1)),"float32"))}function nY(n,t){return Ot(()=>Fn(Yn(lc(zu(n,1),zu(t,1))),"float32"))}function rY(n,t){return Ot(()=>{const e=nY(n,t),r=function O_e(n,t){return Ot(()=>Fn(Yn(lc(zu(n,0),zu(t,1))),"float32"))}(n,t),i=_n(e,r);return Fn(Zo(Ka(i,0),nr(e,i),0),"float32")})}function iY(n,t){return IO(n,t)}function sY(n,t){return n.rank===t.rank&&(n=jp(n,[n.rank-1])),(t=rv(t,-1)).dtype!==n.dtype&&(t=Fn(t,n.dtype)),Fn(zu(n,t),"float32")}const l6=dE,oY=AO,MO={binaryAccuracy:a6,categoricalAccuracy:u6,precision:rY,categoricalCrossentropy:l6,sparseCategoricalCrossentropy:oY,mse:yv,MSE:yv,mae:TO,MAE:TO,mape:Y0,MAPE:Y0,cosine:s6};function H_e(n){if("string"==typeof n&&n in MO)return MO[n];if("string"!=typeof n&&null!=n)return n;throw new St(`Unknown metric ${n}`)}function kO(n){if(El(null!==n,`Unknown LossOrMetricFn ${n}`),"string"==typeof n)return n;{let t;for(const e of Object.keys(DO))if(DO[e]===n){t=e;break}if(void 0!==t)return t;for(const e of Object.keys(MO))if(MO[e]===n){t=e;break}return void 0!==t?t:n.name}}function uY(n,t,e=!1){if(null==n||"object"!=typeof n||Object.getPrototypeOf(n)!==Object.prototype||!c6(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){const r=JSON.stringify(n);r.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function c6(n){if(null===n)return!0;if("object"==typeof n){if(Object.getPrototypeOf(n)===Object.prototype){const t=Object.keys(n);for(const e of t)if("string"!=typeof e||!c6(n[e]))return!1;return!0}if(Array.isArray(n)){for(const t of n)if(!c6(t))return!1;return!0}return!1}{const t=typeof n;return"string"===t||"number"===t||"boolean"===t}}function RO(n,t,e=console.log){let r="";for(let i=0;i<n.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=n[i],r=r.slice(0,t[i]),r+=" ".repeat(t[i]-r.length);e(r)}function Z_e(n,t,e){let r,i;try{i=n.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch(u){i="multiple"}try{r=JSON.stringify(n.outputShape)}catch(u){r="multiple"}RO([`${n.name} (${n.getClassName()})`,i,r,n.countParams().toString()],t,e)}function K_e(n,t,e,r){let i,s;try{s=n.inboundNodes.map(y=>JSON.stringify(y.inputShapes)).join(",")}catch(y){s="multiple"}try{i=JSON.stringify(n.outputShape)}catch(y){i="multiple"}const o=[];for(const y of n.inboundNodes)if(!(null!=e&&e.length>0&&-1===e.indexOf(y)))for(let _=0;_<y.inboundLayers.length;++_)o.push(`${y.inboundLayers[_].name}[${y.nodeIndices[_]}][${y.tensorIndices[_]}]`);const a=n.name,u=n.getClassName(),d=0===o.length?"":o[0];RO([`${a} (${u})`,s,i,n.countParams().toString(),d],t,r);for(let y=1;y<o.length;++y)RO(["","","","",o[y]],t,r)}function lY(n,t,e){return("inboundNodes"===n||"outputLayers"===n||"inputLayers"===n)&&0===t&&"string"==typeof e}function pE(n,t){if(null===n)return null;if("string"==typeof n)return pv(n);if("number"==typeof n||"boolean"==typeof n)return n;if(n instanceof Array){const e=[],r=n.length;for(let i=0;i<r;++i){const s=n[i];lY(t,i,s)?e.push(s):e.push(pE(s,t))}return e}{const e={};for(const r of Object.keys(n)){const i=n[r];if("name"===r&&"string"==typeof i)e[r]=i;else{const s=pv(r);e[s]=pE(i,s)}}return e}}function h6(n,t){if(null==n)return null;if("string"==typeof n)return hd(n);if("number"==typeof n||"boolean"==typeof n)return n;if(n instanceof Array){const e=[],r=n.length;for(let i=0;i<r;++i){const s=n[i];lY(t,i,s)?e.push(s):e.push(h6(s,t))}return e}{const e={};for(const r of Object.keys(n)){const i=n[r];e[hd(r)]="name"!==r&&"className"!==r||"string"!=typeof i?h6(i,r):i}return e}}const OO="4.4.0";class th extends Jr{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const B=this.getClassName().toLowerCase();this.name=vO(B)}if(this.supportsMasking=!1,this.trainable_=!0,this.inputs=Array.isArray(t.inputs)?t.inputs.slice():[t.inputs],this.outputs=Array.isArray(t.outputs)?t.outputs.slice():[t.outputs],Zp(this.inputs).length!==this.inputs.length)throw new St(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(B=>B.name)}`);Zp(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(B=>B.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const B of this.outputs){const ie=B.nodeIndex,ye=B.tensorIndex;this.outputLayers.push(B.sourceLayer),this.outputLayersNodeIndices.push(ie),this.outputLayersTensorIndices.push(ye)}for(const B of this.inputs){const Q=B.sourceLayer,ie=B.nodeIndex,ye=B.tensorIndex;El(0===ie,"input layer has >1 nodes"),El(0===ye,"input layer has >1 tensors"),this.inputLayers.push(Q),this.inputLayersNodeIndices.push(ie),this.inputLayersTensorIndices.push(ye)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let B=0;B<this.inputLayers.length;B++){const Q=this.inputLayers[B];if(!(Q instanceof cE))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${B} (0-based) originates from layer type ${Q.getClassName()}.`);this.inputNames.push(Q.name),this.feedInputShapes.push(Q.batchInputShape),this.feedInputNames.push(Q.name)}for(const B of this.outputLayers)this.outputNames.push(B.name);this.internalInputShapes=this.inputs.map(B=>B.shape),this.internalOutputShapes=this.outputs.map(B=>B.shape);const e={},r={},i={},s={},o={},a=[],u=(B,Q,ie,ye,Me,Be)=>{(null==ye||null==Me||null==Be)&&(ye=B.sourceLayer,Me=B.nodeIndex,Be=B.tensorIndex);const He=ye.inboundNodes[Me];if(-1!==ie.indexOf(He))throw new fc(`The tensor ${B.name} at layer "${ye.name}" is part of a cycle.`);if(-1!==Q.indexOf(He))return;this.containerNodes.add(th.nodeKey(ye,Me)),ye.id in o||(o[ye.id]=Object.keys(o).length),-1===ie.indexOf(He)&&ie.push(He);const st=He.inboundLayers.length;for(let lt=0;lt<st;lt++)u(He.inputTensors[lt],Q,ie,He.inboundLayers[lt],He.nodeIndices[lt],He.tensorIndices[lt]);for(Q.push(He);ie.indexOf(He)>=0;)ie.splice(ie.indexOf(He),1);a.push(He)},d=[],m=[];for(const B of this.outputs)u(B,d,m);const y=a.slice().reverse();for(const B of y){r[B.id]=B,B.id in e||(e[B.id]=0);let Q=e[B.id];Q=Math.max(Q,null==i[B.outboundLayer.id]?0:i[B.outboundLayer.id]),i[B.outboundLayer.id]=Q,s[B.outboundLayer.id]=B.outboundLayer,e[B.id]=Q;for(let ye=0;ye<B.inboundLayers.length;ye++){const He=B.inboundLayers[ye].inboundNodes[B.nodeIndices[ye]];e[He.id]=Math.max(Q+1,null==e[He.id]?0:e[He.id]),r[He.id]=He}}const _={};for(const B in e){const Q=e[B];Q in _||(_[Q]=[]),_[Q].push(r[B])}const E={};for(const B in i){const Q=i[B];Q in E||(E[Q]=[]),E[Q].push(s[B])}let D=Object.keys(E).map(B=>parseInt(B,10)).sort(mO);this.layers=[];for(const B of D){const Q=E[B];Q.sort((ie,ye)=>{const Me=o[ie.id],Be=o[ye.id];return Me<Be?-1:Me>Be?1:0});for(const ie of Q)ie instanceof th&&this.internalContainerRefs.push(ie),this.layers.push(ie)}this.layersByDepth=E,D=Object.keys(_).map(B=>parseInt(B,10)).sort(mO);const O=this.inputs.slice(),R=[];for(const B of D)for(const Q of _[B]){const ie=Q.outboundLayer;if(null!=ie){for(const ye of Q.inputTensors)if(-1===O.indexOf(ye))throw new fc(`Graph disconnected: cannot obtain value for tensor ${ye} at layer "${ie.name}". The following previous layers were accessed without issue: ${R}`);for(const ye of Q.outputTensors)O.push(ye);R.push(ie.name)}}this.nodesByDepth=_;const $=this.layers.map(B=>B.name);for(const B of $){const Q=$.filter(ie=>ie===B).length;if(1!==Q)throw new fc(`The name "${B}" is used ${Q} times in the model. All layer names should be unique. Layer names: `+JSON.stringify($))}this.outboundNodes=[],this.inboundNodes=[],new CO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(B=>null),outputMasks:this.outputs.map(B=>null),inputShapes:this.inputs.map(B=>B.shape),outputShapes:this.outputs.map(B=>B.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(r=>r.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new St("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const r of this.layers)e.push(...r.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const r={};let i=0;for(const o of this.layers)for(const a of o.weights){if(null!=r[a.originalName])throw new St(`Duplicate weight name: ${a.originalName}`);r[a.originalName]=a,i++}const s=[];for(const o in t){let a=o;if(null==r[o]){const u=o.split("/");a=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(null!=r[a])s.push([r[a],t[o]]);else if(e)throw new St(`Provided weight data has no target variable: ${o}`);delete r[a]}if(e){const o=[];for(const a in r)o.push(a);if(o.length>0)throw new St(`${o.length} of ${i} weights are not set: ${o}`)}n6(s)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion=`tfjs-layers ${OO}`,e.backend="TensorFlow.js",e}toJSON(t,e=!0){const r=h6(this.updatedConfig());return e?JSON.stringify(r):r}call(t,e){return Ot(()=>{t=os(t);const r=new Yp;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],t[i]);return hE(this.outputs,r,e)})}computeMask(t,e){return Ot(()=>{let r;return t=os(t),r=null==e?dv(null,t.length):os(e),this.runInternalGraph(t,r)[1]})}computeOutputShape(t){const e=wO(t);if(e.length!==this.inputLayers.length)throw new St(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<e.length;a++)r[this.inputLayers[a].name+"_0_0"]=e[a];const i=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(mO);if(i.length>1)for(const a of i){const u=this.nodesByDepth[a];for(const d of u){const m=d.outboundLayer;if(-1!==this.inputLayers.map(O=>O.id).indexOf(m.id))continue;const y=[];for(let O=0;O<d.inboundLayers.length;O++)y.push(r[`${d.inboundLayers[O].name}_${d.nodeIndices[O]}_${d.tensorIndices[O]}`]);const E=wO(m.computeOutputShape(_u(y))),D=m.inboundNodes.indexOf(d);for(let O=0;O<E.length;O++)r[`${m.name}_${D}_${O}`]=E[O]}}const s=[],o=[];for(let a=0;a<this.outputLayers.length;a++)o.push(`${this.outputLayers[a].name}_${this.outputLayersNodeIndices[a]}_${this.outputLayersTensorIndices[a]}`);for(let a=0;a<o.length;a++){const u=o[a];El(u in r),s.push(r[u])}return _u(s)}runInternalGraph(t,e){null==e&&(e=dv(null,t.length));const r={};for(let u=0;u<this.inputs.length;++u)r[this.inputs[u].id]=[t[u],e[u]];const i=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(mO);for(const u of i){const d=this.nodesByDepth[u];for(const m of d){const y=m.outboundLayer,_=m.inputTensors,E=m.outputTensors,D=new Array;for(const O of _)O.id in r&&D.push(r[O.id]);if(D.length===_.length){let R,$,B,Q,O={};if(null!=m.callArgs&&(O=m.callArgs),1===D.length){const[ie,ye]=D[0];null==O.mask&&(O.mask=ye),B=os(y.call(ie,O)),Q=os(y.computeMask(ie,ye)),R=[ie],$=[ye]}else R=D.map(ie=>ie[0]),$=D.map(ie=>ie[1]),null==O.mask&&(O.mask=$),B=os(y.call(R,O)),Q=os(y.computeMask(R,$));if(y.activityRegularizer)throw new Ur("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let ie=0;ie<E.length;++ie)r[E[ie].id]=[B[ie],Q[ie]]}}}const s=[],o=[],a=[];for(const u of this.outputs){El(u.id in r,`Could not compute output ${u.name} : ${u.id}`);const[d,m]=r[u.id];a.push(d.shape),s.push(d),o.push(m)}return[s,o,a]}buildNodeConversionMap(t){const e={};let r;for(const i of this.layers){r=i instanceof th?1:0;for(let s=0;s<i.inboundNodes.length;s++){const o=th.nodeKey(i,s);this.containerNodes.has(o)&&(e[o]=r,r+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new St(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new St("Provide either a layer name or layer index");for(const r of this.layers)if(r.name===t)return r;throw new St(`No such layer: ${t}`)}calculateLosses(){return Ot(()=>{const t=[];for(const e of this.layers)for(let r=0;r<e.inboundNodes.length;++r){const i=th.nodeKey(e,r);this.containerNodes.has(i)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),r=[];for(const o of this.layers){const a=o.getClassName(),u=o.getConfig(),d=[];for(let y=0;y<o.inboundNodes.length;y++){const _=o.inboundNodes[y],E=th.nodeKey(o,y);let D={};if(this.containerNodes.has(E)){if(_.callArgs)try{JSON.stringify(_.callArgs),D=_.callArgs}catch(O){console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${_.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),D={}}if(_.inboundLayers.length>0){const O=[];for(let R=0;R<_.inboundLayers.length;R++){const $=_.inboundLayers[R],Q=_.tensorIndices[R];let ye=e[th.nodeKey($,_.nodeIndices[R])];null==ye&&(ye=0),O.push([$.name,ye,Q,D])}d.push(O)}}}const m={};m.name=o.name,m.className=a,m.config=u,m.inboundNodes=d,r.push(m)}t.layers=r;const i=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],d=th.nodeKey(a,this.inputLayersNodeIndices[o]);if(!this.containerNodes.has(d))continue;let m=e[d];null==m&&(m=0),i.push([a.name,m,this.inputLayersTensorIndices[o]])}t.inputLayers=i;const s=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],d=th.nodeKey(a,this.outputLayersNodeIndices[o]);if(!this.containerNodes.has(d))continue;let m=e[d];null==m&&(m=0),s.push([a.name,m,this.outputLayersTensorIndices[o]])}return t.outputLayers=s,t}static fromConfig(t,e,r={},i=!1){const s={},o={};function a(R,$){R.name in o?o[R.name].push($):o[R.name]=[$]}function u(R,$){const B=[];let Q;for(const ie of $){const ye=ie[0],Me=ie[1],Be=ie[2];if(Q=null==ie[3]?{}:ie[3],!(ye in s))return void a(R,$);const He=s[ye];if(He.inboundNodes.length<=Me)return void a(R,$);B.push(He.inboundNodes[Me].outputTensors[Be])}B.length>0&&R.apply(_u(B),Q)}function d(R){const $=R.name,B=eh(R,null!=e.customObjects?e.customObjects:{});B.setFastWeightInitDuringBuild(i),s[$]=B,R.inboundNodes.forEach(ie=>{if(!(ie instanceof Array))throw new St(`Corrupted configuration, expected array for nodeData: ${ie}`);a(B,ie)})}const m=e.name,y=e.layers;for(const R of y)d(R);for(;!Cye(o);)for(const R of y){const $=s[R.name];if($.name in o){const B=o[$.name];delete o[$.name];for(const Q of B)u($,Q)}}const _=[],E=[],D=e.inputLayers;for(const R of D){const $=R[0],B=R[1],Q=R[2];El($ in s),_.push(s[$].inboundNodes[B].outputTensors[Q])}const O=e.outputLayers;for(const R of O){const $=R[0],B=R[1],Q=R[2];El($ in s),E.push(s[$].inboundNodes[B].outputTensors[Q])}return new t({inputs:_,outputs:E,name:m})}get stateful(){if(this._stateful)throw new St("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Ot(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}function hY(n,t){return function cY(n,t,e){const r=t.length;if(null==n||Array.isArray(n)&&0===n.length)return t.map(i=>null);if(1===r)return Array.isArray(n)&&1===n.length?n:"object"==typeof n&&t[0]in n?[n[t[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error(`Provided ${e} is an array of ${n.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return n}if("object"==typeof n&&Object.keys(n).length>0&&"object"==typeof n[Object.keys(n)[0]]){const i=[];return t.forEach(s=>{i.push(s in n?n[s]:null)}),i}throw new Error(`The model has multiple (${r}) outputs, so ${e} must be either an array with ${r} elements or an object with ${t} keys. Provided ${e} not understood: ${JSON.stringify(n)}`)}(n,t,"classWeight")}function fY(n,t,e,r){return f6.apply(this,arguments)}function f6(){return(f6=(0,Nt.Z)(function*(n,t,e,r){if(null!=t||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=e){const i=Ot(()=>{if(1===n.shape.length)return Vh(n);if(2===n.shape.length){if(n.shape[1]>1)return rv(n,1);if(1===n.shape[1])return wt(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(yield i.data());Or(i);const o=[];return s.forEach(a=>{if(null==e[a])throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(e[a])}),ka(o,"float32")}return null})).apply(this,arguments)}function X_e(n,t){return vt(n,t)}function dY(n,t){let e,r;e=t.xs,r=t.ys,De(null!=e&&null!=r,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const s=pY("input",n.inputNames,e),o=pY("output",n.outputNames,r),a=s[0].shape[0];De(s.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),De(o.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let u=0;u<s.length;u++)De(s[u].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[u]} has ${s[u].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let u=0;u<o.length;u++)De(o[u].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[u]} has ${o[u].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:s,ys:o}}function pY(n,t,e){if(e instanceof yi)return[e];if(Array.isArray(e))return De(e.length===t.length,()=>`Received an array of ${e.length} Tensors, but expected ${t.length} to match the ${n} keys ${t}.`),e;{const r=[];for(const i of t){if(null==e[i])throw new St(`The feature data generated by the dataset lacks the required ${n} key '${i}'.`);r.push(e[i])}return r}}function Q_e(n){if(3===n.length)throw new Ur("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}function d6(){return(d6=(0,Nt.Z)(function*(n,t,e){const r=null!=e.batchesPerEpoch;if(De(null!=n.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),De(null!=e,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),De(null!=e.epochs&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),De(!r||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),De(null==e.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const i=null!=e.validationData;let s,o;if(i)if(mY(e.validationData))De(null==e.validationBatches||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{const R=Q_e(e.validationData);s=R.xs,o=R.ys}const a=n.makeTrainFunction(),u=n.getDedupedMetricsNames();let d;d=i?u.slice().concat(u.map(R=>"val_"+R)):u.slice();const m=JX(e.callbacks,e.yieldEvery),y=null==e.verbose?1:e.verbose,{callbackList:_,history:E}=tY(m,y,e.epochs,null,null,e0e(t,e),null,i,d);_.setModel(n),n.history=E,yield _.onTrainBegin(),n.stopTraining_=!1;let D=null==e.initialEpoch?0:e.initialEpoch,O=yield t.iterator();for(;D<e.epochs;){const R={};yield _.onEpochBegin(D);let $=0,B=0;for(r||(O=yield t.iterator());!r||$<e.batchesPerEpoch;){const Q=yield O.next();if(r&&Q.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${$} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(null!=Q.value){const{xs:ie,ys:ye}=dY(n,Q.value),Me={};Me.batch=B,Me.size=ie[0].shape[0],yield _.onBatchBegin(B,Me);const Be=[];if(null!=e.classWeight){const lt=hY(e.classWeight,n.outputNames);for(let It=0;It<lt.length;++It)Be.push(yield fY(ye[It],null,lt[It]))}const He=ie.concat(ye).concat(Be),st=a(He);Or(He);for(let lt=0;lt<u.length;++lt){const zt=st[lt];Me[u[lt]]=zt,Ao(zt)}yield _.onBatchEnd(B,Me),KX(Me),B++,$++}if(r?$>=e.batchesPerEpoch:Q.done){if(i){let ie;ie=mY(e.validationData)?os(yield n.evaluateDataset(e.validationData,{batches:e.validationBatches})):os(n.evaluate(s,o,{batchSize:null==e.validationBatchSize?32:e.validationBatchSize,verbose:0}));for(let ye=0;ye<n.metricsNames.length;++ye)R[`val_${n.metricsNames[ye]}`]=ie[ye]}break}if(n.stopTraining_)break}if(yield _.onEpochEnd(D,R),D++,n.stopTraining_)break}return yield _.onTrainEnd(),yield n.history.syncData(),n.history}finally{n.isTraining=!1}})).apply(this,arguments)}function e0e(n,t){let e=null;return null!=t.batchesPerEpoch?e=t.batchesPerEpoch:Number.isFinite(n.size)&&(e=n.size),e}function mY(n){return"function"==typeof n.iterator}function t0e(n){return"function"==typeof n.next}function p6(){return(p6=(0,Nt.Z)(function*(n,t,e){const r=null!=(e=e||{}).batches,i=n.testFunction;let s=[];if(e.verbose>0)throw new Ur("Verbose mode is not implemented yet.");De(!r||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);const o=t0e(t)?t:yield t.iterator();let a=0,u=0;for(;!r||u<e.batches;){const d=yield o.next();if(s=Ot(()=>{if(d.value){const{xs:m,ys:y}=dY(n,d.value),_=m.concat(y),E=Ot(()=>i(_));if(Or(_),0===u)for(let O=0;O<E.length;++O)s.push(hr(0));const D=_[0].shape[0];for(let O=0;O<E.length;++O){const R=E[O],$=s[O];s[O]=Ot(()=>_n(s[O],vt(D,R))),u>0&&Or($)}Or(E),a+=D,++u}return s}),d.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let d=0;d<s.length;++d){const m=s[d];s[d]=nr(s[d],a),Or(m)}return _u(s)})).apply(this,arguments)}function m6(n){De(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function mE(n,t,e){return null==n?[null]:Array.isArray(n)?n.map(r=>vv(r,t,e-t)):vv(n,t,e-t)}function g6(n,t){return Ot(()=>null==n?null:Array.isArray(n)?n.map(e=>g6(e,t)):AX(n,"int32"===t.dtype?t:Fn(t,"int32")))}function v6(n,t){const e=[];let r=0,i=null;for(;r<n;)i=r+t,i>=n&&(i=n),e.push([r,i]),r=i;return e}function gY(n){const t=[];n instanceof yi&&(n=[n]);for(let e=0;e<n.length;++e){const r=n[e];if(1===r.rank)t.push(aE(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function nh(n,t){if(null==n)return;const e=[];if(t instanceof yi)e.push(t.id);else if(Array.isArray(t))t.forEach(i=>e.push(i.id));else if(null!=t)for(const i in t)e.push(t[i].id);const r=[];if(n instanceof yi)-1===e.indexOf(n.id)&&r.push(n);else if(Array.isArray(n))n.forEach(i=>{-1===e.indexOf(i.id)&&r.push(i)});else if(null!=n)for(const i in n){const s=n[i];-1===e.indexOf(s.id)&&r.push(s)}r.forEach(i=>{i.isDisposed||i.dispose()})}function y6(n){return Array.isArray(n)}function vY(n){return!function r0e(n){return n instanceof yi}(n)&&!y6(n)}function yY(n,t,e,r=!0,i=""){if(null==t||0===t.length){if(null!=n){let o=!1;if(y6(n)&&n.length>0)o=!0;else if(vY(n)){for(const a in n)if(n.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new St(`Error when checking model ${i} expected no data, but got ${n}`)}return[]}if(null==n)return t.map(o=>null);let s;if(vY(n)){n=n,s=[];for(const o of t){if(null==n[o])throw new St(`No data provided for "${o}". Need data for each key in: ${t}`);s.push(n[o])}}else if(y6(n)){if((n=n).length!==t.length)throw new St(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);s=n}else{if(n=n,t.length>1)throw new St(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);s=[n]}if(s=gY(s),null!=e)for(let o=0;o<t.length;++o){if(null==e[o])continue;const a=s[o];if(a.shape.length!==e[o].length)throw new St(`Error when checking ${i}: expected ${t[o]} to have ${e[o].length} dimension(s). but got array with shape ${a.shape}`);for(let u=0;u<e[o].length;++u){if(0===u&&!r)continue;const d=a.shape[u],m=e[o][u];if(null!=m&&m>=0&&d!==m)throw new St(`${i} expected a batch of elements where each example has shape [${e[o].slice(1,e[o].length)}] (i.e.,tensor shape [*,${e[o].slice(1,e[o].length)}]) but the ${i} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return s}function _Y(n,t,e,r=!0,i=""){let s;if(Array.isArray(n)){if(n.length!==t.length)throw new St(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${n.length} Tensors(s).`);s=n}else{if(t.length>1)throw new St(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);s=[n]}if(null!=e)for(let o=0;o<t.length;++o){if(null==e[o])continue;const a=s[o];if(a.shape.length!==e[o].length)throw new St(`Error when checking ${i}: expected ${t[o]} to have ${e[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let u=0;u<e[o].length;++u){if(0===u&&!r)continue;const d=a.shape[u],m=e[o][u];if(null!=m&&m!==d)throw new St(`Error when checking ${i}: expected ${t[o]} to have shape ${JSON.stringify(e[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}let Jp=(()=>{class n extends th{constructor(e){super(e),this.isTraining=!1}summary(e,r,i=console.log){if(!this.built)throw new St("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function G_e(n,t,e,r=console.log){const i=function q_e(n){let t=!0;const e=[],r=[];for(const i in n.nodesByDepth)e.push(n.nodesByDepth[i]);for(const i of e){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){t=!1;break}r.push(...i)}if(t)for(const i of n.layers){let s=!1;for(const o of i.inboundNodes)if(-1!==r.indexOf(o)){if(s){t=!1;break}s=!0}if(!t)break}return t}(n),s=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(i?(t=t||90,e=e||[.32,.61,.89,1]):(t=t||115,e=e||[.24,.48,.7,.8,1]),e[e.length-1]<=1&&(e=e.map(m=>Math.floor(t*m))),!i){s.push("Receives inputs"),o=[];for(const m in n.nodesByDepth)o.push(...n.nodesByDepth[m])}r("_".repeat(t)),RO(s,e,r),r("=".repeat(t));const a=n.layers;for(let m=0;m<a.length;++m)i?Z_e(a[m],e,r):K_e(a[m],e,o,r),r((m===a.length-1?"=":"_").repeat(t));n.checkTrainableWeightsConsistency();const u=function j_e(n){let t;return t=xO(null!=n.collectedTrainableWeights?n.collectedTrainableWeights:n.trainableWeights),t}(n),d=xO(n.nonTrainableWeights);r(`Total params: ${u+d}`),r(`Trainable params: ${u}`),r(`Non-trainable params: ${d}`),r("_".repeat(t))}(this,e,r,i)}compile(e){if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function W_e(n){const t={Adagrad:()=>fv.adagrad(.01),Adadelta:()=>fv.adadelta(1,.95,Io()),Adam:()=>fv.adam(.001,.9,.999,Io()),Adamax:()=>fv.adamax(.002,.9,.999,Io(),0),RMSProp:()=>fv.rmsprop(.001,.9,0,Io()),SGD:()=>fv.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,n in t)return t[n]();throw new St(`Unknown Optimizer ${n}`)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof td))throw new St("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let r=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new St(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);r=e.loss.map(u=>o6(u))}else{const a=o6(e.loss);this.outputs.forEach(u=>{r.push(a)})}else{e.loss=e.loss;for(const a in e.loss)if(-1===this.outputNames.indexOf(a))throw new St(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)null==e.loss[a]&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),r.push(o6(e.loss[a]))}this.lossFunctions=r,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const u=this.internalOutputShapes[a];this.feedOutputNames.push(this.outputNames[a]),this.feedOutputShapes.push(u),this.feedLossFns.push(this.lossFunctions[a])}const i=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],gv("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(-1!==i.indexOf(a))continue;const u=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([u,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const s=function o0e(n,t){if(null==n||Array.isArray(n)&&0===n.length)return t.map(r=>[]);let e;if("string"==typeof n||"function"==typeof n)e=[n];else{if(!Array.isArray(n)&&"object"!=typeof n)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);e=n}if(Array.isArray(e))return t.map(r=>e);{const r=[];for(const i of t){let s=e.hasOwnProperty(i)?e[i]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}(e.metrics,this.outputNames),o=(a,u,d)=>{this.outputNames.length>1&&(u=this.outputNames[a]+"_"+u),this.metricsNames.push(u),this.metricsTensors.push([d,a])};gv("metric",()=>{for(let a=0;a<this.outputs.length;++a)-1===i.indexOf(a)&&(m=>{let _,E,D;for(const O of m){if("string"==typeof O&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(O)){const $=this.internalOutputShapes[a];let B;1===$[$.length-1]||this.lossFunctions[a]===IO?-1!==["accuracy","acc"].indexOf(O)?E=a6:-1!==["crossentropy","ce"].indexOf(O)&&(E=iY):this.lossFunctions[a]===AO?-1!==["accuracy","acc"].indexOf(O)?E=sY:-1!==["crossentropy","ce"].indexOf(O)&&(E=oY):-1!==["accuracy","acc"].indexOf(O)?E=u6:-1!==["crossentropy","ce"].indexOf(O)&&(E=l6),-1!==["accuracy","acc"].indexOf(O)?B="acc":-1!==["crossentropy","ce"].indexOf(O)&&(B="ce"),D=E,_=""+B}else D=H_e(O),_=""+kO(O);let R;gv(_,()=>{R=D}),o(a,_,R)}})(s[a])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,r,i={}){const s=null==i.batchSize?32:i.batchSize;m6(s);const a=this.standardizeUserDataXY(e,r,!0,s);try{const u=a[0].concat(a[1]);return this.makeTestFunction(),_u(this.testLoop(this.testFunction,u,s,i.verbose,i.steps))}finally{nh(a[0],e),nh(a[1],r)}}evaluateDataset(e,r){var i=this;return(0,Nt.Z)(function*(){return i.makeTestFunction(),function n0e(n,t,e){return p6.apply(this,arguments)}(i,e,r)})()}checkNumSamples(e,r,i,s="steps"){let o;if(null!=i){if(o=null,null!=r)throw new St(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${r}`)}else{if(null==e)throw new St(`Either the input data should have a defined shape, or ${s} shoud be specified.`);o=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return o}execute(e,r){if(Array.isArray(r)&&0===r.length)throw new St("`outputs` is an empty Array, which is not allowed.");const i=Array.isArray(r),o=this.retrieveSymbolicTensors(i?r:[r]),a=new Yp;if(e instanceof yi&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new St(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let d=0;d<this.inputs.length;++d)a.add(this.inputs[d],e[d])}else for(const d of this.inputs){const m=e[d.name];if(null==m)throw new St(`No value is provided for the model's input ${d.name}`);a.add(d,m)}const u=hE(o,a);return i?u:u[0]}retrieveSymbolicTensors(e){const r=dv(null,e.length);let i=e.length;for(const s of this.layers){const o=Array.isArray(s.output)?s.output:[s.output],a=o.map(u=>u.name);for(let u=0;u<e.length;++u){const d=a.indexOf(e[u]);if(-1!==d&&(r[u]=o[d],i--),0===i)break}if(0===i)break}if(i>0){const s=[];throw r.forEach((o,a)=>{null==o&&s.push(e[a])}),new St(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return r}predictLoop(e,r=32,i=!1){return Ot(()=>{const s=this.checkNumSamples(e);if(i)throw new Ur("Verbose predictLoop() is not implemented yet.");const o=v6(s,r),a=this.outputs.map(u=>[]);for(let u=0;u<o.length;++u)Ot(()=>{const _=mE(e,o[u][0],o[u][1]),E=[];if(Array.isArray(_))for(let O=0;O<_.length;++O)E.push({key:this.inputs[O],value:_[O]});else E.push({key:this.inputs[0],value:_});const D=new Yp(E);return hE(this.outputs,D)}).forEach((m,y)=>a[y].push(m));return _u(a.map(u=>Js(u,0)))})}predict(e,r={}){const i=gY(e);_Y(i,this.inputNames,this.feedInputShapes,!1);try{const s=null==r.batchSize?32:r.batchSize;return m6(s),this.predictLoop(i,s)}finally{nh(i,e)}}predictOnBatch(e){_Y(e,this.inputNames,this.feedInputShapes,!0);const r=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,r)}standardizeUserDataXY(e,r,i=!0,s){if(null==this.optimizer_)throw new fc("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let a=0;a<this.feedOutputShapes.length;++a){const u=this.feedOutputShapes[a];o.push(this.feedLossFns[a]===AO?u.slice(0,u.length-1).concat([1]):u)}if(function i0e(n,t,e){const r=Zp(n.map(s=>s.shape[0]));r.sort();const i=Zp(t.map(s=>s.shape[0]));if(i.sort(),r.length>1)throw new St(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(s=>s.shape))}`);if(i.length>1)throw new St(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(r.length>0&&i.length>0&&!ri(r,i))throw new St(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}(e=yY(e,this.feedInputNames,this.feedInputShapes,!1,"input"),r=yY(r,this.feedOutputNames,o,!1,"target")),function s0e(n,t,e){const r=[yv,IO,dE];for(let i=0;i<n.length;++i){const s=n[i],o=t[i],a=e[i];if(null!=o){if(o===dE&&1===s.shape[s.shape.length-1])throw new St(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(o)){const u=s.shape.slice(1),d=a.slice(1);for(let m=0;m<u.length;++m){const y=u[m],_=d[m];if(null!=_&&y!==_)throw new St(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=s&&s>0&&e[0].shape[0]%s!=0)throw new St(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,r]}standardizeUserData(e,r,i,s,o=!0,a){var u=this;return(0,Nt.Z)(function*(){const[d,m]=u.standardizeUserDataXY(e,r,o,a);if(null!=i)throw new Error("sample weight is not supported yet.");let y=null;if(null!=s){const _=hY(s,u.outputNames);y=[];for(let E=0;E<_.length;++E)y.push(yield fY(m[E],null,_[E]))}return[d,m,y]})()}testLoop(e,r,i,s=0,o){return Ot(()=>{const a=this.checkNumSamples(r,i,o,"steps"),u=[];if(s>0)throw new Ur("Verbose mode is not implemented yet.");if(null!=o)throw new Ur("steps mode in testLoop() is not implemented yet");{const d=v6(a,i),m=ka(Kc(0,a));for(let y=0;y<d.length;++y){const _=d[y][0],E=d[y][1],D=vv(m,_,E-_),O=g6(r,D),R=e(O);if(0===y)for(let $=0;$<R.length;++$)u.push(hr(0));for(let $=0;$<R.length;++$)u[$]=_n(u[$],vt(E-_,R[$]))}for(let y=0;y<u.length;++y)u[y]=nr(u[y],a)}return u})}getDedupedMetricsNames(){const e=this.metricsNames,r=[];for(let i=0;i<e.length;++i){const s=e[i];let o=s;vX(e,s)>1&&(o+=`_${vX(e.slice(0,i),s)}`),r.push(o)}return r}makeTrainFunction(){return e=>{const r=[],i=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],d=this.collectedTrainableWeights.map(_=>_.read());return[this.optimizer_.minimize(()=>{const _=[];for(let R=0;R<this.inputs.length;++R)_.push({key:this.inputs[R],value:i[R]});const E=new Yp(_),D=hE(this.outputs,E,{training:!0});let O;for(let R=0;R<this.lossFunctions.length;++R){let B=this.lossFunctions[R](s[R],D[R]);null!=o[R]&&(B=X_e(B,o[R]));const Q=Rs(B);r.push(Q),O=0===R?B:_n(O,B)}for(let R=0;R<this.metricsTensors.length;++R){let $;if(this.outputs.length>1&&R<this.outputs.length)$=r[R];else{const Q=this.metricsTensors[R][1];$=Rs((0,this.metricsTensors[R][0])(s[Q],D[Q]))}Ao($),a.push($)}return O=Rs(O),this.calculateLosses().forEach(R=>{O=_n(O,R)}),O},!0,d)].concat(a)}}makeTestFunction(){this.testFunction=e=>Ot(()=>{const r=[];let i;const s=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let m=0;m<this.inputs.length;++m)a.push({key:this.inputs[m],value:s[m]});const u=new Yp(a),d=hE(this.outputs,u);for(let m=0;m<this.lossFunctions.length;++m){const _=Rs((0,this.lossFunctions[m])(o[m],d[m]));i=0===m?_:_n(i,_),r.push(i)}for(let m=0;m<this.metricsTensors.length;++m){const _=this.metricsTensors[m][1],E=Rs((0,this.metricsTensors[m][0])(o[_],d[_]));r.push(E)}return r})}fit(e,r,i={}){var s=this;return(0,Nt.Z)(function*(){if(s.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let o,a,u,d,m,y,_,E,D;s.isTraining=!0;try{const O=null==i.batchSize?32:i.batchSize;m6(O);const R=!1,$=yield s.standardizeUserData(e,r,i.sampleWeight,i.classWeight,R,O);o=$[0],a=$[1],D=$[2];let Q,B=!1;if(null!=i.validationData&&i.validationData.length>0){if(B=!0,2!==i.validationData.length)throw 3===i.validationData.length?new Ur("validationData including sample weights is not supported yet."):new St(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${i.validationData} is invalid.`);m=i.validationData[0],y=i.validationData[1];const It=!0,zt=yield s.standardizeUserData(m,y,null,null,It,O);_=zt[0],E=zt[1],Q=_.concat(E)}else if(null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1){B=!0;const It=Math.floor(o[0].shape[0]*(1-i.validationSplit)),zt=o[0].shape[0];_=mE(o,It,zt),u=o,o=mE(o,0,It),E=mE(a,It,zt),d=a,a=mE(a,0,It),Q=_.concat(E)}else null!=i.validationSteps&&(B=!0);const ie=o.concat(a).concat(D);s.checkTrainableWeightsConsistency();const ye=s.makeTrainFunction(),Me=s.getDedupedMetricsNames();let Be,He;B?(s.makeTestFunction(),Be=s.testFunction,He=Me.slice().concat(Me.map(It=>"val_"+It))):(Be=null,Q=[],He=Me.slice());const st=JX(i.callbacks,i.yieldEvery);return yield s.fitLoop(ye,ie,Me,O,i.epochs,i.verbose,st,Be,Q,i.shuffle,He,i.initialEpoch,null,null)}finally{s.isTraining=!1,nh(o,e),nh(a,r),nh(u,e),nh(d,r),nh(_,m),nh(E,y),null!=D&&Or(D)}})()}fitLoop(e,r,i,s,o,a,u,d,m,y,_,E,D,O){var R=this;return(0,Nt.Z)(function*(){null==s&&(s=32),null==o&&(o=1),null==y&&(y=!0),null==E&&(E=0);let $=!1;if(null!=d&&null!=m&&($=!0),null!=O&&($=!0,null==D))throw new St("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const B=R.checkNumSamples(r,s,D,"steps_per_epoch");let Q;null!=B&&(Q=Kc(0,B)),null==a&&(a=1);const{callbackList:ie,history:ye}=tY(u,a,o,E,B,D,s,$,_);ie.setModel(R),R.history=ye,yield ie.onTrainBegin(),R.stopTraining_=!1;for(let Me=E;Me<o;++Me){yield ie.onEpochBegin(Me);const Be={};if(null!=D)throw new Ur("stepsPerEpoch mode is not implemented yet.");{if("batch"===y)throw new Ur("batch shuffling is not implemneted yet");y&&X4(Q);const He=ka(Q),st=v6(B,s);for(let lt=0;lt<st.length;++lt){const It={};if(yield ie.onBatchBegin(lt,It),Ot(()=>{const zt=st[lt][0],Wt=st[lt][1],qt=vv(He,zt,Wt-zt);It.batch=lt,It.size=Wt-zt;const Kt=g6(r,qt),Tt=e(Kt);for(let Rt=0;Rt<i.length;++Rt){const Ht=Tt[Rt];It[i[Rt]]=Ht,Ao(Ht)}if(lt===st.length-1&&$){const Rt=R.testLoop(d,m,s);for(let Dt=0;Dt<i.length;++Dt){const Ht=i[Dt],ln=Rt[Dt];Ao(ln),Be["val_"+Ht]=ln}}}),yield ie.onBatchEnd(lt,It),KX(It),R.stopTraining_)break}He.dispose()}if(yield ie.onEpochEnd(Me,Be),R.stopTraining_)break}return yield ie.onTrainEnd(),yield R.history.syncData(),R.history})()}fitDataset(e,r){var i=this;return(0,Nt.Z)(function*(){return function J_e(n,t,e){return d6.apply(this,arguments)}(i,e,r)})()}trainOnBatch(e,r){var i=this;return(0,Nt.Z)(function*(){const s=yield i.standardizeUserData(e,r),o=s[0],a=s[1],d=i.makeTrainFunction()(o.concat(a)),m=[];for(const y of d){const _=yield y.data();m.push(_[0])}return Or(d),nh(s[0],e),nh(s[1],r),_u(m)})()}getNamedWeights(e){const r=[],i=null!=e&&e.trainableOnly,s=i?this.trainableWeights:this.weights,o=this.getWeights(i);for(let a=0;a<s.length;++a)i&&!s[a].trainable||r.push({name:s[a].originalName,tensor:o[a]});return r}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const r=SR().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=r-SR().numTensors}return e}getLossIdentifiers(){let e;if("string"==typeof this.loss)e=hd(this.loss);else if(Array.isArray(this.loss)){for(const r of this.loss)if("string"!=typeof r)throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(r=>hd(r))}else{const r=Object.keys(this.loss);e={};const i=this.loss;for(const s of r){if("string"!=typeof i[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=hd(i[s])}}return e}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[hd(kO(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>hd(kO(e)));{const e={};for(const r in this.metrics)e[r]=hd(kO(this.metrics[r]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const i=eh(pE(e.optimizer_config));let s,o;if("string"==typeof e.loss)s=pv(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(a=>pv(a));else if(null!=e.loss){s={};for(const a in e.loss)s[a]=pv(e.loss[a])}if(Array.isArray(e.metrics))o=e.metrics.map(a=>pv(a));else if(null!=e.metrics){o={};for(const a in e.metrics)o[a]=pv(e.metrics[a])}this.compile({loss:s,metrics:o,optimizer:i})}save(e,r){var i=this;return(0,Nt.Z)(function*(){if("string"==typeof e){const y=Q7(e);if(0===y.length)throw new St(`Cannot find any save handlers for URL '${e}'`);if(y.length>1)throw new St(`Found more than one (${y.length}) save handlers for URL '${e}'`);e=y[0]}if(null==e.save)throw new St("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=yield pU(i.getNamedWeights(r)),d={modelTopology:i.toJSON(null,!1),format:"layers-model",generatedBy:`TensorFlow.js tfjs-layers v${OO}`,convertedBy:null};if(null!=r&&r.includeOptimizer&&null!=i.optimizer){d.trainingConfig=i.getTrainingConfig();const y="optimizer",{data:_,specs:E}=yield pU(yield i.optimizer.getWeights(),y);s.specs.push(...E),s.data=wR([s.data,_])}return null!=i.userDefinedMetadata&&(uY(i.userDefinedMetadata,i.name,!0),d.userDefinedMetadata=i.userDefinedMetadata),d.weightData=s.data,d.weightSpecs=s.specs,e.save(d)})()}setUserDefinedMetadata(e){uY(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}return n.className="Model",n})();function u0e(n,t){return _6.apply(this,arguments)}function _6(){return(_6=(0,Nt.Z)(function*(n,t){"modelTopology"in n||(n={modelTopology:n});let e=(n=n).modelTopology;null!=e.model_config&&(e=e.model_config);const i=eh(pE(e),t);if(null!=n.weightsManifest){const s=yield dZ(n.weightsManifest,n.pathPrefix,i.weights.map(a=>a.originalName)),o={};for(const a of i.weights)o[a.originalName]=s[a.originalName];i.loadWeights(o),Or(s)}return i})).apply(this,arguments)}function l0e(n,t){return b6.apply(this,arguments)}function b6(){return(b6=(0,Nt.Z)(function*(n,t){if(null==t&&(t={}),"string"==typeof n){const e=J7(n,t);if(0===e.length)e.push(vZ(n,t));else if(e.length>1)throw new St(`Found more than one (${e.length}) load handlers for URL '${n}'`);n=e[0]}return c0e(n,void 0,t)})).apply(this,arguments)}function c0e(n,t,e){return w6.apply(this,arguments)}function w6(){return(w6=(0,Nt.Z)(function*(n,t,e){if(null==e&&(e={}),null==n.load)throw new St("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=yield n.load();let i=r.modelTopology;null!=i.model_config&&(i=i.model_config);const s=null==e.strict||e.strict,o=null!=r.weightData&&null!=r.weightSpecs&&s,a=eh(pE(i),t,o),u=r.trainingConfig;if(null!=u&&a.loadTrainingConfig(u),null!=r.userDefinedMetadata&&a.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new St("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:d,optimizerWeights:m}=h0e(r.weightData,r.weightSpecs);a.loadWeights(d,s),null!=a.optimizer&&m.length>0&&(yield a.optimizer.setWeights(m)),Or(d),Or(m.map(y=>y.tensor))}return a})).apply(this,arguments)}function h0e(n,t){const e=gU(n,t),r={},i=[];return t.forEach(s=>{"optimizer"===s.group?i.push({name:s.name,tensor:e[s.name]}):r[s.name]=e[s.name]}),{modelWeights:r,optimizerWeights:i}}Nn(Jp),Nn((()=>{class n extends Jp{}return n.className="Functional",n})());let x6=(()=>{class n extends Jp{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=null!=e.name?e.name:vO("sequential_"),null!=e.layers)for(const r of e.layers)this.add(r)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(i=>i<0))throw new St(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const r=e instanceof n||e instanceof Jp;let i;if(r){if(i=e,1!==i.outputs.length)throw new St("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==i.inputs.length)throw new St("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new St("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=zX({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(r)this.outputs=i.outputs,this.inputs=i.inputs;else{if(1!==e.inboundNodes.length)throw new St(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(1!==e.inboundNodes[0].outputTensors.length)throw new St("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=VX(this.outputs[0])}this.inboundNodes=[],new CO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:dv(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,r){return null==this.model&&this.build(),this.model.call(e,r)}build(e){if(Ei(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Jp({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,r,i=console.log){this.built||this.build(),super.summary(e,r,i)}setWeights(e){null==this.model&&this.build(),this.model.setWeights(e)}evaluate(e,r,i={}){if(!this.built)throw new fc("The model needs to be compiled before being used.");return this.model.evaluate(e,r,i)}evaluateDataset(e,r){var i=this;return(0,Nt.Z)(function*(){if(!i.built)throw new fc("The model needs to be compiled before being used.");return i.model.evaluateDataset(e,r)})()}predict(e,r={}){return null==this.model&&this.build(),this.model.predict(e,r)}predictOnBatch(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}fit(e,r,i={}){var s=this;return(0,Nt.Z)(function*(){if(!s.built)throw new fc("The model needs to be compiled before being used.");return s.model.fit(e,r,i)})()}fitDataset(e,r){var i=this;return(0,Nt.Z)(function*(){if(!i.built)throw new fc("The model needs to be compiled before being used.");return i.model.fitDataset(e,r)})()}trainOnBatch(e,r){var i=this;return(0,Nt.Z)(function*(){return i.model.trainOnBatch(e,r)})()}static fromConfig(e,r,i={},s=!1){let o,a={};if(r instanceof Array){if(null==r[0].className||"Merge"===r[0].className)throw new St("Legacy serialization format not supported yet.");o=r}else De(null!=r.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=r.layers,delete r.layers,a=r;const u=new e(a);if(!(u instanceof n))throw new Ur(`Sequential.fromConfig called on non-Sequential input: ${u}`);for(const d of o){const y=eh(d,void 0,s);s&&y.setFastWeightInitDuringBuild(!0),u.add(y)}return u}set stopTraining(e){if(null==this.model)throw new St("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(null==this.model)throw new St("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const r of this.layers){const i={};i.className=r.getClassName(),i.config=r.getConfig(),e.push(i)}return{name:this.name,layers:e}}}return n.className="Sequential",n})();function f0e(n){return new Jp(n)}function d0e(n){return new x6(n)}function bY(n){return zX(n)}function p0e(n,t){eY.registerCallbackConstructor(n,t)}Nn(x6);class bu extends Jg{getConfig(){return{}}}Nn((()=>{class n extends bu{apply(e,r=1){return function Vye(n,t=1){if(1!==t)throw new Ur(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return $0(n)}(e,r)}}return n.className="elu",n})()),Nn((()=>{class n extends bu{apply(e){return ZR(e)}}return n.className="selu",n})()),Nn((()=>{class n extends bu{apply(e){return Zc(e)}}return n.className="relu",n})()),Nn((()=>{class n extends bu{apply(e){return Ot(()=>Gp(6,Zc(e)))}}return n.className="relu6",n})()),Nn((()=>{class n extends bu{apply(e){return e}}return n.className="linear",n})()),Nn((()=>{class n extends bu{apply(e){return qc(e)}}return n.className="sigmoid",n})()),Nn((()=>{class n extends bu{apply(e){return function Uye(n){return Ot(()=>{const t=_n(.5,vt(.2,n));return gu(t,0,1)})}(e)}}return n.className="hardSigmoid",n})()),Nn((()=>{class n extends bu{apply(e){return av(e)}}return n.className="softplus",n})()),Nn((()=>{class n extends bu{apply(e){return function zye(n){return Ot(()=>nr(n,_n(mo(n),1)))}(e)}}return n.className="softsign",n})()),Nn((()=>{class n extends bu{apply(e){return sv(e)}}return n.className="tanh",n})());let wY=(()=>{class n extends bu{apply(e,r=-1){return JS(e,r)}}return n.className="softmax",n})();function em(n){return n.getClassName()}function C6(n,t={}){return sE(n,bl.getMap().classNameMap,t,"activation")}function tm(n){if(null==n){return C6({className:"linear",config:{}})}if("string"==typeof n){const t={};return t.className=n,t.config={},C6(t)}return n instanceof bu?n:C6(n)}function S6(n){if(null!=n&&"object"!=typeof n)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}Nn(wY),Nn((()=>{class n extends bu{apply(e,r=-1){return BR(e,r)}}return n.className="logSoftmax",n})()),Nn((()=>{class n extends bu{apply(e,r=1){return Ot(()=>vt(qc(vt(e,r)),e))}}return n.className="swish",n})()),Nn((()=>{class n extends bu{apply(e){return Ot(()=>vt(e,sv(av(e))))}}return n.className="mish",n})());class xY extends Jg{}let FO=(()=>{class n extends xY{constructor(e){super(),S6(e),this.l1=null==e||null==e.l1?.01:e.l1,this.l2=null==e||null==e.l2?.01:e.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(e){return Ot(()=>{let r=vo([1]);return this.hasL1&&(r=_n(r,Yn(vt(this.l1,mo(e))))),this.hasL2&&(r=_n(r,Yn(vt(this.l2,uE(e))))),wt(r,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,r){return new e({l1:r.l1,l2:r.l2})}}return n.className="L1L2",n})();Nn(FO);const CY={l1l2:"L1L2"};function ts(n){return VH(n)}function SY(n,t={}){return sE(n,bl.getMap().classNameMap,t,"regularizer")}function bs(n){return null==n?null:"string"==typeof n?SY({className:n in CY?CY[n]:n,config:{}}):n instanceof xY?n:SY(n)}let EY=(()=>{class n extends Jr{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,null!=e&&(this.maxValue=e.maxValue)}call(e,r){e=xr(e);let i=Zc(e);return null!=this.maxValue&&(i=gu(i,0,this.maxValue)),i}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ReLU",n})();Nn(EY);let NY=(()=>{class n extends Jr{constructor(e){super(null==e?{}:e),this.DEFAULT_ALPHA=.3,null==e&&(e={}),this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,r){const i=xr(e);return WS(i,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return n.className="LeakyReLU",n})();Nn(NY);let TY=(()=>{class n extends Jr{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),this.supportsMasking=!0,this.alphaInitializer=_s(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=bs(e.alphaRegularizer),this.alphaConstraint=Mo(e.alphaConstraint),null==e.sharedAxes)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new St(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`);this.sharedAxes=[e.sharedAxes]}}build(e){const r=(e=Ei(e)).slice(1);if(null!=this.sharedAxes)for(const s of this.sharedAxes)r[s-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const i={};if(null!=this.sharedAxes)for(let s=1;s<e.length;++s)i[s]=e[s];this.inputSpec=[new yo({ndim:e.length,axes:i})],this.built=!0}call(e,r){return e=xr(e),XS(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Os(this.alphaInitializer),alphaRegularizer:ts(this.alphaRegularizer),alphaConstraint:Do(this.alphaConstraint),sharedAxes:this.sharedAxes},r=super.getConfig();return Object.assign(e,r),e}}return n.className="PReLU",n})();Nn(TY);let AY=(()=>{class n extends Jr{constructor(e){if(super(null==e?{}:e),this.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==this.DEFAULT_ALPHA)throw new Ur(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==e.alpha?this.DEFAULT_ALPHA:e.alpha}call(e,r){const i=xr(e);return $0(i)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ELU",n})();Nn(AY);let IY=(()=>{class n extends Jr{constructor(e){super(null==e?{}:e),this.DEFAULT_THETA=1,null==e&&(e={}),this.theta=null==e.theta?this.DEFAULT_THETA:e.theta}call(e,r){const i=xr(e);return vt(i,Fn(Ka(i,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ThresholdedReLU",n})();Nn(IY);let DY=(()=>{class n extends Jr{constructor(e){super(null==e?{}:e),this.DEFAULT_AXIS=1,null==e&&(e={}),this.softmax=(new wY).apply,this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis}call(e,r){const i=xr(e);return this.softmax(i,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Softmax",n})();function Q0(n,t,e){if("number"==typeof n)return dv(n,t);if(n.length!==t)throw new St(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${n.length} elements.`);for(let r=0;r<t;++r){const i=n[r];if(!Oye(i))throw new St(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(n)} including a non-integer number ${i}`)}return n}function rh(n,t,e,r,i=1){if(null==n)return n;let o;return o="same"===e?n:n-(t+(t-1)*(i-1))+1,Math.floor((o+r-1)/r)}function qh(n,t,e,r){if(null==n)return null;if("valid"===r)n=n*t+Xp([e-t,0]);else{if("same"!==r)throw new St(`Unsupport padding mode: ${r}.`);n*=t}return n}function E6(n,t){return Ot(()=>(no(t),"channelsFirst"===t?ii(n,[0,2,3,1]):n))}function MY(n,t){return Ot(()=>(no(t),"channelsFirst"===t?ii(n,[0,2,3,4,1]):n))}function N6(n,t,e,r=[1,1],i="valid",s,o,a=null){return Ot(()=>{if(null==s&&(s="channelsLast"),no(s),3!==n.rank&&4!==n.rank)throw new St(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(3!==t.rank&&4!==t.rank)throw new St(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let u=E6(n,s);if("causal"===i)throw new Ur("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=wK({x:u,filter:t,strides:r,pad:"same"===i?"same":"valid",dilations:o,dataFormat:"NHWC",bias:e,activation:a}),"channelsFirst"===s&&(u=ii(u,[0,3,1,2])),u})}Nn(DY);class PO extends Jr{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",PO.verifyArgs(e),this.rank=t,Xo(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new Ur(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Q0(e.kernelSize,t,"kernelSize"),this.strides=Q0(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,Nl(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,no(this.dataFormat),this.activation=tm(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=_s(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Mo(e.biasConstraint),this.biasRegularizer=bs(e.biasRegularizer),this.activityRegularizer=bs(e.activityRegularizer),this.dilationRate=Q0(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new St(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new St(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new St(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(t){if(El("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!UH(t.kernelSize,"number",1,3))throw new St(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:em(this.activation),useBias:this.useBias,biasInitializer:Os(this.biasInitializer),biasRegularizer:ts(this.biasRegularizer),activityRegularizer:ts(this.activityRegularizer),biasConstraint:Do(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class J0 extends PO{constructor(t,e){super(t,e),this.kernel=null,J0.verifyArgs(e),this.filters=e.filters,Xo(this.filters,"filters"),this.kernelInitializer=_s(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Mo(e.kernelConstraint),this.kernelRegularizer=bs(e.kernelRegularizer)}build(t){t=Ei(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new St(`The channel dimension of the input should be defined. Found ${t[e]}`);const r=t[e],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:r}}],this.built=!0}call(t,e){return Ot(()=>{let r;t=xr(t);const i=null==this.bias?null:this.bias.read(),s=_X(this.activation.getClassName());if(null!=s&&2===this.rank)r=N6(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(1===this.rank)r=function kY(n,t,e,r=1,i="valid",s,o=1){return Ot(()=>{if(null==s&&(s="channelsLast"),no(s),3!==n.shape.length)throw new St(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(3!==t.shape.length)throw new St(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(null!=e&&1!==e.shape.length)throw new St(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if("channelsFirst"===s&&(n=ii(n,[0,2,1])),"causal"===i)throw new Ur("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=RR(n,t,r,"same"===i?"same":"valid","NWC",o);return null!=e&&(a=Yc(a,e)),a})}(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)r=N6(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new Ur("convolutions greater than 3D are not implemented yet.");r=function RY(n,t,e,r=[1,1,1],i="valid",s,o){return Ot(()=>{if(null==s&&(s="channelsLast"),no(s),4!==n.rank&&5!==n.rank)throw new St(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(4!==t.rank&&5!==t.rank)throw new St(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=MY(n,s);if("causal"===i)throw new Ur("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=T5(a,t,r,"same"===i?"same":"valid","NDHWC",o),null!=e&&(a=Yc(a,e)),"channelsFirst"===s&&(a=ii(a,[0,4,1,2,3])),a})}(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(r=this.activation.apply(r))}return r})}computeOutputShape(t){t=Ei(t);const e=[],r="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let s=0;s<r.length;++s){const o=rh(r[s],this.kernelSize[s],this.padding,this.strides[s],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[s]);e.push(o)}let i=[t[0]];return"channelsLast"===this.dataFormat?(i=i.concat(e),i.push(this.filters)):(i.push(this.filters),i=i.concat(e)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Os(this.kernelInitializer),kernelRegularizer:ts(this.kernelRegularizer),kernelConstraint:Do(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new St(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}let T6=(()=>{class n extends J0{constructor(e){super(2,e),n.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!UH(e.kernelSize,"number",1,2))throw new St(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv2D",n})();Nn(T6);let A6=(()=>{class n extends J0{constructor(e){super(3,e),n.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new St(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv3D",n})();Nn(A6);let OY=(()=>{class n extends T6{constructor(e){if(super(e),this.inputSpec=[new yo({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new St(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(4!==(e=Ei(e)).length)throw new St("Input should have rank 4; Received input shape: "+JSON.stringify(e));const r="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[r])throw new St("The channel dimension of the inputs should be defined. Found `None`.");const i=e[r],s=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new yo({ndim:4,axes:{[r]:i}})],this.built=!0}call(e,r){return Ot(()=>{let i=xr(e);if(4!==i.shape.length)throw new St(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${i.shape.length}`);const s=i.shape;let a,u;"channelsFirst"===this.dataFormat?(a=2,u=3):(a=1,u=2);const m=s[u],_=this.kernelSize[1],D=this.strides[1],$=[s[0],qh(s[a],this.strides[0],this.kernelSize[0],this.padding),qh(m,D,_,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(i=ii(i,[0,2,3,1]));let B=OR(i,this.kernel.read(),$,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(B=ii(B,[0,3,1,2])),null!=this.bias&&(B=Yc(B,this.bias.read(),this.dataFormat)),null!=this.activation&&(B=this.activation.apply(B)),B})}computeOutputShape(e){const r=(e=Ei(e)).slice();let i,s,o;"channelsFirst"===this.dataFormat?(i=1,s=2,o=3):(i=3,s=1,o=2);const a=this.kernelSize[0],u=this.kernelSize[1],d=this.strides[0],m=this.strides[1];return r[i]=this.filters,r[s]=qh(r[s],d,a,this.padding),r[o]=qh(r[o],m,u,this.padding),r}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}return n.className="Conv2DTranspose",n})();Nn(OY);let FY=(()=>{class n extends A6{constructor(e){if(super(e),this.inputSpec=[new yo({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new St(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(5!==(e=Ei(e)).length)throw new St("Input should have rank 5; Received input shape: "+JSON.stringify(e));const r="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[r])throw new St("The channel dimension of the inputs should be defined. Found `None`.");const i=e[r],s=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new yo({ndim:5,axes:{[r]:i}})],this.built=!0}call(e,r){return Ot(()=>{let i=xr(e);if(5!==i.shape.length)throw new St(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${i.shape.length}`);const s=i.shape;let a,u,d;"channelsFirst"===this.dataFormat?(d=2,a=3,u=4):(d=1,a=2,u=3);const y=s[a],_=s[u],D=this.kernelSize[1],O=this.kernelSize[2],$=this.strides[1],B=this.strides[2],Me=[s[0],qh(s[d],this.strides[0],this.kernelSize[0],this.padding),qh(y,$,D,this.padding),qh(_,B,O,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(i=ii(i,[0,2,3,4,1]));let Be=A5(i,this.kernel.read(),Me,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(Be=ii(Be,[0,4,1,2,3])),null!==this.bias&&(Be=Yc(Be,this.bias.read(),this.dataFormat)),null!==this.activation&&(Be=this.activation.apply(Be)),Be})}computeOutputShape(e){const r=(e=Ei(e)).slice();let i,s,o,a;"channelsFirst"===this.dataFormat?(i=1,s=2,o=3,a=4):(i=4,s=1,o=2,a=3);const u=this.kernelSize[0],d=this.kernelSize[1],m=this.kernelSize[2],y=this.strides[0],_=this.strides[1],E=this.strides[2];return r[i]=this.filters,r[s]=qh(r[s],y,u,this.padding),r[o]=qh(r[o],_,d,this.padding),r[a]=qh(r[a],E,m,this.padding),r}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}return n.className="Conv3DTranspose",n})();Nn(FY);let v0e=(()=>{class n extends J0{constructor(e,r){if(super(e,r),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==r.filters)throw new St("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new St("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new St(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(r.padding)}`);this.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,this.depthwiseInitializer=_s(r.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=bs(r.depthwiseRegularizer),this.depthwiseConstraint=Mo(r.depthwiseConstraint),this.pointwiseInitializer=_s(r.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=bs(r.pointwiseRegularizer),this.pointwiseConstraint=Mo(r.pointwiseConstraint)}build(e){if((e=Ei(e)).length<this.rank+2)throw new St(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const r="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[r]||e[r]<0)throw new St(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[r])}`);const i=e[r],s=this.kernelSize.concat([i,this.depthMultiplier]),o=[];for(let u=0;u<this.rank;++u)o.push(1);o.push(i*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):null,this.inputSpec=[new yo({ndim:this.rank+2,axes:{[r]:i}})],this.built=!0}call(e,r){return Ot(()=>{let i;if(e=xr(e),1===this.rank)throw new Ur("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(e=ii(e,[0,2,3,1])),i=KR(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(i=Yc(i,this.bias.read(),this.dataFormat)),null!=this.activation&&(i=this.activation.apply(i)),"channelsFirst"===this.dataFormat&&(i=ii(i,[0,3,1,2])),i})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Os(this.depthwiseInitializer),e.pointwiseInitializer=Os(this.pointwiseInitializer),e.depthwiseRegularizer=ts(this.depthwiseRegularizer),e.pointwiseRegularizer=ts(this.pointwiseRegularizer),e.depthwiseConstraint=Do(this.depthwiseConstraint),e.pointwiseConstraint=Do(this.pointwiseConstraint),e}}return n.className="SeparableConv",n})(),PY=(()=>{class n extends v0e{constructor(e){super(2,e)}}return n.className="SeparableConv2D",n})();Nn(PY);let LY=(()=>{class n extends J0{constructor(e){super(1,e),n.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if("number"!=typeof e.kernelSize&&!UH(e.kernelSize,"number",1,1))throw new St(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}return n.className="Conv1D",n})();Nn(LY);let $Y=(()=>{class n extends Jr{constructor(e){super(e),this.cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,this.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,r){return Ot(()=>{if(e=xr(e),"channelsLast"===this.dataFormat){const i=_O(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return _O(i,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const i=_O(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return _O(i,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Cropping2D",n})();Nn($Y);let BY=(()=>{class n extends Jr{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==e.size?this.DEFAULT_SIZE:e.size,this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,no(this.dataFormat),this.interpolation=null==e.interpolation?"nearest":e.interpolation,function Mye(n){mv(Tye,"InterpolationFormat",n)}(this.interpolation)}computeOutputShape(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],null==e[2]?null:this.size[0]*e[2],null==e[3]?null:this.size[1]*e[3]]:[e[0],null==e[1]?null:this.size[0]*e[1],null==e[2]?null:this.size[1]*e[2],e[3]]}call(e,r){return Ot(()=>{let i=xr(e);const s=i.shape;if("channelsFirst"===this.dataFormat){i=ii(i,[0,2,3,1]);const o=this.size[0]*s[2],a=this.size[1]*s[3],u="nearest"===this.interpolation?cc.resizeNearestNeighbor(i,[o,a]):cc.resizeBilinear(i,[o,a]);return ii(u,[0,3,1,2])}{const o=this.size[0]*s[1],a=this.size[1]*s[2];return"nearest"===this.interpolation?cc.resizeNearestNeighbor(i,[o,a]):cc.resizeBilinear(i,[o,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}}return n.className="UpSampling2D",n})();Nn(BY);let VY=(()=>{class n extends PO{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=_s(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Mo(e.depthwiseConstraint),this.depthwiseRegularizer=bs(e.depthwiseRegularizer)}build(e){if((e=Ei(e)).length<4)throw new St(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const r="channelsFirst"===this.dataFormat?1:3;if(null==e[r]||e[r]<0)throw new St(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[r]}).`);const i=e[r];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,r){return Ot(()=>{let i=function y0e(n,t,e=[1,1],r="valid",i,s){return Ot(()=>{null==i&&(i="channelsLast"),no(i);let o=E6(n,i);if(4!==n.rank)throw new St(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(4!==t.rank)throw new St(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=L0(o,t,e,"same"===r?"same":"valid","NHWC",s),"channelsFirst"===i&&(o=ii(o,[0,3,1,2])),o})}(e=xr(e),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(i=Yc(i,this.bias.read(),this.dataFormat)),null!=this.activation&&(i=this.activation.apply(i)),i})}computeOutputShape(e){e=Ei(e);const i="channelsFirst"===this.dataFormat?e[3]:e[2],s="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=rh("channelsFirst"===this.dataFormat?e[2]:e[1],this.kernelSize[0],this.padding,this.strides[0]),a=rh(i,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],s,o,a]:[e[0],o,a,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Os(this.depthwiseInitializer),e.depthwiseRegularizer=ts(this.depthwiseRegularizer),e.depthwiseConstraint=Do(this.depthwiseRegularizer),e}}return n.className="DepthwiseConv2D",n})();function zY(n,t,e,r){if(Array.isArray(n)){if(null!=t||null!=e)throw new St("When inputs is an array, neither initialState or constants should be provided");null!=r&&(e=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(t=n.slice(1,n.length)),n=n[0]}function i(s){return null==s||Array.isArray(s)?s:[s]}return{inputs:n,initialState:t=i(t),constants:e=i(e)}}function UY(n,t,e,r=!1,i,s,o=!1,a=!1){return Ot(()=>{const u=t.shape.length;if(u<3)throw new St(`Input should be at least 3D, but is ${u}D.`);const d=[1,0].concat(Kc(2,u));if(t=ii(t,d),null!=s)throw new Ur("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=Fn(Fn(i,"bool"),"float32")).rank===u-1&&(i=Ma(i,-1)),i=ii(i,d)),r&&(t=Cl(t,0),null!=i&&(i=Cl(i,0)));const m=[];let y,_=e;const E=t.shape[0],D=Sl(t);let O,R;null!=i&&(O=Sl(i));for(let $=0;$<E;++$){const B=D[$],Q=Ot(()=>n(B,_));if(null==i)y=Q[0],_=Q[1];else{const ie=Ot(()=>{const ye=O[$],Me=qn(Gu(ye),ye);return{output:_n(vt(Q[0],ye),vt(_[0],Me)),newStates:_.map((st,lt)=>_n(vt(Q[1][lt],ye),vt(st,Me)))}});y=ie.output,_=ie.newStates}a&&m.push(y)}return a&&(R=yu(m,1)),[y,R,_]})}Nn(VY);let nm=(()=>{class n extends Jr{constructor(e){let r;if(super(e),null==e.cell)throw new St("cell property is missing for the constructor of RNN.");if(r=Array.isArray(e.cell)?new M6({cells:e.cell}):e.cell,null==r.stateSize)throw new St("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=r,this.returnSequences=null!=e.returnSequences&&e.returnSequences,this.returnState=null!=e.returnState&&e.returnState,this.goBackwards=null!=e.goBackwards&&e.goBackwards,this._stateful=null!=e.stateful&&e.stateful,this.unroll=null!=e.unroll&&e.unroll,this.supportsMasking=!0,this.inputSpec=[new yo({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?Kc(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(r=>null):this.states_}setStates(e){this.states_=e}computeOutputShape(e){e6(e)&&(e=e[0]),e=e;let r=this.cell.stateSize;Array.isArray(r)||(r=[r]);const i=r[0];let s;if(s=this.returnSequences?[e[0],e[1],i]:[e[0],i],this.returnState){const o=[];for(const a of r)o.push([e[0],a]);return[s].concat(o)}return s}computeMask(e,r){return Ot(()=>{Array.isArray(r)&&(r=r[0]);const i=this.returnSequences?r:null;if(this.returnState){const s=this.states.map(o=>null);return[i].concat(s)}return i})}get states(){if(null==this.states_){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[];for(let i=0;i<e;++i)r.push(null);return r}return this.states_}set states(e){this.states_=e}build(e){if(null!=this.numConstants)throw new Ur("Constants support is not implemented in RNN yet.");e6(e)&&(e=e[0]),e=e;const i=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new yo({shape:[i,null,...s]});const o=[e[0]].concat(e.slice(2));let a;if(this.cell.build(o),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!ri(this.stateSpec.map(u=>u.shape[u.shape.length-1]),a))throw new St(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(u=>new yo({shape:[null,u]}));this.stateful&&this.resetStates()}resetStates(e,r=!1){Ot(()=>{if(!this.stateful)throw new Wh("Cannot call resetStates() on an RNN Layer that is not stateful.");const i=this.inputSpec[0].shape[0];if(null==i)throw new St("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>vo([i,s])):[vo([i,this.cell.stateSize])];else if(null==e)Or(this.states_),null!=this.keptStates&&(Or(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>vo([i,s])):this.states_[0]=vo([i,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new St(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);!0===r?this.keptStates.push(this.states_.slice()):Or(this.states_);for(let s=0;s<this.states_.length;++s){const o=e[s],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,u=[i,a];if(!ri(o.shape,u))throw new St(`State ${s} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${o.shape}`);this.states_[s]=o}}this.states_=this.states_.map(s=>Ao(s.clone()))})}apply(e,r){let i=null==r?null:r.initialState,s=null==r?null:r.constants;null==r&&(r={});const o=zY(e,i,s,this.numConstants);e=o.inputs,i=o.initialState,s=o.constants;let a=[],u=[];if(null!=i){r.initialState=i,a=a.concat(i),this.stateSpec=[];for(const m of i)this.stateSpec.push(new yo({shape:m.shape}));u=u.concat(this.stateSpec)}if(null!=s&&(r.constants=s,a=a.concat(s),this.numConstants=s.length),a[0]instanceof Jc){const m=[e].concat(a),y=this.inputSpec.concat(u),_=this.inputSpec;this.inputSpec=y;const E=super.apply(m,r);return this.inputSpec=_,E}return super.apply(e,r)}call(e,r){return Ot(()=>{const i=null==r?null:r.mask,s=null==r?null:r.training;let o=null==r?null:r.initialState;e=xr(e),null==o&&(o=this.stateful?this.states_:this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==a)throw new St(`RNN Layer has ${a} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const u={training:s},m=UY((O,R)=>{const $=this.cell.call([O].concat(R),u);return[$[0],$.slice(1)]},e,o,this.goBackwards,i,null,this.unroll,this.returnSequences),y=m[0],_=m[1],E=m[2];this.stateful&&this.resetStates(E,s);const D=this.returnSequences?_:y;return this.returnState?[D].concat(E):D})}getInitialState(e){return Ot(()=>{let r=vo(e.shape);return r=Yn(r,[1,2]),r=aE(r),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(i=>i>1?GH(r,[1,i]):r):this.cell.stateSize>1?[GH(r,[1,this.cell.stateSize])]:[r]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(r.numConstants=this.numConstants);const i=this.cell.getConfig();return this.getClassName()===n.className&&(r.cell={className:this.cell.getClassName(),config:i}),Object.assign(Object.assign(Object.assign({},i),e),r)}static fromConfig(e,r,i={}){const o=eh(r.cell,i);return new e(Object.assign(r,{cell:o}))}}return n.className="RNN",n})();Nn(nm);class gE extends Jr{}let I6=(()=>{class n extends gE{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Xo(this.units,"units"),this.activation=tm(null==e.activation?this.DEFAULT_ACTIVATION:e.activation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=_s(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=_s(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=_s(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bs(e.kernelRegularizer),this.recurrentRegularizer=bs(e.recurrentRegularizer),this.biasRegularizer=bs(e.biasRegularizer),this.kernelConstraint=Mo(e.kernelConstraint),this.recurrentConstraint=Mo(e.recurrentConstraint),this.biasConstraint=Mo(e.biasConstraint),this.dropout=K0([1,Xp([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=K0([1,Xp([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ei(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,r){return Ot(()=>{if(2!==(e=e).length)throw new St(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let i=e[1];e=e[0];const s=null!=r.training&&r.training;let o;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rm({ones:()=>Gu(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rm({ones:()=>Gu(i),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,u=this.recurrentDropoutMask;o=jh(null!=a?vt(e,a):e,this.kernel.read()),null!=this.bias&&(o=Yc(o,this.bias.read())),null!=u&&(i=vt(i,u));let d=_n(o,jh(i,this.recurrentKernel.read()));return null!=this.activation&&(d=this.activation.apply(d)),[d,d]})}getConfig(){const e=super.getConfig(),r={units:this.units,activation:em(this.activation),useBias:this.useBias,kernelInitializer:Os(this.kernelInitializer),recurrentInitializer:Os(this.recurrentInitializer),biasInitializer:Os(this.biasInitializer),kernelRegularizer:ts(this.kernelRegularizer),recurrentRegularizer:ts(this.recurrentRegularizer),biasRegularizer:ts(this.biasRegularizer),activityRegularizer:ts(this.activityRegularizer),kernelConstraint:Do(this.kernelConstraint),recurrentConstraint:Do(this.recurrentConstraint),biasConstraint:Do(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),r)}}return n.className="SimpleRNNCell",n})();Nn(I6);let HY=(()=>{class n extends nm{constructor(e){e.cell=new I6(e),super(e)}call(e,r){return Ot(()=>(null!=this.cell.dropoutMask&&(Or(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Or(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})))}static fromConfig(e,r){return new e(r)}}return n.className="SimpleRNN",n})();Nn(HY);let D6=(()=>{class n extends gE{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new St("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Xo(this.units,"units"),this.activation=tm(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=tm(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=_s(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=_s(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=_s(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=bs(e.kernelRegularizer),this.recurrentRegularizer=bs(e.recurrentRegularizer),this.biasRegularizer=bs(e.biasRegularizer),this.kernelConstraint=Mo(e.kernelConstraint),this.recurrentConstraint=Mo(e.recurrentConstraint),this.biasConstraint=Mo(e.biasConstraint),this.dropout=K0([1,Xp([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=K0([1,Xp([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ei(e),this.kernel=this.addWeight("kernel",[e[e.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(e,r){return Ot(()=>{if(2!==(e=e).length)throw new St(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const i=null!=r.training&&r.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rm({ones:()=>Gu(e),rate:this.dropout,training:i,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rm({ones:()=>Gu(s),rate:this.recurrentDropout,training:i,count:3,dropoutFunc:this.dropoutFunc}));const a=this.recurrentDropoutMask;let u,d,m;0<this.dropout&&this.dropout<1&&(e=vt(e,this.dropoutMask[0]));let y=jh(e,this.kernel.read());this.useBias&&(y=Yc(y,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=vt(s,a[0]));const _=this.recurrentKernel.read(),[E,D]=vu(_,[2*this.units,this.units],_.rank-1),O=jh(s,E),[R,$,B]=vu(y,3,y.rank-1),[Q,ie]=vu(O,2,O.rank-1);u=this.recurrentActivation.apply(_n(R,Q)),d=this.recurrentActivation.apply(_n($,ie));const ye=jh(vt(d,s),D);m=this.activation.apply(_n(B,ye));const Me=_n(vt(u,s),vt(_n(1,ss(u)),m));return[Me,Me]})}getConfig(){const e=super.getConfig(),r={units:this.units,activation:em(this.activation),recurrentActivation:em(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Os(this.kernelInitializer),recurrentInitializer:Os(this.recurrentInitializer),biasInitializer:Os(this.biasInitializer),kernelRegularizer:ts(this.kernelRegularizer),recurrentRegularizer:ts(this.recurrentRegularizer),biasRegularizer:ts(this.biasRegularizer),activityRegularizer:ts(this.activityRegularizer),kernelConstraint:Do(this.kernelConstraint),recurrentConstraint:Do(this.recurrentConstraint),biasConstraint:Do(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),r)}}return n.className="GRUCell",n})();Nn(D6);let WY=(()=>{class n extends nm{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new D6(e),super(e)}call(e,r){return Ot(()=>(null!=this.cell.dropoutMask&&(Or(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Or(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})))}static fromConfig(e,r){return 0===r.implmentation&&(r.implementation=1),new e(r)}}return n.className="GRU",n})();Nn(WY);let LO=(()=>{class n extends gE{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Xo(this.units,"units"),this.activation=tm(void 0===e.activation?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=tm(void 0===e.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=null==e.useBias||e.useBias,this.kernelInitializer=_s(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=_s(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=_s(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=bs(e.kernelRegularizer),this.recurrentRegularizer=bs(e.recurrentRegularizer),this.biasRegularizer=bs(e.biasRegularizer),this.kernelConstraint=Mo(e.kernelConstraint),this.recurrentConstraint=Mo(e.recurrentConstraint),this.biasConstraint=Mo(e.biasConstraint),this.dropout=K0([1,Xp([0,null==e.dropout?0:e.dropout])]),this.recurrentDropout=K0([1,Xp([0,null==e.recurrentDropout?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var r;let s;if(e=Ei(e),this.kernel=this.addWeight("kernel",[e[e.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,a=this.units;s=new((r=class extends pc{apply(d,m){const y=o.apply([a]),_=(new qH).apply([a]),E=o.apply([2*a]);return TX(TX(y,_),E)}}).className="CustomInit",r)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,r){return Ot(()=>{const i=null!=r.training&&r.training;if(3!==(e=e).length)throw new St(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rm({ones:()=>Gu(e),rate:this.dropout,training:i,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rm({ones:()=>Gu(s),rate:this.recurrentDropout,training:i,count:4,dropoutFunc:this.dropoutFunc}));const u=this.recurrentDropoutMask;let d,m,y,_;0<this.dropout&&this.dropout<1&&(e=vt(e,this.dropoutMask[0]));let E=jh(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=vt(s,u[0])),E=_n(E,jh(s,this.recurrentKernel.read())),this.useBias&&(E=Yc(E,this.bias.read()));const[D,O,R,$]=vu(E,4,E.rank-1);d=this.recurrentActivation.apply(D),m=this.recurrentActivation.apply(O),y=_n(vt(m,o),vt(d,this.activation.apply(R))),_=this.recurrentActivation.apply($);const B=vt(_,this.activation.apply(y));return[B,B,y]})}getConfig(){const e=super.getConfig(),r={units:this.units,activation:em(this.activation),recurrentActivation:em(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Os(this.kernelInitializer),recurrentInitializer:Os(this.recurrentInitializer),biasInitializer:Os(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ts(this.kernelRegularizer),recurrentRegularizer:ts(this.recurrentRegularizer),biasRegularizer:ts(this.biasRegularizer),activityRegularizer:ts(this.activityRegularizer),kernelConstraint:Do(this.kernelConstraint),recurrentConstraint:Do(this.recurrentConstraint),biasConstraint:Do(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),r)}}return n.className="LSTMCell",n})();Nn(LO);let GY=(()=>{class n extends nm{constructor(e){0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new LO(e),super(e)}call(e,r){return Ot(()=>(null!=this.cell.dropoutMask&&(Or(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Or(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})))}static fromConfig(e,r){return 0===r.implmentation&&(r.implementation=1),new e(r)}}return n.className="LSTM",n})();Nn(GY);let M6=(()=>{class n extends gE{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const r of this.cells.slice().reverse())Array.isArray(r.stateSize)?e.push(...r.stateSize):e.push(r.stateSize);return e}call(e,r){return Ot(()=>{let i=(e=e).slice(1);const s=[];for(const u of this.cells.slice().reverse())Array.isArray(u.stateSize)?s.push(i.splice(0,u.stateSize.length)):s.push(i.splice(0,1));s.reverse();const o=[];let a;for(let u=0;u<this.cells.length;++u){const d=this.cells[u];i=s[u],a=0===u?[e[0]].concat(i):[a[0]].concat(i),a=d.call(a,r),o.push(a.slice(1))}i=[];for(const u of o.slice().reverse())i.push(...u);return[a[0]].concat(i)})}build(e){let r;e6(e)&&(e=e[0]),e=e,this.cells.forEach((i,s)=>{gv(`RNNCell_${s}`,()=>{i.build(e),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,e=[e[0],r]})}),this.built=!0}getConfig(){const e=super.getConfig(),s={cells:this.cells.map(o=>({className:o.getClassName(),config:o.getConfig()}))};return Object.assign(Object.assign({},e),s)}static fromConfig(e,r,i={}){const s=[];for(const o of r.cells)s.push(eh(o,i));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const r of this.cells)e.push(...r.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const r of this.cells)e.push(...r.nonTrainableWeights);if(!this.trainable){const r=[];for(const i of this.cells)r.push(...i.trainableWeights);return r.concat(e)}return e}getWeights(){const e=[];for(const r of this.cells)e.push(...r.weights);return t6(e)}setWeights(e){const r=[];for(const i of this.cells){const o=e.splice(i.weights.length);for(let a=0;a<i.weights.length;++a)r.push([i.weights[a],o[a]])}n6(r)}}return n.className="StackedRNNCells",n})();function rm(n){const{ones:t,rate:e,training:r=!1,count:i=1,dropoutFunc:s}=n,o=()=>null!=s?s(t(),e):IX(t(),e),a=()=>lE(o,t,r);return!i||i<=1?Ao(a().clone()):Array(i).fill(void 0).map(a).map(d=>Ao(d.clone()))}Nn(M6);let b0e=(()=>{class n extends nm{constructor(e){if(e.unroll)throw new Ur("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ur("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new yo({ndim:5})]}call(e,r){return Ot(()=>{if(null!=this.cell.dropoutMask&&(Or(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Or(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),r&&r.constants)throw new St("ConvRNN2D cell does not support constants");return super.call(e,{mask:null==r?null:r.mask,training:null==r?null:r.training,initialState:null==r?null:r.initialState})})}computeOutputShape(e){let r=this.computeSingleOutputShape(e);return this.returnSequences||(r=[r[0],...r.slice(2)]),this.returnState&&(r=[r,...Array(2).fill([e[0],...r.slice(-3)])]),r}getInitialState(e){return Ot(()=>{const{stateSize:r}=this.cell,s=this.computeSingleOutputShape(e.shape),a=vo([s[0],...s.slice(2)]);return Array.isArray(r)?Array(r.length).fill(a):[a]})}resetStates(e,r=!1){Ot(()=>{if(!this.stateful)throw new Wh("Cannot call resetStates() on an RNN Layer that is not stateful.");const i=this.inputSpec[0].shape,s=this.computeSingleOutputShape(i),o=[s[0],...s.slice(2)];if(null==i[0])throw new St("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(()=>vo(o)):[vo(o)];else if(null==e)Or(this.states_),null!=this.keptStates&&(Or(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>vo(o)):this.states_[0]=vo(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new St(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r?this.keptStates.push(this.states_.slice()):Or(this.states_);for(let u=0;u<this.states_.length;++u){const d=e[u],m=o;if(!ri(d.shape,m))throw new St(`State ${u} is incompatible with layer ${this.name}: expected shape=${m}, received shape=${d.shape}`);this.states_[u]=d}}this.states_=this.states_.map(u=>Ao(u.clone()))})}computeSingleOutputShape(e){const{dataFormat:r,filters:i,kernelSize:s,padding:o,strides:a,dilationRate:u}=this.cell,d="channelsFirst"===r,y=e[d?4:3],_=rh(e[d?3:2],s[0],o,a[0],u[0]),E=rh(y,s[1],o,a[1],u[1]);return[...e.slice(0,2),...d?[i,_,E]:[_,E,i]]}}return n.className="ConvRNN2D",n})(),k6=(()=>{class n extends LO{constructor(e){const{filters:r,kernelSize:i,strides:s,padding:o,dataFormat:a,dilationRate:u}=e;super(Object.assign(Object.assign({},e),{units:r})),this.filters=r,Xo(this.filters,"filters"),this.kernelSize=Q0(i,2,"kernelSize"),this.kernelSize.forEach(d=>Xo(d,"kernelSize")),this.strides=Q0(s||1,2,"strides"),this.strides.forEach(d=>Xo(d,"strides")),this.padding=o||"valid",Nl(this.padding),this.dataFormat=a||"channelsLast",no(this.dataFormat),this.dilationRate=Q0(u||1,2,"dilationRate"),this.dilationRate.forEach(d=>Xo(d,"dilationRate"))}build(e){var r;e=Ei(e);const i="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[i])throw new St(`The channel dimension of the input should be defined. Found ${e[i]}`);const a=this.kernelSize.concat([e[i],4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const u=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",u,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let d;if(this.unitForgetBias){const m=this.biasInitializer,y=this.filters;d=new((r=class extends pc{apply(E,D){return WH([m.apply([y]),Wu([y]),m.apply([2*y])])}}).className="CustomInit",r)}else d=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,d,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,r){return Ot(()=>{if(3!==e.length)throw new St(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const i=r.training||!1,s=e[0],o=e[1],a=e[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=rm({ones:()=>Gu(s),rate:this.dropout,training:i,count:4,dropoutFunc:this.dropoutFunc}));const d=this.dropoutMask,m=(vn,An,Tn)=>An&&An[Tn]?vt(An[Tn],vn):vn;let y=m(s,d,0),_=m(s,d,1),E=m(s,d,2),D=m(s,d,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=rm({ones:()=>Gu(o),rate:this.recurrentDropout,training:i,count:4,dropoutFunc:this.dropoutFunc}));const O=this.recurrentDropoutMask;let R=m(o,O,0),$=m(o,O,1),B=m(o,O,2),Q=m(o,O,3);const[ye,Me,Be,He]=vu(this.kernel.read(),4,3),[st,lt,It,zt]=this.useBias?vu(this.bias.read(),4):[null,null,null,null];y=this.inputConv(y,ye,st,this.padding),_=this.inputConv(_,Me,lt,this.padding),E=this.inputConv(E,Be,It,this.padding),D=this.inputConv(D,He,zt,this.padding);const[Wt,qt,Kt,Tt]=vu(this.recurrentKernel.read(),4,3);R=this.recurrentConv(R,Wt),$=this.recurrentConv($,qt),B=this.recurrentConv(B,Kt),Q=this.recurrentConv(Q,Tt);const Rt=this.recurrentActivation.apply(_n(y,R)),Dt=this.recurrentActivation.apply(_n(_,$)),Ht=_n(vt(Dt,a),vt(Rt,this.activation.apply(_n(E,B)))),ln=vt(this.recurrentActivation.apply(_n(D,Q)),this.activation.apply(Ht));return[ln,ln,Ht]})}getConfig(){const i=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e}(super.getConfig(),["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},i),s)}inputConv(e,r,i,s){const o=sd(e,r,this.strides,s||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return i?Yc(o,i,this.dataFormat):o}recurrentConv(e,r){return sd(e,r,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}return n.className="ConvLSTM2DCell",n})();Nn(k6);let jY=(()=>{class n extends b0e{constructor(e){const r=new k6(e);super(Object.assign(Object.assign({},e),{cell:r}))}static fromConfig(e,r){return new e(r)}}return n.className="ConvLSTM2D",n})();Nn(jY);let R6=(()=>{class n extends Jr{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(null==this.noiseShape)return this.noiseShape;const r=e.shape,i=[];for(let s=0;s<this.noiseShape.length;++s)i.push(null==this.noiseShape[s]?r[s]:this.noiseShape[s]);return i}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);const i=xr(e);if(0<this.rate&&this.rate<1){const s=null!=r.training&&r.training,o=this.getNoiseShape(i);return lE(()=>IX(i,this.rate,o,this.seed),()=>i,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=super.getConfig();return Object.assign(e,r),e}dispose(){return super.dispose()}}return n.className="Dropout",n})();Nn(R6);let qY=(()=>{class n extends R6{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const r=e.shape;return[r[0],1,r[2]]}}return n.className="SpatialDropout1D",n})();Nn(qY);let ZY=(()=>{class n extends Jr{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){let r=null;null!=e.batchSize&&(r=e.batchSize),this.batchInputShape=[r,e.inputDim]}this.units=e.units,Xo(this.units,"units"),this.activation=tm(e.activation),null!=e.useBias&&(this.useBias=e.useBias),this.kernelInitializer=_s(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=_s(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Mo(e.kernelConstraint),this.biasConstraint=Mo(e.biasConstraint),this.kernelRegularizer=bs(e.kernelRegularizer),this.biasRegularizer=bs(e.biasRegularizer),this.activityRegularizer=bs(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){const r=(e=Ei(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[r,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:r}}],this.built=!0}computeOutputShape(e){const r=(e=Ei(e)).slice();return r[r.length-1]=this.units,r}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);const i=xr(e),s=_X(this.activation.getClassName());let o;return null!=s?o=jh(i,this.kernel.read(),s,this.bias?this.bias.read():null):(o=jh(i,this.kernel.read()),null!=this.bias&&(o=Yc(o,this.bias.read())),null!=this.activation&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:em(this.activation),useBias:this.useBias,kernelInitializer:Os(this.kernelInitializer),biasInitializer:Os(this.biasInitializer),kernelRegularizer:ts(this.kernelRegularizer),biasRegularizer:ts(this.biasRegularizer),activityRegularizer:ts(this.activityRegularizer),kernelConstraint:Do(this.kernelConstraint),biasConstraint:Do(this.biasConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Dense",n})();Nn(ZY);let KY=(()=>{class n extends Jr{constructor(e){super(e=e||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ei(e);for(const r of e.slice(1))if(null==r)throw new St(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Kp(e,1)]}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);let i=xr(e);if("channelsFirst"===this.dataFormat&&i.rank>1){const s=[0];for(let o=2;o<i.rank;++o)s.push(o);s.push(1),i=ii(i,s)}return function Bye(n){if(n.rank<=1)throw new St(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const t=[n.shape[0],Kp(n.shape,1)];return wt(n,t)}(i)})}getConfig(){const e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);const r=super.getConfig();return Object.assign(e,r),e}}return n.className="Flatten",n})();Nn(KY);let XY=(()=>{class n extends Jr{constructor(e){super(e),this.supportsMasking=!0,this.activation=tm(e.activation)}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);const i=xr(e);return this.activation.apply(i)})}getConfig(){const e={activation:em(this.activation)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Activation",n})();Nn(XY);let YY=(()=>{class n extends Jr{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,r){return Ot(()=>function Lye(n,t){return Ot(()=>{if(2!==n.shape.length)throw new St(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);return GH(aE(n,1),[1,t,1])})}(e=xr(e),this.n))}getConfig(){const e={n:this.n},r=super.getConfig();return Object.assign(e,r),e}}return n.className="RepeatVector",n})();Nn(YY);let QY=(()=>{class n extends Jr{constructor(e){super(e),this.targetShape=e.targetShape;for(let r=0;r<this.targetShape.length;++r)this.isUnknown(this.targetShape[r])&&(this.targetShape[r]=null)}isUnknown(e){return e<0||null==e}fixUnknownDimension(e,r){const i="Total size of new array must be unchanged.",s=r.slice();let o=1,a=null;for(let d=0;d<s.length;++d){const m=s[d];if(this.isUnknown(m)){if(null!==a)throw new St("Can only specifiy one unknown dimension.");a=d}else o*=m}const u=Kp(e);if(null!==a){if(0===o||u%o!=0)throw new St(i);s[a]=u/o}else if(u!==o)throw new St(i);return s}computeOutputShape(e){let r=!1;for(let i=0;i<e.length;++i)if(this.isUnknown(e[i])){r=!0;break}return r?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);const i=xr(e),s=i.shape,o=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return wt(i,o)})}getConfig(){const e={targetShape:this.targetShape},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Reshape",n})();Nn(QY);let JY=(()=>{class n extends Jr{constructor(e){if(super(e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const r=Kc(1,e.dims.length+1);if(!ri(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new yo({ndim:this.dims.length+1})]}computeOutputShape(e){const r=(e=Ei(e)).slice();return this.dims.forEach((i,s)=>{r[s+1]=e[i]}),r}call(e,r){return ii(xr(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Permute",n})();Nn(JY);let eQ=(()=>{class n extends Jr{constructor(e){super(null==e?{}:e),this.supportsMasking=!0,this.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={maskValue:this.maskValue};return Object.assign(r,e),r}computeMask(e,r){const i=xr(e);return PS(uv(i,this.maskValue),-1)}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);const i=xr(e),a=PS(uv(i,this.maskValue),-1,!0);return vt(i,Fn(a,i.dtype))})}}return n.className="Masking",n})();Nn(eQ);let tQ=(()=>{class n extends Jr{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){let r=null;null!=e.batchSize&&(r=e.batchSize),this.batchInputShape=null==e.inputLength?[r,null]:[r].concat(os(e.inputLength))}this.inputDim=e.inputDim,Xo(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Xo(this.outputDim,"outputDim"),this.embeddingsInitializer=_s(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=bs(e.embeddingsRegularizer),this.activityRegularizer=bs(e.activityRegularizer),this.embeddingsConstraint=Mo(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,r){return Ot(()=>this.maskZero?(e=xr(e),uv(e,ai(e))):null)}computeOutputShape(e){if(e=Ei(e),null==this.inputLength)return[...e,this.outputDim];const r=os(this.inputLength);if(r.length!==e.length-1)throw new St(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let i=0;for(let s=0;s<r.length;++s){const o=r[s],a=e[s+1];if(null!=o&&null!=a&&o!==a)throw new St(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);null==o&&(r[i]=a),i++}}return[e[0],...r,this.outputDim]}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);let i=xr(e);"int32"!==i.dtype&&(i=Gh(i,"int32"));const s=AX(this.embeddings.read(),wt(i,[i.size]));return wt(s,Ei(this.computeOutputShape(i.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Os(this.embeddingsInitializer),embeddingsRegularizer:ts(this.embeddingsRegularizer),activityRegularizer:ts(this.activityRegularizer),embeddingsConstraint:Do(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Embedding",n})();Nn(tQ);class _v extends Jr{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Ur}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const r=t.slice(0,t.length-e.length);for(let i=0;i<e.length;++i){const s=t[t.length-e.length+i],o=e[i];if(null==s||null==o||s<0||o<0)r.push(null);else if(1===s)r.push(o);else if(1===o)r.push(s);else{if(s!==o)throw new St("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));r.push(s)}}return r}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Ei(t)]),(t=t).length<2)throw new St(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const s of t)null!=s&&null!==s[0]&&e.push(s[0]);if(e=Zp(e),e.length>1)throw new St(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let r=null==t[0]?null:t[0].slice(1);for(let s=1;s<t.length;++s){const o=null==t[s]?null:t[s].slice(1);r=this.computeElementwiseOpOutputShape(r,o)}const i=t.map(s=>s.length);this.reshapeRequired=-1!==t.indexOf(null)||1!==Zp(i).length}call(t,e){return Ot(()=>{if(t=t,this.reshapeRequired){const r=[],i=t.map(s=>s.rank);if(-1===i.indexOf(null)){const s=Xp(i);for(let o of t){const a=o.rank;for(let u=0;u<s-a;++u)o=aE(o,1);r.push(o)}return this.mergeFunction(r)}{let s=!1;for(const u of t){const d=u.rank;if(null==d){const m=u.shape,y=m[0],_=m.slice(1).concat([y]);let E=wt(u,[y].concat(Kp(m.slice(1))));E=ii(E,[1,0]),E=wt(E,_),r.push(E),s=!0}else if(d>1){const m=Kc(1,d).concat([0]);r.push(ii(u,m)),s=!0}else r.push(u)}let o=this.mergeFunction(r);const a=o.rank;if(s)if(null==a){const u=o.shape,m=u[u.length-1],y=[m].concat(u.slice(0,u.length-1));o=wt(ii(wt(o,[-1,m]),[1,0]),y)}else if(a>1){const u=[a-1].concat(Kc(0,a-1));o=ii(o,u)}return o}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==(t=t)[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const s=null==t[i]?null:t[i].slice(1);e=this.computeElementwiseOpOutputShape(e,s)}let r=[];for(const i of t)null!=i&&null!==i[0]&&r.push(i[0]);return r=Zp(r),e=1===r.length?r.concat(e):[null].concat(e),e}computeMask(t,e){return Ot(()=>{if(null==e)return null;if(!Array.isArray(e))throw new St("`mask` should be an Array");if(!Array.isArray(t))throw new St("`inputs` should be an Array");if(e.length!==t.length)throw new St(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(i=>null==i))return null;let r=(e=e.map(i=>null==i?i:Ma(i,0)))[0];for(let i=1;i<e.length-1;++i)r=lc(r,e[i]);return r})}}let $O=(()=>{class n extends _v{constructor(e){super(e)}mergeFunction(e){return Ot(()=>{let r=e[0].clone();for(let i=1;i<e.length;++i)r=_n(r,e[i]);return r})}}return n.className="Add",n})();Nn($O);let BO=(()=>{class n extends _v{constructor(e){super(e)}mergeFunction(e){return Ot(()=>{let r=e[0].clone();for(let i=1;i<e.length;++i)r=vt(r,e[i]);return r})}}return n.className="Multiply",n})();Nn(BO);let VO=(()=>{class n extends _v{constructor(e){super(e)}mergeFunction(e){return Ot(()=>{let r=e[0].clone();for(let i=1;i<e.length;++i)r=_n(r,e[i]);return vt(1/e.length,r)})}}return n.className="Average",n})();Nn(VO);let zO=(()=>{class n extends _v{constructor(e){super(e)}mergeFunction(e){return Ot(()=>{let r=e[0];for(let i=1;i<e.length;++i)r=Uh(r,e[i]);return r})}}return n.className="Maximum",n})();Nn(zO);let UO=(()=>{class n extends _v{constructor(e){super(e)}mergeFunction(e){return Ot(()=>{let r=e[0];for(let i=1;i<e.length;++i)r=Gp(r,e[i]);return r})}}return n.className="Minimum",n})();Nn(UO);let HO=(()=>{class n extends _v{constructor(e){super(e),this.DEFAULT_AXIS=-1,null==e&&(e={}),this.axis=null==e.axis?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new St("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let r=!0;for(const s of e)if(null!=s){r=!1;break}if(r)return;const i=[];for(let s=0;s<e.length;++s){const o=e[s].slice();o.splice(this.axis,1);let a=!1;for(const u of i)if(ri(u,o)){a=!0;break}a||i.push(o)}if(i.length>1)throw new St("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Ot(()=>WH(e,this.axis))}computeOutputShape(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new St("A `Concatenate` layer should be called on a list of inputs.");const r=e,i=r[0].slice(),s=this.axis<0?i.length+this.axis:this.axis;for(const o of r.slice(1)){if(null==i[s]||null==o[s]){i[s]=null;break}i[s]+=o[s]}return i}computeMask(e,r){if(null==r)return null;if(!Array.isArray(r))throw new St("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new St("`inputs` should be an array for Concatenate");if(r.length!==e.length)throw new St(`Mismatch in the length of mask (${r.length}) and the legnth of inputs (${e.length})`);return Ot(()=>{let i=!0;if(r.forEach(a=>{null==a||(i=!1)}),i)return null;const s=[];for(let a=0;a<e.length;++a)s.push(null==r[a]?Fn(Gu(e[a]),"bool"):r[a].rank<e[a].rank?Ma(r[a],-1):r[a]);const o=Js(s,this.axis);return kR(o,-1,!1)})}getConfig(){const e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Concatenate",n})();function vE(n,t){for(;n<0;)n+=t;return n}Nn(HO);let nQ=(()=>{class n extends _v{constructor(e){super(e),this.axes=e.axes,this.normalize=null!=e.normalize&&e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){De(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const r=e[0],i=e[1];if(r.length>3||i.length>3)throw new Ur("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(r,i);if(r[s[0]]!==i[s[1]])throw new St(`Dimension incompatibility: ${r[s[0]]} !== ${i[s[1]]}`)}mergeFunction(e){if(2!==e.length)throw new St(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let s,r=e[0],i=e[1];return s=Array.isArray(this.axes)?this.axes.map((o,a)=>vE(o,e[a].shape.length)):[vE(this.axes,r.shape.length),vE(this.axes,i.shape.length)],this.normalize&&(r=NO(r,s[0]),i=NO(i,s[1])),function w0e(n,t,e){if(n.shape.length>3||t.shape.length>3)throw new Ur("batchDot is not implemented for tensors of 4D or higher rank yet");if(De(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),De(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),"number"==typeof e&&(e=[e,e]),"complex64"===n.dtype||"complex64"===t.dtype)throw new Ur("batchDot is not implemented for complex64-type Tensors yet.");const r=n.shape.length,i=t.shape.length;null==e&&(e=[r-1,i-2]);const s=e;return Ot(()=>{let o,a;if(r>i){o=r-i;const u=[];for(let d=0;d<o;++d)u.push(1);t=wt(t,t.shape.concat(u))}else if(i>r){o=i-r;const u=[];for(let d=0;d<o;++d)u.push(1);n=wt(n,n.shape.concat(u))}else o=0;if(a=2===n.shape.length&&2===t.shape.length?s[0]===s[1]?Yn(vt(n,t),s[0]):Yn(vt(ii(n,[1,0]),t),s[1]):Qr(n,t,s[0]!==n.shape.length-1,s[1]===t.shape.length-1),o>0){let u;u=r>i?r+i-3:r-1;const d=[];for(let m=u;m<u+o;++m)d.push(m);a=jp(a,d)}return 1===a.shape.length&&(a=Ma(a,1)),a})}(r,i,s)}interpretAxes(e,r){let i;return i=Array.isArray(this.axes)?this.axes:[vE(this.axes,e.length),vE(this.axes,r.length)],i}computeOutputShape(e){De(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const r=e[0].slice(),i=e[1].slice();if(r.length>3||i.length>3)throw new Ur("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(r,i);r.splice(s[0],1),i.splice(s[1],1),i.splice(0,1);const o=r.concat(i);return 1===o.length&&o.push(1),o}computeMask(e,r){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},r=super.getConfig();return Object.assign(e,r),e}}return n.className="Dot",n})();Nn(nQ);let rQ=(()=>{class n extends Jr{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={stddev:this.stddev};return Object.assign(r,e),r}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);const i=xr(e);return lE(()=>_n(bO(i.shape,0,this.stddev),i),()=>i,r.training||!1)})}}return n.className="GaussianNoise",n})();Nn(rQ);let iQ=(()=>{class n extends Jr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return Ot(()=>{this.invokeCallHook(e,r);const i=xr(e);return this.rate>0&&this.rate<1?lE(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return vt(i,bO(i.shape,1,o))},()=>i,r.training||!1):i})}}return n.className="GaussianDropout",n})();Nn(iQ);let sQ=(()=>{class n extends Jr{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||xr(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return Ot(()=>{if(this.rate<1&&this.rate>0){const i=this._getNoiseShape(e);return lE(()=>{const o=xr(e),d=-1.7580993408473766;let m=od(lv(i),this.rate);m=Gh(m,"float32");const y=((1-this.rate)*(1+this.rate*d**2))**-.5,_=-y*d*this.rate,E=_n(vt(o,m),vt(_n(m,-1),d));return _n(vt(E,y),_)},()=>xr(e),r.training||!1)}return e})}}return n.className="AlphaDropout",n})();function yE(n,t,e,r,i,s=.001){let o;if(2===n.rank)o=v5(n,t,e,r,i,s);else if(3===n.rank)o=y5(n,t,e,r,i,s);else{if(4!==n.rank)throw new Ur(`batchNormalization is not implemented for array of rank ${n.rank} yet`);o=_5(n,t,e,r,i,s)}return o}Nn(sQ);let oQ=(()=>{class n extends Jr{constructor(e){null==e&&(e={}),super(e),this.supportsMasking=!0,this.axis=null==e.axis?-1:e.axis,this.momentum=null==e.momentum?.99:e.momentum,this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=_s(e.betaInitializer||"zeros"),this.gammaInitializer=_s(e.gammaInitializer||"ones"),this.movingMeanInitializer=_s(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=_s(e.movingVarianceInitializer||"ones"),this.betaConstraint=Mo(e.betaConstraint),this.gammaConstraint=Mo(e.gammaConstraint),this.betaRegularizer=bs(e.betaRegularizer),this.gammaRegularizer=bs(e.gammaRegularizer)}build(e){e=Ei(e);const r=this.axis>=0?this.axis:this.axis+e.length,i=e[r];if(null==i)throw new St(`Axis ${r} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new yo({ndim:e.length,axes:{[r]:i}})];const s=[i];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,r){return Ot(()=>{const i=null!=r.training&&r.training,s=xr(e),o=s.shape,a=o.length,u=Kc(0,a),d=this.axis>=0?this.axis:this.axis+a;u.splice(d,1);const m=dv(1,a);m[d]=o[d];const y=u.slice();y.sort();const _=!ri(y,Kc(0,a).slice(0,a-1));if(!i)return(()=>{if(_){const Q=wt(this.movingMean.read(),m),ie=wt(this.movingVariance.read(),m),ye=this.center?wt(this.beta.read(),m):null,Me=this.scale?wt(this.gamma.read(),m):null;return yE(s,Q,ie,ye,Me,this.epsilon)}return yE(s,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[D,O,R]=function S0e(n,t,e,r,i=.001){return ri(r.slice().sort(),Kc(0,n.rank-1))?function x0e(n,t,e,r,i=.001){return Ot(()=>{const s=ZS(n,r),o=s.mean,a=s.variance;return[yE(n,o,a,e,t,i),o,a]})}(n,t,e,r,i):function C0e(n,t,e,r,i=.001){return Ot(()=>{const s=ZS(n,r),o=s.mean,a=s.variance,u=[];for(const D of Kc(0,n.rank))-1!==r.indexOf(D)?u.push(1):u.push(n.shape[D]);const d=wt(o,u),m=wt(a,u),y=null==t?null:wt(t,u),_=null==e?null:wt(e,u);return[yE(n,d,m,_,y,i),o,a]})}(n,t,e,r,i)}(s,this.gamma.read(),this.beta.read(),u,this.epsilon),$=(Q,ie,ye)=>{Ot(()=>{const Me=1-ye,Be=Q.read(),He=vt(qn(Be,ie),Me);Q.write(qn(Be,He))})};return(()=>{$(this.movingMean,O,this.momentum),$(this.movingVariance,R,this.momentum)})(),D})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Os(this.betaInitializer),gammaInitializer:Os(this.gammaInitializer),movingMeanInitializer:Os(this.movingMeanInitializer),movingVarianceInitializer:Os(this.movingVarianceInitializer),betaRegularizer:ts(this.betaRegularizer),gammaRegularizer:ts(this.gammaRegularizer),betaConstraint:Do(this.betaConstraint),gammaConstraint:Do(this.gammaConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="BatchNormalization",n})();Nn(oQ);let aQ=(()=>{class n extends Jr{constructor(e){if(null==e&&(e={}),super(e),this.axis=null==e.axis?-1:e.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const r of this.axis)if(!Number.isInteger(r))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==e.epsilon?.001:e.epsilon,this.center=null==e.center||e.center,this.scale=null==e.scale||e.scale,this.betaInitializer=_s(e.betaInitializer||"zeros"),this.gammaInitializer=_s(e.gammaInitializer||"ones"),this.betaRegularizer=bs(e.betaRegularizer),this.gammaRegularizer=bs(e.gammaRegularizer),this.supportsMasking=!0}build(e){const r=(e=Ei(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=r);for(const o of this.axis)if(o<0||o>=r)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==Zp(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const i=this.axis.map(o=>e[o]);this.gamma=this.scale?this.addWeight("gamma",i,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",i,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}call(e,r){const i=xr(e),s=i.shape,o=s.length;return Ot(()=>{let{mean:u,variance:d}=ZS(i,this.axis,!0);const m=dv(1,o);for(const R of this.axis)m[R]=s[R];const y=R=>null!=R&&R.shape.length!==o?wt(R,m):R;let _=this.scale?y(this.gamma.read()):null,E=this.center?y(this.beta.read()):null;const D=[],O=[];for(let R=0;R<o;++R)-1!==this.axis.indexOf(R)?(D.push(s[R]),O.push(1)):(D.push(1),O.push(s[R]));return u=xl(u,D),d=xl(d,D),null!=_&&(_=xl(_,O)),null!=E&&(E=xl(E,O)),yE(i,u,d,E,_,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Os(this.betaInitializer),gammaInitializer:Os(this.gammaInitializer),betaRegularizer:ts(this.betaRegularizer),gammaRegularizer:ts(this.gammaRegularizer)},r=super.getConfig();return Object.assign(e,r),e}}return n.className="LayerNormalization",n})();Nn(aQ);let uQ=(()=>{class n extends Jr{constructor(e){if(null==e&&(e={}),super(e),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new St(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let r,i;if("number"==typeof e.padding[0])r=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new St(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(r=e.padding[0],2!==e.padding[1].length)throw new St(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);i=e.padding[1]}this.padding=[r,i]}this.inputSpec=[new yo({ndim:4})]}computeOutputShape(e){let r,i;return e=Ei(e),"channelsFirst"===this.dataFormat?(r=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,i=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],r,i]):(r=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,i=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],r,i,e[3]])}call(e,r){return Ot(()=>function E0e(n,t,e){return Ot(()=>{if(4!==n.rank)throw new St(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new St("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==e&&(e="channelsLast"),"channelsLast"!==e&&"channelsFirst"!==e)throw new St(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return r="channelsFirst"===e?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],ad(n,r)})}(xr(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return n.className="ZeroPadding2D",n})();function WO(n,t,e,r,i,s){return Ot(()=>{let o;no(i),wX(s),Nl(r),null==e&&(e=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),n=E6(n,i);const a="same"===r?"same":"valid";return o="max"===s?qS(n,t,e,a):VS(n,t,e,a),"channelsFirst"===i&&(o=ii(o,[0,3,1,2])),o})}function lQ(n,t,e,r,i,s){return Ot(()=>{let o;no(i),wX(s),Nl(r),null==e&&(e=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==s&&(s="max"),n=MY(n,i);const a="same"===r?"same":"valid";return o="max"===s?H5(n,t,e,a):g5(n,t,e,a),"channelsFirst"===i&&(o=ii(o,[0,4,1,2,3])),o})}Nn(uQ);class cQ extends Jr{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new St(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);this.poolSize=t.poolSize}if(Xo(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new St(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);this.strides=t.strides}Xo(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,Nl(this.padding),this.inputSpec=[new yo({ndim:3})]}computeOutputShape(t){const e=rh((t=Ei(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Ot(()=>{this.invokeCallHook(t,e),t=aE(xr(t),2);const r=this.poolingFunction(xr(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return jp(r,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}let hQ=(()=>{class n extends cQ{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return no(o),Nl(s),WO(e,r,i,s,o,"max")}}return n.className="MaxPooling1D",n})();Nn(hQ);let fQ=(()=>{class n extends cQ{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return no(o),Nl(s),WO(e,r,i,s,o,"avg")}}return n.className="AveragePooling1D",n})();Nn(fQ);class dQ extends Jr{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new St(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Xo(this.poolSize,"poolSize"),Xo(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,no(this.dataFormat),Nl(this.padding),this.inputSpec=[new yo({ndim:4})]}computeOutputShape(t){t=Ei(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],r="channelsFirst"===this.dataFormat?t[3]:t[2];return e=rh(e,this.poolSize[0],this.padding,this.strides[0]),r=rh(r,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,r]:[t[0],e,r,t[3]]}call(t,e){return Ot(()=>(this.invokeCallHook(t,e),this.poolingFunction(xr(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}let pQ=(()=>{class n extends dQ{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return no(o),Nl(s),WO(e,r,i,s,o,"max")}}return n.className="MaxPooling2D",n})();Nn(pQ);let mQ=(()=>{class n extends dQ{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return no(o),Nl(s),WO(e,r,i,s,o,"avg")}}return n.className="AveragePooling2D",n})();Nn(mQ);class gQ extends Jr{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new St(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Xo(this.poolSize,"poolSize"),Xo(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,no(this.dataFormat),Nl(this.padding),this.inputSpec=[new yo({ndim:5})]}computeOutputShape(t){t=Ei(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],r="channelsFirst"===this.dataFormat?t[3]:t[2],i="channelsFirst"===this.dataFormat?t[4]:t[3];return e=rh(e,this.poolSize[0],this.padding,this.strides[0]),r=rh(r,this.poolSize[1],this.padding,this.strides[1]),i=rh(i,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,r,i]:[t[0],e,r,i,t[4]]}call(t,e){return Ot(()=>(this.invokeCallHook(t,e),this.poolingFunction(xr(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}let vQ=(()=>{class n extends gQ{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return no(o),Nl(s),lQ(e,r,i,s,o,"max")}}return n.className="MaxPooling3D",n})();Nn(vQ);let yQ=(()=>{class n extends gQ{constructor(e){super(e)}poolingFunction(e,r,i,s,o){return no(o),Nl(s),lQ(e,r,i,s,o,"avg")}}return n.className="AveragePooling3D",n})();Nn(yQ);class _Q extends Jr{constructor(t){super(t),this.inputSpec=[new yo({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new Ur}}let bQ=(()=>{class n extends _Q{constructor(e){super(e||{})}call(e,r){return Ot(()=>{const i=xr(e);return Rs(i,1)})}}return n.className="GlobalAveragePooling1D",n})();Nn(bQ);let wQ=(()=>{class n extends _Q{constructor(e){super(e||{})}call(e,r){return Ot(()=>{const i=xr(e);return wl(i,1)})}}return n.className="GlobalMaxPooling1D",n})();Nn(wQ);class xQ extends Jr{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,no(this.dataFormat),this.inputSpec=[new yo({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new Ur}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}let CQ=(()=>{class n extends xQ{call(e,r){return Ot(()=>{const i=xr(e);return Rs(i,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}return n.className="GlobalAveragePooling2D",n})();Nn(CQ);let SQ=(()=>{class n extends xQ{call(e,r){return Ot(()=>{const i=xr(e);return wl(i,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}return n.className="GlobalMaxPooling2D",n})();Nn(SQ);class EQ extends Jr{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,r={}){const s=eh(e.layer,r);delete e.layer;const o={layer:s};return Object.assign(o,e),new t(o)}}let NQ=(()=>{class n extends EQ{constructor(e){super(e),this.supportsMasking=!0}build(e){if((e=Ei(e)).length<3)throw new St(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const r=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),super.build(e)}computeOutputShape(e){const r=[(e=Ei(e))[0]].concat(e.slice(2)),i=this.layer.computeOutputShape(r);return[i[0],e[1]].concat(i.slice(1))}call(e,r){return Ot(()=>UY((a,u)=>[xr(this.layer.call(a,r)),[]],e=xr(e),[],!1,null,null,!1,!0)[1])}}return n.className="TimeDistributed",n})();Nn(NQ);let TQ=(()=>{class n extends EQ{constructor(e){super(e);const r=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=r,this.forwardLayer=eh(i),r.goBackwards=!0!==r.goBackwards;const s={};if(s.className=e.layer.getClassName(),s.config=r,this.backwardLayer=eh(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function N0e(n){mv(Dye,"BidirectionalMergeMode",n)}(this.mergeMode),e.weights)throw new Ur("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const i=Math.floor(e.length/2);this.forwardLayer.setWeights(e.slice(0,i)),this.backwardLayer.setWeights(e.slice(i))}computeOutputShape(e){let i,s,o,r=this.forwardLayer.computeOutputShape(e);return Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),r=r,this.returnState&&(o=r.slice(1)),i=r[0],i=i,"concat"===this.mergeMode?(i[i.length-1]*=2,s=[i]):s=null==this.mergeMode?[i,i.slice()]:[i],this.returnState?null==this.mergeMode?s.concat(o).concat(o.slice()):[i].concat(o).concat(o.slice()):_u(s)}apply(e,r){let i=null==r?null:r.initialState,s=null==r?null:r.constants;null==r&&(r={});const o=zY(e,i,s,this.numConstants);if(e=o.inputs,i=o.initialState,s=o.constants,Array.isArray(e)&&(i=e.slice(1),e=e[0]),(null==i||0===i.length)&&null==s)return super.apply(e,r);const a=[],u=[];if(null!=i){const m=i.length;if(m%2>0)throw new St("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,a.push(...i);const y=i.map(_=>new yo({shape:_.shape}));this.forwardLayer.stateSpec=y.slice(0,m/2),this.backwardLayer.stateSpec=y.slice(m/2),u.push(...y)}if(null!=s)throw new Ur("Support for constants in Bidirectional layers is not implemented yet.");const d=a[0]instanceof Jc;for(const m of a)if(m instanceof Jc!==d)throw new St("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(d){const m=[e].concat(a),y=this.inputSpec.concat(u),_=this.inputSpec;this.inputSpec=y;const E=super.apply(m,r);return this.inputSpec=_,E}return super.apply(e,r)}call(e,r){return Ot(()=>{const i=r.initialState;let s,o,a,u;if(null==i)s=this.forwardLayer.call(e,r),o=this.backwardLayer.call(e,r);else{const d=i.slice(0,i.length/2),m=i.slice(i.length/2);s=this.forwardLayer.call(e,Object.assign(r,{initialState:d})),o=this.backwardLayer.call(e,Object.assign(r,{initialState:m}))}return this.returnState&&(Array.isArray(s)&&(a=s.slice(1).concat(o.slice(1))),s=s[0],o=o[0]),this.returnSequences&&(o=Cl(o,1)),"concat"===this.mergeMode?u=WH([s,o]):"sum"===this.mergeMode?u=_n(s,o):"ave"===this.mergeMode?u=vt(.5,_n(s,o)):"mul"===this.mergeMode?u=vt(s,o):null==this.mergeMode&&(u=[s,o]),this.returnState?null==this.mergeMode?u.concat(a):[u].concat(a):u})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){gv(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),gv(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,r){let i;if(Array.isArray(r)&&(r=r[0]),i=this.returnSequences?null==this.mergeMode?[r,r]:r:null==this.mergeMode?[null,null]:null,this.returnState){const o=this.forwardLayer.states.map(a=>null);return Array.isArray(i)?i.concat(o).concat(o):[i].concat(o).concat(o)}return i}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},r=super.getConfig();return Object.assign(e,r),e}static fromConfig(e,r){const i=eh(r.layer);if(delete r.layer,null!=r.numConstants)throw new Ur("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=r;return s.layer=i,new e(s)}}return n.className="Bidirectional",n})();Nn(TQ);let AQ=(()=>{class n extends Jr{constructor(e){super(e),this.scale=e.scale,this.offset=e.offset?e.offset:0}getConfig(){const e={scale:this.scale,offset:this.offset},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return Ot(()=>("float32"!==(e=xr(e)).dtype&&(e=Gh(e,"float32")),_n(vt(e,this.scale),this.offset)))}}return n.className="Rescaling",n})();Nn(AQ);const{resizeBilinear:A0e,cropAndResize:I0e}=cc;let IQ=(()=>{class n extends Jr{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,r,i,s,o,a,u,d){return Ot(()=>{let m,y=!1;const R=[r/a,i/u,(s+r)/a,(o+i)/u],$=[];3===e.rank?(y=!0,m=yu([e])):m=e;for(let Me=0;Me<m.shape[0];Me++)$.push(R);const B=Vu($,[$.length,4]),Q=cv(0,$.length,1,"int32"),ye=I0e(m,B,Q,[s,o],"nearest");return Gh(y?xr(Sl(ye)):ye,d)})}upsize(e,r,i,s){return Ot(()=>Gh(A0e(e,[r,i]),s))}call(e,r){return Ot(()=>{const i=xr(e),s=i.dtype,o=i.shape,a=o[o.length-3],u=o[o.length-2];let d=0;a!==this.height&&(d=Math.floor((a-this.height)/2));let m=0;return u!==this.width&&(m=Math.floor((u-this.width)/2),0===m&&(m=1)),d>=0&&m>=0?this.centerCrop(i,d,m,this.height,this.width,a,u,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){const i=(e=Ei(e)).length-2;return e[e.length-3]=this.height,e[i]=this.width,e}}return n.className="CenterCrop",n})();Nn(IQ);let DQ=(()=>{class n extends Jr{constructor(e){super(e),this.numTokens=e.numTokens,this.outputMode=e.outputMode?e.outputMode:"multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){return null==(e=Ei(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,r){return Ot(()=>{let i;if("int32"!==(e=xr(e)).dtype&&(e=Gh(e,"int32")),void 0!==r.countWeights){if("count"!==this.outputMode)throw new St(`countWeights is not used when outputMode !== count.\n              Received countWeights=${r.countWeights}`);i=xr(r.countWeights)}const s=wl(e),o=B0(e),a=Ka(this.numTokens,s).bufferSync().get(0),u=od(o,0).bufferSync().get(0);if(!a||!u)throw new St(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return function D0e(n,t,e,r){let i=xr(n);if("int32"!==i.dtype&&(i=Gh(i,"int32")),"int"===t)return i;const s=i.shape;if(0===i.rank&&(i=Ma(i,-1)),"oneHot"===t&&1!==i.shape[i.shape.length-1]&&(i=Ma(i,-1)),i.rank>2)throw new St(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${s} which would result in output rank ${i.rank}.`);const o=["multiHot","oneHot"].includes(t);let u;if(u=LR(i,void 0!==r&&"count"===t?r:[],e,o),"tfIdf"!==t)return u;if(r)return vt(u,r);throw new St("When outputMode is 'tfIdf', weights must be provided.")}(e,this.outputMode,this.numTokens,i)})}}return n.className="CategoryEncoding",n})();Nn(DQ);const MQ=new Set(["bilinear","nearest"]);let kQ=(()=>{class n extends Jr{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation){if(!MQ.has(e.interpolation))throw new St(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);this.interpolation=e.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(e.cropToAspectRatio)}computeOutputShape(e){return e=Ei(e),[this.height,this.width,e[2]]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return Ot(()=>{const i=[this.height,this.width];if("bilinear"===this.interpolation)return cc.resizeBilinear(e,i,!this.cropToAspectRatio);if("nearest"===this.interpolation)return cc.resizeNearestNeighbor(e,i,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...MQ]} are supported`)})}}return n.className="Resizing",n})();Nn(kQ);let k0e=(()=>{class n{constructor(e){this.seed=e}next(){if(void 0!==this.seed)return this.seed++}}return n.className="RandomSeed",n})(),R0e=(()=>{class n extends Jr{constructor(e){super(e),this.randomGenerator=new k0e(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},r=super.getConfig();return Object.assign(e,r),e}}return n.className="BaseRandomLayer",n})();const RQ=new Set(["bilinear","nearest"]);let OQ=(()=>{class n extends R0e{constructor(e){super(e);const{factor:r,interpolation:i="bilinear"}=e;if(this.factor=r,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new St(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new St(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new St(`factor cannot have upper bound less than lower bound.\n        Got upper bound: ${this.widthUpper}.\n        Got lower bound: ${this.widthLower}\n      `);if(i){if(!RQ.has(i))throw new St(`Invalid interpolation parameter: ${i} is not implemented`);this.interpolation=i}}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){return e=Ei(e),[this.imgHeight,-1,e[2]]}call(e,r){return Ot(()=>{const i=xr(e);this.imgHeight=i.shape[i.shape.length-3];const s=i.shape[i.shape.length-2];this.widthFactor=lv([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*s;o=Math.round(o);const a=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return cc.resizeBilinear(e,a);case"nearest":return cc.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}\n          but only ${[...RQ]} are supported`)}})}}return n.className="RandomWidth",n})();function F0e(n){return new cE(n)}function P0e(n){return new AY(n)}function L0e(n){return new EY(n)}function $0e(n){return new NY(n)}function B0e(n){return new TY(n)}function V0e(n){return new DY(n)}function z0e(n){return new IY(n)}function U0e(n){return new LY(n)}function H0e(n){return new T6(n)}function W0e(n){return new OY(n)}function G0e(n){return new A6(n)}function j0e(n){return new FY(n)}function q0e(n){return new PY(n)}function Z0e(n){return new $Y(n)}function K0e(n){return new BY(n)}function X0e(n){return new VY(n)}function Y0e(n){return new XY(n)}function Q0e(n){return new ZY(n)}function J0e(n){return new R6(n)}function ebe(n){return new qY(n)}function tbe(n){return new KY(n)}function nbe(n){return new YY(n)}function rbe(n){return new QY(n)}function ibe(n){return new JY(n)}function sbe(n){return new tQ(n)}function obe(n){return new $O(n)}function abe(n){return new VO(n)}function ube(n){return new HO(n)}function lbe(n){return new zO(n)}function cbe(n){return new UO(n)}function hbe(n){return new BO(n)}function fbe(n){return new nQ(n)}function dbe(n){return new oQ(n)}function pbe(n){return new aQ(n)}function mbe(n){return new uQ(n)}function O6(n){return new fQ(n)}function gbe(n){return O6(n)}function vbe(n){return O6(n)}function F6(n){return new mQ(n)}function ybe(n){return F6(n)}function _be(n){return F6(n)}function P6(n){return new yQ(n)}function bbe(n){return P6(n)}function wbe(n){return P6(n)}function xbe(n){return new bQ(n)}function Cbe(n){return new CQ(n)}function FQ(n){return new wQ(n)}function PQ(n){return new SQ(n)}function LQ(n){return new hQ(n)}function $Q(n){return new pQ(n)}function Sbe(n){return new vQ(n)}function Ebe(n){return new WY(n)}function Nbe(n){return new D6(n)}function Tbe(n){return new GY(n)}function Abe(n){return new LO(n)}function Ibe(n){return new HY(n)}function Dbe(n){return new I6(n)}function Mbe(n){return new jY(n)}function kbe(n){return new k6(n)}function Rbe(n){return new nm(n)}function Obe(n){return new M6(n)}function Fbe(n){return new TQ(n)}function Pbe(n){return new NQ(n)}Nn(OQ);const Lbe=FQ,$be=PQ,Bbe=LQ,Vbe=$Q;function zbe(n){return new rQ(n)}function Ube(n){return new iQ(n)}function Hbe(n){return new sQ(n)}function Wbe(n){return new eQ(n)}function Gbe(n){return new AQ(n)}function jbe(n){return new IQ(n)}function qbe(n){return new kQ(n)}function Zbe(n){return new DQ(n)}function Kbe(n){return new OQ(n)}function Xbe(n,t){return a6(n,t)}function Ybe(n,t){return iY(n,t)}function Qbe(n,t){return sY(n,t)}function Jbe(n,t){return u6(n,t)}function ewe(n,t){return l6(n,t)}function twe(n,t){return rY(n,t)}function nwe(n,t){return function F_e(n,t){return Ot(()=>{const e=nY(n,t),r=function R_e(n,t){return Ot(()=>Fn(Yn(lc(zu(n,1),zu(t,0))),"float32"))}(n,t),i=_n(e,r);return Fn(Zo(Ka(i,0),nr(e,i),0),"float32")})}(n,t)}function rwe(n,t){return s6(n,t)}function iwe(n,t){return TO(n,t)}function swe(n,t){return Y0(n,t)}function owe(n,t){return Y0(n,t)}function awe(n,t){return Y0(n,t)}function uwe(n,t){return yv(n,t)}function lwe(n,t){return yv(n,t)}function cwe(n,t){return yv(n,t)}function hwe(n){return new FO(n)}function fwe(n){return function m0e(n){return S6(n),new FO({l1:null!=n?n.l1:null,l2:0})}(n)}function dwe(n){return function g0e(n){return S6(n),new FO({l2:null!=n?n.l2:null,l1:0})}(n)}class BQ extends X0{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof Jp))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function GO(n,t){return n<t}function VQ(n,t){return n>t}class zQ extends BQ{constructor(t){if(super(),null==t&&(t={}),t.restoreBestWeights)throw new Ur("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.monitorFunc="min"===this.mode?GO:"max"===this.mode||-1!==this.monitor.indexOf("acc")?VQ:GO,this.monitorFunc===GO&&(this.minDelta*=-1)}onTrainBegin(t){var e=this;return(0,Nt.Z)(function*(){e.wait=0,e.stoppedEpoch=0,e.best=null!=e.baseline?e.baseline:e.monitorFunc===GO?1/0:-1/0})()}onEpochEnd(t,e){var r=this;return(0,Nt.Z)(function*(){yield Qp(e);const i=r.getMonitorValue(e);null!=i&&(r.monitorFunc(i-r.minDelta,r.best)?(r.best=i,r.wait=0):(r.wait++,r.wait>=r.patience&&(r.stoppedEpoch=t,r.model.stopTraining=!0)))})()}onTrainEnd(t){var e=this;return(0,Nt.Z)(function*(){e.stoppedEpoch>0&&e.verbose&&console.log(`Epoch ${e.stoppedEpoch}: early stopping.`)})()}getMonitorValue(t){null==t&&(t={});const e=t[this.monitor];return null==e&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(t)}`),e}}const mwe={earlyStopping:function pwe(n){return new zQ(n)}};Ft().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var UQ,Tl=(()=>{return(n=Tl||(Tl={}))[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF",Tl;var n})();!function(n){let t;var e;(e=t=n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(UQ||(UQ={}));const L6={};function gwe(n,t){L6[n]={tfOpName:n,category:"custom",inputs:[],attrs:[],customExecutor:t}}function HQ(n){return L6[n]}function vwe(n){delete L6[n]}function fe(n,t,e,r,i){const s=t.inputParams[n];if(s&&void 0!==s.inputIndexStart){const a=s.inputIndexStart,u=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?a+1:s.inputIndexEnd,d=a<0?t.inputNames.length+a:a;if("tensor"===s.type)return ha(t.inputNames[d],e,r,i);if("tensors"===s.type){const _=t.inputs.slice(a,u);return t.inputNames.slice(a,u).filter((D,O)=>{var R;return"NoOp"!==(null===(R=_[O])||void 0===R?void 0:R.op)}).map(D=>ha(D,e,r,i))}const m=ha(t.inputNames[d],e,r,i),y=m.dataSync();return"number"===s.type?y[0]:yl(m.shape,y)}const o=t.attrParams[n];return o&&o.value}function ha(n,t,e,r){const[i,s]=qu(n,e);if(null!=r){const a=r.getHashTableHandleByName(i);if(null!=a)return a}const o=e.currentContextIds.find(a=>!!t[jO(i,a)]);return void 0!==o?t[jO(i,o)][s]:void 0}function WQ(n,t,e){return t[jO(n,e.currentContextId)]}function fd(n,t){const[e,r,i]=qu(n,t);return[jO(e,t&&t.currentContextId),r,i]}function jO(n,t){return t?`${n}-${t}`:n}function qu(n,t){if(""===n)return["",0,void 0];const e=null!=t&&null!=t.parseNodeNameCache;if(e){const s=t.parseNodeNameCache.get(n);if(null!=s)return s}const r=n.split(":");let i;if(1===r.length)i=[n,0,void 0];else{const o=3===r.length?r[1]:void 0;i=[r[0],Number(r[r.length-1]),o]}return e&&t.parseNodeNameCache.set(n,i),i}function qO(n,t,e){let r=fe("pad",n,t,e);if("explicit"===r){r=fe("explicitPaddings",n,t,e);const i=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)i[s][0]=r[2*s],i[s][1]=r[2*s+1];return i}return r}function dd(n){return n.kept?n:Vh(n)}const ywe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_we=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],bwe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],wwe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],xwe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Cwe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Swe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Ewe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Nwe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Twe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Awe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Iwe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Dwe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],Mwe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],kwe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Rwe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Owe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Fwe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Pwe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class GQ{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[bt,$e,Ne,we,qe,Ye,at,At,Ut,Mt,sn,je,We,tt,Pt,Ue,xt,Vt,Qt].map(r=>r.json));this.opMappers=e.reduce((r,i)=>(r[i.tfOpName]=i,r),{})}transformGraph(t,e={}){const i=[],s=[],o=[],a=t.node.reduce((O,R)=>(O[R.name]=this.mapNode(R),R.op.startsWith("Placeholder")?i.push(O[R.name]):"Const"===R.op?s.push(O[R.name]):(null==R.input||0===R.input.length)&&o.push(O[R.name]),O),{});let u=[];const d=[];let m={},y={};null!=e&&(m=this.mapSignatureEntries(e.inputs),y=this.mapSignatureEntries(e.outputs));const _=Object.keys(a);_.forEach(O=>{const R=a[O];R.inputNames.forEach(($,B)=>{const[Q,,ie]=fd($),ye=a[Q];if(null!=ye.outputs){const Me=ye.outputs.indexOf(ie);-1!==Me&&(R.inputNames[B]=`${Q}:${Me}`)}R.inputs.push(ye),ye.children.push(R)})}),0===Object.keys(y).length?_.forEach(O=>{const R=a[O];0===R.children.length&&d.push(R)}):Object.keys(y).forEach(O=>{const[R]=fd(O),$=a[R];null!=$&&($.signatureKey=y[O],d.push($))}),Object.keys(m).length>0?Object.keys(m).forEach(O=>{const[R]=fd(O),$=a[R];$&&($.signatureKey=m[O],u.push($))}):u=i;let E={};null!=t.library&&null!=t.library.function&&(E=t.library.function.reduce((O,R)=>(O[R.signature.name]=this.mapFunction(R),O),{}));const D={nodes:a,inputs:u,outputs:d,weights:s,placeholders:i,signature:e,functions:E};return o.length>0&&(D.initNodes=o),D}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,r)=>(e[t[r].name]=r,e),{})}mapNode(t){const e=HQ(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const r={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(i=>i.startsWith("^")?i.slice(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(r.inputParams=e.inputs.reduce((i,s)=>(i[s.name]={type:s.type,inputIndexStart:s.start,inputIndexEnd:s.end},i),{})),null!=e.attrs&&(r.attrParams=e.attrs.reduce((i,s)=>{const o=s.type;let a;switch(s.type){case"string":a=$6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=$6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"string[]":a=j6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=j6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number":a=V6(t.attr,s.tfName,s.defaultValue||0),void 0===a&&s.tfDeprecatedName&&(a=V6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"number[]":a=G6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=G6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool":a=B6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=B6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool[]":a=Z6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=Z6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape":a=W6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=W6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape[]":a=q6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=q6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype":a=U6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=U6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype[]":a=H6(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=H6(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"func":a=qQ(t.attr,s.tfName,s.defaultValue),void 0===a&&s.tfDeprecatedName&&(a=qQ(t.attr,s.tfDeprecatedName,s.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${s.type} for op: ${t.op}`)}return i[s.name]={value:a,type:o},i},{})),r}mapFunction(t){const e=t.nodeDef,i=[];let s={};null!=e&&(s=e.reduce((y,_)=>(y[_.name]=this.mapNode(_),"Const"===_.op&&i.push(y[_.name]),y),{}));const o=[],a=[];t.signature.inputArg.forEach(y=>{const[_]=fd(y.name),E={name:_,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:z6(y.type),type:"dtype"}},children:[]};E.signatureKey=y.name,o.push(E),s[_]=E}),Object.keys(s).forEach(y=>{const _=s[y];_.inputNames.forEach((E,D)=>{const[O,,R]=fd(E),$=s[O];if(null!=$.outputs){const B=$.outputs.indexOf(R);-1!==B&&(_.inputNames[D]=`${O}:${B}`)}_.inputs.push($),$.children.push(_)})});const d=t.ret;t.signature.outputArg.forEach(y=>{const[_,E]=fd(d[y.name]),D=s[_];null!=D&&(D.defaultOutput=E,a.push(D))});const m=this.mapArgsToSignature(t);return{nodes:s,inputs:o,outputs:a,weights:i,placeholders:[],signature:m}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((e,r)=>(e[r.name]=this.mapArgToTensorInfo(r),e),{}),outputs:t.signature.outputArg.reduce((e,r)=>(e[r.name]=this.mapArgToTensorInfo(r,t.ret),e),{})}}mapArgToTensorInfo(t,e){let r=t.name;return null!=e&&(r=e[r]),{name:r,dtype:t.type}}}function jQ(n,t){const e=Array.isArray(n)?String.fromCharCode.apply(null,n):function Lwe(n){const t=Ft().global;if(void 0!==t.atob)return t.atob(n);if("undefined"!=typeof Buffer)return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(n);return t?e:e.toLowerCase()}function $6(n,t,e,r=!1){const i=n[t];return null!=i?jQ(i.s,r):e}function B6(n,t,e){const r=n[t];return r?r.b:e}function V6(n,t,e){const r=n[t]||{},i=null!=r.i?r.i:null!=r.f?r.f:e;return"number"==typeof i?i:parseInt(i,10)}function z6(n){switch("string"==typeof n&&(n=Tl[n]),n){case Tl.DT_FLOAT:case Tl.DT_HALF:return"float32";case Tl.DT_INT32:case Tl.DT_INT64:case Tl.DT_INT8:case Tl.DT_UINT8:return"int32";case Tl.DT_BOOL:return"bool";case Tl.DT_DOUBLE:return"float32";case Tl.DT_STRING:return"string";default:return null}}function qQ(n,t,e){const r=n[t];return r&&r.func?r.func.name:e}function U6(n,t,e){const r=n[t];return r&&r.type?z6(r.type):e}function H6(n,t,e){const r=n[t];return r&&r.list&&r.list.type?r.list.type.map(i=>z6(i)):e}function ZQ(n){if(!n.unknownRank)return null!=n.dim?n.dim.map(t=>"number"==typeof t.size?t.size:parseInt(t.size,10)):[]}function W6(n,t,e){const r=n[t];return r&&r.shape?ZQ(r.shape):e}function G6(n,t,e){const r=n[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(i=>"number"==typeof i?i:parseInt(i,10)):e}function j6(n,t,e,r=!1){const i=n[t];return i&&i.list&&i.list.s?i.list.s.map(s=>jQ(s,r)):e}function q6(n,t,e){const r=n[t];return r&&r.list&&r.list.shape?r.list.shape.map(i=>ZQ(i)):e}function Z6(n,t,e){const r=n[t];return r&&r.list&&r.list.b?r.list.b:e}class $we{constructor(t,e,r){this.node=t,this.tensorMap=e,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(i=>this.getInput(i)),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((i,s)=>(i[s]=this.getAttr(s),i),{}))}getInput(t){return ha(t,this.tensorMap,this.context)}getAttr(t,e){const r=this.node.rawAttrs[t];if(null!=r.tensor)return ha(t,this.tensorMap,this.context);if(null!=r.i||null!=r.f)return V6(this.node.rawAttrs,t,e);if(null!=r.s)return $6(this.node.rawAttrs,t,e);if(null!=r.b)return B6(this.node.rawAttrs,t,e);if(null!=r.shape)return W6(this.node.rawAttrs,t,e);if(null!=r.type)return U6(this.node.rawAttrs,t,e);if(null!=r.list){if(null!=r.list.i||null!=r.list.f)return G6(this.node.rawAttrs,t,e);if(null!=r.list.s)return j6(this.node.rawAttrs,t,e);if(null!=r.list.shape)return q6(this.node.rawAttrs,t,e);if(null!=r.list.b)return Z6(this.node.rawAttrs,t,e);if(null!=r.list.type)return H6(this.node.rawAttrs,t,e)}return e}}function mc(n,t,e=""){if("number"!=typeof n&&"number"!=typeof t){De(n.length===t.length,()=>e+` Shapes ${n} and ${t} must match`);for(let r=0;r<n.length;r++){const i=n[r],s=t[r];De(i<0||s<0||i===s,()=>e+` Shapes ${n} and ${t} must match`)}}}function KQ(n){return!("number"==typeof n||n.some(t=>t<0))}function _E(n,t,e){let r=K6(n,e);const i=!KQ(r);if(i&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&t.forEach(s=>{r=K6(s.shape,r)}),!KQ(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function K6(n,t){if("number"==typeof n)return t;if("number"==typeof t)return n;if(n.length!==t.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${t}`);const e=[];for(let r=0;r<n.length;++r){const i=n[r],s=t[r];if(i>=0&&s>=0&&i!==s)throw new Error(`Incompatible shape during merge: ${n} vs. ${t}`);e[r]=i>=0?i:s}return e}class zwe{constructor(t,e,r,i,s,o,a){this.name=t,this.dtype=e,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=s,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=hr(0),Ao(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{(null==t||!t.has(e.tensor.id))&&e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(e=>this.read(e))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0===this.size()&&(null==this.elementShape||0===this.elementShape.length)&&(this.elementShape=e.shape),mc(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);r.tensor=e,Ao(e),r.written=!0,this.tensors[t]=r}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((r,i)=>this.write(r,e[i]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let i=0;i<this.size();i++)t.push(i)}if(0===t.length)return Vu([],[0].concat(this.elementShape));const r=this.readMany(t);return mc(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),yu(r,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return Vu([],[0].concat(this.elementShape));const e=[];for(let i=0;i<this.size();i++)e.push(i);const r=this.readMany(e);return mc(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Js(r,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const r=Math.max(...t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(t,Sl(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let r=0;const i=t.map(u=>(r+=u,r));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const s=0===r?0:e.size/r,o=[];Ot(()=>{e=wt(e,[1,r,s]);for(let u=0;u<t.length;++u)o[u]=wt(ui(e,[0,0===u?0:i[u-1],0],[1,t[u],s]),this.elementShape);return o});const a=[];for(let u=0;u<t.length;u++)a[u]=u;this.writeMany(a,o)}}class bv{get id(){return this.idTensor.id}constructor(t,e,r,i=-1){this.tensors=t,this.elementShape=e,this.elementDtype=r,null!=t&&t.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);mc(e,s.shape,"TensorList shape mismatch: "),Ao(s)}),this.idTensor=hr(0),this.maxNumElements=i,Ao(this.idTensor)}copy(){return new bv([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{(null==t||!t.has(e.id))&&e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,r=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(-1!==r&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);mc(t,this.elementShape,"TensorList shape mismatch: ");const i=_E(this.elementShape,this.tensors,t);return Ot(()=>{const s=this.tensors.map(o=>wt(o,i));return yu(s,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const r=_E(this.elementShape,this.tensors,t),i=this.tensors.pop();return i.kept=!1,mc(i.shape,t,"TensorList shape mismatch: "),wt(i,r)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(mc(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Ao(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const e=new bv([],this.elementShape,this.elementDtype,this.maxNumElements);e.tensors.length=t;for(let r=0;r<Math.min(this.tensors.length,t);++r)e.tensors[r]=this.tensors[r];return e}getItem(t,e,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[t])throw new Error(`element at index ${t} is null.`);mc(this.tensors[t].shape,e,"TensorList shape mismatch: ");const i=_E(this.elementShape,this.tensors,e);return wt(this.tensors[t],i)}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);mc(this.elementShape,e.shape,"TensorList shape mismatch: "),Ao(e),null!=this.tensors[t]&&(this.tensors[t].kept=!1),this.tensors[t]=e}gather(t,e,r){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);mc(this.elementShape,r,"TensorList shape mismatch: "),t=t.slice(0,this.size());const i=_E(this.elementShape,this.tensors,r);return 0===t.length?Vu([],[0].concat(i)):Ot(()=>{const s=t.map(o=>wt(this.tensors[o],i));return yu(s,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);mc(this.elementShape,e,"TensorList shape mismatch: ");const r=_E(this.elementShape,this.tensors,e);return 0===this.size()?Vu([],[0].concat(r)):Ot(()=>{const i=this.tensors.map(s=>wt(s,r));return Js(i,0)})}}const jwe=function(){var n=(0,Nt.Z)(function*(t,e,r){switch(t.op){case"If":case"StatelessIf":{const i=fe("thenBranch",t,e,r),s=fe("elseBranch",t,e,r),o=fe("cond",t,e,r),a=fe("args",t,e,r);return(yield o.data())[0]?r.functionMap[i].executeFunctionAsync(a,r.tensorArrayMap,r.tensorListMap):r.functionMap[s].executeFunctionAsync(a,r.tensorArrayMap,r.tensorListMap)}case"While":case"StatelessWhile":{const i=fe("body",t,e,r),s=fe("cond",t,e,r),o=fe("args",t,e,r),a=yield r.functionMap[s].executeFunctionAsync(o,r.tensorArrayMap,r.tensorListMap),u=o.map(y=>y.id);let d=yield a[0].data();a.forEach(y=>{!y.kept&&-1===u.indexOf(y.id)&&y.dispose()});let m=o;for(;d[0];){const y=m;m=yield r.functionMap[i].executeFunctionAsync(m,r.tensorArrayMap,r.tensorListMap);const _=m.map(D=>D.id);y.forEach(D=>{!D.kept&&-1===u.indexOf(D.id)&&-1===_.indexOf(D.id)&&D.dispose()});const E=yield r.functionMap[s].executeFunctionAsync(m,r.tensorArrayMap,r.tensorListMap);d=yield E[0].data(),E.forEach(D=>{!D.kept&&-1===u.indexOf(D.id)&&-1===_.indexOf(D.id)&&D.dispose()})}return m}case"LoopCond":return[dd(fe("pred",t,e,r))];case"Switch":{const i=fe("pred",t,e,r);let s=fe("data",t,e,r);return s.kept||(s=dd(s)),(yield i.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const i=t.inputNames.find(s=>void 0!==ha(s,e,r));return i?[dd(ha(i,e,r))]:void 0}case"Enter":{const i=fe("frameName",t,e,r),s=fe("tensor",t,e,r);return r.enterFrame(i),[dd(s)]}case"Exit":{const i=fe("tensor",t,e,r);return r.exitFrame(),[dd(i)]}case"NextIteration":{const i=fe("tensor",t,e,r);return r.nextIteration(),[dd(i)]}case"TensorArrayV3":{const i=fe("size",t,e,r),s=fe("dtype",t,e,r),o=fe("elementShape",t,e,r),a=fe("dynamicSize",t,e,r),u=fe("clearAfterRead",t,e,r),d=fe("identicalElementShapes",t,e,r),m=fe("name",t,e,r),y=new zwe(m,s,i,o,d,a,u);return r.addTensorArray(y),[y.idTensor,hr(1)]}case"TensorArrayWriteV3":{const i=fe("tensorArrayId",t,e,r),s=fe("index",t,e,r),o=fe("tensor",t,e,r),a=r.getTensorArray(i.id);return a.write(s,o),[a.idTensor]}case"TensorArrayReadV3":{const i=fe("tensorArrayId",t,e,r),s=fe("index",t,e,r);return[r.getTensorArray(i.id).read(s)]}case"TensorArrayGatherV3":{const i=fe("tensorArrayId",t,e,r),s=fe("indices",t,e,r),o=fe("dtype",t,e,r);return[r.getTensorArray(i.id).gather(s,o)]}case"TensorArrayScatterV3":{const i=fe("tensorArrayId",t,e,r),s=fe("indices",t,e,r),o=fe("tensor",t,e,r),a=r.getTensorArray(i.id);return a.scatter(s,o),[a.idTensor]}case"TensorArrayConcatV3":{const i=fe("tensorArrayId",t,e,r),s=r.getTensorArray(i.id),o=fe("dtype",t,e,r);return[s.concat(o)]}case"TensorArraySplitV3":{const i=fe("tensorArrayId",t,e,r),s=fe("tensor",t,e,r),o=fe("lengths",t,e,r),a=r.getTensorArray(i.id);return a.split(o,s),[a.idTensor]}case"TensorArraySizeV3":{const i=fe("tensorArrayId",t,e,r);return[hr(r.getTensorArray(i.id).size(),"int32")]}case"TensorArrayCloseV3":{const i=fe("tensorArrayId",t,e,r),s=r.getTensorArray(i.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const i=fe("tensorListId",t,e,r),s=fe("index",t,e,r),o=fe("tensor",t,e,r),a=r.getTensorList(i.id);return a.setItem(s,o),[a.idTensor]}case"TensorListGetItem":{const i=fe("tensorListId",t,e,r),s=fe("index",t,e,r),o=fe("elementShape",t,e,r),a=fe("elementDType",t,e,r);return[r.getTensorList(i.id).getItem(s,o,a)]}case"TensorListScatterV2":case"TensorListScatter":{const i=fe("indices",t,e,r),u=function Wwe(n,t,e,r){if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const i=Math.max(...t);if(null!=r&&-1!==r&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const s=new bv([],e,n.dtype,r),o=Sl(n,0);return t.forEach((a,u)=>{s.setItem(a,o[u])}),s}(fe("tensor",t,e,r),i,fe("elementShape",t,e,r),fe("numElements",t,e,r));return r.addTensorList(u),[u.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const i=fe("elementShape",t,e,r),s=fe("elementDType",t,e,r);let o;o="TensorListReserve"===t.op?"numElements":"maxNumElements";const a=fe(o,t,e,r),d=function Hwe(n,t,e,r){return new bv([],n,t,r)}(i,s,0,"TensorListReserve"===t.op?-1:a);return r.addTensorList(d),[d.idTensor]}case"TensorListGather":{const i=fe("tensorListId",t,e,r),s=fe("indices",t,e,r),o=fe("elementShape",t,e,r),a=fe("elementDType",t,e,r);return[r.getTensorList(i.id).gather(s,a,o)]}case"TensorListStack":{const i=fe("tensorListId",t,e,r),s=fe("elementShape",t,e,r),o=fe("elementDType",t,e,r),a=fe("numElements",t,e,r);return[r.getTensorList(i.id).stack(s,o,a)]}case"TensorListFromTensor":{const a=function Uwe(n,t,e){const r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==e)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${e}`);mc(n.shape.slice(1),t,"TensorList shape mismatch: ");const s=Sl(n);return new bv(s,t,r)}(fe("tensor",t,e,r),fe("elementShape",t,e,r),fe("elementDType",t,e,r));return r.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const i=fe("tensorListId",t,e,r),s=r.getTensorList(i.id),o=fe("dtype",t,e,r),a=fe("elementShape",t,e,r);return[s.concat(o,a)]}case"TensorListPushBack":{const i=fe("tensorListId",t,e,r),s=fe("tensor",t,e,r),o=r.getTensorList(i.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const i=fe("tensorListId",t,e,r),s=fe("elementShape",t,e,r),o=fe("elementDType",t,e,r);return[r.getTensorList(i.id).popBack(s,o)]}case"TensorListSplit":{const i=fe("tensor",t,e,r),s=fe("elementShape",t,e,r),a=function Gwe(n,t,e){let r=0;const i=t.map(m=>(r+=m,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${n.shape}`);const o=K6(n.shape.slice(1),e),a=0===r?0:n.size/r,u=Ot(()=>{const m=[];n=wt(n,[1,r,a]);for(let y=0;y<t.length;++y)m[y]=wt(ui(n,[0,0===y?0:i[y-1],0],[1,t[y],a]),o);return n.dispose(),m}),d=new bv([],e,n.dtype,t.length);for(let m=0;m<u.length;m++)d.setItem(m,u[m]);return d}(i,fe("lengths",t,e,r),s);return r.addTensorList(a),[a.idTensor]}case"TensorListLength":{const i=fe("tensorListId",t,e,r);return[hr(r.getTensorList(i.id).size(),"int32")]}case"TensorListResize":{const i=fe("tensorListId",t,e,r),s=fe("size",t,e,r),a=r.getTensorList(i.id).resize(s);return r.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}});return function(e,r,i){return n.apply(this,arguments)}}();function XQ(n,t,e){const[r,i]=fe("fusedOps",n,t,e),s="biasadd"===r,o=!s,a="prelu"===i,u="fusedbatchnorm"===r,d=fe("numArgs",n,t,e);if(s){if(a&&2!==d)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&s&&1!==d)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const m=fe("strides",n,t,e),y=qO(n,t,e),_=fe("dataFormat",n,t,e).toUpperCase(),E=fe("dilations",n,t,e);let[D,O]=fe("args",n,t,e);return o&&(O=D,D=void 0),{stride:m,pad:y,dataFormat:_,dilations:E,biasArg:D,preluArg:O,activationFunc:i,leakyreluAlpha:fe("leakyreluAlpha",n,t,e)}}function X6(n,t,e){return{boxes:fe("boxes",n,t,e),scores:fe("scores",n,t,e),maxOutputSize:fe("maxOutputSize",n,t,e),iouThreshold:fe("iouThreshold",n,t,e),scoreThreshold:fe("scoreThreshold",n,t,e),softNmsSigma:fe("softNmsSigma",n,t,e)}}const Kwe=function(){var n=(0,Nt.Z)(function*(t,e,r,i,s=rn){switch(t.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:a,maxOutputSize:u,iouThreshold:d,scoreThreshold:m,softNmsSigma:y}=X6(t,e,r),_=yield s.image.nonMaxSuppressionWithScoreAsync(o,a,u,d,m,y);return[_.selectedIndices,_.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:a,maxOutputSize:u,iouThreshold:d,scoreThreshold:m}=X6(t,e,r),y=fe("padToMaxOutputSize",t,e,r),_=yield s.image.nonMaxSuppressionPaddedAsync(o,a,u,d,m,y);return[_.selectedIndices,_.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:a,maxOutputSize:u,iouThreshold:d,scoreThreshold:m}=X6(t,e,r);return[yield s.image.nonMaxSuppressionAsync(o,a,u,d,m)]}case"Where":{const o=s.cast(fe("condition",t,e,r),"bool"),a=[yield s.whereAsync(o)];return o.dispose(),a}case"ListDiff":return s.setdiff1dAsync(fe("x",t,e,r),fe("y",t,e,r));default:throw TypeError(`Node type ${t.op} is not implemented`)}});return function(e,r,i,s){return n.apply(this,arguments)}}();class Qwe{get id(){return this.handle.id}constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=hr(0),this.tensorMap=new Map,Ao(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return hr(this.size(),"int32")}import(t,e){var r=this;return(0,Nt.Z)(function*(){r.checkKeyAndValueTensor(t,e);const i=yield t.data();return r.tensorMap.forEach(s=>s.dispose()),r.tensorMap.clear(),Ot(()=>{const s=Sl(e),o=i.length,a=s.length;De(o===a,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${a} elements.`);for(let u=0;u<o;u++){const d=i[u],m=s[u];Ao(m),r.tensorMap.set(d,m)}return r.handle})})()}find(t,e){var r=this;return(0,Nt.Z)(function*(){r.checkKeyAndValueTensor(t,e);const i=yield t.data();return Ot(()=>{const s=[];for(let o=0;o<i.length;o++){const u=r.findWithDefault(i[o],e);s.push(u)}return yu(s)})})()}findWithDefault(t,e){const r=this.tensorMap.get(t);return null!=r?r:e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${e.dtype}`)}}const Jwe=function(){var n=(0,Nt.Z)(function*(t,e,r,i){switch(t.op){case"HashTable":case"HashTableV2":{const s=i.getHashTableHandleByName(t.name);if(null!=s)return[s];{const o=fe("keyDType",t,e,r),a=fe("valueDType",t,e,r),u=new Qwe(o,a);return i.addHashTable(t.name,u),[u.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=fe("tableHandle",t,e,r,i),o=fe("keys",t,e,r),a=fe("values",t,e,r);return[yield i.getHashTableById(s.id).import(o,a)]}case"LookupTableFind":case"LookupTableFindV2":{const s=fe("tableHandle",t,e,r,i),o=fe("keys",t,e,r),a=fe("defaultValue",t,e,r);return[yield i.getHashTableById(s.id).find(o,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=fe("tableHandle",t,e,r,i);return[i.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}});return function(e,r,i,s){return n.apply(this,arguments)}}();function YQ(n,t,e,r,i=Ot){const s=((o,a,u)=>{switch(o.category){case"arithmetic":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(fe("a",n,t,e),fe("b",n,t,e))];case"AddN":return[r.addN(fe("tensors",n,t,e))];case"FloorMod":case"Mod":return[r.mod(fe("a",n,t,e),fe("b",n,t,e))];case"Mul":return[r.mul(fe("a",n,t,e),fe("b",n,t,e))];case"RealDiv":case"Div":return[r.div(fe("a",n,t,e),fe("b",n,t,e))];case"DivNoNan":return[r.divNoNan(fe("a",n,t,e),fe("b",n,t,e))];case"FloorDiv":return[r.floorDiv(fe("a",n,t,e),fe("b",n,t,e))];case"Sub":return[r.sub(fe("a",n,t,e),fe("b",n,t,e))];case"Minimum":return[r.minimum(fe("a",n,t,e),fe("b",n,t,e))];case"Maximum":return[r.maximum(fe("a",n,t,e),fe("b",n,t,e))];case"Pow":return[r.pow(fe("a",n,t,e),fe("b",n,t,e))];case"SquaredDifference":return[r.squaredDifference(fe("a",n,t,e),fe("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"basic_math":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"Abs":case"ComplexAbs":return[r.abs(fe("x",n,t,e))];case"Acos":return[r.acos(fe("x",n,t,e))];case"Acosh":return[r.acosh(fe("x",n,t,e))];case"Asin":return[r.asin(fe("x",n,t,e))];case"Asinh":return[r.asinh(fe("x",n,t,e))];case"Atan":return[r.atan(fe("x",n,t,e))];case"Atan2":return[r.atan2(fe("x",n,t,e),fe("y",n,t,e))];case"Atanh":return[r.atanh(fe("x",n,t,e))];case"Ceil":return[r.ceil(fe("x",n,t,e))];case"Complex":return[r.complex(fe("real",n,t,e),fe("imag",n,t,e))];case"Cos":return[r.cos(fe("x",n,t,e))];case"Cosh":return[r.cosh(fe("x",n,t,e))];case"Elu":return[r.elu(fe("x",n,t,e))];case"Erf":return[r.erf(fe("x",n,t,e))];case"Exp":return[r.exp(fe("x",n,t,e))];case"Expm1":return[r.expm1(fe("x",n,t,e))];case"Floor":return[r.floor(fe("x",n,t,e))];case"Log":return[r.log(fe("x",n,t,e))];case"Log1p":return[r.log1p(fe("x",n,t,e))];case"Imag":return[r.imag(fe("x",n,t,e))];case"Neg":return[r.neg(fe("x",n,t,e))];case"Reciprocal":return[r.reciprocal(fe("x",n,t,e))];case"Real":return[r.real(fe("x",n,t,e))];case"Relu":return[r.relu(fe("x",n,t,e))];case"Round":return[r.round(fe("x",n,t,e))];case"Selu":return[r.selu(fe("x",n,t,e))];case"Sigmoid":return[r.sigmoid(fe("x",n,t,e))];case"Sin":return[r.sin(fe("x",n,t,e))];case"Sign":return[r.sign(fe("x",n,t,e))];case"Sinh":return[r.sinh(fe("x",n,t,e))];case"Softplus":return[r.softplus(fe("x",n,t,e))];case"Sqrt":return[r.sqrt(fe("x",n,t,e))];case"Square":return[r.square(fe("x",n,t,e))];case"Tanh":return[r.tanh(fe("x",n,t,e))];case"Tan":return[r.tan(fe("x",n,t,e))];case"ClipByValue":return[r.clipByValue(fe("x",n,t,e),fe("clipValueMin",n,t,e),fe("clipValueMax",n,t,e))];case"Relu6":return[r.relu6(fe("x",n,t,e))];case"Rsqrt":return[r.rsqrt(ha(n.inputNames[0],t,e))];case"Prod":return[r.prod(fe("x",n,t,e),fe("axes",n,t,e))];case"LeakyRelu":return[r.leakyRelu(fe("x",n,t,e),fe("alpha",n,t,e))];case"Prelu":return[r.prelu(fe("x",n,t,e),fe("alpha",n,t,e))];case"IsNan":return[r.isNaN(ha(n.inputNames[0],t,e))];case"IsInf":return[r.isInf(ha(n.inputNames[0],t,e))];case"IsFinite":return[r.isFinite(ha(n.inputNames[0],t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"control":return jwe(o,a,u);case"convolution":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"Conv1D":{const i=fe("stride",n,t,e),s=fe("pad",n,t,e),o=fe("dataFormat",n,t,e).toUpperCase(),a=fe("dilation",n,t,e);return[r.conv1d(fe("x",n,t,e),fe("filter",n,t,e),i,s,o,a)]}case"Conv2D":{const i=fe("strides",n,t,e),s=qO(n,t,e),o=fe("dataFormat",n,t,e).toUpperCase(),a=fe("dilations",n,t,e);return[r.conv2d(fe("x",n,t,e),fe("filter",n,t,e),[i[1],i[2]],s,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:i,pad:s,dataFormat:o,dilations:a,biasArg:u,preluArg:d,activationFunc:m,leakyreluAlpha:y}=XQ(n,t,e);return[r.fused.conv2d({x:fe("x",n,t,e),filter:fe("filter",n,t,e),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:u,activation:m,preluActivationWeights:d,leakyreluAlpha:y})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:s,dataFormat:o,dilations:a,biasArg:u,preluArg:d,activationFunc:m,leakyreluAlpha:y}=XQ(n,t,e);return[r.fused.depthwiseConv2d({x:fe("x",n,t,e),filter:fe("filter",n,t,e),strides:[i[1],i[2]],pad:s,dataFormat:o,dilations:[a[1],a[2]],bias:u,activation:m,preluActivationWeights:d,leakyreluAlpha:y})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=fe("outputShape",n,t,e),s=fe("strides",n,t,e),o=qO(n,t,e);return[r.conv2dTranspose(fe("x",n,t,e),fe("filter",n,t,e),i,[s[1],s[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=fe("strides",n,t,e),s=qO(n,t,e),o=fe("dilations",n,t,e),a=fe("dataFormat",n,t,e).toUpperCase();return[r.depthwiseConv2d(fe("input",n,t,e),fe("filter",n,t,e),[i[1],i[2]],s,a,[o[1],o[2]])]}case"Conv3D":{const i=fe("strides",n,t,e),s=fe("pad",n,t,e),o=fe("dataFormat",n,t,e).toUpperCase(),a=fe("dilations",n,t,e);return[r.conv3d(fe("x",n,t,e),fe("filter",n,t,e),[i[1],i[2],i[3]],s,o,[a[1],a[2],a[3]])]}case"AvgPool":{const i=fe("strides",n,t,e),s=fe("pad",n,t,e),o=fe("kernelSize",n,t,e);return[r.avgPool(fe("x",n,t,e),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPool":{const i=fe("strides",n,t,e),s=fe("pad",n,t,e),o=fe("kernelSize",n,t,e);return[r.maxPool(fe("x",n,t,e),[o[1],o[2]],[i[1],i[2]],s)]}case"MaxPoolWithArgmax":{const i=fe("strides",n,t,e),s=fe("pad",n,t,e),o=fe("kernelSize",n,t,e),a=fe("includeBatchInIndex",n,t,e),{result:u,indexes:d}=r.maxPoolWithArgmax(fe("x",n,t,e),[o[1],o[2]],[i[1],i[2]],s,a);return[u,d]}case"AvgPool3D":{const i=fe("strides",n,t,e),s=fe("pad",n,t,e),o=fe("kernelSize",n,t,e);return[r.avgPool3d(fe("x",n,t,e),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"MaxPool3D":{const i=fe("strides",n,t,e),s=fe("pad",n,t,e),o=fe("kernelSize",n,t,e);return[r.maxPool3d(fe("x",n,t,e),[o[1],o[2],o[3]],[i[1],i[2],i[3]],s)]}case"Dilation2D":{const i=fe("strides",n,t,e),s=fe("pad",n,t,e),o=fe("dilations",n,t,e),a=i[1],u=i[2],d=o[1],m=o[2];return[r.dilation2d(fe("x",n,t,e),fe("filter",n,t,e),[a,u],s,[d,m],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"creation":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"Fill":{const i=fe("shape",n,t,e),s=fe("dtype",n,t,e),o=fe("value",n,t,e);return[r.fill(i,o,s)]}case"LinSpace":{const i=fe("start",n,t,e),s=fe("stop",n,t,e),o=fe("num",n,t,e);return[r.linspace(i,s,o)]}case"Multinomial":{const i=fe("logits",n,t,e),s=fe("numSamples",n,t,e),o=fe("seed",n,t,e);return[r.multinomial(i,s,o)]}case"OneHot":{const i=fe("indices",n,t,e),s=fe("depth",n,t,e),o=fe("onValue",n,t,e),a=fe("offValue",n,t,e),u=fe("dtype",n,t,e);return[r.oneHot(i,s,o,a,u)]}case"Ones":return[r.ones(fe("shape",n,t,e),fe("dtype",n,t,e))];case"OnesLike":return[r.onesLike(fe("x",n,t,e))];case"RandomStandardNormal":return[r.randomStandardNormal(fe("shape",n,t,e),fe("dtype",n,t,e),fe("seed",n,t,e))];case"RandomUniform":return[r.randomUniform(fe("shape",n,t,e),fe("minval",n,t,e),fe("maxval",n,t,e),fe("dtype",n,t,e))];case"Range":{const i=fe("start",n,t,e),s=fe("stop",n,t,e),o=fe("step",n,t,e);return[r.range(i,s,o,fe("dtype",n,t,e))]}case"TruncatedNormal":{const i=fe("shape",n,t,e),s=fe("mean",n,t,e),o=fe("stdDev",n,t,e),a=fe("seed",n,t,e);return[r.truncatedNormal(i,s,o,fe("dtype",n,t,e),a)]}case"Zeros":return[r.zeros(fe("shape",n,t,e),fe("dtype",n,t,e))];case"ZerosLike":return[r.zerosLike(fe("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"dynamic":return Kwe(o,a,u);case"evaluation":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"LowerBound":{const i=fe("sortedSequence",n,t,e),s=fe("values",n,t,e);return[r.lowerBound(i,s)]}case"TopKV2":{const i=fe("x",n,t,e),s=fe("k",n,t,e),o=fe("sorted",n,t,e),a=r.topk(i,s,o);return[a.values,a.indices]}case"UpperBound":{const i=fe("sortedSequence",n,t,e),s=fe("values",n,t,e);return[r.upperBound(i,s)]}case"Unique":{const i=fe("x",n,t,e),s=r.unique(i);return[s.values,s.indices]}case"UniqueV2":{const i=fe("x",n,t,e),s=fe("axis",n,t,e),o=r.unique(i,s);return[o.values,o.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"image":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"ResizeBilinear":{const i=fe("images",n,t,e),s=fe("size",n,t,e),o=fe("alignCorners",n,t,e),a=fe("halfPixelCenters",n,t,e);return[r.image.resizeBilinear(i,[s[0],s[1]],o,a)]}case"ResizeNearestNeighbor":{const i=fe("images",n,t,e),s=fe("size",n,t,e),o=fe("alignCorners",n,t,e),a=fe("halfPixelCenters",n,t,e);return[r.image.resizeNearestNeighbor(i,[s[0],s[1]],o,a)]}case"CropAndResize":{const i=fe("image",n,t,e),s=fe("boxes",n,t,e),o=fe("boxInd",n,t,e),a=fe("cropSize",n,t,e),u=fe("method",n,t,e),d=fe("extrapolationValue",n,t,e);return[r.image.cropAndResize(i,s,o,a,u,d)]}case"ImageProjectiveTransformV3":{const i=fe("images",n,t,e),s=fe("transforms",n,t,e),o=fe("outputShape",n,t,e),a=fe("fillValue",n,t,e),u=fe("interpolation",n,t,e),d=fe("fillMode",n,t,e);return[r.image.transform(i,s,u.toLowerCase(),d.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"graph":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"Const":return t[n.name];case"PlaceholderWithDefault":const i=fe("default",n,t,e);return[ha(n.name,t,e)||i];case"Placeholder":return[ha(n.name,t,e)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[dd(fe("x",n,t,e))];case"IdentityN":return fe("x",n,t,e).map(m=>dd(m));case"Shape":return[r.tensor1d(fe("x",n,t,e).shape,"int32")];case"ShapeN":return fe("x",n,t,e).map(m=>r.tensor1d(m.shape));case"Size":return[r.scalar(fe("x",n,t,e).size,"int32")];case"Rank":return[r.scalar(fe("x",n,t,e).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=fe("x",n,t,e),a=fe("data",n,t,e),u=fe("message",n,t,e),d=fe("summarize",n,t,e);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let m=0;m<a.length;m++)console.log(Array.prototype.slice.call(a[m].dataSync()).slice(0,d));return[o];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"logical":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"Equal":return[r.equal(fe("a",n,t,e),fe("b",n,t,e))];case"NotEqual":return[r.notEqual(fe("a",n,t,e),fe("b",n,t,e))];case"Greater":return[r.greater(fe("a",n,t,e),fe("b",n,t,e))];case"GreaterEqual":return[r.greaterEqual(fe("a",n,t,e),fe("b",n,t,e))];case"Less":return[r.less(fe("a",n,t,e),fe("b",n,t,e))];case"LessEqual":return[r.lessEqual(fe("a",n,t,e),fe("b",n,t,e))];case"LogicalAnd":return[r.logicalAnd(fe("a",n,t,e),fe("b",n,t,e))];case"LogicalNot":return[r.logicalNot(fe("a",n,t,e))];case"LogicalOr":return[r.logicalOr(fe("a",n,t,e),fe("b",n,t,e))];case"Select":case"SelectV2":return[r.where(fe("condition",n,t,e),fe("a",n,t,e),fe("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"matrices":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(fe("a",n,t,e),fe("b",n,t,e),fe("transposeA",n,t,e),fe("transposeB",n,t,e))];case"Einsum":return[r.einsum(fe("equation",n,t,e),...fe("tensors",n,t,e))];case"Transpose":return[r.transpose(fe("x",n,t,e),fe("perm",n,t,e))];case"_FusedMatMul":const[i,s]=fe("fusedOps",n,t,e),o="biasadd"===i,a="prelu"===s,u=fe("numArgs",n,t,e),d=fe("leakyreluAlpha",n,t,e);if(o){if(a&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[m,y]=fe("args",n,t,e);return[r.fused.matMul({a:fe("a",n,t,e),b:fe("b",n,t,e),transposeA:fe("transposeA",n,t,e),transposeB:fe("transposeB",n,t,e),bias:m,activation:s,preluActivationWeights:y,leakyreluAlpha:d})];case"MatrixBandPart":return[r.linalg.bandPart(fe("a",n,t,e),fe("numLower",n,t,e),fe("numUpper",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"normalization":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"EuclideanNorm":return[r.euclideanNorm(fe("x",n,t,e),fe("axis",n,t,e),fe("keepDims",n,t,e))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(fe("x",n,t,e),fe("mean",n,t,e),fe("variance",n,t,e),fe("offset",n,t,e),fe("scale",n,t,e),fe("epsilon",n,t,e))];case"LRN":return[r.localResponseNormalization(fe("x",n,t,e),fe("radius",n,t,e),fe("bias",n,t,e),fe("alpha",n,t,e),fe("beta",n,t,e))];case"Softmax":return[r.softmax(fe("x",n,t,e))];case"LogSoftmax":return[r.logSoftmax(fe("x",n,t,e))];case"SparseToDense":return[r.sparseToDense(fe("sparseIndices",n,t,e),fe("outputShape",n,t,e),fe("sparseValues",n,t,e),fe("defaultValue",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"ragged":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:s}=r.raggedGather(fe("paramsNestedSplits",n,t,e),fe("paramsDenseValues",n,t,e),fe("indices",n,t,e),fe("outputRaggedRank",n,t,e));return i.concat(s)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:s}=r.raggedRange(fe("starts",n,t,e),fe("limits",n,t,e),fe("splits",n,t,e));return[i,s]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(fe("shape",n,t,e),fe("values",n,t,e),fe("defaultValue",n,t,e),fe("rowPartitionTensors",n,t,e),fe("rowPartitionTypes",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"reduction":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"Max":{const a=fe("axis",n,t,e),u=fe("keepDims",n,t,e);return[r.max(fe("x",n,t,e),a,u)]}case"Mean":{const a=fe("axis",n,t,e),u=fe("keepDims",n,t,e);return[r.mean(fe("x",n,t,e),a,u)]}case"Min":{const a=fe("axis",n,t,e),u=fe("keepDims",n,t,e);return[r.min(fe("x",n,t,e),a,u)]}case"Sum":{const a=fe("axis",n,t,e),u=fe("keepDims",n,t,e);return[r.sum(fe("x",n,t,e),a,u)]}case"All":{const a=fe("axis",n,t,e),u=fe("keepDims",n,t,e);return[r.all(fe("x",n,t,e),a,u)]}case"Any":{const a=fe("axis",n,t,e),u=fe("keepDims",n,t,e);return[r.any(fe("x",n,t,e),a,u)]}case"ArgMax":{const a=fe("axis",n,t,e);return[r.argMax(fe("x",n,t,e),a)]}case"ArgMin":{const a=fe("axis",n,t,e);return[r.argMin(fe("x",n,t,e),a)]}case"Prod":{const a=fe("axis",n,t,e),u=fe("keepDims",n,t,e);return[r.prod(fe("x",n,t,e),a,u)]}case"Cumprod":{const a=fe("axis",n,t,e),u=fe("exclusive",n,t,e),d=fe("reverse",n,t,e);return[r.cumprod(fe("x",n,t,e),a,u,d)]}case"Cumsum":{const a=fe("axis",n,t,e),u=fe("exclusive",n,t,e),d=fe("reverse",n,t,e);return[r.cumsum(fe("x",n,t,e),a,u,d)]}case"Bincount":const i=fe("x",n,t,e),s=fe("weights",n,t,e),o=fe("size",n,t,e);return[r.bincount(i,s,o)];case"DenseBincount":{const a=fe("x",n,t,e),u=fe("weights",n,t,e),d=fe("size",n,t,e),m=fe("binaryOutput",n,t,e);return[r.denseBincount(a,u,d,m)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"slice_join":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"ConcatV2":case"Concat":{const i=fe("n",n,t,e),s=fe("axis",n,t,e);let o=fe("tensors",n,t,e);return o=o.slice(0,i),[r.concat(o,s)]}case"Gather":{const i=fe("x",n,t,e),s=fe("indices",n,t,e);return[r.gather(i,r.cast(s,"int32"),0)]}case"GatherV2":{const i=fe("axis",n,t,e),s=fe("batchDims",n,t,e),o=fe("x",n,t,e),a=fe("indices",n,t,e);return[r.gather(o,r.cast(a,"int32"),i,s)]}case"Reverse":{const i=fe("dims",n,t,e),s=[];for(let a=0;a<i.length;a++)i[a]&&s.push(a);const o=fe("x",n,t,e);return[r.reverse(o,s)]}case"ReverseV2":{const i=fe("axis",n,t,e),s=fe("x",n,t,e);return[r.reverse(s,i)]}case"Slice":{const i=fe("begin",n,t,e),s=fe("size",n,t,e);return[r.slice(fe("x",n,t,e),i,s)]}case"StridedSlice":{const i=fe("begin",n,t,e),s=fe("end",n,t,e),o=fe("strides",n,t,e),a=fe("beginMask",n,t,e),u=fe("endMask",n,t,e),d=fe("ellipsisMask",n,t,e),m=fe("newAxisMask",n,t,e),y=fe("shrinkAxisMask",n,t,e),_=fe("x",n,t,e);return[r.stridedSlice(_,i,s,o,a,u,d,m,y)]}case"Pack":return Ot(()=>{const i=fe("axis",n,t,e),s=fe("tensors",n,t,e),o=s[0].shape,a=r.squeeze(s[0]).shape,u=s.map(d=>{const m=ri(d.shape,o);if(!m&&!ri(r.squeeze(d).shape,a))throw new Error("the input tensors shape does not match");return m?d:r.reshape(d,o)});return[r.stack(u,i)]});case"Unpack":{const i=fe("axis",n,t,e),s=fe("tensor",n,t,e);return r.unstack(s,i)}case"Tile":{const i=fe("reps",n,t,e);return[r.tile(fe("x",n,t,e),i)]}case"Split":case"SplitV":{const i=fe("axis",n,t,e),s=fe("numOrSizeSplits",n,t,e),o=fe("x",n,t,e);return r.split(o,s,i)}case"ScatterNd":{const i=fe("indices",n,t,e),s=fe("values",n,t,e),o=fe("shape",n,t,e);return[r.scatterND(i,s,o)]}case"GatherNd":{const i=fe("x",n,t,e),s=fe("indices",n,t,e);return[r.gatherND(i,s)]}case"SparseToDense":{const i=fe("sparseIndices",n,t,e),s=fe("outputShape",n,t,e),o=fe("sparseValues",n,t,e),a=fe("defaultValue",n,t,e);return[r.sparseToDense(i,o,s,o.dtype===a.dtype?a:r.cast(a,o.dtype))]}case"TensorScatterUpdate":{const i=fe("indices",n,t,e),s=fe("values",n,t,e),o=fe("tensor",n,t,e);return[r.tensorScatterUpdate(o,i,s)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"sparse":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:s,emptyRowIndicator:o,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows(fe("indices",n,t,e),fe("values",n,t,e),fe("denseShape",n,t,e),fe("defaultValue",n,t,e));return[i,s,o,a]}case"SparseReshape":{const{outputIndices:i,outputShape:s}=r.sparse.sparseReshape(fe("inputIndices",n,t,e),fe("inputShape",n,t,e),fe("newShape",n,t,e));return[i,s]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(fe("data",n,t,e),fe("indices",n,t,e),fe("segmentIds",n,t,e))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(fe("data",n,t,e),fe("indices",n,t,e),fe("segmentIds",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"spectral":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"FFT":return[r.fft(fe("x",n,t,e))];case"IFFT":return[r.ifft(fe("x",n,t,e))];case"RFFT":return[r.rfft(fe("x",n,t,e))];case"IRFFT":return[r.irfft(fe("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"string":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(fe("input",n,t,e),fe("pattern",n,t,e),fe("rewrite",n,t,e),fe("replaceGlobal",n,t,e))];case"StringNGrams":{const{nGrams:i,nGramsSplits:s}=r.string.stringNGrams(fe("data",n,t,e),fe("dataSplits",n,t,e),fe("separator",n,t,e),fe("nGramWidths",n,t,e),fe("leftPad",n,t,e),fe("rightPad",n,t,e),fe("padWidth",n,t,e),fe("preserveShortSequences",n,t,e));return[i,s]}case"StringSplit":{const{indices:i,values:s,shape:o}=r.string.stringSplit(fe("input",n,t,e),fe("delimiter",n,t,e),fe("skipEmpty",n,t,e));return[i,s,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(fe("input",n,t,e),fe("numBuckets",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"transformation":return i(()=>((n,t,e,r=rn)=>{switch(n.op){case"Cast":return[r.cast(fe("x",n,t,e),fe("dtype",n,t,e))];case"ExpandDims":{const i=fe("axis",n,t,e);return[r.expandDims(fe("x",n,t,e),i)]}case"Squeeze":{const i=fe("axis",n,t,e);return[r.squeeze(fe("x",n,t,e),i)]}case"Reshape":return[r.reshape(fe("x",n,t,e),fe("shape",n,t,e))];case"MirrorPad":return[r.mirrorPad(fe("x",n,t,e),fe("padding",n,t,e),fe("mode",n,t,e))];case"PadV2":case"Pad":return[r.pad(fe("x",n,t,e),fe("padding",n,t,e),fe("constantValue",n,t,e))];case"SpaceToBatchND":{const i=fe("blockShape",n,t,e),s=fe("paddings",n,t,e);return[r.spaceToBatchND(fe("x",n,t,e),i,s)]}case"BatchToSpaceND":{const i=fe("blockShape",n,t,e),s=fe("crops",n,t,e);return[r.batchToSpaceND(fe("x",n,t,e),i,s)]}case"DepthToSpace":{const i=fe("blockSize",n,t,e),s=fe("dataFormat",n,t,e).toUpperCase();return[r.depthToSpace(fe("x",n,t,e),i,s)]}case"BroadcastTo":return[r.broadcastTo(fe("x",n,t,e),fe("shape",n,t,e))];case"BroadcastArgs":return[r.broadcastArgs(fe("s0",n,t,e),fe("s1",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}})(o,a,u));case"hash_table":return Jwe(o,a,u,r);case"custom":const d=HQ(o.op);if(d&&d.customExecutor)return d.customExecutor(new $we(o,a,u));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,t,e);return Xf(s)?s.then(o=>[].concat(o)):[].concat(s)}class QQ{constructor(t={},e={},r={},i={},s){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=r,this.functionMap=i,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const r=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}function JQ(n,t,e,r){const i=new Set,s=[];let o=null,a=null;const u=new Set,d=new Set(Object.keys(n).map(_=>qu(_)[0]));r=r||[];const m=new Set(r.map(_=>qu(_.name)[0])),y=[...t];for(;y.length>0;){const _=y.pop();if((wv(_)||yxe(_)||_xe(_))&&null==o&&(o=_,a=o.children.map(E=>E.name).filter(E=>i.has(E))),i.add(_.name),null==e[_.name]&&!d.has(_.name)&&!m.has(_.name)){if(0===_.inputs.length){s.push(_.name);continue}_.inputs.forEach(E=>{u.has(E.name)||(u.add(E.name),y.push(E))})}}return{inputs:n,outputs:t,usedNodes:i,missingInputs:s,dynamicNode:o,syncInputs:a}}class ZO extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}const mxe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),gxe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),vxe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function wv(n){return mxe.has(n.op)}function yxe(n){return gxe.has(n.op)}function _xe(n){return vxe.has(n.op)}class KO{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(r=>t[r].map(i=>i.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(r=>{this._functionExecutorMap[r]=new KO(t.functions[r],this)})}getCompilationKey(t,e){const r=t.map(s=>s.name).sort(),i=e.map(s=>s.name).sort();return r.join(this.SEPARATOR)+"--"+i.join(this.SEPARATOR)}compile(t,e){const r=JQ(t,e,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:s,syncInputs:o}=r;if(null!=s)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(i.length>0){const d=e.map(y=>y.name),m=Object.keys(t);throw new Error(`Cannot compute the outputs [${d}] from the provided inputs [${m}]. Missing the following inputs: [${i}]`)}const a=function hxe(n,t){const{usedNodes:e,inputs:r}=t,o=R=>e.has("string"==typeof R?R:R.name);function a(R){return[...new Map(R.map($=>[$.name,$])).values()]}const u=a([...Object.keys(r).map(R=>qu(R)[0]).map(R=>n.nodes[R]),...n.weights,...n.initNodes||[]]).filter(o),d=a([...u,...Object.values(n.nodes)]).filter(o),m=new Map(d.map(R=>[R.name,R])),y={};for(const R of d){y[R.name]=y[R.name]||0;for(const $ of R.children)o($)||(y[$.name]=Number.POSITIVE_INFINITY),y[$.name]=(y[$.name]||0)+1}const _=Object.entries(y).filter(([,R])=>0===R).map(([R])=>R),E=[..._];for(;_.length>0;){const R=_.pop(),$=m.get(R);for(const B of $.children.filter(o))0==--y[B.name]&&(E.push(B.name),_.push(B.name))}const O=function fxe(n,t){const e=new Map(n.map(o=>[o.name,o])),r=t.map(o=>o.name),i=new Set(r);for(;r.length>0;){const o=r.pop(),a=e.get(o);for(const u of a.children)!e.has(u.name)||i.has(u.name)||(i.add(u.name),r.push(u.name))}return n.filter(o=>i.has(o.name))}(E.map(R=>m.get(R)),u);return function dxe(n,t){const e=new Map(n.map((a,u)=>[a.name,u])),r=new Set(t.map(a=>a.name)),i=a=>r.has("string"==typeof a?a:a.name),s=new Set(n.map(a=>a.name)),o=a=>s.has("string"==typeof a?a:a.name);for(const a of n){for(const u of a.children.filter(o)){if(!e.has(u.name))throw new ZO(`Child ${u.name} of node ${a.name} is unreachable.`);if(e.get(a.name)>e.get(u.name))throw new ZO(`Node ${a.name} is scheduled to run after its child ${u.name}.`)}if(!i(a))for(const u of a.inputs){if(!e.has(u.name))throw new ZO(`Input ${u.name} of node ${a.name} is unreachable.`);if(e.get(u.name)>e.get(a.name))throw new ZO(`Node ${a.name} is scheduled to run before its input ${u.name}.`)}}}(O,u),O}(this.graph,r),u=function pxe(n){const t=new Map(n.map((a,u)=>[a.name,u])),e=Number.MAX_SAFE_INTEGER,r=n.map((a,u)=>wv(a)?e:u),i=a=>{const u=r[t.get(a.name)];return null==u?-1:u},s=n.map((a,u)=>a.children.map(i).reduce((d,m)=>Math.max(d,m),r[u])),o=new Map;for(let a=0;a<n.length;++a){const u=s[a];if(u===e)continue;const d=n[a],m=n[u];o.has(m.name)||o.set(m.name,[]),o.get(m.name).push(d)}return o}(a);return{orderedNodes:a,nodeLiveUntilMap:u}}cloneAndKeepTensor(t){if(null==t)return null;const e=t.clone();return Ao(e),e}cloneTensorList(t){return t?t.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,this.cloneTensorList(r)]))}execute(t,e){this.disposeIntermediateTensors(),t=this.mapInputs(t);const r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const i=r.map(_=>this.graph.nodes[qu(_)[0]]),s=e.map(_=>qu(_)[0]),o=new Set(s);let a=s.map(_=>this.graph.nodes[_]);0===a.length&&(a=this._outputs);const u=this.getCompilationKey(i,a);let d=this.compiledMap.get(u);null==d&&(d=this.compile(t,a),this.compiledMap.set(u,d));try{this.keepIntermediateTensors=Ft().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(_){this.keepIntermediateTensors=!1,console.warn(_.message)}const m={},y={};return Ot(()=>{const _=new QQ(this.weightMap,m,y,this.functionExecutorMap,this.parseNodeNameCache),E=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach($=>{const[B,Q]=qu($,_),ie=[];ie[Q]=t[$],E[B]=ie,this.keepIntermediateTensors&&(this.clonedTensorsMap[B]=this.cloneTensorList(ie))});const D=this.getFrozenTensorIds(E),{orderedNodes:O,nodeLiveUntilMap:R}=d;for(const $ of O){if(E[$.name])continue;const B=YQ($,E,_,this._resourceManager);if(Xf(B))throw new Error(`The execution of the op '${$.op}' returned a promise. Please use model.executeAsync() instead.`);E[$.name]=B,this.keepIntermediateTensors&&(this.clonedTensorsMap[$.name]=this.cloneTensorList(B)),this.checkTensorForDisposalWithNodeLiveUntilInfo($,E,_,D,o,R.get($.name))}return null==this.parent&&_.dispose(D),e.map($=>ha($,E,_))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(r=>t[r]).map(r=>r.map(i=>i.id)));return new Set(e)}checkTensorForDisposal(t,e,r,i,s,o,a){if(!wv(e)&&!o.has(t)){for(const u of r[t])null!=u&&(a[u.id]=(a[u.id]||0)+e.children.length);for(const u of e.inputs){if(wv(u))continue;const d=WQ(u.name,r,i);if(null!=d)for(const m of d){if(!m||m.kept||s.has(m.id))continue;const y=a[m.id];1===y?(m.dispose(),delete a[m.id]):null!=y&&a[m.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,e,r,i,s,o){function a(u){return wv(u)||s.has(u.name)}if(!wv(t)&&null!=o)for(const u of o){if(a(u))continue;const d=WQ(u.name,e,r);for(const m of d)!m||m.kept||i.has(m.id)||m.dispose()}}executeAsync(t,e){var r=this;return(0,Nt.Z)(function*(){return r._executeAsync(t,e)})()}disposeIntermediateTensors(){!this.clonedTensorsMap||(Object.values(this.clonedTensorsMap).forEach(t=>{for(const e of t)e&&!e.isDisposed&&e.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}_executeAsync(t,e,r=!1,i={},s={}){var o=this;return(0,Nt.Z)(function*(){o.disposeIntermediateTensors(),r||(t=o.mapInputs(t),o.checkInputs(t),o.checkInputShapeAndType(t),e=o.mapOutputs(e),o.checkOutputs(e));try{o.keepIntermediateTensors=Ft().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(E){o.keepIntermediateTensors=!1,console.warn(E.message)}const a=new QQ(o.weightMap,i,s,o.functionExecutorMap,o.parseNodeNameCache);o.keepIntermediateTensors&&(o.clonedTensorsMap=o.cloneTensorMap(o.weightMap));const u=yield o.executeWithControlFlow(t,a,e,r),d=e.map(E=>ha(E,u,a)),m=d.map(E=>E.id),y=Object.keys(t).map(E=>t[E].id),_=new Set([...m,...y,...o.weightIds]);return Object.values(u).forEach(E=>{E.forEach(D=>{D&&!D.isDisposed&&!_.has(D.id)&&D.dispose()})}),null==o.parent&&a.dispose(_),d})()}executeFunctionAsync(t,e,r){var i=this;return(0,Nt.Z)(function*(){const s=t.reduce((o,a,u)=>(o[i.inputs[u].name]=a,o),{});return i._executeAsync(s,i.outputNodes,!0,e,r)})()}executeWithControlFlow(t,e,r,i){var s=this;return(0,Nt.Z)(function*(){const o=Object.keys(t),a=o.map(ye=>s.graph.nodes[qu(ye)[0]]),u=r.map(ye=>qu(ye)[0]),d=new Set(u);let m=u.map(ye=>s.graph.nodes[ye]);0===m.length&&(m=s._outputs);const{usedNodes:y,missingInputs:_,dynamicNode:E,syncInputs:D}=JQ(t,m,s.weightMap,s._initNodes),O=[...a,...s.graph.weights,...s._initNodes||[]].map(ye=>({node:ye,contexts:e.currentContext})),R=Object.assign({},s.weightMap);Object.keys(t).forEach(ye=>{const[Me,Be]=qu(ye),He=[];He[Be]=t[ye],R[Me]=He});const $={},B=s.getFrozenTensorIds(R),Q={};for(;O.length>0;){const ye=s.processStack(a,O,e,R,Q,B,d,$,y);yield Promise.all(ye)}null==E&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const ie=m.filter(ye=>!wv(ye)&&!ha(ye.name,R,e)).map(ye=>ye.name);if(ie.length>0){let ye="";throw null!=E&&(ye=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${D}]`),new Error(`Cannot compute the outputs [${ie}] from the provided inputs [${o}]. Consider providing the following inputs: [${_}]. ${ye}`)}return R})()}processStack(t,e,r,i,s,o,a,u,d){const m=[];for(;e.length>0;){const y=e.pop();r.currentContext=y.contexts;let _="";if("Enter"===y.node.op&&fe("isConstant",y.node,i,r)&&([_]=fd(y.node.name,r)),null==i[y.node.name]){const E=YQ(y.node,i,r,this._resourceManager);_||([_]=fd(y.node.name,r));const D=r.currentContext;Xf(E)?m.push(E.then(O=>(i[_]=O,this.keepIntermediateTensors&&(this.clonedTensorsMap[_]=this.cloneTensorList(O)),r.currentContext=D,this.checkTensorForDisposal(_,y.node,i,r,o,a,u),this.processChildNodes(y.node,e,r,i,s,d),O))):(i[_]=E,this.keepIntermediateTensors&&(this.clonedTensorsMap[_]=this.cloneTensorList(E)),this.checkTensorForDisposal(_,y.node,i,r,o,a,u),this.processChildNodes(y.node,e,r,i,s,d))}else this.processChildNodes(y.node,e,r,i,s,d)}return m}processChildNodes(t,e,r,i,s,o){t.children.forEach(a=>{const[u]=fd(a.name,r);s[u]||!o.has(a.name)||("Merge"===a.op?a.inputNames.some(d=>!!ha(d,i,r))&&(s[u]=!0,e.push({contexts:r.currentContext,node:a})):a.inputNames.every(d=>!!ha(d,i,r))&&(s[u]=!0,e.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(e=>e.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const r=t[e],[i]=qu(e),s=this.graph.nodes[i];if(s.attrParams.shape&&s.attrParams.shape.value){const o=s.attrParams.shape.value;De(o.length===r.shape.length&&r.shape.every((u,d)=>-1===o[d]||o[d]===u),()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&De(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(t){var e,r;const i={};for(const s in t){const o=null===(r=null===(e=this._signature)||void 0===e?void 0:e.inputs)||void 0===r?void 0:r[s];null!=o?i[o.name]=t[s]:i[s]=t[s]}return i}checkInputs(t){const e=Object.keys(t).filter(r=>{const[i]=qu(r);return null==this.graph.nodes[i]});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(e=>{var r,i;const s=null===(i=null===(r=this._signature)||void 0===r?void 0:r.outputs)||void 0===i?void 0:i[e];return null!=s?s.name:e},{})}checkOutputs(t){t.forEach(e=>{const[r]=qu(e);if(!this.graph.nodes[r])throw new Error(`The output '${e}' is not found in the graph`)})}}class bxe{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}class Y6{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,e={},r=se){this.modelUrl=t,this.loadOptions=e,this.version="n/a",this.io=r,null==e&&(this.loadOptions={}),this.resourceManager=new bxe}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const e=this.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return Xf(t)?t.then(e=>this.loadSync(e)):this.loadSync(t)}loadSync(t){this.artifacts=t;const e=this.artifacts.modelTopology;let r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const s=this.artifacts.userDefinedMetadata;null!=s.signature&&(r=s.signature),null!=s.structuredOutputKeys&&(this.structuredOutputKeys=s.structuredOutputKeys)}this.signature=r,this.version=`${e.versions.producer}.${e.versions.minConsumer}`;const i=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new KO(GQ.Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const s=GQ.Instance.transformGraph(t.modelInitializer);this.initializer=new KO(s),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}save(t,e){var r=this;return(0,Nt.Z)(function*(){if("string"==typeof t){const i=r.io.getSaveHandlers(t);if(0===i.length)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(i.length>1)throw new Error(`Found more than one (${i.length}) save handlers for URL '${t}'`);t=i[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(r.artifacts)})()}addStructuredOutputNames(t){if(this.structuredOutputKeys){const r={};return(t instanceof yi?[t]:t).forEach((i,s)=>r[this.structuredOutputKeys[s]]=i),r}return t}predict(t,e){const r=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(r)}predictAsync(t,e){var r=this;return(0,Nt.Z)(function*(){const i=yield r.executeAsync(t,r.outputNodes);return r.addStructuredOutputNames(i)})()}normalizeInputs(t){var e;if(!(t instanceof yi||Array.isArray(t))){const s=null===(e=this.signature)||void 0===e?void 0:e.inputs;if(null!=s)for(const o in s){const a=s[o];null!=a.resourceId&&(t[o]=this.resourceIdToCapturedInput[a.resourceId])}return t}t=Array.isArray(t)?t:[t];const r=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${t.length} input tensors provided.`);let i=0;return this.inputNodes.reduce((s,o)=>{var a,u,d;const m=null===(d=null===(u=null===(a=this.signature)||void 0===a?void 0:a.inputs)||void 0===u?void 0:u[o])||void 0===d?void 0:d.resourceId;return s[o]=null!=m?this.resourceIdToCapturedInput[m]:t[i++],s},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return null==this.initializer?[]:this.initializer.execute({},null==this.initializerSignature?[]:Object.keys(this.initializerSignature.outputs))}executeInitializerGraphAsync(){var t=this;return(0,Nt.Z)(function*(){return null==t.initializer?[]:t.initializer.executeAsync({},null==t.initializerSignature?[]:Object.keys(t.initializerSignature.outputs))})()}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const e=this.initializerSignature.outputs,r=Object.keys(e);for(let i=0;i<r.length;i++)this.resourceIdToCapturedInput[e[r[i]].resourceId]=t[i]}}execute(t,e){null==this.resourceIdToCapturedInput&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const r=this.executor.execute(t,e);return r.length>1?r:r[0]}executeAsync(t,e){var r=this;return(0,Nt.Z)(function*(){null==r.resourceIdToCapturedInput&&r.setResourceIdToCapturedInput(yield r.executeInitializerGraphAsync()),t=r.normalizeInputs(t),e=r.normalizeOutputs(e);const i=yield r.executor.executeAsync(t,e);return i.length>1?i:i[0]})()}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,r)=>(e[r]=[t[r]],e),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Or(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}function Cxe(n){return Q6.apply(this,arguments)}function Q6(){return(Q6=(0,Nt.Z)(function*(n,t={},e=se){if(null==n)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"==typeof n&&(n=Exe(n));const r=new Y6(n,t,e);return yield r.load(),r})).apply(this,arguments)}function Sxe(n){if(null==n)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let t;if(n instanceof Array){const[r,i]=n;if(!r)throw new Error("modelJSON must be the first element of the array");if(!(i&&i instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in r))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in r))throw new Error("Model JSON is missing 'weightsManifest'");t=AR(yU(r,wU(r.weightsManifest),i))}else if("load"in n)t=n;else{if(!("modelTopology"in n&&"weightSpecs"in n&&"weightData"in n))throw new Error("Unknown model format");t=AR(n)}const e=new Y6(t);return e.load(),e}function Exe(n){return n.endsWith("/")||(n+="/"),`${n}model.json?tfjs-format=file`}const eJ="4.4.0";function XO(n,t,e=new Map,r=new Set){if(null==n)return null;if("function"==typeof Blob&&n instanceof Blob)return n.slice();if(r.has(n))throw new Error("Circular references are not supported.");if(e.has(n))return e.get(n);const i=t(n);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(eb(n)){const s=Array.isArray(n)?[]:{};r.add(n);for(const o in n){const u=XO(n[o],t,e,r);s[o]=u}return r.delete(n),n.__proto__&&(s.__proto__=n.__proto__),s}throw new Error(`Can't recurse into non-iterable type: ${n}`)}return e.set(n,i.value),i.value}function Txe(n,t=nJ){return tJ(n,t)}function tJ(n,t,e=new Set){const r=n[0];if(e.has(r))throw new Error("Circular references are not supported.");const i=t(n);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(eb(r)){const s=Array.isArray(r)?[]:{};e.add(r);for(const o in r){const u=tJ(n.map(d=>d[o]),t,e);s[o]=u}return e.delete(r),s}throw new Error(`Can't recurse into non-iterable type: ${r}`)}return i.value}function nJ(n){return null===n?null:eb(n[0])?{value:null,recurse:!0}:{value:n,recurse:!1}}function rJ(n,t){return J6.apply(this,arguments)}function J6(){return(J6=(0,Nt.Z)(function*(n,t){const e=new Map;XO(n,t,e);for(const i of Array.from(e.keys())){const s=e.get(i);if(Xf(s)){const o=yield s;e.set(i,o)}}return XO(n,t,e)})).apply(this,arguments)}function eb(n){let t=!1;if(Ft().get("IS_BROWSER"))t=n instanceof TextDecoder;else{const{StringDecoder:e}=z(8963);t=n instanceof e}return null!=n&&!ArrayBuffer.isView(n)&&(Array.isArray(n)||"object"==typeof n&&!(n instanceof yi)&&!(n instanceof Promise)&&!t)}function Mxe(n){return n instanceof yi?{value:n.clone(),recurse:!1}:eb(n)?{value:null,recurse:!0}:{value:n,recurse:!1}}class iJ{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),r=this.get(e);return this.set(e,this.pop()),r}}let kxe=(()=>{class n extends iJ{constructor(){super(n.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=2*this.capacity,r=new Array(e),i=this.length();for(let s=0;s<i;s++)r[s]=this.get(this.wrap(this.begin+s));this.data=r,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i}}return n.INITIAL_CAPACITY=32,n})();function sJ(n){return new Oxe(n)}function bE(n){return new Fxe(n)}class Yo{toArray(){var t=this;return(0,Nt.Z)(function*(){const e=[];let r=yield t.next();for(;!r.done;)e.push(r.value),r=yield t.next();return e})()}toArrayForTest(){var t=this;return(0,Nt.Z)(function*(){const e=t.prefetch(100),r=[];let i=yield e.next();for(;!i.done;)r.push(i.value),i=yield e.next();return r})()}resolveFully(){var t=this;return(0,Nt.Z)(function*(){let e=yield t.next();for(;!e.done;)e=yield t.next()})()}resolveWhile(t){var e=this;return(0,Nt.Z)(function*(){let r=yield e.next(),i=t(r.value);for(;!r.done&&i;)r=yield e.next(),i=t(r.value)})()}handleErrors(t){return new Uxe(this,t)}filter(t){return new Vxe(this,t)}map(t){return new zxe(this,t)}mapAsync(t){return new aJ(this,t)}serialMapAsync(t){return new aJ(this,t).serial()}flatmap(t){return new Hxe(this,t)}forEachAsync(t){var e=this;return(0,Nt.Z)(function*(){return e.map(t).resolveFully()})()}serialForEach(t){var e=this;return(0,Nt.Z)(function*(){return e.serialMapAsync(t).resolveWhile(r=>!0===r)})()}rowMajorBatch(t,e=!0){return new Bxe(this,t,e)}columnMajorBatch(t,e=!0,r=nJ){return this.rowMajorBatch(t,e).map(s=>Txe(s,r))}concatenate(t,e){return new uJ(sJ([this,t]),e)}take(t){return t<0||null==t?this:new $xe(this,t)}skip(t){return t<0||null==t?this:new Lxe(this,t)}prefetch(t){return new lJ(this,t)}shuffle(t,e){return new Gxe(this,t,e)}serial(){return new Pxe(this)}}class Oxe extends Yo{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}next(){var t=this;return(0,Nt.Z)(function*(){if(t.trav>=t.items.length)return{value:null,done:!0};const e=t.items[t.trav];return t.trav++,{value:(n=e,function Nxe(n,t){return XO(n,t)}(n,Mxe)),done:!1};var n})()}}class Fxe extends Yo{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}next(){var t=this;return(0,Nt.Z)(function*(){try{return t.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}})()}}class Pxe extends Yo{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.lastRead.then(()=>t.serialNext()),t.lastRead})()}serialNext(){var t=this;return(0,Nt.Z)(function*(){return t.upstream.next()})()}}class Lxe extends Yo{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.lastRead.then(()=>t.serialNext()),t.lastRead})()}serialNext(){var t=this;return(0,Nt.Z)(function*(){for(;t.count++<t.maxCount;){const e=yield t.upstream.next();if(e.done)return e;Or(e.value)}return t.upstream.next()})()}}class $xe extends Yo{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}next(){var t=this;return(0,Nt.Z)(function*(){return t.count++>=t.maxCount?{value:null,done:!0}:t.upstream.next()})()}}class Bxe extends Yo{constructor(t,e,r=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=r,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.lastRead.then(()=>t.serialNext()),t.lastRead})()}serialNext(){var t=this;return(0,Nt.Z)(function*(){const e=[];for(;e.length<t.batchSize;){const r=yield t.upstream.next();if(r.done)return t.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(r.value)}return{value:e,done:!1}})()}}class Vxe extends Yo{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.lastRead.then(()=>t.serialNext()),t.lastRead})()}serialNext(){var t=this;return(0,Nt.Z)(function*(){for(;;){const e=yield t.upstream.next();if(e.done||t.predicate(e.value))return e;Or(e.value)}})()}}class zxe extends Yo{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Map`}next(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.upstream.next();if(e.done)return{value:null,done:!0};const r=Jf(e.value),i=t.transform(e.value),s=Jf(i);for(const o of r)_R(o,s)||o.dispose();return{value:i,done:!1}})()}}class Uxe extends Yo{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.lastRead.then(()=>t.serialNext()),t.lastRead})()}serialNext(){var t=this;return(0,Nt.Z)(function*(){for(;;)try{return yield t.upstream.next()}catch(e){if(!t.handler(e))return{value:null,done:!0}}})()}}class aJ extends Yo{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> AsyncMap`}next(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.upstream.next();if(e.done)return{value:null,done:!0};const r=Jf(e.value),i=yield t.transform(e.value),s=Jf(i);for(const o of r)_R(o,s)||o.dispose();return{value:i,done:!1}})()}}class eW extends Yo{constructor(){super(),this.outputQueue=new kxe,this.lastRead=Promise.resolve({value:null,done:!1})}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.lastRead.then(()=>t.serialNext()),t.lastRead})()}serialNext(){var t=this;return(0,Nt.Z)(function*(){for(;0===t.outputQueue.length();)if(!(yield t.pump()))return{value:null,done:!0};return{value:t.outputQueue.shift(),done:!1}})()}}class Hxe extends eW{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return`${this.upstream.summary()} -> Flatmap`}pump(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.upstream.next();if(e.done)return!1;const r=Jf(e.value),i=t.transform(e.value),s=Jf(i);t.outputQueue.pushAll(i);for(const o of r)_R(o,s)||o.dispose();return!0})()}}class uJ extends Yo{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.readFromChain(t.lastRead),t.lastRead})()}readFromChain(t){var e=this;return(0,Nt.Z)(function*(){if(yield t,null==e.iterator){const i=yield e.moreIterators.next();if(i.done)return{value:null,done:!0};e.iterator=i.value,null!=e.baseErrorHandler&&(e.iterator=e.iterator.handleErrors(e.baseErrorHandler))}const r=yield e.iterator.next();return r.done?(e.iterator=null,e.readFromChain(t)):r})()}}var pd=(()=>{return(n=pd||(pd={}))[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST",pd;var n})();class Wxe extends Yo{constructor(t,e=pd.FAIL){super(),this.iterators=t,this.mismatchMode=e,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}nextState(t){var e=this;return(0,Nt.Z)(function*(){yield t;let r=0,i=0;const o=yield rJ(e.iterators,function s(a){return a instanceof Yo?{value:a.next().then(d=>(r++,d.done&&i++,d.value)),recurse:!1}:{value:null,recurse:!0}});if(r===i)return{value:null,done:!0};if(i>0)switch(e.mismatchMode){case pd.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${e.count}.`);case pd.SHORTEST:return{value:null,done:!0}}return e.count++,{value:o,done:!1}})()}next(){var t=this;return(0,Nt.Z)(function*(){return t.currentPromise=t.nextState(t.currentPromise),t.currentPromise})()}}class lJ extends Yo{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new iJ(e)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class Gxe extends lJ{constructor(t,e,r){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=W0.alea(r||aa().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}next(){var t=this;return(0,Nt.Z)(function*(){return t.lastRead=t.lastRead.then(()=>t.serialNext()),t.lastRead})()}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}serialNext(){var t=this;return(0,Nt.Z)(function*(){for(t.upstreamExhausted||t.refill();!t.buffer.isEmpty();){const e=t.chooseIndex(),r=yield t.buffer.shuffleExcise(e);if(!r.done)return t.refill(),r;t.upstreamExhausted=!0}return{value:null,done:!0}})()}}let wE=(()=>{class n{constructor(){this.size=null}batch(e,r=!0){const i=this;let s;return De(e>0,()=>`batchSize needs to be positive, but it is\n      ${e}`),s=this.size===1/0||null==this.size?this.size:r?Math.ceil(this.size/e):Math.floor(this.size/e),Zu((0,Nt.Z)(function*(){return(yield i.iterator()).columnMajorBatch(e,r,Zxe)}),s)}concatenate(e){const r=this;let i;return i=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,Zu((0,Nt.Z)(function*(){return(yield r.iterator()).concatenate(yield e.iterator())}),i)}filter(e){const r=this;let i;return i=this.size===1/0?1/0:null,Zu((0,Nt.Z)(function*(){return(yield r.iterator()).filter(s=>Ot(()=>e(s)))}),i)}forEachAsync(e){var r=this;return(0,Nt.Z)(function*(){return(yield r.iterator()).forEachAsync(e)})()}map(e){const r=this;return Zu((0,Nt.Z)(function*(){return(yield r.iterator()).map(i=>Ot(()=>e(i)))}),this.size)}mapAsync(e){const r=this;return Zu((0,Nt.Z)(function*(){return(yield r.iterator()).mapAsync(e)}),this.size)}prefetch(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const r=this;return Zu((0,Nt.Z)(function*(){return(yield r.iterator()).prefetch(e)}),this.size)}repeat(e){const r=this;let i;return i=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,Zu((0,Nt.Z)(function*(){return function oJ(n,t){return new uJ(n,t)}(bE((0,Nt.Z)(function*(){return{value:yield r.iterator(),done:!1}})).take(e))}),i)}skip(e){const r=this;let i;return i=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,Zu((0,Nt.Z)(function*(){return(yield r.iterator()).skip(e)}),i)}shuffle(e,r,i=!0){if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const s=this,o=W0.alea(r||aa().toString());return Zu((0,Nt.Z)(function*(){let a=o.int32();return i&&(a+=o.int32()),(yield s.iterator()).shuffle(e,a.toString())}),this.size)}take(e){const r=this;let i;return i=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,Zu((0,Nt.Z)(function*(){return(yield r.iterator()).take(e)}),i)}toArray(){var e=this;return(0,Nt.Z)(function*(){if(e.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(yield e.iterator()).toArray()})()}toArrayForTest(){var e=this;return(0,Nt.Z)(function*(){if(e.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(yield e.iterator()).toArrayForTest()})()}}return n.MAX_BUFFER_SIZE=1e4,n})();function Zu(n,t=null){return new class extends wE{constructor(){super(...arguments),this.size=t}iterator(){return(0,Nt.Z)(function*(){return n()})()}}}function jxe(n){return Zu((0,Nt.Z)(function*(){return sJ(n)}),n.length)}function qxe(n){if(!eb(n))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(n))for(let e=0;e<n.length;e++)t=null==t?n[e].size:Math.min(t,n[e].size);else if(n instanceof Object)for(const e in n)t=null==t?n[e].size:Math.min(t,n[e].size);return Zu((0,Nt.Z)(function*(){return function Rxe(n,t=pd.FAIL){return new Wxe(n,t)}(yield rJ(n,r=>{if(r instanceof wE)return{value:r.iterator(),recurse:!1};if(eb(r))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}),pd.SHORTEST)}),t)}function Zxe(n){return null===n?null:function Axe(n){return null==n||function Ixe(n){return null===n||"object"!=typeof n&&"function"!=typeof n}(n)||Array.isArray(n)||"object"==typeof n&&n instanceof yi||jo(n)}(n[0])?{value:Kxe(n),recurse:!1}:{value:null,recurse:!0}}function Kxe(n){if(0===n.length)throw new Error("Can't make a batch of zero elements.");return n[0]instanceof yi?yu(n):Vu(n)}class cJ extends wE{constructor(t){super(),this.input=t}iterator(){var t=this;return(0,Nt.Z)(function*(){return(yield t.input.iterator()).decodeUTF8().split("\n").map(s=>(s.endsWith("\r")&&(s=s.slice(0,-1)),s))})()}}const xE=Symbol("out"),hJ=Symbol("field"),QO=Symbol("quote"),tW=Symbol("quoteafterquote"),fJ=Symbol("quoteinquote");class dJ extends wE{columnNames(){var t=this;return(0,Nt.Z)(function*(){return t.columnNamesValidated||(yield t.setColumnNames()),t.configuredColumnsOnly?Object.keys(t.columnConfigs):t.fullColumnNames})()}setColumnNames(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.maybeReadHeaderLine();if(!t.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");t.fullColumnNames&&e&&De(e.length===t.fullColumnNames.length,()=>"The length of provided columnNames ("+t.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),t.fullColumnNames||(t.fullColumnNames=e);const r=t.fullColumnNames.reduce((s,o)=>(s[o]=s[o]+1||1,s),{}),i=Object.keys(r).filter(s=>r[s]>1);if(De(0===i.length,()=>"Duplicate column names found: "+i.toString()),t.columnConfigs)for(const s of Object.keys(t.columnConfigs))if(-1===t.fullColumnNames.indexOf(s))throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+t.fullColumnNames.toString()+").");t.columnNamesValidated=!0})()}maybeReadHeaderLine(){var t=this;return(0,Nt.Z)(function*(){if(t.hasHeader){const r=yield(yield t.base.iterator()).next();if(r.done)throw new Error("No data was found for CSV parsing.");return t.parseRow(r.value,!1)}return null})()}constructor(t,e){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new cJ(t),e||(e={}),this.hasHeader=!1!==e.hasHeader,this.fullColumnNames=e.columnNames,this.columnConfigs=e.columnConfigs,this.configuredColumnsOnly=e.configuredColumnsOnly,e.delimWhitespace?(De(null==e.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=e.delimiter?e.delimiter:","}iterator(){var t=this;return(0,Nt.Z)(function*(){t.columnNamesValidated||(yield t.setColumnNames());let e=yield t.base.iterator();return t.hasHeader&&(e=e.skip(1)),e.map(r=>t.makeDataElement(r))})()}makeDataElement(t){const e=this.parseRow(t),r={},i={};for(let s=0;s<this.fullColumnNames.length;s++){const o=this.fullColumnNames[s],a=this.columnConfigs?this.columnConfigs[o]:null;if(!this.configuredColumnsOnly||a){const u=e[s];let d=null;if(""===u)if(a&&void 0!==a.default)d=a.default;else{if(a&&(a.required||a.isLabel))throw new Error(`Required column ${o} is empty in this line: ${t}`);d=void 0}else{const m=Number(u);if(isNaN(m))d=a&&"bool"===a.dtype?this.getBoolean(u):u;else if(a&&a.dtype)switch(a.dtype){case"float32":default:d=m;break;case"int32":d=Math.floor(m);break;case"bool":d=this.getBoolean(u)}else d=m}a&&a.isLabel?i[o]=d:r[o]=d}}return 0===Object.keys(i).length?r:{xs:r,ys:i}}getBoolean(t){return"1"===t||"true"===t.toLowerCase()?1:0}parseRow(t,e=!0){const r=[];let i=0;const s=t.length;let o=xE;for(let a=0;a<s;a++)switch(o){case xE:switch(t.charAt(a)){case'"':i=a+1,o=QO;break;case this.delimiter:if(i=a+1," "===this.delimiter&&this.delimWhitespace)break;r.push(""),o=xE;break;default:o=hJ,i=a}break;case hJ:t.charAt(a)===this.delimiter&&(r.push(t.substring(i,a)),o=xE,i=a+1);break;case QO:'"'===t.charAt(a)&&(o=tW);break;case tW:switch(t.charAt(a)){case this.delimiter:r.push(t.substring(i,a-1)),o=xE,i=a+1;break;case'"':o=QO;break;default:o=fJ}break;case fJ:'"'===t.charAt(a)&&(o=QO)}if(r.push(o===tW?t.substring(i,s-1):t.substring(i)),e&&r.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${r}`);return r}}class nW extends Yo{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const e=Math.log2(this.fftSize);if(this.fftSize<0||e<4||e>14||!Number.isInteger(e))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=!1!==t.includeSpectrogram,this.includeWaveform=!0===t.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static create(t={}){return(0,Nt.Z)(function*(){if(!Ft().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const e=new nW(t);return yield e.start(),e})()}start(){var t=this;return(0,Nt.Z)(function*(){try{t.stream=yield navigator.mediaDevices.getUserMedia({audio:null==t.audioTrackConstraints||t.audioTrackConstraints,video:!1})}catch(i){throw new Error(`Error thrown while initializing video stream: ${i.message}`)}if(!t.stream)throw new Error("Could not obtain audio from microphone.");const e=window.AudioContext||window.webkitAudioContext;if(t.audioContext=new e,t.sampleRateHz){if(t.audioContext.sampleRate!==t.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${t.sampleRateHz}; Actual: ${t.audioContext.sampleRate}`)}else t.sampleRateHz=t.audioContext.sampleRate;const r=t.audioContext.createMediaStreamSource(t.stream);t.analyser=t.audioContext.createAnalyser(),t.analyser.fftSize=2*t.fftSize,t.analyser.smoothingTimeConstant=t.smoothingTimeConstant,r.connect(t.analyser),t.freqData=new Float32Array(t.fftSize),t.timeData=new Float32Array(t.fftSize)})()}next(){var t=this;return(0,Nt.Z)(function*(){if(t.isClosed)return{value:null,done:!0};let e,r;const i=yield t.getAudioData();if(t.includeSpectrogram){const s=t.flattenQueue(i.freqDataQueue);e=t.getTensorFromAudioDataArray(s,[t.numFrames,t.columnTruncateLength,1])}if(t.includeWaveform){const s=t.flattenQueue(i.timeDataQueue);r=t.getTensorFromAudioDataArray(s,[t.numFrames*t.fftSize,1])}return{value:{spectrogram:e,waveform:r},done:!1}})()}capture(){var t=this;return(0,Nt.Z)(function*(){return(yield t.next()).value})()}getAudioData(){var t=this;return(0,Nt.Z)(function*(){const e=[],r=[];let i=0;return new Promise(s=>{const o=setInterval(()=>{t.includeSpectrogram&&(t.analyser.getFloatFrequencyData(t.freqData),t.freqData[0]===-1/0&&s({freqDataQueue:e,timeDataQueue:r}),e.push(t.freqData.slice(0,t.columnTruncateLength))),t.includeWaveform&&(t.analyser.getFloatTimeDomainData(t.timeData),r.push(t.timeData.slice())),++i===t.numFrames&&(clearInterval(o),s({freqDataQueue:e,timeDataQueue:r}))},t.fftSize/t.sampleRateHz*1e3)})})()}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const e=t[0].length,r=new Float32Array(t.length*e);return t.forEach((i,s)=>r.set(i,s*e)),r}getTensorFromAudioDataArray(t,e){const r=new Float32Array(Xt(e));return r.set(t,r.length-t.length),Vu(r,e)}}class rW extends Yo{constructor(t,e){if(super(),this.webcamVideoElement=t,this.webcamConfig=e,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=ka([0],"int32"),this.webcamConfig.centerCrop){const r=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,i=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,s=(1-r)/2,o=(1-i)/2;this.cropBox=qp([o,s,i+o,s+r],[1,4])}else this.cropBox=qp([0,0,1,1],[1,4])}summary(){return"webcam"}static create(t,e={}){return(0,Nt.Z)(function*(){if(!Ft().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!e.resizeWidth||!e.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=e.resizeWidth,t.height=e.resizeHeight}const r=new rW(t,e);return yield r.start(),r})()}start(){var t=this;return(0,Nt.Z)(function*(){t.webcamConfig.facingMode&&De("user"===t.webcamConfig.facingMode||"environment"===t.webcamConfig.facingMode,()=>`Invalid webcam facing mode: ${t.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{t.stream=yield navigator.mediaDevices.getUserMedia({video:{deviceId:t.webcamConfig.deviceId,facingMode:t.webcamConfig.facingMode?t.webcamConfig.facingMode:"user",width:t.webcamVideoElement.width,height:t.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!t.stream)throw new Error("Could not obtain video from webcam.");try{t.webcamVideoElement.srcObject=t.stream}catch(e){console.log(e),t.webcamVideoElement.src=window.URL.createObjectURL(t.stream)}return t.webcamVideoElement.play(),t.isClosed=!1,new Promise(e=>{t.webcamVideoElement.onloadedmetadata=()=>{e()}})})()}next(){var t=this;return(0,Nt.Z)(function*(){if(t.isClosed)return{value:null,done:!0};let e;try{e=bZ(t.webcamVideoElement)}catch(r){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(r)}`)}if(!t.resize)return{value:e,done:!1};try{return{value:t.cropAndResizeFrame(e),done:!1}}catch(r){throw new Error(`Error thrown cropping the video: ${r.message}`)}finally{e.dispose()}})()}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(t){return Ot(()=>{const e=Ma(Fn(t,"float32"),0);let r;return r=cc.cropAndResize(e,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear"),wt(r,r.shape.slice(1))})}capture(){var t=this;return(0,Nt.Z)(function*(){return(yield t.next()).value})()}stop(){this.stream.getTracks().forEach(e=>e.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}class pJ{}class mJ extends Yo{split(t){return new Xxe(this,t)}}class Xxe extends mJ{constructor(t,e){super(),this.upstream=t,this.impl=new Yxe(t,e)}summary(){return this.impl.summary()}next(){var t=this;return(0,Nt.Z)(function*(){return t.impl.next()})()}}class Yxe extends eW{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}pump(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.upstream.next();if(e.done)return""!==t.carryover&&(t.outputQueue.push(t.carryover),t.carryover="",!0);const r=e.value.split(t.separator);r[0]=t.carryover+r[0];for(const i of r.slice(0,-1))t.outputQueue.push(i);return t.carryover=r[r.length-1],!0})()}}class Qxe extends Yo{decodeUTF8(){return new Jxe(this)}}class Jxe extends mJ{constructor(t){super(),this.upstream=t,this.impl=new e1e(t)}summary(){return this.impl.summary()}next(){var t=this;return(0,Nt.Z)(function*(){return t.impl.next()})()}}class e1e extends eW{constructor(t){if(super(),this.upstream=t,Ft().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:e}=z(1601);this.decoder=new e("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}pump(){var t=this;return(0,Nt.Z)(function*(){const e=yield t.upstream.next();let r,i;return!e.done&&(r=e.value,i=Ft().get("IS_BROWSER")?t.decoder.decode(r,{stream:!0}):t.decoder.write(Buffer.from(r.buffer)),t.outputQueue.push(i),!0)})()}}class gJ extends Qxe{constructor(t,e={}){super(),this.file=t,this.options=e,De(t instanceof Uint8Array||!!Ft().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1048576}summary(){return`FileChunks ${this.file}`}next(){var t=this;return(0,Nt.Z)(function*(){return t.offset>=(t.file instanceof Uint8Array?t.file.byteLength:t.file.size)?{value:null,done:!0}:{value:yield new Promise((r,i)=>{const s=t.offset+t.chunkSize;if(t.file instanceof Uint8Array)r(new Uint8Array(t.file.slice(t.offset,s)));else{const o=new FileReader;o.onload=u=>{let d=o.result;if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),!(d instanceof Uint8Array))return i(new TypeError("FileReader returned unknown type."));r(d)},o.onabort=u=>i(new Error("Aborted")),o.onerror=u=>i(new Error(u.type));const a=t.file.slice(t.offset,s);o.readAsArrayBuffer(a)}t.offset=s}),done:!1}})()}}function iW(){return(iW=(0,Nt.Z)(function*(n,t={},e){let r,i;"string"==typeof n?r=n:(r=n.url,i=n1e(n));const s=yield(e||L7)(r,i);if(s.ok){const o=new Uint8Array(yield s.arrayBuffer());return new gJ(o,t)}throw new Error(s.statusText)})).apply(this,arguments)}const n1e=n=>({method:n.method,headers:n.headers,body:n.body,mode:n.mode,credentials:n.credentials,cache:n.cache,redirect:n.redirect,referrer:n.referrer,integrity:n.integrity});function vJ(n){return"string"==typeof n&&"file://"===n.slice(0,7)}class yJ extends pJ{constructor(t,e={}){super(),this.input=t,this.options=e}iterator(){var t=this;return(0,Nt.Z)(function*(){if(vJ(t.input)&&Ft().get("IS_NODE")){const e=z(7792);t.input=e.readFileSync(t.input.slice(7))}return new gJ(t.input,t.options)})()}}class _J extends pJ{constructor(t,e={}){super(),this.url=t,this.fileOptions=e}iterator(){var t=this;return(0,Nt.Z)(function*(){return vJ(t.url)?new yJ(t.url,t.fileOptions).iterator():function t1e(n){return iW.apply(this,arguments)}(t.url,t.fileOptions)})()}}function r1e(n,t={}){return new dJ(new _J(n),t)}function i1e(n){const t=bE(n);return Zu((0,Nt.Z)(function*(){return t}))}function s1e(n){return Zu((0,Nt.Z)(function*(){const t=yield n();return bE(()=>t.next())}))}function o1e(n,t){return sW.apply(this,arguments)}function sW(){return(sW=(0,Nt.Z)(function*(n,t){return rW.create(n,t)})).apply(this,arguments)}function a1e(n){return oW.apply(this,arguments)}function oW(){return(oW=(0,Nt.Z)(function*(n){return nW.create(n)})).apply(this,arguments)}const bJ="4.4.0";function er(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{null!=e&&De("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the CPU backend.`)})}const u1e=rO;let wJ=(()=>{class n extends Zk{nextDataId(){return n.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new K4(this,jc())}write(e,r,i){this.firstUse&&(this.firstUse=!1,Ft().get("IS_NODE")&&_l("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:i,refCount:1}),s}makeTensorInfo(e,r,i){let s;if("string"===r&&null!=i&&i.length>0&&Fh(i[0])){const o=i.map(a=>Ph(a));s=this.write(o,e,r)}else s=this.write(i,e,r);return{dataId:s,shape:e,dtype:r}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){this.data.has(e)&&this.data.get(e).refCount--}move(e,r,i,s,o){this.data.set(e,{values:r,dtype:s,refCount:o})}numDataIds(){return this.data.numDataIds()}read(e){var r=this;return(0,Nt.Z)(function*(){return r.readSync(e)})()}readSync(e){const{dtype:r,complexTensorInfos:i}=this.data.get(e);return"complex64"===r?ld(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):S7(this.data.get(e).values,r)}bufferSync(e){const r=this.readSync(e.dataId);if("string"===e.dtype)try{const i=r.map(s=>Qf(s));return Zr(e.shape,e.dtype,i)}catch(i){throw new Error("Failed to decode encoded string bytes into utf-8")}return Zr(e.shape,e.dtype,r)}makeOutput(e,r,i){return jc().makeTensorFromTensorInfo(this.makeTensorInfo(r,i,e),this)}disposeData(e,r=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!r&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:i}=this.data.get(e);null!=i&&(this.disposeData(i.real.dataId,!0),this.disposeData(i.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}time(e){return(0,Nt.Z)(function*(){const r=aa();return e(),{kernelMs:aa()-r}})()}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){er([e],"where");const r=this.readSync(e.dataId);return u1e(e.shape,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}return n.nextDataId=0,n})();function xJ(n){const t=new Float32Array(n.length);for(let e=0;e<n.length;++e)t[e]=Math.abs(n[e]);return t}const l1e={kernelName:xC,backendName:"cpu",kernelFunc:n=>{const{x:t}=n.inputs,e=n.backend;er(t,"abs");let r=new Float32Array(Xt(t.shape));return r=xJ(e.data.get(t.dataId).values),e.makeOutput(r,t.shape,t.dtype)}};function _o(n){return(t,e,r,i,s)=>{const o=Fr(t,e),a=o.length,u=ur(o),m=Wo(s,Xt(o)),y=t.length,_=e.length,E=ur(t),D=ur(e),O=tv(t,o),R=tv(e,o);if(O.length+R.length===0)for(let $=0;$<m.length;++$)m[$]=n(r[$%r.length],i[$%i.length]);else for(let $=0;$<m.length;++$){const B=jg($,a,u),Q=B.slice(-y);O.forEach(Be=>Q[Be]=0);const ie=Wc(Q,y,E),ye=B.slice(-_);R.forEach(Be=>ye[Be]=0);const Me=Wc(ye,_,D);m[$]=n(r[ie],i[Me])}return[m,o]}}function Ku(n){const{inputs:t,backend:e}=n,{real:r,imag:i}=t,s=e.data.get(r.dataId).values,o=e.data.get(i.dataId).values,a=e.makeTensorInfo(r.shape,"complex64");return e.data.get(a.dataId).complexTensorInfos={real:e.makeTensorInfo(r.shape,"float32",s),imag:e.makeTensorInfo(i.shape,"float32",o)},a}const c1e={kernelName:a2,backendName:"cpu",kernelFunc:Ku};function JO(n,t,e="float32"){if("complex64"===e)return Ku({inputs:{real:JO(n,t,"float32"),imag:JO(n,t,"float32")},backend:n});const r=oa(Xt(t),e);return n.makeTensorInfo(t,e,r)}function Zh(n){const{inputs:t,backend:e}=n,{x:r}=t;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const h1e={kernelName:Y_,backendName:"cpu",kernelFunc:Zh};function xv(n){const{inputs:t,backend:e}=n,{input:r}=t,i=e.data.get(r.dataId).complexTensorInfos.real,s=e.data.get(i.dataId).values;return e.makeTensorInfo(i.shape,i.dtype,s)}const f1e={kernelName:z2,backendName:"cpu",kernelFunc:xv};function CJ(n,t,e,r){if("int32"===r)return[t,"int32",Int32Array.from(n)];if("bool"===r){const i=Lp([0],e),[s,o]=_o((a,u)=>a!==u?1:0)(t,[],n,i,"bool");return[o,"bool",s]}throw new Error(`Error in Cast: failed to cast ${e} to ${r}`)}function im(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dtype:s}=r;if("complex64"===s){if("complex64"===i.dtype)return Zh({inputs:{x:i},backend:e});const m=JO(e,i.shape,i.dtype),y=im({inputs:{x:i},backend:e,attrs:{dtype:"float32"}}),_=Ku({inputs:{real:y,imag:m},backend:e});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),_}if("complex64"===i.dtype){const m=xv({inputs:{input:i},backend:e}),y=im({inputs:{x:m},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(m),y}if(!J4(i.dtype,s)){const m=Zh({inputs:{x:i},backend:e});return{dataId:m.dataId,shape:m.shape,dtype:s}}const o=e.data.get(i.dataId).values,[a,u,d]=CJ(o,i.shape,i.dtype,s);return e.makeTensorInfo(a,u,d)}const d1e={kernelName:$_,backendName:"cpu",kernelFunc:im};function Qo(n,t,e,r){return null==e?({inputs:i,backend:s})=>{const{a:o,b:a}=i,u=s;er([o,a],n);const d=u.data.get(o.dataId).values,m=u.data.get(a.dataId).values,y="string"===o.dtype?cd(d):d,_="string"===o.dtype?cd(m):m,E=r||o.dtype,[D,O]=t(o.shape,a.shape,y,_,E);return u.makeTensorInfo(O,E,D)}:({inputs:i,backend:s})=>{const{a:o,b:a}=i,u=s;if("complex64"===o.dtype||"complex64"===a.dtype){const d=im({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),m=u.data.get(d.dataId),_=m.complexTensorInfos.imag,E=u.data.get(m.complexTensorInfos.real.dataId).values,D=u.data.get(_.dataId).values,O=im({inputs:{x:a},backend:u,attrs:{dtype:"complex64"}}),R=u.data.get(O.dataId),B=R.complexTensorInfos.imag,Q=u.data.get(R.complexTensorInfos.real.dataId).values,ie=u.data.get(B.dataId).values,[ye,Me,Be]=e(o.shape,a.shape,E,D,Q,ie),He=u.makeTensorInfo(Be,"float32",ye),st=u.makeTensorInfo(Be,"float32",Me),lt=Ku({inputs:{real:He,imag:st},backend:u});return u.disposeIntermediateTensorInfo(d),u.disposeIntermediateTensorInfo(O),u.disposeIntermediateTensorInfo(He),u.disposeIntermediateTensorInfo(st),lt}{const d=u.data.get(o.dataId).values,m=u.data.get(a.dataId).values,y=r||o.dtype,[_,E]=t(o.shape,a.shape,d,m,y);return u.makeTensorInfo(E,y,_)}}}function aW(n){return(t,e,r,i,s,o)=>{const a=Fr(t,e),u=Xt(a),d=a.length,m=ur(a),y=Wo("float32",u),_=Wo("float32",u),E=tv(t,a),D=tv(e,a),O=ld(r,i),R=ld(s,o),$=t.length,B=ur(t),Q=e.length,ie=ur(e);if(E.length+D.length===0)for(let ye=0;ye<y.length;ye++){const Me=ye%O.length,Be=ye%R.length,He=n(O[2*Me],O[2*Me+1],R[2*Be],R[2*Be+1]);y[ye]=He.real,_[ye]=He.imag}else for(let ye=0;ye<y.length;ye++){const Me=jg(ye,d,m),Be=Me.slice(-$);E.forEach(zt=>Be[zt]=0);const He=Wc(Be,$,B),st=Me.slice(-Q);D.forEach(zt=>st[zt]=0);const lt=Wc(st,Q,ie),It=n(O[2*He],O[2*He+1],R[2*lt],R[2*lt+1]);y[ye]=It.real,_[ye]=It.imag}return[y,_,a]}}const SJ=_o((n,t)=>n+t),p1e=aW((n,t,e,r)=>({real:n+e,imag:t+r})),tb=Qo(qg,SJ,p1e),m1e={kernelName:qg,backendName:"cpu",kernelFunc:tb};function uW(n,t,e,r,i){const s=Xt(r),o=oa(i,e);for(let a=0;a<n.length;a++){const u=n[a];if(u<0)throw new Error("Input x must be non-negative!");u>=i||(o[u]+=s>0?t[a]:1)}return o}function EJ(n,t,e,r=!1){const i=n.shape[0],s=n.shape[1],o=Zr([i,e],t.dtype);for(let a=0;a<i;a++)for(let u=0;u<s;u++){const d=n.get(a,u);if(d<0)throw new Error("Input x must be non-negative!");d>=e||o.set(r?1:t.size>0?o.get(a,d)+t.get(a,u):o.get(a,d)+1,a,d)}return o}function Kh(n){return(t,e,r)=>{const i=Ws(e,t.length);for(let s=0;s<t.length;++s)i[s]=n(t[s],r);return i}}function Wi(n,t,e){return sm(n,Kh(t),e)}function sm(n,t,e){return({inputs:r,attrs:i,backend:s})=>{const{x:o}=r;er(o,n);const a=s,u=a.data.get(o.dataId).values;let d;if("string"===o.dtype){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");d=cd(u)}else d=u;const m=e||o.dtype,y=t(d,m,i);return a.makeTensorInfo(o.shape,m,y)}}const NJ=Kh(n=>Math.ceil(n)),g1e=sm(B_,NJ),v1e={kernelName:B_,backendName:"cpu",kernelFunc:g1e};function TJ(n,t,e,r){const i=Ws(e,Xt(t));if(r&&"string"!==e){let s=0;n.forEach(o=>{const a=Xt(o.shape);i.set(o.vals,s),s+=a})}else{let s=0;n.forEach(o=>{const a="string"===e?cd(o.vals):o.vals;let u=0;for(let d=0;d<o.shape[0];++d){const m=d*t[1]+s;for(let y=0;y<o.shape[1];++y)i[m+y]=a[u++]}s+=o.shape[1]})}return i}const AJ=_o((n,t)=>n===t?1:0),IJ=Qo($C,AJ,null,"bool"),y1e={kernelName:$C,backendName:"cpu",kernelFunc:IJ},DJ=Kh(n=>Math.exp(n)),MJ=sm(j_,DJ,"float32"),_1e={kernelName:j_,backendName:"cpu",kernelFunc:MJ},kJ=Kh(n=>Math.expm1(n)),b1e=sm(q_,kJ),w1e={kernelName:q_,backendName:"cpu",kernelFunc:b1e},RJ=Kh(n=>Math.floor(n)),x1e=sm(Z_,RJ),C1e={kernelName:Z_,backendName:"cpu",kernelFunc:x1e},OJ=_o((n,t)=>Math.floor(n/t)),S1e=Qo(K_,OJ,null,"int32"),E1e={kernelName:K_,backendName:"cpu",kernelFunc:S1e};function FJ(n,t,e,r,i,s,o,a,u){const d=Zr([r,s],e);for(let m=0;m<r;m++){const y=[];let _=0;for(let E=0;E<i;E++){const D=n[m*i+E];_+=D*o[E],y.push(D)}if(_<0||_>=u/s)throw new Error(`Invalid indices: ${y} does not index into ${a}`);for(let E=0;E<s;E++)d.values[m*s+E]=t.get(...t.indexToLoc(_*s+E))}return d}function PJ(n,t,e){const r=Zr(e,n.dtype);for(let i=0;i<r.size;++i){const o=r.indexToLoc(i).slice(),d=t.locToIndex([o[0],o[2]]);o[2]=t.values[d];const m=n.locToIndex(o);0<=m&&m<n.values.length&&(r.values[i]=n.values[m])}return r}const LJ=_o((n,t)=>n>t?1:0),N1e=Qo(UC,LJ,null,"bool"),T1e={kernelName:UC,backendName:"cpu",kernelFunc:N1e},$J=_o((n,t)=>n>=t?1:0),A1e=Qo(X_,$J,null,"bool"),I1e={kernelName:X_,backendName:"cpu",kernelFunc:A1e},BJ=_o((n,t)=>n<t?1:0),D1e=Qo(WC,BJ,null,"bool"),M1e={kernelName:WC,backendName:"cpu",kernelFunc:D1e},VJ=_o((n,t)=>n<=t?1:0),k1e=Qo(GC,VJ,null,"bool"),R1e={kernelName:GC,backendName:"cpu",kernelFunc:k1e};function zJ(n,t,e){const r=(t-n)/(e-1),i=oa(e,"float32");i[0]=n;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}const UJ=Kh(n=>Math.log(n)),O1e=sm(t0,UJ),F1e={kernelName:t0,backendName:"cpu",kernelFunc:O1e};function HJ(n,t,e,r){const i=Wo(r,Xt(e));for(let s=0;s<i.length;++s){const o=s*t;let a=n[o];for(let u=0;u<t;++u){const d=n[o+u];(Number.isNaN(d)||d>a)&&(a=d)}i[s]=a}return i}const WJ=_o((n,t)=>Math.max(n,t)),P1e=Qo(r0,WJ),L1e={kernelName:r0,backendName:"cpu",kernelFunc:P1e},GJ=_o((n,t)=>Math.min(n,t)),$1e=Qo(s0,GJ),B1e={kernelName:s0,backendName:"cpu",kernelFunc:$1e},lW=_o((n,t)=>n*t),V1e=aW((n,t,e,r)=>({real:n*e-t*r,imag:n*r+t*e})),eF=Qo(a0,lW,V1e),z1e={kernelName:a0,backendName:"cpu",kernelFunc:eF};function jJ(n,t,e){const r=Yf(-1,e);return lW([],t,r,n,e)}const H1e={kernelName:nS,backendName:"cpu",kernelFunc:function U1e(n){const{inputs:t,backend:e}=n,{x:r}=t;er(r,"neg");const i=e.data.get(r.dataId).values,[s,o]=jJ(i,r.shape,r.dtype);return e.makeTensorInfo(o,r.dtype,s)}},qJ=_o((n,t)=>n!==t?1:0),W1e=Qo(rS,qJ,null,"bool"),G1e={kernelName:rS,backendName:"cpu",kernelFunc:W1e};function cW(n,t,e,r,i){const s=t.length,o=Xt(t),a=ur(t),u=ur(i),d=Wo(e,Xt(i));for(let m=0;m<o;++m){const y=jg(m,s,a),_=new Array(y.length);for(let D=0;D<_.length;D++)_[D]=y[r[D]];d[Wc(_,s,u)]=n[m]}return d}function wu(n){const{inputs:t,attrs:e,backend:r}=n,{x:i}=t,{perm:s}=e;er(i,"transpose");const a=new Array(i.shape.length);for(let y=0;y<a.length;y++)a[y]=i.shape[s[y]];const d=cW(r.data.get(i.dataId).values,i.shape,i.dtype,s,a);return{dataId:r.write(d,a,i.dtype),shape:a,dtype:i.dtype}}const j1e={kernelName:Zg,backendName:"cpu",kernelFunc:wu};function ZJ(n,t,e,r){const[i,s]=Ko(n,r),o=pu(t,"int32"),a=oa(Xt(i),o),u=Xt(s);for(let d=0;d<a.length;++d){const m=d*u;let y=1;for(let _=0;_<u;++_)y*=e[m+_];a[d]=y}return{outVals:a,outShape:i,outDtype:o}}const Z1e={kernelName:lS,backendName:"cpu",kernelFunc:function q1e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;er(i,"prod");const a=i.shape.length,u=Yr(s,i.shape),d=ks(u,a);let m=u,y=i;const _=[];null!=d&&(y=wu({inputs:{x:i},backend:e,attrs:{perm:d}}),_.push(y),m=to(m.length,a));const E=e.data.get(y.dataId).values,{outVals:D,outShape:O,outDtype:R}=ZJ(y.shape,y.dtype,E,m);let $=O;return o&&($=eo(O,u)),_.forEach(B=>e.disposeIntermediateTensorInfo(B)),e.makeTensorInfo($,R,D)}};function KJ(n,t){const e=n.slice(0,t);for(;e.length<t;)e.push(1);for(let r=t;r<n.length;r++)e[t-1]*=n[r];return e}function XJ(n,t,e,r,i,s,o,a){if(0===n.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function K1e(n,t,e){n.forEach((r,i)=>{if(r<0||r>=e){const s=jg(i,t.length,ur(t)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${e})`)}})}(s,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const d=r[0],{outSplits:m,valueSlices:y,numValues:_}=function Y1e(n,t,e,r){const i=[];let s=0;const a=new Array(t.length-1+e.length).fill(null).map(()=>[0]);!function X1e(n,t){for(let e=0;e<n.length;++e){const r=n[e],i=e===n.length-1?t:n[e+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}(e,r);let u=1;for(let d=0;d<t.length-1;++d){u*=t[d];const m=t[d+1];for(let y=1;y<u+1;++y)a[d].push(y*m)}for(let d=0;d<n.length;++d){let m=n[d],y=n[d]+1;for(let _=0;_<e.length;++_){const E=e[_],D=_+t.length-1;if(D>=0){const O=a[D],R=O[O.length-1]-E[m];for(let $=m;$<y;++$)a[D].push(E[$+1]+R)}m=E[m],y=E[y]}y!==m&&(i.push([m,y]),s+=y-m)}return{outSplits:a,valueSlices:i,numValues:s}}(s,o,n,d),E=function Q1e(n){const t=[];for(let e=0;e<n.length;++e){const i=Ws("int32",n[e].length);t.push(i),n[e].forEach((s,o)=>i[o]=s)}return t}(m),D=function eCe(n,t,e,r,i){const s=t.slice();s[0]=i;const o=Ws(e,Xt(s)),a=n.length;return function J1e(n,t,e,r,i,s){const o=KJ(t,2)[1],a=KJ(s,2)[1];let u=0;for(const d of e)for(let m=d[0];m<d[1];++m){for(let y=0;y<r;++y)i[u*a+y]=n[m*o+y];++u}}(n,t,r,0===a?0:a/t[0],o,s),[o,s]}(e,r,i,y,_);return[E,D[0],D[1]]}const YJ=2147483647;function QJ(n,t,e,r,i,s,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=0===t.length,u=0===i.length,d=0===o.length,m=[];a||m.push(t[0]),u||m.push(i[0]),d||m.push(o[0]);for(let R=1;R<m.length;++R)if(m[R]!==m[R-1])throw new Error("starts, limits, and deltas must have the same shape");const y=0===m.length?1:m[0],_=Ws("int32",y+1);_[0]=0;for(let R=0;R<y;++R){const $=a?n[0]:n[R],B=u?r[0]:r[R],Q=d?s[0]:s[R];if(0===Q)throw new Error("Requires delta != 0");let ie;if(Q>0&&B<$||Q<0&&B>$)ie=0;else if(ie=Math.ceil(Math.abs((B-$)/Q)),ie>YJ)throw new Error(`Requires ((limit - start) / delta) <= ${YJ}`);_[R+1]=_[R]+ie}const D=Ws(e,_[y]);let O=0;for(let R=0;R<y;++R){const $=_[R+1]-_[R];let B=a?n[0]:n[R];const Q=d?s[0]:s[R];for(let ie=0;ie<$;++ie)D[O++]=B,B+=Q}return[_,D]}var gc=hc;class tF{constructor(t,e,r,i,s,o,a,u,d,m){this.shape=t,this.shapeShape=e,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=u,this.rowPartitionValuesShapes=d,this.rowPartitionTypes=PK(m),this.raggedRank=LK(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===gc.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===gc.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case gc.VALUE_ROWIDS:return tF.getMaxWidthValueRowID(e);case gc.ROW_SPLITS:return tF.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${gc[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let r=0;for(let i=0;i<e-1;++i){const s=t[i+1]-t[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let r=0,i=t[0],s=0;for(let o=1;o<e;++o){const a=t[o];a!==i&&(i=a,s=Math.max(o-r,s),r=o)}return Math.max(e-r,s)}tensorShapeFromTensor(t,e,r=!0){if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return eee(t,r)}calculateOutputSize(t){const e=this.valuesShape;$K(this.defaultValueShape,e);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=FK(this.raggedRank,i,e);o[0]<0&&(o[0]=t);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(t,e,r){const i=Math.min(t,r),s=[];let o=0;for(let a=0;a<i;++a,o+=e)s.push(o);for(let a=i;a<t;++a)s.push(-1);return De(s.length===t,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(t,e,r,i){const s=t.length,o=[];for(let a=0;a<s-1;++a){const u=t[a+1]-t[a];let d=Math.min(i,u),m=e[a];-1===m&&(d=0);for(let y=0;y<d;++y)o.push(m),m+=r;for(let y=0;y<u-d;++y)o.push(-1)}if(s>0&&o.length!==t[s-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,e,r,i){const s=t.length,o=[];if(0===s)return[];let a=0,u=t[0];if(u>=e.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${e.length}`);let d=e[u];o.push(d);for(let m=1;m<s;++m){const y=t[m];if(y===u)d>=0&&(++a,a<i?d+=r:d=-1);else{if(a=0,u=y,y>=e.length)throw new Error(`Got nextValueRowId=${y} which is not less than ${e.length}`);d=e[y]}o.push(d)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,e,r,i){const s=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case gc.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,e,r,i);case gc.ROW_SPLITS:if(s.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(s,e,r,i);default:throw new Error(`Unsupported partition type: ${gc[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case gc.FIRST_DIM_SIZE:return t[0];case gc.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case gc.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${gc[e]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),r=this.calculateOutputSize(e),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let u=i.length-2;u>=0;--u)i[u]=i[u+1]*r[u+1];const s=eee(r,!1),o=Ws(this.valuesDType,Xt(s));if(i[0]*r[0]>0){let u=this.calculateFirstParentOutputIndex(e,i[0],r[0]);for(let d=1;d<=this.raggedRank;++d)u=this.calculateOutputIndex(d-1,u,i[d],r[d]);this.setOutput(this.raggedRank,u,o,s)}return[s,o]}setOutput(t,e,r,i){if(0===r.length)return;const s=this.values,o=r;let a=i.slice();a=a.slice(t+1);const u=Xt(a),d=e.length;let m=this.defaultValue;if(m.length!==u&&1!==m.length){const D=this.defaultValueShape;Ot(()=>{const O=wt(m,D);m=ov(O,a).dataSync()})}let y=0,_=0,E=0;for(let D=0;D<=d;++D){let O=D<d?e[D]:-1;if(O!==E){if(_<E){const R=s.subarray(y*u);JJ(o.subarray(_*u),R,(E-_)*u)}if(D>=d&&(O=Math.floor(r.length/u)),O>E)if(1===this.defaultValue.length)o.subarray(E*u,O*u).fill(this.defaultValue[0]),E=O;else for(;O>E;)JJ(o.slice(E*u),m,u),++E;O<0?(y=D+1,_=E):(y=D,_=E,E=_+1)}else++E}}}function JJ(n,t,e){for(let r=0;r<e;r++)n[r]=t[r]}function eee(n,t){const e=[];for(let r of n){if(r<0){if(!t)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}e.push(r)}return e}function tee(n,t,e,r,i,s,o,a,u,d){return new tF(n,t,e,r,i,s,o,a,u,d).compute()}function nee(n,t,e,r){if(n===t||n<t&&e<0||t<n&&e>1)return oa(0,r);const u=oa(Math.abs(Math.ceil((t-n)/e)),r);t<n&&1===e&&(e=-1),u[0]=n;for(let d=1;d<u.length;d++)u[d]=u[d-1]+e;return u}const ree=Kh(n=>1/Math.sqrt(n)),tCe=sm(d0,ree),nCe={kernelName:d0,backendName:"cpu",kernelFunc:tCe};function Cv(n,t,e,r,i,s,o,a,u,d){const m=[r/i,i],y=n.values,_=t.values;if(0===r)return Zr(e,t.dtype);const E=u instanceof po?u:Zr(m,t.dtype);"string"==typeof u||"number"==typeof u?E.values.fill(u):"boolean"==typeof u&&E.values.fill(+u);for(let D=0;D<s;D++){const O=[];let R=0;for(let $=0;$<o;$++){const B=y[D*o+$];O.push(B),R+=B*a[$]}if(R<0||R>=r/i)throw new Error(`Invalid indices: ${O} does not index into ${e}`);for(let $=0;$<i;$++)d?E.values[R*i+$]+=_[D*i+$]:E.values[R*i+$]=0===t.rank?_[0]:_[D*i+$]}return E}const rCe=Kh(n=>1/(1+Math.exp(-n))),iee=Wi(y0,n=>1/(1+Math.exp(-n))),iCe={kernelName:y0,backendName:"cpu",kernelFunc:iee};function see(n,t,e,r,i){const s=QU(r,t,e),o=Xt(e),a=ur(r);if(s){const y=JU(t,a);return"string"===i?n.slice(y,y+o):n.subarray(y,y+o)}const d=Zr(r,i,"string"===i?cd(n):n),m=Zr(e,i);for(let y=0;y<m.size;++y){const _=m.indexToLoc(y),E=_.map((D,O)=>D+t[O]);m.set(d.get(...E),..._)}return"string"===i?oX(m.values):m.values}function Sv(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,size:o}=r;er(i,"slice");const[a,u]=MR(i,s,o);XU(i,a,u);const m=see(e.data.get(i.dataId).values,a,u,i.shape,i.dtype);return e.makeTensorInfo(u,i.dtype,m)}const sCe={kernelName:mS,backendName:"cpu",kernelFunc:Sv};function oee(n,t,e,r,i,s,o){const a=t[0],u=s[0],d=new Array(u),m=new Array(a),y=t[1];if(0===u){if(0!==a)throw new Error(qK(a));return[Ws(e,0),[0,y],Ws(i,0),d,m]}let _=!0,E=0;const D=new Array(u).fill(0);for(let R=0;R<a;++R){const $=n[R*y];if($<0)throw new Error(ZK(R,$));if($>=u)throw new Error(KK(R,$,u));++D[$],_=_&&$>=E,E=$}let O=!0;for(let R=0;R<u;++R){const $=0===D[R];d[R]=$,O=O&&!$,D[R]=Math.max(D[R],1),R>0&&(D[R]+=D[R-1])}if(O&&_){const R=n,$=r;for(let B=0;B<a;++B)m[B]=B;return[R,[a,y],$,d,m]}{const R=D[u-1],$=Ws(e,R*y),B=Ws(i,R),Q=new Array(u).fill(0);for(let ie=0;ie<a;++ie){const ye=n[ie*y],Be=(0===ye?0:D[ye-1])+Q[ye];Q[ye]++;for(let He=0;He<y;++He)$[Be*y+He]=n[ie*y+He];B[Be]=r[ie],m[ie]=Be}for(let ie=0;ie<u;++ie)if(0===Q[ie]){const Me=0===ie?0:D[ie-1];$[Me*y+0]=ie;for(let Be=1;Be<y;++Be)$[Me*y+Be]=0;B[Me]=o}return[$,[R,y],B,d,m]}}function aee(n,t,e,r,i){const s=Xt(r),o=t[0],a=i.length,u=[];let d=1,m=-1;for(let R=0;R<a;++R){const $=i[R];if(-1===$){if(-1!==m)throw new Error(XK(m,R));m=R,u.push(1)}else{if($<0)throw new Error(YK(R,$));d*=$,u.push($)}}if(-1!==m){if(d<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const R=Math.trunc(s/d);if(d*R!==s)throw new Error(JK(r,u));u[m]=R}if(Xt(u)!==s)throw new Error(eX(r,u));const _=r.length,E=[];if(_>0){E[_-1]=1;for(let R=_-2;R>=0;--R)E[R]=E[R+1]*r[R+1]}const D=[];if(a>0){D[a-1]=1;for(let R=a-2;R>=0;--R)D[R]=D[R+1]*u[R+1]}const O=Ws(e,o*a);for(let R=0;R<o;++R){let $=0;for(let B=0;B<_;++B)$+=n[R*_+B]*E[B];for(let B=0;B<a;++B)O[R*a+B]=Math.trunc($/D[B]),$%=D[B]}return[O,[o,a],u]}function hW(n,t,e,r,i,s=!1,o=0){const a=r.length,u=[t[0],n.length/t[0]],d=u[1],y=a>0?i[a-1]+1:0;if(y<0)throw new Error("segment ids must be >= 0");const _=t.slice();_[0]=y;const D=Ws(e,_.reduce((Q,ie)=>Q*ie,1));if(0===a)return y>0&&D.fill(o),[D,_];if(y<=0)throw new Error("segment ids must be >= 0");let O=0,R=1,$=0,B=i[O];for(;;){let Q=0;if(R<a){if(Q=i[R],B===Q){++R;continue}if(B>=Q)throw new Error("segment ids are not increasing")}if(B<0||B>=y)throw new Error(nX(B,y));B>$&&D.fill(o,$*d,B*d);for(let ie=O;ie<R;++ie){const ye=r[ie];if(ye<0||ye>=u[0])throw new Error(rX(ie,r[ie],u[0]));for(let Me=0;Me<d;Me++)D[B*d+Me]+=n[ye*d+Me]}if(s)for(let ie=0;ie<d;ie++)D[B*d+ie]/=R-O;if(O=R,++R,$=B+1,B=Q,R>a)break}return $<y&&D.fill(o,$*d,y*d),[D,_]}const oCe=Kh(n=>Math.sqrt(n)),aCe=Wi(b0,n=>Math.sqrt(n)),uCe={kernelName:b0,backendName:"cpu",kernelFunc:aCe},uee=_o((n,t)=>{const e=n-t;return e*e}),lCe=Qo(w0,uee),cCe={kernelName:w0,backendName:"cpu",kernelFunc:lCe},lee=Kh((n,t)=>{const{pattern:e,replaceGlobal:r,rewrite:i}=t;return n.replace(new RegExp(e,r?"g":""),i)}),hCe=sm(bS,lee),fCe={kernelName:bS,backendName:"cpu",kernelFunc:hCe};function cee(n,t,e,r){const i=Zr(n,t.dtype);for(let s=0;s<i.size;s++){const o=i.indexToLoc(s),a=new Array(o.length);for(let u=0;u<a.length;u++)a[u]=o[u]*e[u]+r[u];i.set(t.get(...a),...o)}return i}class dCe{constructor(t,e,r,i,s,o){this.separator=Ph(t),this.nGramWidths=e,this.leftPad=Ph(r),this.rightPad=Ph(i),this.padWidth=s,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const r=this.getPadWidth(e);return Math.max(0,t+2*r-e+1)}createNGrams(t,e,r,i,s,o){for(let a=0;a<s;++a){const u=this.getPadWidth(o),d=Math.max(0,u-a),m=Math.max(0,u-(s-(a+1))),y=o-(d+m),_=e+(d>0?0:a-u);let E=0;E+=d*this.leftPad.length;for(let B=0;B<y;++B)E+=t[_+B].length;E+=m*this.rightPad.length,E+=(d+m+y-1)*this.separator.length,r[i+a]=new Uint8Array(E);const O=r[i+a];let R=0;const $=B=>B.forEach(Q=>O[R++]=Q);for(let B=0;B<d;++B)$(this.leftPad),$(this.separator);for(let B=0;B<y-1;++B)$(t[_+B]),$(this.separator);if(y>0){$(t[_+y-1]);for(let B=0;B<m;++B)$(this.separator),$(this.rightPad)}else{for(let B=0;B<m-1;++B)$(this.rightPad),$(this.separator);$(this.rightPad)}}}compute(t,e){const r=t.length,i=e.length;if(i>0){let u=e[0];if(0!==u)throw new Error(`First split value must be 0, got ${u}`);for(let d=1;d<i;++d){let m=e[d]>=u;if(m=m&&e[d]<=r,!m)throw new Error(`Invalid split value ${e[d]}, must be in [${u}, ${r}]`);u=e[d]}if(u!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${u}`)}const s=i-1,o=Ws("int32",i);if(0===r||0===i){const u=new Array(r);for(let d=0;d<=s;++d)o[d]=0;return[u,o]}o[0]=0;for(let u=1;u<=s;++u){const d=e[u]-e[u-1];let m=0;this.nGramWidths.forEach(y=>{m+=this.getNumNGrams(d,y)}),this.preserveShort&&d>0&&0===m&&(m=1),o[u]=o[u-1]+m}const a=new Array(o[s]);for(let u=0;u<s;++u){const d=e[u];let m=o[u];if(this.nGramWidths.forEach(y=>{const E=this.getNumNGrams(e[u+1]-e[u],y);this.createNGrams(t,d,a,m,E,y),m+=E}),this.preserveShort&&m===o[u]){const y=e[u+1]-e[u];if(0===y)continue;this.createNGrams(t,d,a,m,1,y+2*this.padWidth)}}return[a,o]}}function hee(n,t,e,r,i,s,o,a){return new dCe(e,r,i,s,o,a).compute(n,t)}function pCe(n,t,e,r){if(!n.length)return;if(0===t.length){for(let s=0;s<n.length;++s)r.push(n.subarray(s,s+1));return}if(1===t.length){const s=t[0];let o=n.indexOf(s);for(;-1!==o;){const a=n.subarray(0,o);(!e||0!==a.length)&&r.push(a),o=(n=n.subarray(o+1)).indexOf(s)}return void((!e||0!==n.length)&&r.push(n))}let i=0;for(let s=0;s<n.length+1;s++)if(s===n.length||-1!==t.indexOf(n[s])){const o=n.subarray(i,s);(!e||0!==o.length)&&r.push(o),i=s+1}}function fee(n,t,e){const r=n.length,i=[];let s=0,o=0;const a=new Array(r);for(let _=0;_<r;++_){const E=i.length;pCe(n[_],t,e,i);const D=i.length-E;a[_]=D,s+=D,o=Math.max(o,D)}const u=Ws("int32",2*s),d=new Array(s),m=[r,o];let y=0;for(let _=0;_<r;++_)for(let E=0;E<a[_];++E)u[2*y]=_,u[2*y+1]=E,d[y]=i[y],++y;return[u,d,m]}function dee(n,t){const e=Ws("int32",n.length);for(let r=0;r<n.length;++r)e[r]=P7(n[r]).modulo(t).getLowBitsUnsigned();return e}const pee=_o((n,t)=>n-t),mCe=aW((n,t,e,r)=>({real:n-e,imag:t-r})),fW=Qo(x0,pee,mCe),gCe={kernelName:x0,backendName:"cpu",kernelFunc:fW};function mee(n,t){const e=new Array(n.rank);for(let i=0;i<e.length;i++)e[i]=n.shape[i]*t[i];const r=Zr(e,n.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),o=new Array(n.rank);for(let u=0;u<o.length;u++)o[u]=s[u]%n.shape[u];const a=n.locToIndex(o);r.values[i]=n.values[a]}return r}const CE=(n,t)=>{const e=t.value-n.value;return 0===e?n.index-t.index:e};function gee(n,t,e=0,r=n.length-1){for(;r>e;){if(r-e>600){const a=r-e+1,u=t-e+1,d=Math.log(a),m=.5*Math.exp(2*d/3),y=.5*Math.sqrt(d*m*(a-m)/a)*Math.sign(u-a/2);gee(n,t,Math.max(e,Math.floor(t-u*m/a+y)),Math.min(r,Math.floor(t+(a-u)*m/a+y)))}const i=n[t];let s=e,o=r;for(Zf(n,e,t),CE(n[r],i)>0&&Zf(n,e,r);s<o;){for(Zf(n,s,o),s++,o--;CE(n[s],i)<0;)s+=1;for(;CE(n[o],i)>0;)o-=1}0===CE(n[e],i)?Zf(n,e,o):(o+=1,Zf(n,o,r)),o<=t&&(e=o+1),t<=o&&(r=o-1)}}function vee(n,t,e,r,i){const s=t[t.length-1],[o,a]=[n.length/s,s],u=Wo(e,o*r),d=Wo("int32",o*r);for(let y=0;y<o;y++){const _=y*a,E=n.subarray(_,_+a);let D=new Array(E.length);E.forEach((B,Q)=>D[Q]={value:B,index:Q}),r<D.length&&(gee(D,r),D=D.slice(0,r)),i&&D.sort(CE);const O=y*r,R=u.subarray(O,O+r),$=d.subarray(O,O+r);for(let B=0;B<r;B++)R[B]=D[B].value,$[B]=D[B].index}const m=t.slice();return m[m.length-1]=r,[Zr(m,e,u),Zr(m,"int32",d)]}function yee(n,t,e,r){const i=Yr(t,e)[0],s=[1,e[0],1];for(let D=0;D<i;D++)s[0]*=e[D];s[1]=e[i];for(let D=i+1;D<e.length;D++)s[2]*=e[D];const o=new Map,a=new Int32Array(e[i]),u=new po(s,r,n),d=[],m=1===s[0]&&1===s[2];for(let D=0;D<e[i];D++){let O;if(m)O=n[D].toString();else{const $=[];for(let B=0;B<s[0];B++)for(let Q=0;Q<s[2];Q++)$.push(u.get(B,D,Q));O=$.join(",")}const R=o.get(O);if(null!=R)a[D]=R;else{const $=o.size;o.set(O,$),a[D]=$,d.push(D)}}const y=s.slice();y[1]=o.size;const _=new po(y,r);d.forEach((D,O)=>{for(let R=0;R<s[0];R++)for(let $=0;$<s[2];$++)_.set(u.get(R,D,$),R,O,$)});const E=e.slice();return E[i]=y[1],{outputValues:_.values,outputShape:E,indices:a}}const _ee="4.4.0";kU("cpu",()=>new wJ,1);const bee=Wi(W_,n=>n>=0?n:Math.exp(n)-1),vCe={kernelName:W_,backendName:"cpu",kernelFunc:bee};function wee(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{alpha:s}=r;er([i],"leakyRelu");const o=Xt(i.shape),a=e.data.get(i.dataId).values,u=Wo("float32",o);for(let d=0;d<a.length;d++)u[d]=a[d]<0?s*a[d]:a[d];return e.makeTensorInfo(i.shape,"float32",u)}const yCe={kernelName:HC,backendName:"cpu",kernelFunc:wee},_Ce=_o((n,t)=>n<0?t*n:n);function xee(n){const{inputs:t,backend:e}=n,{x:r,alpha:i}=t;er([r,i],"prelu");const s=e.data.get(r.dataId).values,o=e.data.get(i.dataId).values,[a,u]=_Ce(r.shape,i.shape,s,o,"float32");return e.makeTensorInfo(u,"float32",a)}const bCe={kernelName:uS,backendName:"cpu",kernelFunc:xee},Cee=Wi(c0,n=>Math.max(0,n)),wCe={kernelName:c0,backendName:"cpu",kernelFunc:Cee},See=Wi(h0,n=>Math.min(Math.max(0,n),6)),xCe={kernelName:h0,backendName:"cpu",kernelFunc:See};function nF(n,t,e,r,i){if("linear"===e)return Zh({inputs:{x:t},backend:n});if("relu"===e)return Cee({inputs:{x:t},backend:n});if("elu"===e)return bee({inputs:{x:t},backend:n});if("relu6"===e)return See({inputs:{x:t},backend:n});if("prelu"===e)return xee({inputs:{x:t,alpha:r},backend:n});if("leakyrelu"===e)return wee({inputs:{x:t},backend:n,attrs:{alpha:i}});if("sigmoid"===e)return iee({inputs:{x:t},backend:n});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}function as(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{shape:s}=r,o=Xt(i.shape),a=Q4(s,o),u=Xt(a);De(o===u,()=>`The new shape (${a}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),e.incRef(i.dataId);const d=e.data.get(i.dataId);if(null!=d.complexTensorInfos){const y=d.complexTensorInfos.imag;d.complexTensorInfos.real.shape=a,y.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}const CCe={kernelName:cS,backendName:"cpu",kernelFunc:as};function Eee(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;er([i,s],"matMul");const u=i.shape.length,d=s.shape.length,m=o?i.shape[u-2]:i.shape[u-1],y=a?s.shape[d-1]:s.shape[d-2],_=o?i.shape[u-1]:i.shape[u-2],E=a?s.shape[d-2]:s.shape[d-1],D=i.shape.slice(0,-2),O=s.shape.slice(0,-2),R=Xt(D),$=Xt(O),Q=Fr(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([_,E]);De(m===y,()=>`Error in matMul: inner shapes (${m}) and (${y}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${o} and transposeB=${a} must match.`);const ye=a?[$,E,y]:[$,y,E],Me=as({inputs:{x:i},backend:e,attrs:{shape:o?[R,m,_]:[R,_,m]}}),Be=as({inputs:{x:s},backend:e,attrs:{shape:ye}}),He=o?Me.shape[1]:Me.shape[2],st=o?Me.shape[2]:Me.shape[1],lt=a?Be.shape[1]:Be.shape[2],It=Math.max(R,$),zt=e.data.get(Me.dataId).values,Wt=e.data.get(Be.dataId).values,qt=ur(Me.shape),Kt=ur(Be.shape),[Tt,Rt,Dt]=o?[qt[0],1,qt[1]]:[qt[0],qt[1],1],[Ht,ln,vn]=a?[1,Kt[1],Kt[0]]:[Kt[1],1,Kt[0]],An=st*lt,Tn=Zr([It,st,lt],Me.dtype),In=Tn.values,kn=e.blockSize;for(let Hn=0;Hn<It;Hn++){const Un=Hn%R,lr=Hn%$;for(let ir=0;ir<st;ir+=kn){const Cr=Math.min(ir+kn,st);for(let $r=0;$r<lt;$r+=kn){const Gi=Math.min($r+kn,lt);for(let us=0;us<He;us+=kn){const Gs=Math.min(us+kn,He);for(let ls=ir;ls<Cr;ls++)for(let Xi=$r;Xi<Gi;Xi++){let Fs=0;for(let ws=us;ws<Gs;ws++)Fs+=zt[Un*Tt+ls*Rt+ws*Dt]*Wt[ws*Ht+Xi*ln+lr*vn];In[Hn*An+(ls*lt+Xi)]+=Fs}}}}}return e.disposeIntermediateTensorInfo(Me),e.disposeIntermediateTensorInfo(Be),e.makeTensorInfo(Q,Tn.dtype,Tn.values)}const SCe={kernelName:AC,backendName:"cpu",kernelFunc:Eee},NCe={kernelName:SS,backendName:"cpu",kernelFunc:function ECe(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:u,transposeB:d,activation:m,leakyreluAlpha:y}=r;let _,E,D;const O=[];_=Eee({inputs:{a:i,b:s},attrs:{transposeA:u,transposeB:d},backend:e}),o&&(E=tb({inputs:{a:_,b:o},backend:e}),O.push(_),_=E),m&&(D=nF(e,_,m,a,y),O.push(_),_=D);for(const $ of O)e.disposeIntermediateTensorInfo($);return _}},TCe=Wi(M_,n=>Math.acos(n)),ACe={kernelName:M_,backendName:"cpu",kernelFunc:TCe},ICe=Wi(k_,n=>Math.acosh(n)),DCe={kernelName:k_,backendName:"cpu",kernelFunc:ICe},kCe={kernelName:CC,backendName:"cpu",kernelFunc:function MCe(n){const{inputs:t,backend:e}=n,r=t;er(t,"addN");const i=r.map(a=>e.data.get(a.dataId).values),s=Zr(r[0].shape,r[0].dtype),o=s.values;for(let a=0;a<r.length;a++){const u=i[a];for(let d=0;d<o.length;d++)o[d]+=u[d]}return e.makeTensorInfo(s.shape,s.dtype,s.values)}},OCe={kernelName:e2,backendName:"cpu",kernelFunc:function RCe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;er(i,"all");const a=Yr(s,i.shape);let u=a;const d=ks(u,i.shape.length);let m=i;null!=d&&(m=wu({inputs:{x:i},backend:e,attrs:{perm:d}}),u=to(u.length,i.shape.length)),ca("all",u,m.shape.length);const[y,_]=Ko(m.shape,u),E=Xt(_),D=oa(Xt(y),m.dtype),O=e.data.get(m.dataId).values;for(let $=0;$<D.length;++$){const B=$*E;let Q=O[B];for(let ie=0;ie<E;++ie){const ye=O[B+ie];Q=Q&&ye}D[$]=Q}null!=d&&e.disposeIntermediateTensorInfo(m);const R=e.makeTensorInfo(y,m.dtype,D);if(o){const B=as({inputs:{x:R},backend:e,attrs:{shape:eo(y,a)}});return e.disposeIntermediateTensorInfo(R),B}return R}},PCe={kernelName:t2,backendName:"cpu",kernelFunc:function FCe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;er(i,"any");const a=Yr(s,i.shape);let u=a;const d=ks(u,i.shape.length);let m=i;null!=d&&(m=wu({inputs:{x:i},backend:e,attrs:{perm:d}}),u=to(u.length,i.shape.length)),ca("any",u,m.shape.length);const[y,_]=Ko(m.shape,u),E=Xt(_),D=oa(Xt(y),m.dtype),O=e.data.get(m.dataId).values;for(let $=0;$<D.length;++$){const B=$*E;let Q=O[B];for(let ie=0;ie<E;++ie){const ye=O[B+ie];Q=Q||ye}D[$]=Q}null!=d&&e.disposeIntermediateTensorInfo(m);const R=e.makeTensorInfo(y,m.dtype,D);if(o){const B=as({inputs:{x:R},backend:e,attrs:{shape:eo(y,a)}});return e.disposeIntermediateTensorInfo(R),B}return R}},$Ce={kernelName:SC,backendName:"cpu",kernelFunc:function LCe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;er(i,"argMax");let o=Yr(s,i.shape);const a=ks(o,i.shape.length);let u=i;const d=[];null!=a&&(u=wu({inputs:{x:i},backend:e,attrs:{perm:a}}),d.push(u),o=to(o.length,u.shape.length)),o=[o[0]],ca("argMax",o,u.shape.length);const[m,y]=Ko(u.shape,o),E=oa(Xt(m),"int32"),D=Xt(y),O=e.data.get(u.dataId).values;for(let R=0;R<E.length;++R){const $=R*D;let B=O[$],Q=0;for(let ie=0;ie<D;++ie){const ye=O[$+ie];ye>B&&(B=ye,Q=ie)}E[R]=Q}return d.forEach(R=>e.disposeIntermediateTensorInfo(R)),e.makeTensorInfo(m,"int32",E)}},VCe={kernelName:EC,backendName:"cpu",kernelFunc:function BCe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;er(i,"argMin");let o=Yr(s,i.shape);const a=ks(o,i.shape.length);let u=i;const d=[];null!=a&&(u=wu({inputs:{x:i},backend:e,attrs:{perm:a}}),d.push(u),o=to(o.length,u.shape.length)),o=[o[0]],ca("argMin",o,u.shape.length);const[m,y]=Ko(u.shape,o),E=oa(Xt(m),"int32"),D=Xt(y),O=e.data.get(u.dataId).values;for(let R=0;R<E.length;++R){const $=R*D;let B=O[$],Q=0;for(let ie=0;ie<D;++ie){const ye=O[$+ie];ye<B&&(B=ye,Q=ie)}E[R]=Q}return d.forEach(R=>e.disposeIntermediateTensorInfo(R)),e.makeTensorInfo(m,"int32",E)}},zCe=Wi(R_,n=>Math.asin(n)),UCe={kernelName:R_,backendName:"cpu",kernelFunc:zCe},HCe=Wi(O_,n=>Math.asinh(n)),WCe={kernelName:O_,backendName:"cpu",kernelFunc:HCe},GCe=Wi(F_,n=>Math.atan(n)),jCe={kernelName:F_,backendName:"cpu",kernelFunc:GCe},qCe=_o((n,t)=>Math.atan2(n,t)),ZCe=Qo(L_,qCe),KCe={kernelName:L_,backendName:"cpu",kernelFunc:ZCe},XCe=Wi(P_,n=>Math.atanh(n)),YCe={kernelName:P_,backendName:"cpu",kernelFunc:XCe};function dW(n,t,e,r,i,s){const o=i.strideHeight,a=i.strideWidth,u=i.dilationHeight,d=i.dilationWidth,m=i.effectiveFilterHeight,y=i.effectiveFilterWidth,_=i.padInfo.top,E=i.padInfo.left,D="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,O=Zr(i.outShape,e),R=O.values,$=i.outShape[1]*i.outShape[2]*i.outShape[3],B=i.outShape[2]*i.outShape[3],Q=i.outShape[3];for(let ie=0;ie<i.batchSize;++ie){const ye=ie*$,Me=ie*r[0];for(let Be=0;Be<i.inChannels;++Be)for(let He=0;He<i.outHeight;++He){const st=He*o-_,lt=Math.max(0,st),It=Math.min(i.inHeight,m+st),zt=ye+He*B;for(let Wt=0;Wt<i.outWidth;++Wt){const qt=Wt*a-E,Kt=Math.max(0,qt),Tt=Math.min(i.inWidth,y+qt);let Rt=D,Dt=0,Ht=0;for(let vn=lt;vn<It;vn+=u){const An=Me+vn*r[1];for(let Tn=Kt;Tn<Tt;Tn+=d){const kn=n[An+Tn*r[2]+Be];"max"===s&&kn>Rt?Rt=kn:"avg"===s&&(Dt+=kn,Ht++)}if(isNaN(Rt))break}R[zt+Wt*Q+Be]="avg"===s?Dt/Ht:Rt}}}return O}function Nee(n,t,e,r,i=!1,s=!1){const o=Zr(r.outShape,"int32"),a=r.strideHeight,u=r.strideWidth,d=r.dilationHeight,m=r.dilationWidth,y=r.effectiveFilterHeight,_=r.effectiveFilterWidth,E=r.padInfo.top,D=r.padInfo.left,O=Zr(t,e,n);for(let R=0;R<r.batchSize;++R)for(let $=0;$<r.inChannels;++$)for(let B=0;B<r.outHeight;++B){const Q=B*a-E;let ie=Q;for(;ie<0;)ie+=d;const ye=Math.min(r.inHeight,y+Q);for(let Me=0;Me<r.outWidth;++Me){const Be=Me*u-D;let He=Be;for(;He<0;)He+=m;const st=Math.min(r.inWidth,_+Be);let lt=Number.NEGATIVE_INFINITY,It=-1;for(let zt=ie;zt<ye;zt+=d){const Wt=zt-Q;for(let qt=He;qt<st;qt+=m){const Kt=qt-Be,Tt=O.get(R,zt,qt,$);Tt>lt&&(lt=Tt,It=i?s?((R*r.inHeight+zt)*r.inWidth+qt)*r.inChannels+$:(zt*r.inWidth+qt)*r.inChannels+$:Wt*_+Kt)}}o.set(It,R,B,Me,$)}}return o}function Tee(n,t,e,r,i,s){const o=i.strideDepth,a=i.strideHeight,u=i.strideWidth,d=i.dilationDepth,m=i.dilationHeight,y=i.dilationWidth,_=i.effectiveFilterDepth,E=i.effectiveFilterHeight,D=i.effectiveFilterWidth,O=i.padInfo.front,R=i.padInfo.top,$=i.padInfo.left,B="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,Q=Zr(i.outShape,e),ie=Q.values,ye=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],Me=i.outShape[2]*i.outShape[3]*i.outShape[4],Be=i.outShape[3]*i.outShape[4],He=i.outShape[4];for(let st=0;st<i.batchSize;++st){const lt=st*ye,It=st*r[0];for(let zt=0;zt<i.inChannels;++zt)for(let Wt=0;Wt<i.outDepth;++Wt){const qt=Wt*o-O;let Kt=qt;for(;Kt<0;)Kt+=d;const Tt=Math.min(i.inDepth,_+qt),Rt=lt+Wt*Me;for(let Dt=0;Dt<i.outHeight;++Dt){const Ht=Dt*a-R;let ln=Ht;for(;ln<0;)ln+=m;const vn=Math.min(i.inHeight,E+Ht),An=Rt+Dt*Be;for(let Tn=0;Tn<i.outWidth;++Tn){const In=Tn*u-$;let kn=In;for(;kn<0;)kn+=y;const Hn=Math.min(i.inWidth,D+In),Un=An+Tn*He;let lr=B,ir=0,Cr=0;for(let Gi=Kt;Gi<Tt;Gi+=d){const us=It+Gi*r[1];for(let Gs=ln;Gs<vn;Gs+=m){const ls=us+Gs*r[2];for(let Xi=kn;Xi<Hn;Xi+=y){const ws=n[ls+Xi*r[3]+zt];if("max"===s&&ws>lr?lr=ws:"avg"===s&&(ir+=ws,Cr++),isNaN(lr))break}if(isNaN(lr))break}if(isNaN(lr))break}ie[Un+zt]="avg"===s?ir/Math.max(Cr,1):lr}}}}return Q}const eSe={kernelName:NC,backendName:"cpu",kernelFunc:function JCe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;er(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r;De(la(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const m=uc(i.shape,s,o,1,a,u);let y;if(1===m.filterWidth&&1===m.filterHeight&&ri(m.inShape,m.outShape))y=Zh({inputs:{x:i},backend:e});else{const _=e.data.get(i.dataId).values,E=ur(i.shape),D=dW(_,0,i.dtype,E,m,"avg");y=e.makeTensorInfo(m.outShape,i.dtype,D.values)}return y}},nSe={kernelName:TC,backendName:"cpu",kernelFunc:function tSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:d}=r;er(i,"avgPool3d");const m=rd(i.shape,s,o,1,a,u,d),_=Tee(e.data.get(i.dataId).values,0,i.dtype,ur(i.shape),m,"avg");return e.makeTensorInfo(_.shape,"float32",_.values)}},iSe={kernelName:r2,backendName:"cpu",kernelFunc:function rSe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:u,dimRoundingMode:d}=r;er([i,s],"avgPool3DGrad");const m=rd(s.shape,o,a,1,u,d),y=m.strideDepth,_=m.strideHeight,E=m.strideWidth,D=m.filterDepth,O=m.filterHeight,R=m.filterWidth,$=m.dilationDepth,B=m.dilationHeight,Q=m.dilationWidth,ie=m.effectiveFilterDepth,ye=m.effectiveFilterHeight,Me=m.effectiveFilterWidth,Be=ie-1-m.padInfo.front,He=Me-1-m.padInfo.left,st=ye-1-m.padInfo.top,lt=Zr(s.shape,"float32"),It=1/(D*O*R),zt=e.bufferSync(i);for(let Wt=0;Wt<m.batchSize;++Wt)for(let qt=0;qt<m.inChannels;++qt)for(let Kt=0;Kt<m.inDepth;++Kt)for(let Tt=0;Tt<m.inHeight;++Tt)for(let Rt=0;Rt<m.inWidth;++Rt){const Dt=Kt-Be,Ht=Tt-st,ln=Rt-He;let vn=0;for(let An=0;An<ie;An+=$){const Tn=(Dt+An)/y;if(!(Tn<0||Tn>=m.outDepth||Math.floor(Tn)!==Tn))for(let In=0;In<ye;In+=B){const kn=(Ht+In)/_;if(!(kn<0||kn>=m.outHeight||Math.floor(kn)!==kn))for(let Hn=0;Hn<Me;Hn+=Q){const Un=(ln+Hn)/E;Un<0||Un>=m.outWidth||Math.floor(Un)!==Un||(vn+=zt.get(Wt,Tn,kn,Un,qt))}}}lt.set(vn*It,Wt,Kt,Tt,Rt,qt)}return e.makeTensorInfo(lt.shape,lt.dtype,lt.values)}},oSe={kernelName:n2,backendName:"cpu",kernelFunc:function sSe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s;er([i,s],"avgPoolGrad");const{filterSize:a,strides:u,pad:d}=r,m=uc(o.shape,a,u,1,d),y=m.strideHeight,_=m.strideWidth,E=m.filterHeight,D=m.filterWidth,O=m.dilationHeight,R=m.dilationWidth,$=m.effectiveFilterHeight,B=m.effectiveFilterWidth,Q=B-1-m.padInfo.left,ie=$-1-m.padInfo.top,ye=Zr(o.shape,"float32"),Me=1/(E*D),Be=e.data.get(i.dataId).values,He=Zr(i.shape,"float32",Be);for(let st=0;st<m.batchSize;++st)for(let lt=0;lt<m.inChannels;++lt)for(let It=0;It<m.inHeight;++It)for(let zt=0;zt<m.inWidth;++zt){const Wt=It-ie,qt=zt-Q;let Kt=0;for(let Tt=0;Tt<$;Tt+=O){const Rt=(Wt+Tt)/y;if(!(Rt<0||Rt>=m.outHeight||Math.floor(Rt)!==Rt))for(let Dt=0;Dt<B;Dt+=R){const Ht=(qt+Dt)/_;Ht<0||Ht>=m.outWidth||Math.floor(Ht)!==Ht||(Kt+=He.get(st,Rt,Ht,lt))}}ye.set(Kt*Me,st,It,zt,lt)}return e.makeTensorInfo(ye.shape,ye.dtype,ye.values)}},uSe={kernelName:VC,backendName:"cpu",kernelFunc:function aSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,scale:s,offset:o,mean:a,variance:u}=t;De(a.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),De(null==o||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),De(null==s||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),er([i,a,u,s,o],"batchNorm");let{varianceEpsilon:d}=r;null==d&&(d=.001);const m=e.data.get(i.dataId).values,y=e.data.get(a.dataId).values,_=e.data.get(u.dataId).values,E=s?e.data.get(s.dataId).values:new Float32Array([1]),D=o?e.data.get(o.dataId).values:new Float32Array([0]),O=new Float32Array(m.length),R=D.length,$=E.length,B=_.length,Q=y.length;let ie=0,ye=0,Me=0,Be=0;for(let He=0;He<m.length;++He)O[He]=D[ie++]+(m[He]-y[ye++])*E[Me++]/Math.sqrt(_[Be++]+d),ie>=R&&(ie=0),ye>=Q&&(ye=0),Me>=$&&(Me=0),Be>=B&&(Be=0);return e.makeTensorInfo(i.shape,i.dtype,O)}},cSe={kernelName:IC,backendName:"cpu",kernelFunc:function lSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,crops:o}=r;er([i],"batchToSpaceND");const a=s.reduce(($,B)=>$*B),u=nE(i.shape,s,a),d=rE(u.length,s.length),m=iE(i.shape,s,a),y=wH(o,s.length),_=xH(m,o,s.length),E=as({inputs:{x:i},backend:e,attrs:{shape:u}}),D=wu({inputs:{x:E},backend:e,attrs:{perm:d}}),O=as({inputs:{x:D},backend:e,attrs:{shape:m}}),R=Sv({inputs:{x:O},backend:e,attrs:{begin:y,size:_}});return e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(D),e.disposeIntermediateTensorInfo(O),R}},fSe={kernelName:s2,backendName:"cpu",kernelFunc:function hSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o}=r,d=uW(e.data.get(i.dataId).values,e.data.get(s.dataId).values,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,d)}},pSe={kernelName:o2,backendName:"cpu",kernelFunc:function dSe(n){const{inputs:t,backend:e}=n,{s0:r,s1:i}=t,s=e.data.get(r.dataId).values,o=e.data.get(i.dataId).values,a=Fr(Array.from(s),Array.from(o));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}},mSe=Wi(V_,(n,t)=>n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n),gSe={kernelName:V_,backendName:"cpu",kernelFunc:mSe},vSe={kernelName:DC,backendName:"cpu",kernelFunc:n=>{const{x:t}=n.inputs,e=n.backend,r=new Float32Array(Xt(t.shape)),i=e.data.get(t.dataId),o=i.complexTensorInfos.imag,a=e.data.get(i.complexTensorInfos.real.dataId).values,u=e.data.get(o.dataId).values;for(let d=0;d<a.length;d++)r[d]=Math.hypot(a[d],u[d]);return e.makeOutput(r,t.shape,"float32")}};function nb(n){const{inputs:t,backend:e}=n,{input:r}=t,i=e.data.get(r.dataId).complexTensorInfos.imag,s=e.data.get(i.dataId).values;return e.makeTensorInfo(i.shape,i.dtype,s)}const ySe={kernelName:T2,backendName:"cpu",kernelFunc:nb};function rb(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r,s=Yr(i,t[0].shape)[0];yH(t.map(O=>O.shape),s);let a=Hh(t.map(O=>O.shape),s);if(0===Xt(a))return e.makeTensorInfo(a,t[0].dtype,[]);const u=t.filter(O=>Xt(O.shape)>0);if(1===u.length)return Zh({inputs:{x:u[0]},backend:e});if("complex64"===u[0].dtype){const O=u.map(ie=>xv({inputs:{input:ie},backend:e})),R=u.map(ie=>nb({inputs:{input:ie},backend:e})),$=rb({inputs:O,backend:e,attrs:{axis:s}}),B=rb({inputs:R,backend:e,attrs:{axis:s}}),Q=Ku({inputs:{real:$,imag:B},backend:e});return O.forEach(ie=>e.disposeIntermediateTensorInfo(ie)),R.forEach(ie=>e.disposeIntermediateTensorInfo(ie)),e.disposeIntermediateTensorInfo($),e.disposeIntermediateTensorInfo(B),Q}const d=u.map(O=>{const R=Xt(O.shape.slice(s));return as({inputs:{x:O},backend:e,attrs:{shape:[-1,R]}})}),m=d.map(O=>({vals:e.data.get(O.dataId).values,shape:O.shape}));a=Hh(d.map(O=>O.shape),1);const _=TJ(m,a,t[0].dtype,1===d[0].shape[0]),E=Hh(u.map(O=>O.shape),s),D=e.makeTensorInfo(E,t[0].dtype,_);return d.forEach(O=>e.disposeIntermediateTensorInfo(O)),D}const _Se={kernelName:MC,backendName:"cpu",kernelFunc:rb};function Aee(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:u,dilations:d,dimRoundingMode:m}=r;er([i,s],"conv2d");const y=id(u),_=qo(i.shape,s.shape,o,d,a,m,!1,y),E=_.filterHeight,D=_.filterWidth,O=_.dilationHeight,R=_.dilationWidth,$=_.padInfo.left,B=_.padInfo.top,Q="channelsLast"===_.dataFormat,ie=new po(_.outShape,i.dtype),ye=ur(i.shape),Me=ur(s.shape),Be=ye[0],He=Q?ye[1]:ye[2],st=Q?ye[2]:1,lt=Q?1:ye[1],It=ie.strides[0],zt=Q?ie.strides[1]:ie.strides[2],Wt=Q?ie.strides[2]:1,qt=Q?1:ie.strides[1],Kt=e.data.get(i.dataId).values,Tt=e.data.get(s.dataId).values,Rt=ie.values;for(let Dt=0;Dt<_.batchSize;++Dt){const Ht=Dt*Be,ln=Dt*It;for(let vn=0;vn<_.outHeight;++vn){const An=ln+vn*zt,Tn=vn*_.strideHeight-B;for(let In=0;In<E;++In){const kn=Tn+In*O;if(kn<0||kn>=_.inHeight)continue;const Hn=In*Me[0],Un=Ht+kn*He;for(let lr=0;lr<_.outWidth;++lr){const ir=An+lr*Wt,Cr=lr*_.strideWidth-$;for(let $r=0;$r<D;++$r){const Gi=Cr+$r*R;if(Gi<0||Gi>=_.inWidth)continue;const Gs=Un+Gi*st;let ls=Hn+$r*Me[1];for(let Xi=0;Xi<_.inChannels;++Xi){const Fs=Kt[Gs+Xi*lt];for(let ws=0;ws<_.outChannels;++ws)Rt[ir+ws*qt]+=Fs*Tt[ls+ws];ls+=_.outChannels}}}}}}return e.makeTensorInfo(ie.shape,ie.dtype,Rt)}const bSe={kernelName:kC,backendName:"cpu",kernelFunc:Aee},xSe={kernelName:u2,backendName:"cpu",kernelFunc:function wSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:u,dimRoundingMode:d,filterShape:m}=r;er([i,s],"conv2dBackpropFilter");const y=id(u),_=qo(i.shape,m,o,1,a,d,!1,y),{strideHeight:E,strideWidth:D,filterHeight:O,filterWidth:R}=_,$="channelsLast"===_.dataFormat,B=new po(_.filterShape,"float32"),Q=_.padInfo.left,ie=_.padInfo.top,ye=e.data.get(i.dataId).values,Me=e.data.get(s.dataId).values,Be=new po(i.shape,i.dtype,ye),He=new po(s.shape,s.dtype,Me);for(let st=0;st<O;++st){const lt=Math.max(0,Math.ceil((ie-st)/E)),It=Math.min(_.outHeight,(_.inHeight+ie-st)/E);for(let zt=0;zt<R;++zt){const Wt=Math.max(0,Math.ceil((Q-zt)/D)),qt=Math.min(_.outWidth,(_.inWidth+Q-zt)/D);for(let Kt=0;Kt<_.inChannels;++Kt)for(let Tt=0;Tt<_.outChannels;++Tt){let Rt=0;for(let Dt=0;Dt<_.batchSize;++Dt)for(let Ht=lt;Ht<It;++Ht){const ln=st+Ht*E-ie;for(let vn=Wt;vn<qt;++vn){const An=zt+vn*D-Q;Rt+=$?Be.get(Dt,ln,An,Kt)*He.get(Dt,Ht,vn,Tt):Be.get(Dt,Kt,ln,An)*He.get(Dt,Tt,Ht,vn)}}B.set(Rt,st,zt,Kt,Tt)}}}return e.makeTensorInfo(B.shape,B.dtype,B.values)}},SSe={kernelName:RC,backendName:"cpu",kernelFunc:function CSe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:u,dataFormat:d,dimRoundingMode:m}=r;er([i,s],"conv2dBackpropInput");const y=ur(s.shape),_=ur(i.shape);let E=id(d);const D=qo(o,s.shape,a,1,u,m,!1,E),O=new po(D.inShape,"float32"),R=O.values,$=e.data.get(i.dataId).values,B=e.data.get(s.dataId).values,[Q,ie,ye]=y,{batchSize:Me,filterHeight:Be,filterWidth:He,inChannels:st,inHeight:lt,inWidth:It,outChannels:zt,outHeight:Wt,outWidth:qt,strideHeight:Kt,strideWidth:Tt}=D;E=D.dataFormat;const Rt=Be-1-D.padInfo.top,Dt=He-1-D.padInfo.left,Ht="channelsLast"===E,ln=O.strides[0],vn=Ht?O.strides[1]:O.strides[2],An=Ht?O.strides[2]:1,Tn=Ht?1:O.strides[1],In=_[0],kn=Ht?_[1]:_[2],Hn=Ht?_[2]:1,Un=Ht?1:_[1];for(let lr=0;lr<Me;++lr)for(let ir=0;ir<st;++ir)for(let Cr=0;Cr<lt;++Cr){const $r=Cr-Rt,Gi=Math.max(0,Math.ceil($r/Kt)),us=Math.min(Wt,(Be+$r)/Kt);for(let Gs=0;Gs<It;++Gs){const ls=Gs-Dt,Xi=Math.max(0,Math.ceil(ls/Tt)),Fs=Math.min(qt,(He+ls)/Tt);let ws=0;for(let da=Gi;da<us;++da){const pm=da*Kt-$r;for(let Dl=Xi;Dl<Fs;++Dl){const sh=In*lr+kn*da+Hn*Dl,yd=Q*(Be-1-pm)+ie*(He-1-(Dl*Tt-ls))+ye*ir;for(let mm=0;mm<zt;++mm)ws+=$[sh+Un*mm]*B[yd+mm]}}R[ln*lr+vn*Cr+An*Gs+Tn*ir]=ws}}return e.makeTensorInfo(O.shape,O.dtype,O.values)}},NSe={kernelName:OC,backendName:"cpu",kernelFunc:function ESe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r;er([i,s],"conv3d");const d=zp(i.shape,s.shape,o,u,a),{filterDepth:m,filterHeight:y,filterWidth:_,dilationDepth:E,dilationHeight:D,dilationWidth:O,padInfo:R}=d,$=R.front,B=R.left,Q=R.top,ie=new po(d.outShape,i.dtype),ye=e.data.get(i.dataId).values,Me=e.data.get(s.dataId).values,Be=ie.values,He=ur(i.shape),st=ur(s.shape);for(let lt=0;lt<d.batchSize;++lt){const It=lt*He[0],zt=lt*ie.strides[0];for(let Wt=0;Wt<d.outDepth;++Wt){const qt=zt+Wt*ie.strides[1],Kt=Wt*d.strideDepth-$;for(let Tt=0;Tt<m;++Tt){const Rt=Kt+Tt*E;if(Rt<0||Rt>=d.inDepth)continue;const Dt=Tt*st[0],Ht=It+Rt*He[1];for(let ln=0;ln<d.outHeight;++ln){const vn=qt+ln*ie.strides[2],An=ln*d.strideHeight-Q;for(let Tn=0;Tn<y;++Tn){const In=An+Tn*D;if(In<0||In>=d.inHeight)continue;const kn=Dt+Tn*st[1],Hn=Ht+In*He[2];for(let Un=0;Un<d.outWidth;++Un){const lr=vn+Un*d.outChannels,ir=Un*d.strideWidth-B;for(let Cr=0;Cr<_;++Cr){const $r=ir+Cr*O;if($r<0||$r>=d.inWidth)continue;const us=Hn+$r*d.inChannels;let Gs=kn+Cr*st[2];for(let ls=0;ls<d.inChannels;++ls){const Xi=ye[us+ls];for(let Fs=0;Fs<d.outChannels;++Fs)Be[lr+Fs]+=Xi*Me[Gs+Fs];Gs+=d.outChannels}}}}}}}}return e.makeTensorInfo(ie.shape,ie.dtype,ie.values)}},ASe={kernelName:l2,backendName:"cpu",kernelFunc:function TSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:u}=r;er([i,s],"conv3dBackpropFilterV2");const d=ur(i.shape),m=ur(s.shape),y=zp(i.shape,u,o,1,a),_=y.strideDepth,E=y.strideHeight,D=y.strideWidth,O=y.filterDepth,R=y.filterHeight,$=y.filterWidth,B=new po(y.filterShape,"float32"),Q=B.values,[ie,ye,Me,Be]=B.strides,He=e.data.get(s.dataId).values,[st,lt,It,zt]=m,Wt=e.data.get(i.dataId).values,[qt,Kt,Tt,Rt]=d,Dt=y.padInfo.front,Ht=y.padInfo.left,ln=y.padInfo.top;for(let vn=0;vn<O;++vn){const An=Math.max(0,Math.ceil((Dt-vn)/_)),Tn=Math.min(y.outDepth,(y.inDepth+Dt-vn)/_),In=vn*ie;for(let kn=0;kn<R;++kn){const Hn=Math.max(0,Math.ceil((ln-kn)/E)),Un=Math.min(y.outHeight,(y.inHeight+ln-kn)/E),lr=kn*ye+In;for(let ir=0;ir<$;++ir){const Cr=Math.max(0,Math.ceil((Ht-ir)/D)),$r=Math.min(y.outWidth,(y.inWidth+Ht-ir)/D),Gi=ir*Me+lr;for(let us=0;us<y.inChannels;++us){const Gs=us*Be+Gi;for(let ls=0;ls<y.outChannels;++ls){let Xi=0;for(let Fs=0;Fs<y.batchSize;++Fs){const ws=Fs*qt,vd=Fs*st;for(let da=An;da<Tn;++da){const Dl=(vn+da*_-Dt)*Kt+ws,Pv=da*lt+vd;for(let sh=Hn;sh<Un;++sh){const mm=(kn+sh*E-ln)*Tt+Dl,gm=sh*It+Pv;for(let vm=Cr;vm<$r;++vm)Xi+=Wt[(ir+vm*D-Ht)*Rt+mm+us]*He[vm*zt+gm+ls]}}}Q[Gs+ls]=Xi}}}}}return e.makeTensorInfo(B.shape,B.dtype,B.values)}},DSe={kernelName:c2,backendName:"cpu",kernelFunc:function ISe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:u}=r;er([i],"conv3dBackpropInputV2");const d=ur(i.shape),m=ur(s.shape),y=zp(u,s.shape,a,1,o),_=new po(y.inShape,"float32"),E=_.values,[D,O,R,$]=_.strides,B=e.data.get(i.dataId).values,[Q,ie,ye,Me]=d,Be=e.data.get(s.dataId).values,[He,st,lt,It]=m,{batchSize:zt,filterDepth:Wt,filterHeight:qt,filterWidth:Kt,inChannels:Tt,inDepth:Rt,inHeight:Dt,inWidth:Ht,outChannels:ln,outDepth:vn,outHeight:An,outWidth:Tn,strideDepth:In,strideHeight:kn,strideWidth:Hn}=y,Un=Wt-1-y.padInfo.front,lr=qt-1-y.padInfo.top,ir=Kt-1-y.padInfo.left;for(let Cr=0;Cr<zt;++Cr)for(let $r=0;$r<Tt;++$r)for(let Gi=0;Gi<Rt;++Gi){const us=Gi-Un,Gs=Math.max(0,Math.ceil(us/In)),ls=Math.min(vn,(Wt+us)/In);for(let Xi=0;Xi<Dt;++Xi){const Fs=Xi-lr,ws=Math.max(0,Math.ceil(Fs/kn)),vd=Math.min(An,(qt+Fs)/kn);for(let da=0;da<Ht;++da){const pm=da-ir,Dl=Math.max(0,Math.ceil(pm/Hn)),Pv=Math.min(Tn,(Kt+pm)/Hn);let sh=0;for(let yd=Gs;yd<ls;++yd){const mm=yd*In-us;for(let gm=ws;gm<vd;++gm){const vm=gm*kn-Fs;for(let KE=Dl;KE<Pv;++KE){const v8=Q*Cr+ie*yd+ye*gm+Me*KE,F3e=He*(Wt-1-mm)+st*(qt-1-vm)+lt*(Kt-1-(KE*Hn-pm))+It*$r;for(let UF=0;UF<ln;++UF)sh+=B[v8+UF]*Be[F3e+UF]}}}E[D*Cr+O*Gi+R*Xi+$*da+$r]=sh}}}return e.makeTensorInfo(_.shape,_.dtype,_.values)}},MSe=Wi(z_,n=>Math.cos(n)),kSe={kernelName:z_,backendName:"cpu",kernelFunc:MSe},RSe=Wi(U_,n=>Math.cosh(n)),OSe={kernelName:U_,backendName:"cpu",kernelFunc:RSe},PSe={kernelName:f2,backendName:"cpu",kernelFunc:function FSe(n){const{inputs:t,backend:e,attrs:r}=n,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:u,extrapolationValue:d}=r,[m,y,_,E]=i.shape,D=s.shape[0],[O,R]=a,$=Zr([D,O,R,E],"float32"),B=e.data.get(s.dataId).values,Q=e.data.get(o.dataId).values,ie=e.data.get(i.dataId).values,ye=ur(i.shape),Me=ur($.shape);for(let Be=0;Be<D;Be++){const He=4*Be,st=B[He],lt=B[He+1],It=B[He+2],zt=B[He+3],Wt=Q[Be];if(Wt>=m)continue;const qt=O>1?(It-st)*(y-1)/(O-1):0,Kt=R>1?(zt-lt)*(_-1)/(R-1):0;for(let Tt=0;Tt<O;Tt++){const Rt=O>1?st*(y-1)+Tt*qt:.5*(st+It)*(y-1);if(Rt<0||Rt>y-1)for(let Dt=0;Dt<R;Dt++)for(let Ht=0;Ht<E;Ht++)$.values[Ht+Dt*Me[2]+Tt*Me[1]+Be*Me[0]]=d;else if("bilinear"===u){const Dt=Math.floor(Rt),Ht=Math.ceil(Rt),ln=Rt-Dt;for(let vn=0;vn<R;vn++){const An=R>1?lt*(_-1)+vn*Kt:.5*(lt+zt)*(_-1);if(An<0||An>_-1){for(let Hn=0;Hn<E;Hn++)$.values[Hn+vn*Me[2]+Tt*Me[1]+Be*Me[0]]=d;continue}const Tn=Math.floor(An),In=Math.ceil(An),kn=An-Tn;for(let Hn=0;Hn<E;Hn++){let Un=Hn+Tn*ye[2]+Dt*ye[1]+Wt*ye[0];const lr=ie[Un];Un=Hn+In*ye[2]+Dt*ye[1]+Wt*ye[0];const ir=ie[Un];Un=Hn+Tn*ye[2]+Ht*ye[1]+Wt*ye[0];const Cr=ie[Un];Un=Hn+In*ye[2]+Ht*ye[1]+Wt*ye[0];const $r=ie[Un],Gi=lr+(ir-lr)*kn;Un=Hn+vn*Me[2]+Tt*Me[1]+Be*Me[0],$.values[Un]=Gi+(Cr+($r-Cr)*kn-Gi)*ln}}}else for(let Dt=0;Dt<R;++Dt){const Ht=R>1?lt*(_-1)+Dt*Kt:.5*(lt+zt)*(_-1);if(Ht<0||Ht>_-1){for(let An=0;An<E;An++)$.values[An+Dt*Me[2]+Tt*Me[1]+Be*Me[0]]=d;continue}const ln=Math.round(Ht),vn=Math.round(Rt);for(let An=0;An<E;An++)$.values[An+Dt*Me[2]+Tt*Me[1]+Be*Me[0]]=ie[An+ln*ye[2]+vn*ye[1]+Wt*ye[0]]}}}return e.makeTensorInfo($.shape,$.dtype,$.values)}},$Se={kernelName:h2,backendName:"cpu",kernelFunc:function LSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;er(i,"cumprod");const u=ks([s],i.shape.length);let d=i;null!=u&&(d=wu({inputs:{x:i},backend:e,attrs:{perm:u}}));const m=to(1,i.shape.length)[0];if(m!==d.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${m}`);const y=pu(d.dtype,"int32"),_=Jk(Xt(d.shape),y),E=e.data.get(d.dataId).values,D=d.shape[d.shape.length-1],O=a?($,B)=>$+D-B-1:($,B)=>$+B;for(let $=0;$<E.length;$+=D)for(let B=0;B<D;B++){const Q=O($,B);if(0===B)_[Q]=o?1:E[Q];else{const ie=O($,B-1);_[Q]=o?E[ie]*_[ie]:E[Q]*_[ie]}}const R=e.makeTensorInfo(d.shape,y,_);if(null!=u){const B=wu({inputs:{x:R},backend:e,attrs:{perm:Hp(u)}});return e.disposeIntermediateTensorInfo(R),e.disposeIntermediateTensorInfo(d),B}return R}},VSe={kernelName:FC,backendName:"cpu",kernelFunc:function BSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;er(i,"cumsum");const u=ks([s],i.shape.length);let d=i;null!=u&&(d=wu({inputs:{x:i},backend:e,attrs:{perm:u}}));const m=to(1,i.shape.length)[0];if(m!==d.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${m}`);const y=pu(d.dtype,"int32"),_=oa(Xt(d.shape),y),E=e.data.get(d.dataId).values,D=d.shape[d.shape.length-1],O=a?($,B)=>$+D-B-1:($,B)=>$+B;for(let $=0;$<E.length;$+=D)for(let B=0;B<D;B++){const Q=O($,B);if(0===B)_[Q]=o?0:E[Q];else{const ie=O($,B-1);_[Q]=o?E[ie]+_[ie]:E[Q]+_[ie]}}const R=e.makeTensorInfo(d.shape,y,_);if(null!=u){const B=wu({inputs:{x:R},backend:e,attrs:{perm:Hp(u)}});return e.disposeIntermediateTensorInfo(R),e.disposeIntermediateTensorInfo(d),B}return R}},USe={kernelName:d2,backendName:"cpu",kernelFunc:function zSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(1===i.shape.length){const m=uW(e.data.get(i.dataId).values,e.data.get(s.dataId).values,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,m)}if(2===i.shape.length){const m=EJ(e.bufferSync(i),e.bufferSync(s),o,a);return e.makeTensorInfo(m.shape,s.dtype,m.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}},WSe={kernelName:p2,backendName:"cpu",kernelFunc:function HSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockSize:s,dataFormat:o}=r;De("NHWC"===o,()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=i.shape[0],u=i.shape[1],d=i.shape[2],m=i.shape[3],y=u*s,_=d*s,E=m/(s*s),D=e.data.get(i.dataId).values,O=new Float32Array(a*y*_*E);let R=0;for(let $=0;$<a;++$)for(let B=0;B<y;++B){const Q=Math.floor(B/s),ie=B%s;for(let ye=0;ye<_;++ye){const Me=Math.floor(ye/s),He=(ie*s+ye%s)*E;for(let st=0;st<E;++st)O[R++]=D[st+He+m*(Me+d*(Q+u*$))]}}return e.makeTensorInfo([a,y,_,E],i.dtype,O)}};function Iee(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u,dimRoundingMode:d}=r;er([i,s],"depthwiseConv2DNative");const m=ur(i.shape),y=ur(s.shape);let _=u;null==_&&(_=[1,1]),De(la(o,_),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${_}'`);const E=qo(i.shape,s.shape,o,_,a,d,!0),{filterHeight:D,filterWidth:O,dilationHeight:R,dilationWidth:$,padInfo:B}=E,Q=B.left,ie=B.top,ye=E.outChannels/E.inChannels,Me=new po(E.outShape,i.dtype),Be=e.data.get(i.dataId).values,He=e.data.get(s.dataId).values,st=Me.values;for(let lt=0;lt<E.batchSize;++lt){const It=lt*m[0],zt=lt*Me.strides[0];for(let Wt=0;Wt<E.outHeight;++Wt){const qt=zt+Wt*Me.strides[1],Kt=Wt*E.strideHeight-ie;for(let Tt=0;Tt<D;++Tt){const Rt=Kt+Tt*R;if(Rt<0||Rt>=E.inHeight)continue;const Dt=Tt*y[0],Ht=It+Rt*m[1];for(let ln=0;ln<E.outWidth;++ln){const vn=qt+ln*Me.strides[2],An=ln*E.strideWidth-Q;for(let Tn=0;Tn<O;++Tn){const In=An+Tn*$;if(In<0||In>=E.inWidth)continue;const Hn=Ht+In*E.inChannels;let Un=vn,lr=Dt+Tn*y[1];for(let ir=0;ir<E.inChannels;++ir){const Cr=Be[Hn+ir];for(let $r=0;$r<ye;++$r)st[Un+$r]+=Cr*He[lr+$r];Un+=ye,lr+=ye}}}}}}return e.makeTensorInfo(Me.shape,Me.dtype,Me.values)}const GSe={kernelName:PC,backendName:"cpu",kernelFunc:Iee},qSe={kernelName:m2,backendName:"cpu",kernelFunc:function jSe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:d,filterShape:m}=r;er([i,s],"depthwiseConv2dNativeBackpropFilter");const y=qo(i.shape,m,o,a,u,d,!0),{strideHeight:_,strideWidth:E,filterHeight:D,filterWidth:O}=y,R=new po(y.filterShape,"float32"),$=y.padInfo.left,B=y.padInfo.top,Q=y.outChannels/y.inChannels,ie=e.data.get(i.dataId).values,ye=new po(i.shape,i.dtype,ie),Me=e.data.get(s.dataId).values,Be=new po(s.shape,s.dtype,Me);for(let He=0;He<D;++He){const st=Math.max(0,Math.ceil((B-He)/_)),lt=Math.min(y.outHeight,(y.inHeight+B-He)/_);for(let It=0;It<O;++It){const zt=Math.max(0,Math.ceil(($-It)/E)),Wt=Math.min(y.outWidth,(y.inWidth+$-It)/E);for(let qt=0;qt<y.outChannels;++qt){const Kt=Math.trunc(qt/Q),Tt=qt%Q;let Rt=0;for(let Dt=0;Dt<y.batchSize;++Dt)for(let Ht=st;Ht<lt;++Ht){const ln=He+Ht*_-B;for(let vn=zt;vn<Wt;++vn)Rt+=ye.get(Dt,ln,It+vn*E-$,Kt)*Be.get(Dt,Ht,vn,qt)}R.set(Rt,He,It,Kt,Tt)}}}return e.makeTensorInfo(R.shape,R.dtype,R.values)}},KSe={kernelName:g2,backendName:"cpu",kernelFunc:function ZSe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:d,inputShape:m}=r;er([i,s],"depthwiseConv2DNativeBackpropInput");const y=ur(i.shape),_=ur(s.shape),E=qo(m,s.shape,o,a,u,d,!0),D=new po(E.inShape,"float32"),O=D.values,[R,$,B]=D.strides,Q=e.data.get(i.dataId).values,[ie,ye,Me]=y,Be=e.data.get(s.dataId).values,[He,st,lt]=_,{batchSize:It,filterHeight:zt,filterWidth:Wt,inChannels:qt,inHeight:Kt,inWidth:Tt,outChannels:Rt,outHeight:Dt,outWidth:Ht,strideHeight:ln,strideWidth:vn}=E,An=zt-1-E.padInfo.top,Tn=Wt-1-E.padInfo.left,In=Rt/qt;for(let kn=0;kn<It;++kn)for(let Hn=0;Hn<qt;++Hn)for(let Un=0;Un<Kt;++Un){const lr=Un-An,ir=Math.max(0,Math.ceil(lr/ln)),Cr=Math.min(Dt,(zt+lr)/ln);for(let $r=0;$r<Tt;++$r){const Gi=$r-Tn,us=Math.max(0,Math.ceil(Gi/vn)),Gs=Math.min(Ht,(Wt+Gi)/vn);let ls=0;for(let Xi=ir;Xi<Cr;++Xi){const Fs=Xi*ln-lr;for(let ws=us;ws<Gs;++ws){const da=ie*kn+ye*Xi+Me*ws,pm=He*(zt-1-Fs)+st*(Wt-1-(ws*vn-Gi))+lt*Hn;for(let Dl=0;Dl<In;++Dl)ls+=Q[da+(Hn*In+Dl)]*Be[pm+Dl]}}O[R*kn+$*Un+B*$r+Hn]=ls}}return e.makeTensorInfo(D.shape,D.dtype,D.values)}},YSe={kernelName:v2,backendName:"cpu",kernelFunc:function XSe(n){const{inputs:t,backend:e}=n,{x:r}=t,i=Xt(r.shape),s=e.data.get(r.dataId).values,o=Zr([i,i],r.dtype),a=o.values;for(let d=0;d<s.length;d++)a[d*i+d]=s[d];const u=[...r.shape,...r.shape];return e.makeTensorInfo(u,o.dtype,o.values)}},QSe={kernelName:LC,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,filter:i}=n,{strides:s,pad:o,dilations:a}=e,u=t,d=u.data.get(r.dataId).values,m=r.shape.length,y=u.data.get(i.dataId).values,_=i.shape.length,{batchSize:E,inHeight:D,inWidth:O,inChannels:R,outHeight:$,outWidth:B,padInfo:Q,strideHeight:ie,strideWidth:ye,filterHeight:Me,filterWidth:Be,dilationHeight:He,dilationWidth:st,outShape:lt}=LS(r.shape,i.shape,s,o,"NHWC",a),It=Xt(lt),zt=lt.length,Wt=Ws(r.dtype,It);for(let Kt=0;Kt<E;++Kt)for(let Tt=0;Tt<$;++Tt){const Rt=Tt*ie-Q.top;for(let Dt=0;Dt<B;++Dt){const Ht=Dt*ye-Q.left;for(let ln=0;ln<R;++ln){let vn=Number.MIN_SAFE_INTEGER;for(let Tn=0;Tn<Me;++Tn){const In=Rt+Tn*He;if(In>=0&&In<D)for(let kn=0;kn<Be;++kn){const Hn=Ht+kn*st;if(Hn>=0&&Hn<O){const Un=Wc([Kt,In,Hn,ln],m,ur(r.shape)),lr=Wc([Tn,kn,ln],_,ur(i.shape)),ir=d[Un]+y[lr];ir>vn&&(vn=ir)}}}Wt[Wc([Kt,Tt,Dt,ln],zt,ur(lt))]=vn}}}return{dataId:u.write(Lp(Wt,r.dtype),lt,r.dtype),shape:lt,dtype:r.dtype}}},JSe={kernelName:_2,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,filter:i,dy:s}=n,{strides:o,pad:a,dilations:u}=e,d=t,m=yl(r.shape,d.data.get(r.dataId).values),y=yl(i.shape,d.data.get(i.dataId).values),{batchSize:_,inHeight:E,inWidth:D,inChannels:O,outHeight:R,outWidth:$,padInfo:B,strideHeight:Q,strideWidth:ie,filterHeight:ye,filterWidth:Me,dilationHeight:Be,dilationWidth:He,outShape:st}=LS(r.shape,i.shape,o,a,"NHWC",u);De(s.rank===st.length,()=>`Error in ${_2}, dy must have the same rank as output ${st.length}, but got ${s.rank}`);const lt=yl(st,d.data.get(s.dataId).values),It=eU(i.shape,i.dtype);for(let Wt=0;Wt<_;++Wt)for(let qt=0;qt<R;++qt){const Kt=qt*Q-B.top;for(let Tt=0;Tt<$;++Tt){const Rt=Tt*ie-B.left;for(let Dt=0;Dt<O;++Dt){let Ht=Number.MIN_SAFE_INTEGER,ln=0,vn=0;for(let An=0;An<ye;++An){const Tn=Kt+An*Be;if(Tn>=0&&Tn<E)for(let In=0;In<Me;++In){const kn=Rt+In*He;if(kn>=0&&kn<D){const Hn=m[Wt][Tn][kn][Dt]+y[An][In][Dt];Hn>Ht&&(Ht=Hn,ln=An,vn=In)}}}It[ln][vn][Dt]+=lt[Wt][qt][Tt][Dt]}}}return{dataId:d.write(Lp(It,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},eEe={kernelName:y2,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,filter:i,dy:s}=n,{strides:o,pad:a,dilations:u}=e,d=t,m=yl(r.shape,d.data.get(r.dataId).values),y=yl(i.shape,d.data.get(i.dataId).values),{batchSize:_,inHeight:E,inWidth:D,inChannels:O,outHeight:R,outWidth:$,padInfo:B,strideHeight:Q,strideWidth:ie,filterHeight:ye,filterWidth:Me,dilationHeight:Be,dilationWidth:He,outShape:st}=LS(r.shape,i.shape,o,a,"NHWC",u);De(s.rank===st.length,()=>`Error in ${y2}, dy must have the same rank as output ${st.length}, but got ${s.rank}`);const lt=yl(st,d.data.get(s.dataId).values),It=eU(r.shape,r.dtype);for(let Wt=0;Wt<_;++Wt)for(let qt=0;qt<R;++qt){const Kt=qt*Q-B.top;for(let Tt=0;Tt<$;++Tt){const Rt=Tt*ie-B.left;for(let Dt=0;Dt<O;++Dt){let Ht=Number.MIN_SAFE_INTEGER,ln=Kt<0?0:Kt,vn=Rt<0?0:Rt;for(let An=0;An<ye;++An){const Tn=Kt+An*Be;if(Tn>=0&&Tn<E)for(let In=0;In<Me;++In){const kn=Rt+In*He;if(kn>=0&&kn<D){const Hn=m[Wt][Tn][kn][Dt]+y[An][In][Dt];Hn>Ht&&(Ht=Hn,ln=Tn,vn=kn)}}}It[Wt][ln][vn][Dt]+=lt[Wt][qt][Tt][Dt]}}}return{dataId:d.write(Lp(It,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function SE(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;let a;er(i,"sum"),a="bool"===i.dtype?im({inputs:{x:i},backend:e,attrs:{dtype:"int32"}}):Zh({inputs:{x:i},backend:e});const u=a.shape.length,d=Yr(s,a.shape),m=ks(d,u);let y=d,_=a;null!=m&&(_=wu({inputs:{x:a},backend:e,attrs:{perm:m}}),y=to(y.length,u)),ca("sum",y,_.shape.length);const[E,D]=Ko(_.shape,y);let R=JO(e,E,pu(_.dtype,"int32"));const $=Xt(D),B=e.data.get(R.dataId).values,Q=e.data.get(_.dataId).values;for(let ie=0;ie<B.length;++ie){const ye=ie*$;let Me=0;for(let Be=0;Be<$;++Be)Me+=Q[ye+Be];B[ie]=Me}if(o){const ye=R;R=as({inputs:{x:R},backend:e,attrs:{shape:eo(R.shape,d)}}),e.disposeIntermediateTensorInfo(ye)}return e.disposeIntermediateTensorInfo(a),null!=m&&e.disposeIntermediateTensorInfo(_),R}const tEe={kernelName:gS,backendName:"cpu",kernelFunc:SE},rEe={kernelName:b2,backendName:"cpu",kernelFunc:function nEe(n){const{inputs:t,backend:e,attrs:r}=n,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:u}=MH(i,s.length);RH(o.length,u,s);const{path:d,steps:m}=OH(a,u),y=m.length;let _=null,E=o.length;const D=[];for(let O=0;O<y;++O){for(const R of m[O]){const{permutationIndices:$,expandDims:B}=kH(E,u[R]);let Q;FH($)?Q=s[R]:(Q=wu({inputs:{x:s[R]},backend:e,attrs:{perm:$}}),D.push(Q));const ie=Q.shape.slice();for(let ye=0;ye<B.length;++ye)ie.splice(B[ye],0,1);ri(Q.shape,ie)||(Q=as({inputs:{x:Q},backend:e,attrs:{shape:ie}}),D.push(Q)),null===_?_=Q:(_=eF({inputs:{a:Q,b:_},backend:e}),D.push(_))}O<y-1&&(d[O]>=0&&(_=SE({inputs:{x:_},backend:e,attrs:{axis:d[O]-(o.length-E),keepDims:!1}}),D.push(_)),E--)}for(const O of D)O!==_&&e.disposeIntermediateTensorInfo(O);return _}},sEe={kernelName:w2,backendName:"cpu",kernelFunc:function iEe(n){const{inputs:t,backend:e}=n,{dy:r,y:i}=t;er([r,i],"eluGrad");const s=new Float32Array(Xt(i.shape)),o=e.data.get(i.dataId).values,a=e.data.get(r.dataId).values;for(let u=0;u<o.length;++u){const d=o[u];s[u]=d>=0?a[u]:a[u]*(d+1)}return e.makeTensorInfo(i.shape,"float32",s)}},oEe=CH,aEe=SH,uEe=EH,lEe=NH,cEe=TH,hEe=AH,fEe=Wi(G_,n=>{const t=Math.sign(n),e=Math.abs(n),r=1/(1+oEe*e);return t*(1-((((hEe*r+cEe)*r+lEe)*r+uEe)*r+aEe)*r*Math.exp(-e*e))}),dEe={kernelName:G_,backendName:"cpu",kernelFunc:fEe};function rF(n){const{inputs:t,backend:e,attrs:r}=n,{input:i}=t,{dim:s}=r,o=i.shape.length,a=i.shape.slice();let u=s;return s<0&&(De(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+s+1),a.splice(u,0,1),as({inputs:{x:i},backend:e,attrs:{shape:a}})}const pEe={kernelName:BC,backendName:"cpu",kernelFunc:rF},mEe=_o((n,t)=>n/t),pW=Qo(H_,mEe),mW={kernelName:H_,backendName:"cpu",kernelFunc:pW};function Dee(n,t,e){const r=n.shape,i=r[0],s=r[1],o=e.data.get(n.dataId),a=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,d=[i,s],m=Xt(d),y=Wo("float32",m),_=Wo("float32",m);for(let R=0;R<i;R++){const $=Sv({inputs:{x:a},backend:e,attrs:{begin:[R,0],size:[1,s]}}),B=Sv({inputs:{x:u},backend:e,attrs:{begin:[R,0],size:[1,s]}}),Q=Ku({inputs:{real:$,imag:B},backend:e}),{real:ie,imag:ye}=gEe(Q,t,e),Me=ld(ie,ye);for(let Be=0;Be<s;Be++){const He=IH(Me,Be);y[R*s+Be]=He.real,_[R*s+Be]=He.imag}e.disposeIntermediateTensorInfo($),e.disposeIntermediateTensorInfo(B),e.disposeIntermediateTensorInfo(Q)}const E=e.makeTensorInfo(d,"float32",y),D=e.makeTensorInfo(d,"float32",_),O=Ku({inputs:{real:E,imag:D},backend:e});return e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(D),O}function gEe(n,t,e){const r=Xt(n.shape),i=e.data.get(n.dataId),s=e.data.get(i.complexTensorInfos.real.dataId).values,o=e.data.get(i.complexTensorInfos.imag.dataId).values;if(function vEe(n){return 0==(n&n-1)}(r)){const a=gW(s,o,r,t,e),u=[n.shape[0],n.shape[1]];if(t){const d=e.makeTensorInfo(u,"float32",a.real),m=e.makeTensorInfo(u,"float32",a.imag),y=e.makeTensorInfo([],"float32",Yf(r,"float32")),_=Zh({inputs:{x:y},backend:e}),E=mW.kernelFunc({inputs:{a:d,b:y},backend:e}),D=mW.kernelFunc({inputs:{a:m,b:_},backend:e}),O=e.data.get(E.dataId).values,R=e.data.get(D.dataId).values;return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(D),{real:O,imag:R}}return a}{const u=function yEe(n,t,e){const r=new Float32Array(2*t);for(let i=0;i<t;i++){let s=0,o=0;for(let a=0;a<t;a++){const u=WK(i*a,t,e),d=IH(n,a);s+=d.real*u.real-d.imag*u.imag,o+=d.real*u.imag+d.imag*u.real}e&&(s/=t,o/=t),UK(r,s,o,i)}return r}(ld(s,o),r,t);return BK(u)}}function gW(n,t,e,r,i){if(1===e)return{real:n,imag:t};const s=ld(n,t),o=e/2,a=VK(s),u=a.real,d=a.imag,m=[u.length],y=i.makeTensorInfo(m,"float32",u),_=i.makeTensorInfo(m,"float32",d),E=Ku({inputs:{real:y,imag:_},backend:i}),D=zK(s),O=D.real,R=D.imag,$=[O.length],B=i.makeTensorInfo($,"float32",O),Q=i.makeTensorInfo($,"float32",R),ie=Ku({inputs:{real:B,imag:Q},backend:i}),ye=gW(u,d,o,r,i),Me=ye.real,Be=ye.imag,He=[Me.length],st=i.makeTensorInfo(He,"float32",Me),lt=i.makeTensorInfo(He,"float32",Be),It=Ku({inputs:{real:st,imag:lt},backend:i}),zt=gW(O,R,o,r,i),Wt=zt.real,qt=zt.imag,Kt=[Wt.length],Tt=i.makeTensorInfo(Kt,"float32",Wt),Rt=i.makeTensorInfo(Kt,"float32",qt),Dt=Ku({inputs:{real:Tt,imag:Rt},backend:i}),Ht=HK(e,r),ln=[Ht.real.length],vn=i.makeTensorInfo(ln,"float32",Ht.real),An=i.makeTensorInfo(ln,"float32",Ht.imag),Tn=Ku({inputs:{real:vn,imag:An},backend:i}),In=eF({inputs:{a:Tn,b:Dt},backend:i}),kn=tb({inputs:{a:It,b:In},backend:i}),Hn=fW({inputs:{a:It,b:In},backend:i}),Un=xv({inputs:{input:kn},backend:i}),lr=xv({inputs:{input:Hn},backend:i}),ir=nb({inputs:{input:kn},backend:i}),Cr=nb({inputs:{input:Hn},backend:i}),$r=rb({inputs:[Un,lr],backend:i,attrs:{axis:0}}),Gi=rb({inputs:[ir,Cr],backend:i,attrs:{axis:0}}),us=i.data.get($r.dataId).values,Gs=i.data.get(Gi.dataId).values;return i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(Q),i.disposeIntermediateTensorInfo(ie),i.disposeIntermediateTensorInfo(st),i.disposeIntermediateTensorInfo(lt),i.disposeIntermediateTensorInfo(It),i.disposeIntermediateTensorInfo(Tt),i.disposeIntermediateTensorInfo(Rt),i.disposeIntermediateTensorInfo(Dt),i.disposeIntermediateTensorInfo(vn),i.disposeIntermediateTensorInfo(An),i.disposeIntermediateTensorInfo(Tn),i.disposeIntermediateTensorInfo(In),i.disposeIntermediateTensorInfo(kn),i.disposeIntermediateTensorInfo(Hn),i.disposeIntermediateTensorInfo(Un),i.disposeIntermediateTensorInfo(ir),i.disposeIntermediateTensorInfo(lr),i.disposeIntermediateTensorInfo(Cr),i.disposeIntermediateTensorInfo($r),i.disposeIntermediateTensorInfo(Gi),{real:us,imag:Gs}}const bEe={kernelName:x2,backendName:"cpu",kernelFunc:function _Ee(n){const{inputs:t,backend:e}=n,{input:r}=t,i=Xt(r.shape),s=r.shape[r.shape.length-1],a=as({inputs:{x:r},backend:e,attrs:{shape:[i/s,s]}}),u=Dee(a,!1,e),d=as({inputs:{x:u},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(u),d}};function vW(n){const{backend:t,attrs:e}=n,{shape:r,value:i,dtype:s}=e,o=s||Gg(i),a=Ws(o,Xt(r));return function xEe(n,t,e){n.fill(t)}(a,i),t.makeTensorInfo(r,o,a)}const wEe={kernelName:C2,backendName:"cpu",kernelFunc:vW},CEe={kernelName:S2,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{image:r}=n,i=e,s=Wo(r.dtype,Xt(r.shape)),[o,a,u,d]=r.shape,m=i.data.get(r.dataId).values;for(let _=0;_<o;_++){const E=_*u*a*d;for(let D=0;D<a;D++){const O=D*(u*d);for(let R=0;R<u;R++){const $=R*d;for(let B=0;B<d;B++){const Q=Math.round(u-R-1),ie=E+O+$+B;let ye=m[ie];Q>=0&&Q<u&&(ye=m[E+O+Q*d+B]),s[ie]=ye}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},EEe={kernelName:ES,backendName:"cpu",kernelFunc:function SEe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:d,dataFormat:m,dilations:y,dimRoundingMode:_,activation:E,leakyreluAlpha:D}=r;let O=Aee({inputs:{x:i,filter:s},backend:e,attrs:{strides:u,pad:d,dataFormat:m,dilations:y,dimRoundingMode:_}});if(o){const R=O;if("NCHW"===m&&1===o.shape.length&&1!==o.shape[0]){const $=as({inputs:{x:o},backend:e,attrs:{shape:[o.shape[0],1,1]}});O=tb({inputs:{a:O,b:$},backend:e}),e.disposeIntermediateTensorInfo($)}else O=tb({inputs:{a:O,b:o},backend:e});e.disposeIntermediateTensorInfo(R)}if(E){const R=O;if("NCHW"===m&&"prelu"===E&&1===a.shape.length&&1!==a.shape[0]){const $=as({inputs:{x:a},backend:e,attrs:{shape:[a.shape[0],1,1]}});O=nF(e,O,E,$,D),e.disposeIntermediateTensorInfo($)}else O=nF(e,O,E,a,D);e.disposeIntermediateTensorInfo(R)}return O}},TEe={kernelName:NS,backendName:"cpu",kernelFunc:function NEe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:d,dataFormat:m,dilations:y,dimRoundingMode:_,activation:E,leakyreluAlpha:D}=r;let O=Iee({inputs:{x:i,filter:s},backend:e,attrs:{strides:u,pad:d,dataFormat:m,dilations:y,dimRoundingMode:_}});if(o){const R=O;O=tb({inputs:{a:O,b:o},backend:e}),e.disposeIntermediateTensorInfo(R)}if(E){const R=O;O=nF(e,O,E,a,D),e.disposeIntermediateTensorInfo(R)}return O}},IEe={kernelName:E2,backendName:"cpu",kernelFunc:function AEe(n){const{inputs:t,backend:e}=n,{params:r,indices:i}=t,s=Xt(r.shape),o=i.shape,a=o[o.length-1],[u,d,m,y]=IR(r,i);if(0===d)return e.makeTensorInfo(u,r.dtype,[]);const D=FJ(e.data.get(i.dataId).values,e.bufferSync(r),r.dtype,d,a,m,y,r.shape,s);return e.makeTensorInfo(u,r.dtype,D.values)}},MEe={kernelName:zC,backendName:"cpu",kernelFunc:function DEe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,indices:s}=t,{axis:o,batchDims:a}=r;er([i,s],"gatherV2");const u=Yr(o,i.shape)[0],d=e.data.get(s.dataId).values,m=i.shape[u];for(let ie=0;ie<d.length;++ie){const ye=d[ie];De(ye<=m-1&&ye>=0,()=>`GatherV2: the index value ${ye} is not in [0, ${m-1}]`)}let y=a;null==a&&(y=0);const _=Xt(s.shape),E=$H(i,s,u,y),D=as({inputs:{x:i},backend:e,attrs:{shape:[E.batchSize,E.outerSize,E.dimSize,E.sliceSize]}}),O=as({inputs:{x:s},backend:e,attrs:{shape:[E.batchSize,_/E.batchSize]}}),R=[E.batchSize,E.outerSize,_/E.batchSize,E.sliceSize],$=e.bufferSync(O),Q=PJ(e.bufferSync(D),$,R);return e.disposeIntermediateTensorInfo(D),e.disposeIntermediateTensorInfo(O),e.makeTensorInfo(E.outputShape,Q.dtype,Q.values)}},REe={kernelName:N2,backendName:"cpu",kernelFunc:function kEe(n){const{inputs:t,backend:e}=n,{input:r}=t,i=Xt(r.shape),s=r.shape[r.shape.length-1],a=as({inputs:{x:r},backend:e,attrs:{shape:[i/s,s]}}),u=Dee(a,!0,e),d=as({inputs:{x:u},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(u),d}},OEe=Wi(Q_,n=>Number.isFinite(n)?1:0,"bool"),FEe={kernelName:Q_,backendName:"cpu",kernelFunc:OEe},PEe=Wi(J_,n=>Math.abs(n)===1/0?1:0,"bool"),LEe={kernelName:J_,backendName:"cpu",kernelFunc:PEe},$Ee=Wi(e0,n=>Number.isNaN(n)?1:0,"bool"),BEe={kernelName:e0,backendName:"cpu",kernelFunc:$Ee},zEe={kernelName:A2,backendName:"cpu",kernelFunc:function VEe(n){const{backend:t,attrs:e}=n,{start:r,stop:i,num:s}=e,o=zJ(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}},UEe=Wi(n0,n=>Math.log1p(n)),HEe={kernelName:n0,backendName:"cpu",kernelFunc:UEe},WEe=_o((n,t)=>n&&t),GEe=Qo(jC,WEe,null,"bool"),jEe={kernelName:jC,backendName:"cpu",kernelFunc:GEe},qEe=Wi(qC,n=>n?0:1,"bool"),ZEe={kernelName:qC,backendName:"cpu",kernelFunc:qEe},KEe=_o((n,t)=>n||t),XEe=Qo(ZC,KEe,null,"bool"),YEe={kernelName:ZC,backendName:"cpu",kernelFunc:XEe},JEe={kernelName:KC,backendName:"cpu",kernelFunc:function QEe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:u}=r;er(i,"LRN");const d=i.shape[3],m=d-1,y=e.data.get(i.dataId).values,_=Xt(i.shape),E=new Float32Array(_);function D(O){const R=O%d;let $=O-R+Math.max(0,R-s);const B=O-R+Math.min(R+s,m);let Q=0;for(;$<=B;$++){const ie=y[$];Q+=ie*ie}return Q}for(let O=0;O<_;O++){const R=D(O),$=y[O]*Math.pow(o+a*R,-u);E[O]=$}return e.makeTensorInfo(i.shape,i.dtype,E)}},tNe={kernelName:I2,backendName:"cpu",kernelFunc:function eNe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:u,alpha:d,beta:m}=r;er(o,"LRNGrad");const y=Xt(o.shape),_=o.shape[3],E=e.data.get(o.dataId).values,D=e.data.get(i.dataId).values,O=e.data.get(s.dataId).values,R=new Float32Array(y),$=y;for(let B=0;B<$;B++){const Q=B%_,ie=B-Q+Math.max(0,Q-a),ye=B-Q+Math.min(_,Q+a+1);let Me=0;for(let Be=ie;Be<ye;Be++)Me+=Math.pow(D[Be],2);Me=d*Me+u;for(let Be=ie;Be<ye;Be++){let He=-2*d*m*D[Be]*O[B]/Me;B===Be&&(He+=Math.pow(Me,-m)),He*=E[B],R[Be]+=He}}return e.makeTensorInfo(o.shape,i.dtype,R)}};function Mee(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=e;let u=i.shape;const d=u.length,m=Yr(s,u);let y=m;const _=ks(y,d);let E=a.data.get(i.dataId).values;if(null!=_){const ie=new Array(d);for(let ye=0;ye<ie.length;ye++)ie[ye]=u[_[ye]];E=cW(E,u,i.dtype,_,ie),y=to(y.length,d),u=ie}er(i,"max"),ca("max",y,d);const[D,O]=Ko(u,y),$=HJ(E,Xt(O),D,i.dtype),B=a.write($,D,i.dtype);let Q=D;return o&&(Q=eo(D,m)),{dataId:B,shape:Q,dtype:i.dtype}}const nNe={kernelName:XC,backendName:"cpu",kernelFunc:Mee},iNe={kernelName:YC,backendName:"cpu",kernelFunc:function rNe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;er(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r;De(la(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const m=uc(i.shape,s,o,1,a,u);let y;if(1===m.filterWidth&&1===m.filterHeight&&ri(m.inShape,m.outShape))y=Zh({inputs:{x:i},backend:e});else{const _=e.data.get(i.dataId).values,E=ur(i.shape),D=dW(_,0,i.dtype,E,m,"max");y=e.makeTensorInfo(m.outShape,i.dtype,D.values)}return y}},oNe={kernelName:QC,backendName:"cpu",kernelFunc:function sNe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:d}=r;er(i,"maxPool3d");const m=rd(i.shape,s,o,1,a,u,d),_=Tee(e.data.get(i.dataId).values,0,i.dtype,ur(i.shape),m,"max");return e.makeTensorInfo(_.shape,"float32",_.values)}},uNe={kernelName:M2,backendName:"cpu",kernelFunc:function aNe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,{filterSize:o,strides:a,pad:u,dimRoundingMode:d}=r;er([i,s],"maxPool3DGrad");const m=rd(s.shape,o,a,1,u,d),_=function QCe(n,t){const e=Zr(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,s=t.strideWidth,o=t.dilationDepth,a=t.dilationHeight,u=t.dilationWidth,d=t.effectiveFilterDepth,m=t.effectiveFilterHeight,y=t.effectiveFilterWidth,_=t.padInfo.front,E=t.padInfo.top,D=t.padInfo.left;for(let O=0;O<t.batchSize;++O)for(let R=0;R<t.inChannels;++R)for(let $=0;$<t.outDepth;++$){const B=$*r-_;let Q=B;for(;Q<0;)Q+=o;const ie=Math.min(t.inDepth,d+B);for(let ye=0;ye<t.outHeight;++ye){const Me=ye*i-E;let Be=Me;for(;Be<0;)Be+=a;const He=Math.min(t.inHeight,m+Me);for(let st=0;st<t.outWidth;++st){const lt=st*s-D;let It=lt;for(;It<0;)It+=u;const zt=Math.min(t.inWidth,y+lt);let Wt=Number.NEGATIVE_INFINITY,qt=-1;for(let Kt=Q;Kt<ie;Kt+=o){const Tt=Kt-B;for(let Rt=Be;Rt<He;Rt+=a){const Dt=Rt-Me;for(let Ht=It;Ht<zt;Ht+=u){const ln=Ht-lt,vn=n.get(O,Kt,Rt,Ht,R);vn>=Wt&&(Wt=vn,qt=Tt*m*y+Dt*m+ln)}}}e.set(qt,O,$,ye,st,R)}}}return e}(e.bufferSync(s),m),E=m.strideDepth,D=m.strideHeight,O=m.strideWidth,R=m.dilationDepth,$=m.dilationHeight,B=m.dilationWidth,Q=m.effectiveFilterDepth,ie=m.effectiveFilterHeight,ye=m.effectiveFilterWidth,Me=Q-1-m.padInfo.front,Be=ye-1-m.padInfo.left,He=ie-1-m.padInfo.top,st=Zr(s.shape,"float32"),lt=e.bufferSync(i);for(let It=0;It<m.batchSize;++It)for(let zt=0;zt<m.inChannels;++zt)for(let Wt=0;Wt<m.inDepth;++Wt)for(let qt=0;qt<m.inHeight;++qt)for(let Kt=0;Kt<m.inWidth;++Kt){const Tt=Wt-Me,Rt=qt-He,Dt=Kt-Be;let Ht=0;for(let ln=0;ln<Q;ln+=R){const vn=(Tt+ln)/E;if(!(vn<0||vn>=m.outDepth||Math.floor(vn)!==vn))for(let An=0;An<ie;An+=$){const Tn=(Rt+An)/D;if(!(Tn<0||Tn>=m.outHeight||Math.floor(Tn)!==Tn))for(let In=0;In<ye;In+=B){const kn=(Dt+In)/O;if(kn<0||kn>=m.outWidth||Math.floor(kn)!==kn)continue;const lr=Q*ie*ye-1-_.get(It,vn,Tn,kn,zt)===ln*ie*ye+An*ye+In?1:0;0!==lr&&(Ht+=lt.get(It,vn,Tn,kn,zt)*lr)}}}st.set(Ht,It,Wt,qt,Kt,zt)}return e.makeTensorInfo(st.shape,st.dtype,st.values)}},cNe={kernelName:D2,backendName:"cpu",kernelFunc:function lNe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s,output:o}=t,a=s;er([s,o],"maxPoolGrad");const{filterSize:u,strides:d,pad:m,dimRoundingMode:y}=r,_=uc(a.shape,u,d,1,m,y),E=e.data.get(a.dataId).values,D=Zr(_.outShape,a.dtype,Nee(E,a.shape,a.dtype,_).values),O=_.strideHeight,R=_.strideWidth,$=_.dilationHeight,B=_.dilationWidth,Q=_.effectiveFilterHeight,ie=_.effectiveFilterWidth,ye=ie-1-_.padInfo.left,Me=Q-1-_.padInfo.top,Be=Zr(a.shape,"float32"),He=e.data.get(i.dataId).values,st=Zr(i.shape,"float32",He);for(let lt=0;lt<_.batchSize;++lt)for(let It=0;It<_.inChannels;++It)for(let zt=0;zt<_.inHeight;++zt)for(let Wt=0;Wt<_.inWidth;++Wt){const qt=zt-Me,Kt=Wt-ye;let Tt=0;for(let Rt=0;Rt<Q;Rt+=$){const Dt=(qt+Rt)/O;if(!(Dt<0||Dt>=_.outHeight||Math.floor(Dt)!==Dt))for(let Ht=0;Ht<ie;Ht+=B){const ln=(Kt+Ht)/R;if(ln<0||ln>=_.outWidth||Math.floor(ln)!==ln)continue;const Tn=Q*ie-1-D.get(lt,Dt,ln,It)===Rt*ie+Ht?1:0;0!==Tn&&(Tt+=st.get(lt,Dt,ln,It)*Tn)}}Be.set(Tt,lt,zt,Wt,It)}return e.makeTensorInfo(Be.shape,Be.dtype,Be.values)}},fNe={kernelName:k2,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:r}=n,{filterSize:i,strides:s,pad:o,includeBatchInIndex:a}=t,u=e;er(r,"MaxPoolWithArgmax");const d=u.data.get(r.dataId).values,m=uc(r.shape,i,s,[1,1],o),[y,_]=function hNe(n,t,e,r,i){const o=dW(n,0,e,ur(t),i,"max"),a=Nee(n,t,e,i,!0,r);return[o.values,a.values]}(d,r.shape,r.dtype,a,m),E=u.write(y,m.outShape,r.dtype),D=u.write(_,m.outShape,r.dtype);return[{dataId:E,shape:m.outShape,dtype:r.dtype},{dataId:D,shape:m.outShape,dtype:"int32"}]}},pNe={kernelName:JC,backendName:"cpu",kernelFunc:function dNe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,a=Yr(s,i.shape),m=Xt(Ko(i.shape,a)[1]),y=[],_=e.makeTensorInfo([],"float32",new Float32Array([m]));y.push(_);const E=im({inputs:{x:i},backend:e,attrs:{dtype:"float32"}});y.push(E);const D=pW({inputs:{a:E,b:_},backend:e});y.push(D);const O=SE({inputs:{x:D},backend:e,attrs:{axis:s,keepDims:o}});return y.forEach(R=>e.disposeIntermediateTensorInfo(R)),O}},gNe={kernelName:eS,backendName:"cpu",kernelFunc:function mNe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;er(i,"min");const a=Yr(s,i.shape);let u=a;const d=ks(u,i.shape.length);let m=i;null!=d&&(m=wu({inputs:{x:i},backend:e,attrs:{perm:d}}),u=to(u.length,i.shape.length)),ca("min",u,m.shape.length);const[y,_]=Ko(m.shape,u),E=Xt(_),D=oa(Xt(y),m.dtype),O=e.data.get(m.dataId).values;for(let $=0;$<D.length;++$){const B=$*E;let Q=O[B];for(let ie=0;ie<E;++ie){const ye=O[B+ie];(Number.isNaN(ye)||ye<Q)&&(Q=ye)}D[$]=Q}null!=d&&e.disposeIntermediateTensorInfo(m);const R=e.makeTensorInfo(y,m.dtype,D);if(o){const B=as({inputs:{x:R},backend:e,attrs:{shape:eo(y,a)}});return e.disposeIntermediateTensorInfo(R),B}return R}},yNe={kernelName:tS,backendName:"cpu",kernelFunc:function vNe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{paddings:s,mode:o}=r;er(i,"mirrorPad");const a=s.map((Q,ie)=>Q[0]+i.shape[ie]+Q[1]),u=s.map(Q=>Q[0]),d=s.map((Q,ie)=>Q[0]+i.shape[ie]),m="reflect"===o?0:1,y=e.data.get(i.dataId).values,_=i.shape.length,E=ur(i.shape),D=Xt(a),O=a.length,R=ur(a),$=Wo(i.dtype,D);for(let Q=0;Q<D;Q++){let ie=jg(Q,O,R);for(let Me=0;Me<O;Me++)ie[Me]<u[Me]?ie[Me]=2*u[Me]-ie[Me]-m:ie[Me]>=d[Me]&&(ie[Me]=2*(d[Me]-1)-ie[Me]+m);ie=ie.map((Me,Be)=>Me-u[Be]);const ye=Wc(ie,_,E);$[Q]=y[ye]}return{dataId:e.write($,a,i.dtype),shape:a,dtype:i.dtype}}},_Ne=_o((n,t)=>{const e=n%t;return n<0&&t<0||n>=0&&t>=0?e:(e+t)%t}),bNe=Qo(o0,_Ne),wNe={kernelName:o0,backendName:"cpu",kernelFunc:bNe};function kee(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{dim:s}=r,o=i.shape.length;let a=s;if(-1===a&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const u=Yr([a],i.shape),d=Mee({inputs:{x:i},backend:e,attrs:{reductionIndices:u,keepDims:!1}}),m=eo(d.shape,u),y=as({inputs:{x:d},backend:e,attrs:{shape:m}}),_=fW({inputs:{a:i,b:y},backend:e}),E=MJ({inputs:{x:_},backend:e}),D=SE({inputs:{x:E},backend:e,attrs:{axis:u,keepDims:!1}}),O=as({inputs:{x:D},backend:e,attrs:{shape:m}}),R=pW({inputs:{a:E,b:O},backend:e});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(D),e.disposeIntermediateTensorInfo(O),R}const xNe={kernelName:_S,backendName:"cpu",kernelFunc:kee},SNe={kernelName:R2,backendName:"cpu",kernelFunc:function CNe(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r;er(i,"multinomial");const u=a?i:kee({inputs:{logits:i},backend:e,attrs:{dim:-1}}),d=u.shape[0],m=u.shape[1],y=e.data.get(u.dataId).values,_=[d,s],E=oa(Xt(_),"int32");for(let D=0;D<d;++D){const O=D*m,R=new Float32Array(m-1);R[0]=y[O];for(let Q=1;Q<R.length;++Q)R[Q]=R[Q-1]+y[O+Q];const $=W0.alea(o.toString()),B=D*s;for(let Q=0;Q<s;++Q){const ie=$();E[B+Q]=R.length;for(let ye=0;ye<R.length;ye++)if(ie<R[ye]){E[B+Q]=ye;break}}}return a||e.disposeIntermediateTensorInfo(u),e.makeTensorInfo(_,"int32",E)}},ENe=lO,TNe={kernelName:O2,backendName:"cpu",kernelFunc:function NNe(n){const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=r;er(i,"NonMaxSuppression");const d=e.data.get(i.dataId).values,m=e.data.get(s.dataId).values,{selectedIndices:y}=ENe(d,m,o,a,u);return e.makeTensorInfo([y.length],"int32",new Int32Array(y))}},ANe=cO,DNe={kernelName:F2,backendName:"cpu",kernelFunc:function INe(n){const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:d}=r;er(i,"NonMaxSuppressionPadded");const m=e.data.get(i.dataId).values,y=e.data.get(s.dataId).values,{selectedIndices:_,validOutputs:E}=ANe(m,y,o,a,u,d);return[e.makeTensorInfo([_.length],"int32",new Int32Array(_)),e.makeTensorInfo([],"int32",new Int32Array([E]))]}},MNe=hO,RNe={kernelName:P2,backendName:"cpu",kernelFunc:function kNe(n){const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:d}=r;er(i,"NonMaxSuppressionWithScore");const m=e.data.get(i.dataId).values,y=e.data.get(s.dataId).values,_=o,E=a,D=u,O=d,{selectedIndices:R,selectedScores:$}=MNe(m,y,_,E,D,O);return[e.makeTensorInfo([R.length],"int32",new Int32Array(R)),e.makeTensorInfo([$.length],"float32",new Float32Array($))]}},FNe={kernelName:sS,backendName:"cpu",kernelFunc:function ONe(n){const{inputs:t,backend:e,attrs:r}=n,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:u}=r;er(i,"oneHot");const d=Xt(i.shape),m=new Float32Array(d*o);m.fill(u);const y=e.data.get(i.dataId).values;for(let _=0;_<d;++_)y[_]>=0&&y[_]<o&&(m[_*o+y[_]]=a);return e.makeTensorInfo([...i.shape,o],s,m)}};function iF(n){const{inputs:t,backend:e}=n,{x:r}=t;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const i=xv({inputs:{input:r},backend:e}),s=iF({inputs:{x:i},backend:e}),o=nb({inputs:{input:r},backend:e}),a=iF({inputs:{x:o},backend:e}),u=Ku({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),u}return vW({backend:e,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const PNe={kernelName:CS,backendName:"cpu",kernelFunc:iF},LNe={kernelName:iS,backendName:"cpu",kernelFunc:function Ree(n){const{inputs:t,backend:e}=n,{x:r}=t;if("string"===r.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===r.dtype){const i=xv({inputs:{input:r},backend:e}),s=Ree({inputs:{x:i},backend:e}),o=nb({inputs:{input:r},backend:e}),a=iF({inputs:{x:o},backend:e}),u=Ku({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),u}return vW({backend:e,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}};function Oee(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r;if(1===t.length)return rF({inputs:{input:t[0]},backend:e,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(m=>{sa(s,m.shape,"All tensors passed to stack must have matching shapes"),De(o===m.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],d=rb({inputs:t.map(m=>{const y=rF({inputs:{input:m},backend:e,attrs:{dim:i}});return a.push(y),y}),backend:e,attrs:{axis:i}});return a.forEach(m=>e.disposeIntermediateTensorInfo(m)),d}const $Ne={kernelName:oS,backendName:"cpu",kernelFunc:Oee},Fee={kernelName:aS,backendName:"cpu",kernelFunc:function BNe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{paddings:s,constantValue:o}=r;er(i,"pad");const a=s.map((B,Q)=>B[0]+i.shape[Q]+B[1]),u=s.map(B=>B[0]),d=e.data.get(i.dataId).values,m=Xt(i.shape),y=i.shape.length,_=ur(i.shape),E=Xt(a),D=a.length,O=ur(a),R=Wo(i.dtype,E);0!==o&&R.fill(o);for(let B=0;B<m;B++)R[Wc(jg(B,y,_).map((Me,Be)=>Me+u[Be]),D,O)]=d[B];return{dataId:e.write(R,a,i.dtype),shape:a,dtype:i.dtype}}},VNe=_o((n,t)=>Math.pow(n,t)),zNe=Qo(u0,VNe),UNe={kernelName:u0,backendName:"cpu",kernelFunc:zNe},WNe={kernelName:L2,backendName:"cpu",kernelFunc:function HNe(n){const{inputs:t,backend:e,attrs:r}=n,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,u=i.map($=>e.data.get($.dataId).values),d=i.map($=>$.shape),m=e.data.get(s.dataId).values,y=e.data.get(o.dataId).values,[_,E,D]=XJ(u,d,m,s.shape,s.dtype,y,o.shape),O=_.map($=>e.makeTensorInfo([$.length],"int32",$)),R=e.makeTensorInfo(D,s.dtype,E);return O.concat([R])}},jNe={kernelName:$2,backendName:"cpu",kernelFunc:function GNe(n){const{inputs:t,backend:e}=n,{starts:r,limits:i,deltas:s}=t,o=e.data.get(r.dataId).values,a=e.data.get(i.dataId).values,u=e.data.get(s.dataId).values,[d,m]=QJ(o,r.shape,r.dtype,a,i.shape,u,s.shape);return[e.makeTensorInfo([d.length],"int32",d),e.makeTensorInfo([m.length],r.dtype,m)]}},ZNe={kernelName:B2,backendName:"cpu",kernelFunc:function qNe(n){const{inputs:t,backend:e,attrs:r}=n,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:u}=r,d=e.data.get(i.dataId).values,m=e.data.get(s.dataId).values,y=e.data.get(o.dataId).values,_=a.map(R=>e.data.get(R.dataId).values),E=a.map(R=>R.shape),[D,O]=tee(d,i.shape,m,s.shape,s.dtype,y,o.shape,_,E,u);return e.makeTensorInfo(D,s.dtype,O)}},XNe={kernelName:V2,backendName:"cpu",kernelFunc:function KNe(n){const{backend:t,attrs:e}=n,{start:r,stop:i,dtype:s,step:o}=e,a=nee(r,i,o,s);return t.makeTensorInfo([a.length],s,a)}},YNe=Wi(l0,n=>1/n),QNe={kernelName:l0,backendName:"cpu",kernelFunc:YNe},eTe={kernelName:fS,backendName:"cpu",kernelFunc:function JNe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;er(i,"resizeBilinear");const u=ur(i.shape),[d,m]=a,[y,_,E,D]=i.shape,O=e.data.get(i.dataId).values,R=new Float32Array(Xt([y,d,m,D])),$=[s&&d>1?_-1:_,s&&m>1?E-1:E],B=[s&&d>1?d-1:d,s&&m>1?m-1:m];let Q=0;const ie=$[0]/B[0],ye=$[1]/B[1];for(let Me=0;Me<y;Me++)for(let Be=0;Be<d;Be++){let He;He=o?ie*(Be+.5)-.5:ie*Be;const st=Math.max(0,Math.floor(He)),lt=He-st,It=Math.min(_-1,Math.ceil(He)),zt=Me*u[0]+st*u[1],Wt=Me*u[0]+It*u[1];for(let qt=0;qt<m;qt++){let Kt;Kt=o?ye*(qt+.5)-.5:ye*qt;const Tt=Math.max(0,Math.floor(Kt)),Rt=Kt-Tt,Dt=Math.min(E-1,Math.ceil(Kt)),Ht=zt+Tt*u[2],ln=Wt+Tt*u[2],vn=zt+Dt*u[2],An=Wt+Dt*u[2];for(let Tn=0;Tn<D;Tn++){const In=O[Ht+Tn],kn=O[ln+Tn],lr=In+(O[vn+Tn]-In)*Rt;R[Q++]=lr+(kn+(O[An+Tn]-kn)*Rt-lr)*lt}}}return e.makeTensorInfo([y,d,m,D],"float32",R)}},nTe={kernelName:H2,backendName:"cpu",kernelFunc:function tTe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r;er([s,i],"resizeBilinearGrad");const a=ur(i.shape),[u,d,m,y]=i.shape,[,_,E]=s.shape,D=new Float32Array(u*d*m*y),O=[o&&_>1?d-1:d,o&&E>1?m-1:m],R=[o&&_>1?_-1:_,o&&E>1?E-1:E],$=O[0]/R[0],B=O[1]/R[1],Q=e.data.get(s.dataId).values;let ie=0;for(let ye=0;ye<u;ye++){const Me=ye*a[0];for(let Be=0;Be<_;Be++){const He=Be*$,st=Math.floor(He),lt=Math.min(Math.ceil(He),d-1),It=Me+st*a[1],zt=Me+lt*a[1],Wt=He-st,qt=1-Wt;for(let Kt=0;Kt<E;Kt++){const Tt=Kt*B,Rt=Math.floor(Tt),Dt=Math.min(Math.ceil(Tt),m-1),Ht=Tt-Rt,ln=1-Ht,vn=It+Rt*a[2],An=It+Dt*a[2],Tn=zt+Rt*a[2],In=zt+Dt*a[2],kn=qt*ln,Hn=qt*Ht,Un=Wt*ln,lr=Wt*Ht;for(let ir=0;ir<y;ir++){const Cr=Q[ie++];D[vn+ir]+=Cr*kn,D[An+ir]+=Cr*Hn,D[Tn+ir]+=Cr*Un,D[In+ir]+=Cr*lr}}}}return e.makeTensorInfo([u,m,d,y],"float32",D)}},iTe={kernelName:hS,backendName:"cpu",kernelFunc:function rTe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r;er(i,"resizeNearestNeighbor");const u=ur(i.shape),[d,m]=a,[y,_,E,D]=i.shape,O=e.data.get(i.dataId).values,R=new Float32Array(y*d*m*D),$=[s&&d>1?_-1:_,s&&m>1?E-1:E],B=[s&&d>1?d-1:d,s&&m>1?m-1:m],Q=$[0]/B[0],ie=$[1]/B[1];let ye=0;for(let Me=0;Me<y;Me++){const Be=Me*u[0];for(let He=0;He<d;He++){const st=o?Q*(He+.5):Q*He;let lt=Math.min(_-1,s?Math.round(st):Math.floor(st));o&&(lt=Math.max(0,lt));const It=Be+lt*u[1];for(let zt=0;zt<m;zt++){const Wt=o?ie*(zt+.5):ie*zt;let qt=Math.min(E-1,s?Math.round(Wt):Math.floor(Wt));o&&(qt=Math.max(0,qt));const Kt=It+qt*u[2];for(let Tt=0;Tt<D;Tt++)R[ye++]=O[Kt+Tt]}}}return e.makeTensorInfo([y,d,m,D],i.dtype,R)}},oTe={kernelName:U2,backendName:"cpu",kernelFunc:function sTe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r;er([s,i],"resizeNearestNeighborGrad");const a=ur(i.shape),u=ur(s.shape),[d,m,y,_]=i.shape,[,E,D]=s.shape,O=new Float32Array(d*m*y*_),R=e.data.get(s.dataId).values,$=[o&&E>1?m-1:m,o&&D>1?y-1:y],B=[o&&E>1?E-1:E,o&&D>1?D-1:D],Q=$[0]/B[0],ie=$[1]/B[1],ye=1/Q,Me=1/ie,Be=2*Math.ceil(ye)+2,He=2*Math.ceil(Me)+2;for(let st=0;st<d;st++){const lt=st*a[0];for(let It=0;It<m;It++){const zt=lt+It*a[1],Wt=Math.floor(It*ye),qt=Math.floor(Wt-Be/2);for(let Kt=0;Kt<y;Kt++){const Tt=zt+Kt*a[2],Rt=Math.floor(Kt*Me),Dt=Math.floor(Rt-He/2);for(let Ht=0;Ht<_;Ht++){let ln=0;for(let vn=0;vn<Be;vn++){const An=vn+qt;if(An<0||An>=E)continue;const Tn=lt+An*u[1],In=An*Q;if(It===Math.min(m-1,o?Math.round(In):Math.floor(In)))for(let Hn=0;Hn<He;Hn++){const Un=Hn+Dt;if(Un<0||Un>=D)continue;const lr=Tn+Un*u[2],ir=Un*ie;Kt===Math.min(y-1,o?Math.round(ir):Math.floor(ir))&&(ln+=R[lr+Ht])}}O[Tt+Ht]=ln}}}}return e.makeTensorInfo(i.shape,i.dtype,O)}},uTe={kernelName:dS,backendName:"cpu",kernelFunc:function aTe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dims:s}=r;er(i,"reverse");const o=i.shape.length,a=Yr(s,i.shape);if(0===o)return Zh({inputs:{x:i},backend:e});const u=new po(i.shape,i.dtype),d=e.bufferSync(i);for(let m=0;m<u.size;m++){const y=u.indexToLoc(m),_=y.slice();a.forEach(E=>_[E]=i.shape[E]-1-_[E]),u.set(d.get(..._),...y)}return e.makeTensorInfo(u.shape,u.dtype,u.values)}},lTe={kernelName:aR,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:r}=n,{radians:i,fillValue:s,center:o}=t,a=e,u=Wo(r.dtype,Xt(r.shape)),[d,m,y,_]=r.shape,[E,D]=bH(o,m,y),R=Math.sin(i),$=Math.cos(i),B=a.data.get(r.dataId).values;for(let ie=0;ie<d;ie++){const ye=ie*y*m*_;for(let Me=0;Me<m;Me++){const Be=Me*(y*_);for(let He=0;He<y;He++){const st=He*_;for(let lt=0;lt<_;lt++){const It=[d,Me,He,lt],zt=It[2],Wt=It[1];let qt=(zt-E)*$-(Wt-D)*R,Kt=(zt-E)*R+(Wt-D)*$;qt=Math.round(qt+E),Kt=Math.round(Kt+D);let Tt=s;"number"!=typeof s&&(Tt=3===lt?255:s[lt]),qt>=0&&qt<y&&Kt>=0&&Kt<m&&(Tt=B[ye+Kt*(y*_)+qt*_+lt]),u[ye+Be+st+lt]=Tt}}}}return{dataId:a.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},cTe=Wi(f0,n=>{const t=Math.floor(n);return n-t<.5?Math.floor(n):n-t>.5?Math.ceil(n):t%2==0?t:t+1}),hTe={kernelName:f0,backendName:"cpu",kernelFunc:cTe},dTe={kernelName:W2,backendName:"cpu",kernelFunc:function fTe(n){const{inputs:t,backend:e,attrs:r}=n,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:u,sliceSize:d,strides:m,outputSize:y}=Vp(0,i,o),O=Cv(e.bufferSync(i),e.bufferSync(s),o,y,d,u,a,m,0,!0);return e.makeTensorInfo(o,O.dtype,O.values)}};function pTe(n,t){let e=0,r=n.length,i=0;for(;e<r;)i=Math.floor((e+r)/2),n[i]<t?e=i+1:r=i;return r}function mTe(n,t){let e=0,r=n.length,i=0;for(;e<r;)i=Math.floor((e+r)/2),n[i]<=t?e=i+1:r=i;return r}const yTe={kernelName:j2,backendName:"cpu",kernelFunc:function vTe(n){const{inputs:t,backend:e,attrs:r}=n,{sortedSequence:i,values:s}=t,{side:o}=r,d=function gTe(n,t,e,r,i,s){const o=Ws("int32",e*i);for(let a=0;a<e;++a){const u=n.slice(a*r,(a+1)*r),d=a*i;for(let m=0;m<i;++m)o[d+m]="left"===s?pTe(u,t[m+d]):mTe(u,t[m+d])}return o}(e.data.get(i.dataId).values,e.data.get(s.dataId).values,i.shape[0],i.shape[1],s.shape[1],o);return e.makeTensorInfo(s.shape,"int32",d)}},bTe={kernelName:pS,backendName:"cpu",kernelFunc:function _Te(n){const{inputs:t,backend:e}=n,{condition:r,t:i,e:s}=t;er([r,i,s],"select");const o=r.shape.length,a=e.data.get(r.dataId).values,u=e.data.get(i.dataId).values,d=e.data.get(s.dataId).values,m=pu(i.dtype,s.dtype),y=oa(Xt(i.shape),m);let _=0;const E=0===o||o>1||1===i.shape.length?1:Xt(i.shape.slice(1));for(let D=0;D<a.length;D++)for(let O=0;O<E;O++)y[_++]=1===a[D]?u[D]:d[D];return e.makeTensorInfo(i.shape,m,y)}},wTe=dO,xTe=pO,CTe=Wi(p0,n=>n>=0?xTe*n:wTe*(Math.exp(n)-1)),STe={kernelName:p0,backendName:"cpu",kernelFunc:CTe},ETe=Wi(v0,n=>n<0?-1:n>0?1:0),NTe={kernelName:v0,backendName:"cpu",kernelFunc:ETe},TTe=Wi(m0,n=>Math.sin(n)),ATe={kernelName:m0,backendName:"cpu",kernelFunc:TTe},ITe=Wi(g0,n=>Math.sinh(n)),DTe={kernelName:g0,backendName:"cpu",kernelFunc:ITe},Pee=Math.log(1.1920928955078125e-7)+2,MTe=Wi(_0,n=>{const t=n>-Pee,e=n<Pee,r=Math.exp(n);let i;return i=e?r:t?n:Math.log(1+r),i}),kTe={kernelName:_0,backendName:"cpu",kernelFunc:MTe},OTe={kernelName:vS,backendName:"cpu",kernelFunc:function RTe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,paddings:o}=r;er([i],"spaceToBatchND");const a=Xt(s),u=[[0,0]];u.push(...o);for(let Me=1+s.length;Me<i.shape.length;++Me)u.push([0,0]);const d=Fee.kernelFunc({inputs:{x:i},backend:e,attrs:{paddings:u,constantValue:0}}),m=nE(d.shape,s,a,!1),y=rE(m.length,s.length,!1),_=iE(d.shape,s,a,!1),O=as({inputs:{x:d},backend:e,attrs:{shape:m}}),B=wu({inputs:{x:O},backend:e,attrs:{perm:y}}),ye=as({inputs:{x:B},backend:e,attrs:{shape:_}});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(O),e.disposeIntermediateTensorInfo(B),ye}},PTe={kernelName:q2,backendName:"cpu",kernelFunc:function FTe(n){const{inputs:t,backend:e}=n,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(1!==s.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${s.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n        ${i.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const a=e.data.get(r.dataId).values,u=e.data.get(i.dataId).values,d=e.data.get(s.dataId).values,m=e.data.get(o.dataId).values[0],[y,_,E,D,O]=oee(a,r.shape,r.dtype,u,i.dtype,d,m);return[e.makeTensorInfo(_,r.dtype,y),e.makeTensorInfo([_[0]],i.dtype,E),e.makeTensorInfo([D.length],"bool",new Uint8Array(D.map(R=>Number(R)))),e.makeTensorInfo([O.length],r.dtype,new Int32Array(O))]}},$Te={kernelName:Z2,backendName:"cpu",kernelFunc:function LTe(n){const{inputs:t,backend:e}=n,{inputIndices:r,inputShape:i,newShape:s}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${i.shape}`);if(1!==s.shape.length)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(e.data.get(i.dataId).values),a=e.data.get(r.dataId).values,u=Array.from(e.data.get(s.dataId).values),[d,m,y]=aee(a,r.shape,r.dtype,o,u);return[e.makeTensorInfo(m,r.dtype,d),e.makeTensorInfo([y.length],s.dtype,new Int32Array(y))]}},VTe={kernelName:K2,backendName:"cpu",kernelFunc:function BTe(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=e.data.get(r.dataId).values,a=e.data.get(i.dataId).values,u=e.data.get(s.dataId).values,[d,m]=hW(o,r.shape,r.dtype,a,u,!0);return e.makeTensorInfo(m,r.dtype,d)}},UTe={kernelName:X2,backendName:"cpu",kernelFunc:function zTe(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const o=e.data.get(r.dataId).values,a=e.data.get(i.dataId).values,u=e.data.get(s.dataId).values,[d,m]=hW(o,r.shape,r.dtype,a,u);return e.makeTensorInfo(m,r.dtype,d)}},WTe={kernelName:Y2,backendName:"cpu",kernelFunc:function HTe(n){const{inputs:t,backend:e,attrs:r}=n,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:u,numUpdates:d,sliceSize:m,strides:y,outputSize:_}=Vp(0,i,a),E=!1,D=e.bufferSync(i);let O;switch(s.dtype){case"bool":O=Cv(D,e.bufferSync(s),a,_,m,d,u,y,Boolean(e.data.get(o.dataId).values[0]),E);break;case"float32":case"int32":O=Cv(D,e.bufferSync(s),a,_,m,d,u,y,e.data.get(o.dataId).values[0],E);break;case"string":O=Cv(D,e.bufferSync(s),a,_,m,d,u,y,Qf(e.data.get(o.dataId).values[0]),E);break;default:throw new Error(`Unsupported type ${s.dtype}`)}return e.makeTensorInfo(a,O.dtype,O.values)}},jTe={kernelName:yS,backendName:"cpu",kernelFunc:function GTe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=Yr(o,i.shape)[0],u=PH(i,s,a),d=new Array(i.shape.length).fill(0),m=i.shape.slice();return u.map(y=>{const _=[...m];_[a]=y;const E=Sv({inputs:{x:i},backend:e,attrs:{begin:d,size:_}});return d[a]+=y,E})}},qTe={kernelName:Q2,backendName:"cpu",kernelFunc:({inputs:n,backend:t})=>{const{x:e}=n,r=t;er(e,"square");const i=r.data.get(e.dataId).values,s=new Float32Array(i.length);for(let a=0;a<i.length;++a){const u=i[a];s[a]=u*u}return{dataId:r.write(s,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}},ZTe=Wi(N0,(n,t)=>{const e=t;return isNaN(n)?NaN:n>0?1:e.alpha}),KTe={kernelName:N0,backendName:"cpu",kernelFunc:ZTe},YTe={kernelName:J2,backendName:"cpu",kernelFunc:function XTe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,end:o,strides:a,beginMask:u,endMask:d,ellipsisMask:m,newAxisMask:y,shrinkAxisMask:_}=r;er(i,"stridedSlice");const{finalShapeSparse:E,finalShape:D,isIdentity:O,sliceDim0:R,isSimpleSlice:$,begin:B,end:Q,strides:ie}=e5(i.shape,s,o,a,u,d,m,y,_);let ye;if(O)ye=as({inputs:{x:i},backend:e,attrs:{shape:D}});else if(R||$){De(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const Me=YU(B,Q,ie),Be=Sv({inputs:{x:i},backend:e,attrs:{begin:B,size:Me}});ye=as({inputs:{x:Be},backend:e,attrs:{shape:D}}),e.disposeIntermediateTensorInfo(Be)}else{const Be=cee(E,e.bufferSync(i),ie,B);ye=e.makeTensorInfo(D,Be.dtype,Be.values)}return ye}},JTe={kernelName:eR,backendName:"cpu",kernelFunc:function QTe(n){const{inputs:t,backend:e,attrs:r}=n,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:u,preserveShortSequences:d}=r,{data:m,dataSplits:y}=t,_=e.data.get(m.dataId).values,E=e.data.get(y.dataId).values,[D,O]=hee(_,E,i,s,o,a,u,d);return[e.makeTensorInfo([D.length],"string",D),e.makeTensorInfo(y.shape,"int32",O)]}},tAe={kernelName:tR,backendName:"cpu",kernelFunc:function eAe(n){const{inputs:t,backend:e,attrs:r}=n,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=e.data.get(s.dataId).values,u=e.data.get(o.dataId).values[0],[d,m,y]=fee(a,u,i),_=m.length;return[e.makeTensorInfo([_,2],"int32",d),e.makeTensorInfo([_],"string",m),e.makeTensorInfo([2],"int32",new Int32Array(y))]}},rAe={kernelName:nR,backendName:"cpu",kernelFunc:function nAe(n){const{inputs:t,backend:e,attrs:r}=n,{numBuckets:i}=r,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=dee(e.data.get(s.dataId).values,i);return e.makeTensorInfo(s.shape,"int32",a)}},iAe=Wi(C0,n=>Math.tan(n)),sAe={kernelName:C0,backendName:"cpu",kernelFunc:iAe},oAe=Wi(S0,n=>Math.tanh(n));function Lee(n,t,e){switch(e){case"reflect":return function gAe(n,t){let e=n;if(e<0)if(t<=1)e=0;else{const r=2*t;e<r&&(e=r*Math.trunc(-e/r)+e),e=e<-t?e+r:-e-1}else if(e>t-1)if(t<=1)e=0;else{const r=2*t;e-=r*Math.trunc(e/r),e>=t&&(e=r-e-1)}return Op(0,e,t-1)}(n,t);case"wrap":return function vAe(n,t){let e=n;return e<0?t<=1?e=0:e+=t*(Math.trunc(-e/(t-1))+1):e>t-1&&(t<=1?e=0:e-=t*Math.trunc(e/(t-1))),Op(0,e,t-1)}(n,t);case"nearest":return function _Ae(n,t){return Op(0,n,t-1)}(n,t);default:return function yAe(n,t){return n}(n)}}function EE(n,t,e,r,i,s,o,a,u,d,m){return 0<=a&&a<t&&0<=u&&u<e?n[o*r+a*i+u*s+d]:m}function bAe(n,t,e,r,i,s,o,a,u,d,m){return EE(n,t,e,r,i,s,o,Math.round(a),Math.round(u),d,m)}function wAe(n,t,e,r,i,s,o,a,u,d,m){const y=Math.floor(a),_=Math.floor(u),E=y+1,D=_+1;return(E-a)*((D-u)*EE(n,t,e,r,i,s,o,y,_,d,m)+(u-_)*EE(n,t,e,r,i,s,o,y,D,d,m))+(a-y)*((D-u)*EE(n,t,e,r,i,s,o,E,_,d,m)+(u-_)*EE(n,t,e,r,i,s,o,E,D,d,m))}const AAe=[NCe,l1e,ACe,DCe,m1e,kCe,OCe,PCe,$Ce,VCe,UCe,WCe,jCe,KCe,YCe,eSe,nSe,iSe,oSe,SCe,uSe,cSe,fSe,pSe,d1e,v1e,gSe,c1e,vSe,_Se,bSe,xSe,SSe,NSe,ASe,DSe,kSe,OSe,PSe,$Se,VSe,USe,WSe,GSe,qSe,KSe,YSe,QSe,JSe,eEe,rEe,vCe,sEe,y1e,dEe,_1e,pEe,w1e,bEe,wEe,CEe,C1e,E1e,EEe,TEe,IEe,MEe,T1e,I1e,h1e,REe,ySe,FEe,LEe,BEe,yCe,M1e,R1e,zEe,F1e,HEe,jEe,ZEe,YEe,JEe,tNe,nNe,L1e,iNe,oNe,uNe,cNe,fNe,pNe,gNe,B1e,yNe,wNe,SNe,z1e,H1e,TNe,DNe,RNe,G1e,FNe,LNe,$Ne,Fee,UNe,bCe,Z1e,WNe,jNe,ZNe,XNe,f1e,mW,QNe,wCe,xCe,CCe,eTe,nTe,iTe,oTe,uTe,lTe,hTe,nCe,dTe,yTe,bTe,STe,iCe,NTe,ATe,DTe,sCe,xNe,kTe,OTe,PTe,$Te,VTe,UTe,WTe,jTe,uCe,qTe,cCe,fCe,KTe,YTe,JTe,tAe,rAe,gCe,tEe,sAe,{kernelName:S0,backendName:"cpu",kernelFunc:oAe},{kernelName:G2,backendName:"cpu",kernelFunc:function uAe(n){const{inputs:t,backend:e}=n,{tensor:r,indices:i,updates:s}=t,{sliceRank:o,numUpdates:a,sliceSize:u,strides:d,outputSize:m}=Vp(0,i,r.shape),_=e.bufferSync(i),E=e.bufferSync(s),D=e.bufferSync(r),O=Cv(_,E,r.shape,m,u,a,o,d,D,!1);return e.makeTensorInfo(r.shape,O.dtype,O.values)}},{kernelName:E0,backendName:"cpu",kernelFunc:function cAe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reps:s}=r;er(i,"tile");const o=mee(e.bufferSync(i),s);return e.makeTensorInfo(o.shape,o.dtype,o.values)}},{kernelName:rR,backendName:"cpu",kernelFunc:function fAe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{k:s,sorted:o}=r;er(i,"topk");const a=e.data.get(i.dataId).values,[u,d]=vee(a,i.shape,i.dtype,s,o);return[e.makeTensorInfo(u.shape,u.dtype,u.values),e.makeTensorInfo(d.shape,d.dtype,d.values)]}},{kernelName:iR,backendName:"cpu",kernelFunc:function pAe(n){const{inputs:t,attrs:e,backend:r}=n,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:u,outputShape:d}=e,[m,y,_,E]=i.shape,[D,O]=null!=d?d:[y,_],R=[m,D,O,E],$=ur(i.shape),B=$[0],Q=$[1],ie=$[2],ye=ur(R),Me=ye[0],Be=ye[1],He=ye[2],st=Wo(i.dtype,Xt(R));st.fill(u);const lt=r.data.get(i.dataId).values,It=r.data.get(s.dataId).values;for(let Wt=0;Wt<m;++Wt){const qt=1===s.shape[0]?It:It.subarray(8*Wt,8*Wt+8);for(let Kt=0;Kt<D;++Kt)for(let Tt=0;Tt<O;++Tt)for(let Rt=0;Rt<E;++Rt){let Dt;const Ht=qt[6]*Tt+qt[7]*Kt+1;if(0===Ht)continue;const vn=(qt[3]*Tt+qt[4]*Kt+qt[5])/Ht,An=Lee((qt[0]*Tt+qt[1]*Kt+qt[2])/Ht,_,a),Tn=Lee(vn,y,a);switch(o){case"nearest":Dt=bAe(lt,y,_,B,Q,ie,Wt,Tn,An,Rt,u);break;case"bilinear":Dt=wAe(lt,y,_,B,Q,ie,Wt,Tn,An,Rt,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}st[Wt*Me+Kt*Be+Tt*He+Rt]=Dt}return r.makeTensorInfo(R,i.dtype,st)}return{dataId:r.write(st,R,i.dtype),shape:i.shape,dtype:i.dtype}}},j1e,{kernelName:sR,backendName:"cpu",kernelFunc:function xAe(n){const{inputs:t,attrs:e,backend:r}=n,{axis:i}=e,{x:s}=t;er(s,"unique");const o=r.data.get(s.dataId).values,{outputValues:a,outputShape:u,indices:d}=yee(o,i,s.shape,s.dtype);return[r.makeTensorInfo(u,s.dtype,a),r.makeTensorInfo([d.length],"int32",d)]}},{kernelName:wS,backendName:"cpu",kernelFunc:function SAe(n){const{inputs:t,backend:e,attrs:r}=n,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i.shape.length,a=i.shape[s],u=new Array(o-1);let d=0;for(let E=0;E<o;E++)E!==s&&(u[d++]=i.shape[E]);const m=new Array(o).fill(0),y=i.shape.slice();y[s]=1;const _=new Array(a);for(let E=0;E<_.length;E++){m[s]=E;const D=Sv({inputs:{x:i},backend:e,attrs:{begin:m,size:y}});_[E]=as({inputs:{x:D},backend:e,attrs:{shape:u}}),e.disposeIntermediateTensorInfo(D)}return _}},{kernelName:xS,backendName:"cpu",kernelFunc:function NAe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,segmentIds:s}=t,{numSegments:o}=r;er(i,"unsortedSegmentSum");const d=[],m=[],y=i.shape.length-s.shape.length;let _=s;for(let D=0;D<y;++D){const O=rF({inputs:{input:_},backend:e,attrs:{dim:D+1}});_=O,m.push(O)}for(let D=0;D<o;++D){const O=Yf(D,"int32"),R=e.makeTensorInfo([],"int32",O),$=IJ({inputs:{a:R,b:_},backend:e}),B=im({inputs:{x:$},backend:e,attrs:{dtype:"float32"}}),Q=eF({inputs:{a:B,b:i},backend:e}),ie=SE({inputs:{x:Q},backend:e,attrs:{axis:0,keepDims:!1}});d.push(ie),m.push(R),m.push($),m.push(B),m.push(Q),m.push(ie)}const E=Oee({inputs:d,backend:e,attrs:{axis:0}});return m.forEach(D=>e.disposeIntermediateTensorInfo(D)),E}},PNe];for(const n of AAe)cR(n);const om={},sF={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $ee(n,t){om[n]=t}function ih(n,t){if(!(n in om)||null!=t){const r=function DAe(n,t){if(1!==n&&2!==n)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=null==t?function IAe(n){if(!Ft().getBool("IS_SAFARI")&&"undefined"!=typeof OffscreenCanvas&&2===n)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n):t;return e.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete om[n]},!1),Ft().getBool("SOFTWARE_WEBGL_ENABLED")&&(sF.failIfMajorPerformanceCaveat=!1),1===n?e.getContext("webgl",sF)||e.getContext("experimental-webgl",sF):e.getContext("webgl2",sF)}(n,t);if(null===r)return console.log("Could not get context for WebGL version",n),null;om[n]=r}const e=om[n];return null==e||e.isContextLost()?(delete om[n],ih(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),om[n])}var ib=(()=>{return(n=ib||(ib={}))[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH",ib;var n})(),Xu=(()=>{return(n=Xu||(Xu={}))[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD",Xu;var n})(),Jo=(()=>{return(n=Jo||(Jo={}))[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16",Jo;var n})();function NE(n,t){return[t,n]}function oF(n){const t=Xt(n);return Xk(Math.ceil(t/4))}function sb(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function yW(n,t){const e=n;let r,i,s,o,a,u,d,m,y,_;return 2===Ft().getNumber("WEBGL_VERSION")?(r=e.R32F,i=e.R16F,s=e.RGBA16F,o=e.RGBA32F,a=e.RED,d=4,m=1,y=e.HALF_FLOAT,_=e.FLOAT,u=e.RGBA8):(r=n.RGBA,i=n.RGBA,s=n.RGBA,o=e.RGBA,a=n.RGBA,d=4,m=4,y=null!=t?t.HALF_FLOAT_OES:null,_=n.FLOAT,u=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:u,downloadUnpackNumChannels:d,defaultNumChannels:m,textureTypeHalfFloat:y,textureTypeFloat:_}}function Ln(n,t){const e=t();return Ft().getBool("DEBUG")&&function RAe(n){const t=n.getError();if(t!==n.NO_ERROR)throw new Error("WebGL Error: "+Vee(n,t))}(n),e}function Bee(n){return!!(Ft().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===n||5.96e-8<Math.abs(n)&&Math.abs(n)<65504)}function Vee(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function TE(n,t){return md(n,()=>n.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function zee(n,t){const e=md(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ln(n,()=>n.shaderSource(e,t)),Ln(n,()=>n.compileShader(e)),!1===n.getShaderParameter(e,n.COMPILE_STATUS))throw console.log(n.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}function Uee(n,t){const e=md(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ln(n,()=>n.shaderSource(e,t)),Ln(n,()=>n.compileShader(e)),Ft().get("ENGINE_COMPILE_ONLY"))return e;if(!1===n.getShaderParameter(e,n.COMPILE_STATUS))throw _W(t,n.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}const PAe=/ERROR: [0-9]+:([0-9]+):/g;function _W(n,t){const e=PAe.exec(t);if(null==e)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(n);const r=+e[1],i=n.split("\n"),s=i.length.toString().length+2,o=i.map((y,_)=>Wg((_+1).toString(),s)+y);let a=0;for(let y=0;y<o.length;y++)a=Math.max(o[y].length,a);const u=o.slice(0,r-1),d=o.slice(r-1,r),m=o.slice(r);console.log(u.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${Wg(d[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join("\n"))}function Hee(n){return md(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function Wee(n,t){if(Ln(n,()=>n.linkProgram(t)),!Ft().get("ENGINE_COMPILE_ONLY")&&!1===n.getProgramParameter(t,n.LINK_STATUS))throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function aF(n,t){if(Ln(n,()=>n.validateProgram(t)),!1===n.getProgramParameter(t,n.VALIDATE_STATUS))throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Gee(n,t){const e=md(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ln(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),Ln(n,()=>n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function jee(n,t){const e=md(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ln(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e)),Ln(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function LAe(){return 2===Ft().getNumber("WEBGL_VERSION")?1:4}function qee(n){return md(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function Zee(n,t){const e=Ft().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0)throw new Error(`Requested texture size [${n}x${t}] is invalid.`);if(n>e||t>e)throw new Error(`Requested texture size [${n}x${t}] greater than WebGL maximum on this browser / GPU [${e}x${e}].`)}function Kee(n){return md(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function bW(n,t,e,r,i,s,o){const a=n.getAttribLocation(t,e);return-1!==a&&(Ln(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),Ln(n,()=>n.vertexAttribPointer(a,i,n.FLOAT,!1,s,o)),Ln(n,()=>n.enableVertexAttribArray(a)),!0)}function Xee(n,t,e){tte(n,e),Ln(n,()=>n.activeTexture(n.TEXTURE0+e)),Ln(n,()=>n.bindTexture(n.TEXTURE_2D,t))}function $Ae(n,t){tte(n,t),Ln(n,()=>n.activeTexture(n.TEXTURE0+t)),Ln(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Yee(n,t,e){return md(n,()=>n.getUniformLocation(t,e),'uniform "'+e+'" not present in program.')}function Qee(n,t,e){return n.getUniformLocation(t,e)}function Jee(n,t,e,r){Ln(n,()=>Xee(n,t,r)),Ln(n,()=>n.uniform1i(e,r))}function BAe(n){Ln(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,null)),Ln(n,()=>n.viewport(0,0,n.canvas.width,n.canvas.height)),Ln(n,()=>n.scissor(0,0,n.canvas.width,n.canvas.height))}function uF(n,t,e){Ln(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Ln(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0))}function wW(n,t){Ln(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Ln(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function AE(n){const t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+ete(n,t))}function ete(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function md(n,t,e){const r=Ln(n,()=>t());if(null==r)throw new Error(e);return r}function tte(n,t){const e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+n.TEXTURE0;if(r<n.TEXTURE0||r>e)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${e}].`)}function Ev(n,t=2){return Xt(n.slice(0,n.length-t))}function Nv(n){if(0===n.length)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function IE(n){let t=[1,1,1];return 0===n.length||1===n.length&&1===n[0]||(t=[Ev(n),...Nv(n)]),t}function nte(n,t=!1){let e=Ft().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Ft().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Ft().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=e/2),t&&(e*=2,r*=2,1===(n=n.map((a,u)=>u>=n.length-2?Kk(n[u]):n[u])).length&&(n=[2,n[0]])),2!==n.length&&(n=Kf(n).newShape);let i=Xt(n),s=null;n.length<=1&&i<=e?s=[1,i]:2===n.length&&n[0]<=e&&n[1]<=e?s=n:3===n.length&&n[0]*n[1]<=e&&n[2]<=e?s=[n[0]*n[1],n[2]]:3===n.length&&n[0]<=e&&n[1]*n[2]<=e?s=[n[0],n[1]*n[2]]:4===n.length&&n[0]*n[1]*n[2]<=e&&n[3]<=e?s=[n[0]*n[1]*n[2],n[3]]:4===n.length&&n[0]<=e&&n[1]*n[2]*n[3]<=e&&(s=[n[0],n[1]*n[2]*n[3]]);const o=null!=s&&Math.max(...s)>r&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(null==s||o)if(t){const a=Ev(n);let u=2,d=2;n.length&&([u,d]=Nv(n)),i=a*(u/2)*(d/2),s=Xk(i).map(m=>2*m)}else s=Xk(i);return s}function lF(n){return n%2==0}function DE(n,t){if(ri(n=n.slice(-2),t=t.slice(-2))||!n.length||!t.length||0===n[0]||0===n[1]||0===t[0]||0===t[1])return!0;if(n.length!==t.length){const e=n[n.length-1],r=t[t.length-1];if(e===r||lF(e)&&lF(r)&&(1===n[0]||1===t[0]))return!0}return n[1]===t[1]&&lF(n[0])&&lF(t[0])}let cF,hF;function rte(n){if(null==cF){const t=ih(n);cF=t.getParameter(t.MAX_TEXTURE_SIZE)}return cF}function VAe(){cF=null}function zAe(){hF=null}function ite(n){if(null==hF){const t=ih(n);hF=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,hF)}function ste(n){if(0===n)return 0;let t;const e=ih(n);return t=Al(e,"EXT_disjoint_timer_query_webgl2")&&2===n?2:Al(e,"EXT_disjoint_timer_query")?1:0,t}function Al(n,t){return null!=n.getExtension(t)}function xW(n){try{if(null!=ih(n))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function ote(n){if(0===n)return!1;const t=ih(n);if(1===n){if(!Al(t,"OES_texture_float"))return!1}else if(!Al(t,"EXT_color_buffer_float"))return!1;return CW(t)}function ate(n){if(0===n)return!1;const t=ih(n);if(1!==n){if(Al(t,"EXT_color_buffer_float"))return CW(t);const r="EXT_color_buffer_half_float";if(Al(t,r)){const i=t.getExtension(r);return function UAe(n,t){const e=yW(n,t),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(o),a}(t,i)}return!1}return!(!Al(t,"OES_texture_float")||!Al(t,"WEBGL_color_buffer_float"))&&CW(t)}function CW(n){const t=yW(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const s=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,s),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(s),o}function ute(n){return 2===n&&null!=ih(n).fenceSync}function ob(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{null!=e&&De("complex64"!==e.dtype,()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}const rr=Ft();function Xa(){let n,t,e,r,i,s,o,a,u,d;return 2===Ft().getNumber("WEBGL_VERSION")?(n="#version 300 es",t="in",e="out",r="in",i="texture",s="outputColor",o="out vec4 outputColor;",a=Ft().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",d="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(n="",t="attribute",e="varying",r="varying",i="texture2D",s="gl_FragColor",o="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",d="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:n,attribute:t,varyingVs:e,varyingFs:r,texture2D:i,output:s,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:u,defineRound:d}}function Tv(n,t,e="index"){const r=ur(t);return r.map((i,s)=>`int ${n[s]} = ${e} / ${i}; ${s===r.length-1?`int ${n[s+1]} = ${e} - ${n[s]} * ${i}`:`index -= ${n[s]} * ${i}`};`).join("")}function fF(n,t,e="index"){const r=ur(t);return r.map((i,s)=>`int ${n[s]} = ${e} / outShapeStrides[${s}]; ${s===r.length-1?`int ${n[s+1]} = ${e} - ${n[s]} * outShapeStrides[${s}]`:`index -= ${n[s]} * outShapeStrides[${s}]`};`).join("")}function SW(n){const t=ur(n).map(e=>e.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}rr.registerFlag("HAS_WEBGL",()=>rr.getNumber("WEBGL_VERSION")>0),rr.registerFlag("WEBGL_VERSION",()=>xW(2)?2:xW(1)?1:0),rr.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),rr.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===rr.get("WEBGL_VERSION")),rr.registerFlag("WEBGL_CPU_FORWARD",()=>!0),rr.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),rr.registerFlag("WEBGL_PACK",()=>rr.getBool("HAS_WEBGL")),rr.registerFlag("WEBGL_PACK_NORMALIZATION",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_PACK_CLIP",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_PACK_REDUCE",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_LAZILY_UNPACK",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_CONV_IM2COL",()=>rr.getBool("WEBGL_PACK")),rr.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>rte(rr.getNumber("WEBGL_VERSION"))),rr.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>ite(rr.getNumber("WEBGL_VERSION"))),rr.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=rr.getNumber("WEBGL_VERSION");return 0===n?0:ste(n)}),rr.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>rr.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!cU()),rr.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>ote(rr.getNumber("WEBGL_VERSION"))),rr.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!rr.getBool("WEBGL_FORCE_F16_TEXTURES")&&rr.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),rr.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>ate(rr.getNumber("WEBGL_VERSION"))),rr.registerFlag("WEBGL_FENCE_API_ENABLED",()=>ute(rr.getNumber("WEBGL_VERSION"))),rr.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>rr.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),rr.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(n<0&&-1!==n)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)}),rr.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>cU()?1:-1,n=>{if(n<0&&-1!==n)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)}),rr.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),rr.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),rr.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),rr.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),rr.registerFlag("WEBGL_EXP_CONV",()=>!1),rr.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>rr.getBool("IS_TEST")),rr.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),rr.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),rr.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),rr.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);const lte="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:cte}=me;function GAe(n,t,e){const r=[];if(n.forEach(E=>{const D=Xt(E.shapeInfo.logicalShape);if(E.shapeInfo.isUniform?r.push(`uniform float ${E.name}${D>1?`[${D}]`:""};`):(r.push(`uniform sampler2D ${E.name};`),r.push(`uniform int offset${E.name};`)),e.enableShapeUniforms){const{uniformShape:O}=NW(e.packedInputs,E.shapeInfo.logicalShape,E.shapeInfo.texShape);switch(O.length){case 1:r.push(`uniform int ${E.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${E.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${E.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${E.name}Shape;`)}r.push(`uniform ivec2 ${E.name}TexShape;`)}}),e.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}e.customUniforms&&e.customUniforms.forEach(E=>{r.push(`uniform ${E.type} ${E.name}${E.arrayIndex?`[${E.arrayIndex}]`:""};`)});const i=r.join("\n"),s=n.map(E=>function jAe(n,t,e=!1,r){let i="";return i+=e?hte(n,r):ab(n,r),n.shapeInfo.logicalShape.length<=t.logicalShape.length&&(i+=e?function EIe(n,t){const e=n.name,r=e.charAt(0).toUpperCase()+e.slice(1),i="get"+r+"AtOutCoords",s=n.shapeInfo.logicalShape.length,o=t.logicalShape.length,a=cte(n.shapeInfo.logicalShape,t.logicalShape),u=Ki(o),d=o-s;let m;const y=["x","y","z","w","u","v"];m=0===s?"":o<2&&a.length>=1?"coords = 0;":a.map(B=>`coords.${y[B+d]} = 0;`).join("\n");let _="";_=o<2&&s>0?"coords":n.shapeInfo.logicalShape.map((B,Q)=>`coords.${y[Q+d]}`).join(", ");let E="return outputValue;";const O=1===Xt(n.shapeInfo.logicalShape),$=1===Xt(t.logicalShape);if(1!==s||O||$){if(O&&!$)E=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(a.length){const B=s-2,Q=s-1;a.indexOf(B)>-1&&a.indexOf(Q)>-1?E="return vec4(outputValue.x);":a.indexOf(B)>-1?E="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(Q)>-1&&(E="return vec4(outputValue.xx, outputValue.zz);")}}else E="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${u} coords = getOutputCoords();\n      ${m}\n      vec4 outputValue = get${r}(${_});\n      ${E}\n    }\n  `}(n,t):function NIe(n,t){const e=n.name,r=e.charAt(0).toUpperCase()+e.slice(1),i="get"+r+"AtOutCoords",a=n.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!n.shapeInfo.isUniform&&a===u&&null==n.shapeInfo.flatOffset&&ri(n.shapeInfo.texShape,t.texShape))return`\n      float ${i}() {\n        return sampleTexture(${e}, resultUV);\n      }\n    `;const d=Ki(u),m=cte(n.shapeInfo.logicalShape,t.logicalShape),y=u-a;let _;const E=["x","y","z","w","u","v"];_=0===a?"":u<2&&m.length>=1?"coords = 0;":m.map(O=>`coords.${E[O+y]} = 0;`).join("\n");let D="";return D=u<2&&a>0?"coords":n.shapeInfo.logicalShape.map((O,R)=>`coords.${E[R+y]}`).join(", "),`\n    float ${i}() {\n      ${d} coords = getOutputCoords();\n      ${_}\n      return get${r}(${D});\n    }\n  `}(n,t)),i}(E,t,e.packedInputs,e.enableShapeUniforms)).join("\n"),o=t.texShape,a=Xa(),u=function KAe(n){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${n.texture2D}(textureSampler, uv).r;\n    }\n  `}(a);let d,m,y=function QAe(n){return`${n.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${n.varyingFs} vec2 resultUV;\n    ${n.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${n.defineSpecialNaN}\n    ${n.defineSpecialInf}\n    ${n.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${JAe}\n    ${eIe}\n    ${tIe}\n  `}(a);return t.isPacked?(d=function qAe(n,t,e){switch(n.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function rIe(n,t,e){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===r[0]?e?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `:1===r[1]?e?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `:e?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,t,e);case 2:return function hIe(n,t,e){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(ri(n,t))return e?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const i=Math.ceil(n[1]/2);return e?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(n,t,e);case 3:return function sIe(n,t,e){if(e)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(n[2]/2),s=i*Math.ceil(n[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(n,t,e);default:return function aIe(n,t,e){if(e)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(n[n.length-1]/2),s=i*Math.ceil(n[n.length-2]/2);let o=s,a="",u="b, r, c";for(let d=2;d<n.length-1;d++)o*=n[n.length-d-1],a=`\n      int b${d} = index / ${o};\n      index -= b${d} * ${o};\n    `+a,u=`b${d}, `+u;return`\n    ivec${n.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${a}\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${n.length}(${u});\n    }\n  `}(n,t,e)}}(t.logicalShape,o,e.enableShapeUniforms),m=function YAe(n){return`\n    void setOutput(vec4 val) {\n      ${n.output} = val;\n    }\n  `}(a)):(d=function ZAe(n,t,e){switch(n.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function iIe(n,t,e){return 1===t[0]?e?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `:1===t[1]?e?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `:e?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,e);case 2:return function fIe(n,t,e){return ri(n,t)?e?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `:1===n[1]?e?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===n[0]?e?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:e?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${n[1]};\n      int c = index - r * ${n[1]};\n      return ivec2(r, c);\n    }\n  `}(n,t,e);case 3:return function oIe(n,t,e){if(e)return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${fF(["r","c","d"],n)}\n    return ivec3(r, c, d);\n  }\n`;const r=Tv(["r","c","d"],n);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(n,t,e);case 4:return function uIe(n,t,e){if(e)return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${fF(["r","c","d","d2"],n)}\n      return ivec4(r, c, d, d2);\n    }\n  `;const r=Tv(["r","c","d","d2"],n);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(n,t,e);case 5:return function lIe(n,t){const e=Tv(["r","c","d","d2","d3"],n);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${e}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(n,t);case 6:return function cIe(n,t){const e=Tv(["r","c","d","d2","d3","d4"],n);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${e}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(n,t);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}(t.logicalShape,o,e.enableShapeUniforms),m=function XAe(n){return`\n    void setOutput(float val) {\n      ${n.output} = vec4(val, 0, 0, 0);\n    }\n  `}(a)),e.packedInputs&&(y+=nIe),[y,u,m,i,d,s,e.userCode].join("\n")}function ab(n,t=!1){const e=n.shapeInfo.logicalShape;switch(e.length){case 0:return function pIe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${e};}`;const[i,s]=n.shapeInfo.texShape;if(1===i&&1===s)return`\n      float ${r}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const o=Av(e);if(t)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `;const[a,u]=n.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${a}, ${u}, ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `}(n,t);case 1:return function gIe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${ub(n)}\n      }\n    `;const i=n.shapeInfo.texShape,s=i[0],o=i[1];if(1===o&&1===s)return`\n      float ${r}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const a=Av(e);return 1===o?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${e}TexShape[0]));\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `:1===s?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${e}TexShape[1]), 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:t?`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], index + ${a});\n      return sampleTexture(${e}, uv);\n    }\n  `:`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${s}, ${o}, index + ${a});\n      return sampleTexture(${e}, uv);\n    }\n  `}(n,t);case 2:return function yIe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape;if(null!=s&&ri(e,s))return t?`\n      float ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${s[1]}.0, ${s[0]}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const{newShape:o,keptDims:a}=Kf(e);if(o.length<e.length){const E=["row","col"];return`\n      ${ab(lb(n,o),t)}\n      float ${i}(int row, int col) {\n        return ${i}(${cb(E,a)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));\n        ${ub(n)}\n      }\n    `;const d=s[0],m=s[1],y=Av(r);return 1===m?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${y}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${y}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${d}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `:1===d?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${y}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${y}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${m}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `:t?`\n      float ${i}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${y};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${e[1]} + col + ${y};\n    vec2 uv = uvFromFlat(${d}, ${m}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(n,t);case 3:return function bIe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[1]*e[2],o=e[2],{newShape:a,keptDims:u}=Kf(e);if(a.length<e.length){const R=["row","col","depth"];return`\n        ${ab(lb(n,a),t)}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${cb(R,u)});\n        }\n      `}if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${s}, ${o}, 1)));\n        ${ub(n)}\n      }\n    `;const m=n.shapeInfo.texShape,y=m[0],_=m[1],E=n.shapeInfo.flatOffset;if(_===s&&null==E)return t?`\n      float ${i}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${o}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${_}.0, ${y}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(_===o&&null==E)return t?`\n      float ${i}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${_}.0, ${y}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const D=Av(r);return t?`\n    float ${i}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${D};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `:`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${s} + col * ${o} + depth + ${D};\n        vec2 uv = uvFromFlat(${y}, ${_}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(n,t);case 4:return function xIe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[3],o=e[2]*s,a=e[1]*o,{newShape:u,keptDims:d}=Kf(e);if(u.length<e.length){const Q=["row","col","depth","depth2"];return`\n      ${ab(lb(n,u),t)}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${cb(Q,d)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${a}, ${o}, ${s}, 1)));\n        ${ub(n)}\n      }\n    `;const m=n.shapeInfo.flatOffset,y=n.shapeInfo.texShape,_=y[0],E=y[1],D=`int stride2 = ${r}Shape[3];`,O=`int stride1 = ${r}Shape[2] * stride2;`,R=`int stride0 = ${r}Shape[1] * stride1;`;if(E===a&&null==m)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        ${D}\n        ${O}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${o}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${E}.0, ${_}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(E===s&&null==m)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${e[1]*e[2]}, ${e[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${E}.0, ${_}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const $=Av(r);return t?`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${D}\n      ${O}\n      ${R}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${$});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} +\n          depth * ${s} + depth2;\n      vec2 uv = uvFromFlat(${_}, ${E}, index + ${$});\n      return sampleTexture(${r}, uv);\n    }\n  `}(n,t);case 5:return function CIe(n){const t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=t[4],s=t[3]*i,o=t[2]*s,a=t[1]*o,{newShape:u,keptDims:d}=Kf(t);if(u.length<t.length){const R=["row","col","depth","depth2","depth3"];return`\n      ${ab(lb(n,u))}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${cb(R,d)});\n      }\n    `}if(n.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${a}, ${o}, ${s}, ${i})) +\n          depth3;\n        ${ub(n)}\n      }\n    `;const m=n.shapeInfo.flatOffset,y=n.shapeInfo.texShape,_=y[0],E=y[1];if(E===a&&null==m)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${o}, ${s}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${E}.0, ${_}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(E===i&&null==m)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${E}.0, ${_}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} + depth * ${s} +\n          depth2 * ${i} + depth3 + ${Av(e)};\n      vec2 uv = uvFromFlat(${_}, ${E}, index);\n      return sampleTexture(${e}, uv);\n    }\n  `}(n);case 6:return function SIe(n){const t=n.shapeInfo.logicalShape,e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:i,keptDims:s}=Kf(t);if(i.length<t.length){const $=["row","col","depth","depth2","depth3","depth4"];return`\n      ${ab(lb(n,i))}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${cb($,s)});\n      }\n    `}const o=t[5],a=t[4]*o,u=t[3]*a,d=t[2]*u,m=t[1]*d;if(n.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${m}, ${d}, ${u}, ${a})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${o}, 1)));\n        ${ub(n)}\n      }\n    `;const y=n.shapeInfo.flatOffset,_=n.shapeInfo.texShape,E=_[0],D=_[1];if(D===m&&null==y)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${d}, ${u}, ${a}, ${o})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${D}.0, ${E}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;if(D===o&&null==y)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${D}.0, ${E}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `;return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${m} + col * ${d} + depth * ${u} +\n          depth2 * ${a} + depth3 * ${o} + depth4 + ${Av(e)};\n      vec2 uv = uvFromFlat(${E}, ${D}, index);\n      return sampleTexture(${e}, uv);\n    }\n  `}(n);default:throw new Error(`${e.length}-D input sampling is not yet supported`)}}function hte(n,t){switch(n.shapeInfo.logicalShape.length){case 0:return function dIe(n){const t=n.name;return`\n    vec4 ${"get"+t.charAt(0).toUpperCase()+t.slice(1)}() {\n      return ${Xa().texture2D}(${t}, halfCR);\n    }\n  `}(n);case 1:return function mIe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=n.shapeInfo.texShape,s=Xa();if(t)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${s.texture2D}(${e}, uv);\n    }\n  `;const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${o[0]}, ${o[1]}, index);\n      return ${s.texture2D}(${e}, uv);\n    }\n  `}(n,t);case 2:return function vIe(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape,o=s[0],a=s[1],u=Xa();if(null!=s&&ri(e,s))return t?`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${u.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);\n\n        return ${u.texture2D}(${r}, uv);\n      }\n    `;if(t)return`\n    vec4 ${i}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${u.texture2D}(${r}, uv);\n    }\n  `;const d=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(e[1]/2)}, ${d[0]}, ${d[1]}, row, col);\n      return ${u.texture2D}(${r}, uv);\n    }\n  `}(n,t);case 3:return function _Ie(n,t){const e=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(1===e[0]){const E=[1,2],O=["b","row","col"];return`\n        ${hte(lb(n,e.slice(1)),t)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${cb(O,E)});\n        }\n      `}const a=Xa();if(t)return`\n    vec4 ${i}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `;const u=o[0],d=o[1],m=Math.ceil(e[2]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${u}, ${d}, ${m*Math.ceil(e[1]/2)}, ${m}, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `}(n,t);default:return function wIe(n,t){const e=n.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),i=Xa();if(t)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${e}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${e}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${e}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${e}, uv);\n    }\n  `;const s=n.shapeInfo.logicalShape,o=s.length,a=n.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],d=u[0],m=u[1],y=Math.ceil(s[o-1]/2);let _=y*Math.ceil(s[o-2]/2),E="int b, int row, int col",D=`b * ${_} + (row / 2) * ${y} + (col / 2)`;for(let O=2;O<o-1;O++)E=`int b${O}, `+E,_*=s[o-O-1],D=`b${O} * ${_} + `+D;return`\n    vec4 ${r}(${E}) {\n      int index = ${D};\n      int texR = index / ${m};\n      int texC = index - texR * ${m};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${m}, ${d});\n      return ${i.texture2D}(${e}, uv);\n    }\n  `}(n,t)}}const JAe="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",eIe="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",tIe="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",nIe="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Av(n){return`offset${n}`}function ub(n){const t=n.name,e=Xt(n.shapeInfo.logicalShape);return e<2?`return ${t};`:`\n    for (int i = 0; i < ${e}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function Ki(n){if(n<=1)return"int";if(2===n)return"ivec2";if(3===n)return"ivec3";if(4===n)return"ivec4";if(5===n)return"ivec5";if(6===n)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function NW(n,t,e){const{newShape:r,keptDims:i}=Kf(t),s=t.length,o=n&&3===s&&1===t[0],a=o?t.slice(1):r,u=!n&&s>1&&!ri(t,e)&&r.length<s||o;return{useSqueezeShape:u,uniformShape:u?a:t,keptDims:i}}function lb(n,t){const e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function cb(n,t){return t.map(e=>n[e]).join(", ")}function dte(n,t,e){const r=[],i=[];let s,o,a,u=null,d=null;d=n.getUniformLocation(e,"NAN",!1),1===Ft().getNumber("WEBGL_VERSION")&&(u=n.getUniformLocation(e,"INFINITY",!1));const m=!1;for(const y of t.variableNames){const _={name:y,uniform:n.getUniformLocation(e,y,m),offset:n.getUniformLocation(e,`offset${y}`,m)};t.enableShapeUniforms&&(_.shape=n.getUniformLocation(e,`${y}Shape`,m),_.texShape=n.getUniformLocation(e,`${y}TexShape`,m)),r.push(_)}if(t.enableShapeUniforms&&(s=n.getUniformLocation(e,"outShape",m),a=n.getUniformLocation(e,"outShapeStrides",m),o=n.getUniformLocation(e,"outTexShape",m)),t.customUniforms)for(const y of t.customUniforms)i.push(n.getUniformLocation(e,y.name,m));return{variablesLocations:r,customUniformLocations:i,infLoc:u,nanLoc:d,outShapeLocation:s,outShapeStridesLocation:a,outTexShapeLocation:o}}function pte(n,t){if(n.length!==t.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${t.length} inputs`);n.forEach((e,r)=>{const i=e.logicalShape,s=t[r],o=s.shape;if(!ri(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(e.isUniform&&s.isUniform)return;const a=e.texShape,u=s.isUniform?null:s.texData.texShape;if(!ri(a,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${u} must match`)})}function Oa(n){return Ft().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}class DIe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ib.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=Xa();this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?fF(["r","c","d"],t):Tv(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${e.output} = result;\n      }\n    `}}class MIe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ib.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=Xa();this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?fF(["r","c","d"],t):Tv(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${e.output} = result;\n      }\n    `}}class kIe{constructor(t){this.variableNames=["A"],this.outTexUsage=Xu.DOWNLOAD;const e=Xa();this.outputShape=t,this.userCode=`\n      ${lte}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}class RIe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Xu.DOWNLOAD;const e=Xa();this.outputShape=t,this.userCode=`\n      ${lte}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}const OIe={R:0,G:1,B:2,A:3};class mte{constructor(t,e=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=Xa();this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length);let s="result";e&&(s="floor(result * 255. + 0.5)");let o="";for(let a=0;a<r.length;a++)o+=`\n          if(offset == ${a}) {\n            result = values[${OIe[r[a]]}];\n          }`;this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":SW(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ${r.length});\n\n        flatIndex = idiv(flatIndex, ${r.length}, 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ${i.texture2D}(A, uv);\n          ${o}\n        }\n        ${i.output} = vec4(${s}, 0., 0., 0.);\n      }\n    `}}class FIe{constructor(t,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Xa();this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length);let i="",s="result";e&&(s="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const u=2*o+a;i+=`\n          localCoords = coords;\n          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {\n          localCoords[2] += ${a};\n          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {\n            localCoords[1] += ${o};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${r.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${u}] = values[0];\n            } else if (offset == 1) {\n              result[${u}] = values[1];\n            } else if (offset == 2) {\n              result[${u}] = values[2];\n            } else {\n              result[${u}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":SW(t)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${i}\n\n          ${r.output} = ${s};\n        }\n    `}}function gte(n){const t=Xa();return zee(n,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function vte(n){return Gee(n,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function yte(n){return jee(n,new Uint16Array([0,1,2,2,1,3]))}function ME(n,t,e,r,i,s){Zee(t,e);const o=qee(n),a=n.TEXTURE_2D;return Ln(n,()=>n.bindTexture(a,o)),Ln(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Ln(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Ln(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),Ln(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),1===Ft().getNumber("WEBGL_VERSION")?Ln(n,()=>n.texImage2D(a,0,r,t,e,0,i,s,null)):Ln(n,()=>n.texStorage2D(a,1,r,t,e)),Ln(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:o,texShape:[e,t]}}function TW(n){return n.internalFormatFloat}function _te(n,t,e,r){const[i,s]=NE(t,e);return ME(n,i,s,TW(r),r.textureFormatFloat,n.FLOAT)}function AW(n){return n.internalFormatHalfFloat}function bte(n,t,e,r){const[i,s]=NE(t,e);return ME(n,i,s,AW(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function IW(n){return n.downloadTextureFormat}function wte(n,t,e,r){const[i,s]=NE(t,e);return ME(n,i,s,IW(r),n.RGBA,n.UNSIGNED_BYTE)}function DW(n){return n.internalFormatPackedFloat}function xte(n,t,e,r){const[i,s]=sb(t,e);return ME(n,i,s,DW(r),n.RGBA,n.FLOAT)}function MW(n){return n.internalFormatPackedHalfFloat}function Cte(n,t,e,r){const[i,s]=sb(t,e);return ME(n,i,s,MW(r),n.RGBA,r.textureTypeHalfFloat)}function Ste(n,t,e){return Ln(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),bW(n,t,"clipSpacePos",e,3,20,0)&&bW(n,t,"uv",e,2,20,12)}function Ete(n,t,e,r,i,s){let o,a,u;Ln(n,()=>n.bindTexture(n.TEXTURE_2D,t)),i instanceof Uint8Array?(o=new Uint8Array(e*r*4),a=n.UNSIGNED_BYTE,u=n.RGBA):(o=new Float32Array(e*r*4),a=n.FLOAT,u=s.internalFormatPackedFloat),o.set(i),2===Ft().getNumber("WEBGL_VERSION")?Ln(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,r,n.RGBA,a,o)):Ln(n,()=>n.texImage2D(n.TEXTURE_2D,0,u,e,r,0,n.RGBA,a,o)),Ln(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Nte(n,t,e){Ln(n,()=>n.bindTexture(n.TEXTURE_2D,t)),e.data instanceof Uint8Array?2===Ft().getNumber("WEBGL_VERSION")?Ln(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.width,e.height,n.RGBA,n.UNSIGNED_BYTE,e.data)):Ln(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,e.data)):2===Ft().getNumber("WEBGL_VERSION")?Ln(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,e)):Ln(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e)),Ln(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Tte(n,t,e,r){const i=n.createBuffer();Ln(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,i));const a=16*t*e;return Ln(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),Ln(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,0)),Ln(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),i}function Ate(n,t,e){const r=n,i=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function Ite(n,t,e,r){const[i,s]=NE(t,e),a=new Uint8Array(function MAe(n,t){return n*t}(t*e,4));return Ln(n,()=>n.readPixels(0,0,i,s,r.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Dte(n,t,e,r,i,s,o,a){const u=n,d=new Float32Array(function kAe(n,t){const[e,r]=sb(n,t);return e*r*4}(s,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,d),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),d}function Mte(n,t,e){const r=new Float32Array(t*e*4);return Ln(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,r)),r}class pF{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=Ft().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,$ee(e,t)):this.gl=ih(e),t=this.gl,2===Ft().getNumber("WEBGL_VERSION")){const s=t;this.createVertexArray=()=>Ln(s,()=>s.createVertexArray()),this.bindVertexArray=o=>Ln(s,()=>s.bindVertexArray(o)),this.deleteVertexArray=o=>Ln(s,()=>s.deleteVertexArray(o)),this.getVertexArray=()=>Ln(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(null!=t){const s=t.getExtension("OES_vertex_array_object");if(null==s)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ln(t,()=>s.createVertexArrayOES()),this.bindVertexArray=o=>Ln(t,()=>s.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ln(t,()=>s.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ln(t,()=>t.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===Ft().getNumber("WEBGL_VERSION")){const o="OES_texture_half_float";if(this.textureFloatExtension=TE(this.gl,"OES_texture_float"),Al(this.gl,o))this.textureHalfFloatExtension=TE(this.gl,o);else if(Ft().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Al(this.gl,i))this.colorBufferHalfFloatExtension=TE(this.gl,i);else if(Ft().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Al(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Al(this.gl,i))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(i)}this.vertexBuffer=vte(this.gl),this.indexBuffer=yte(this.gl),this.framebuffer=Kee(this.gl),this.textureConfig=yW(this.gl,this.textureHalfFloatExtension)}get debug(){return Ft().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Ln(t,()=>t.finish()),Ln(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Ln(t,()=>t.deleteFramebuffer(this.framebuffer)),Ln(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Ln(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Ln(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),_te(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),bte(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),wte(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),Nte(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,r,i){this.throwIfDisposed(),Ete(this.gl,t,e,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),Cte(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),xte(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(wW(this.gl,this.framebuffer),this.outputTexture=null),Ln(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,r){return this.downloadMatrixDriver(t,()=>Ite(this.gl,e,r,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,r,i,s,o){return Dte(this.gl,t,0,0,0,s,o)}downloadFloat32MatrixFromBuffer(t,e){return Ate(this.gl,t,e)}createBufferFromTexture(t,e,r){this.bindTextureToFrameBuffer(t);const i=Tte(this.gl,e,r);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,r;if(Ft().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=()=>{const o=i.clientWaitSync(s,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},e=s}else Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(e,Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:e,isFencePassed:r}}downloadMatrixFromPackedTexture(t,e,r){return this.downloadMatrixDriver(t,()=>Mte(this.gl,e,r))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=gte(e));const r=Hee(e);let i;return Ln(e,()=>e.attachShader(r,this.vertexShader)),Ln(e,()=>e.attachShader(r,t)),Wee(e,r),i=Object.assign(r,{vao:this.createVertexArray()}),this.bindVertexArray(i.vao),Ln(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),console.assert(Ste(e,i,this.vertexBuffer),"gpgpu_util.bindVertexProgramAttributeStreams not fully successful."),this.debug&&aF(e,i),this.setProgram(i),i}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(Ln(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&(this.bindVertexArray(this.program.vao),this.debug&&aF(this.gl,this.program)),Ln(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,r=!0){return this.throwIfDisposed(),r?Yee(this.gl,t,e):Qee(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),Ln(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),Jee(this.gl,t,e,r)}setOutputMatrixTexture(t,e,r){this.setOutputMatrixTextureDriver(t,r,e)}setOutputPackedMatrixTexture(t,e,r){this.throwIfDisposed();const[i,s]=sb(e,r);this.setOutputMatrixTextureDriver(t,i,s)}setOutputMatrixWriteRegion(t,e,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,e)}setOutputPackedMatrixWriteRegion(t,e,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&aF(this.gl,this.program),AE(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ln(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ln(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=TE(this.gl,2===Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,s),s}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,r=this.getQueryTimerExtensionWebGL2();return void e.endQuery(r.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){var e=this;return(0,Nt.Z)(function*(){return yield Y4(()=>e.disposed||e.isQueryAvailable(t,Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),e.getQueryTime(t,Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})()}getQueryTime(t,e){if(0===e)return null;if(2===e){const r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function PIe(n){let t=0;for(;t<n.length&&n[t]();++t);return t-1}(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:r}=this.itemsToPoll[e];r()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Ft().platform&&(r=Ft().platform.setTimeoutCustom.bind(Ft().platform)),Y4(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,r)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),uF(this.gl,t,this.framebuffer),this.debug&&AE(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(uF(this.gl,this.outputTexture,this.framebuffer),this.debug&&AE(this.gl)):wW(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const r=e();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(t,e,r){this.throwIfDisposed();const i=this.gl;uF(i,t,this.framebuffer),this.debug&&AE(i),this.outputTexture=t,Ln(i,()=>i.viewport(0,0,e,r)),Ln(i,()=>i.scissor(0,0,e,r))}setOutputMatrixWriteRegionDriver(t,e,r,i){this.throwIfDisposed(),Ln(this.gl,()=>this.gl.scissor(t,e,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{addImpl:LIe,bincountImpl:kte,bincountReduceImpl:$Ie,castImpl:BIe,ceilImpl:VIe,concatImpl:zIe,equalImpl:UIe,expImpl:HIe,expm1Impl:WIe,floorImpl:GIe,gatherNdImpl:jIe,gatherV2Impl:qIe,greaterImpl:ZIe,greaterEqualImpl:KIe,lessImpl:XIe,lessEqualImpl:YIe,linSpaceImpl:QIe,logImpl:JIe,maxImpl:eDe,maximumImpl:tDe,minimumImpl:nDe,multiplyImpl:rDe,negImpl:iDe,notEqualImpl:sDe,prodImpl:oDe,raggedGatherImpl:aDe,raggedRangeImpl:uDe,raggedTensorToTensorImpl:lDe,rangeImpl:cDe,rsqrtImpl:hDe,scatterImpl:fDe,sigmoidImpl:dDe,simpleAbsImpl:Rte,sliceImpl:pDe,sparseFillEmptyRowsImpl:mDe,sparseReshapeImpl:gDe,sparseSegmentReductionImpl:Ote,sqrtImpl:vDe,staticRegexReplaceImpl:yDe,stridedSliceImpl:_De,stringNGramsImpl:bDe,stringSplitImpl:wDe,stringToHashBucketFastImpl:xDe,subImpl:CDe,tileImpl:SDe,topKImpl:EDe,transposeImpl:kW,uniqueImpl:NDe}=_e;function Fte(n,t){return["x","y","z","w","u","v"].slice(0,t).map(e=>`${n}.${e}`)}function Ya(n,t){return 1===t?[n]:Fte(n,t)}class ADe{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Oa(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=Ya("rc",this.rank),r=Ki(this.rank),i=this.getOutOfBoundsCondition(e),s=this.getSetup(e),o=this.getOutput(e);this.userCode=`\n        void main() {\n          ${r} rc = getOutputCoords();\n\n          if(${i}) {\n            setOutput(vec4(0));\n          } else {\n            ${s}\n\n            setOutput(vec4(${o}));\n          }\n        }\n      `}}getSourceCoordsArr(t){const e=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let s=`${0===r?"r":"rp1"}, ${0===i?"c":"cp1"}`;for(let o=2;o<this.rank;o++)s=`${t[t.length-1-o]},`+s;e.push(s)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let r=this.rank-2;r<this.rank;r++)e+=`${t[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2);return`\n      int r = ${e[0]};\n      int c = ${e[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1]};\n      bool rEdge = rp1 >= ${this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2]};\n    `}getOutput(t){const e=this.getSourceCoordsArr(t);return 1===this.rank?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${e[0]}),\n            cEdge ? 0. : getA(${e[1]}),\n            rEdge ? 0. : getA(${e[2]}),\n            rEdge || cEdge ? 0. : getA(${e[3]})`}}class Pte{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length);let r="";for(let i=0;i<4;i++){let s="thisRC = rc;";i%2==1&&(s+="thisRC.z += 1;"),i>1&&(s+="thisRC.y += 1;"),r+=`\n        ${s}\n        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${i}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${i>0?"}":""}\n      `}this.userCode=`\n      ${function IDe(n,t){return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${t?function WAe(n,t,e="index"){const i=function HAe(n,t){const e=n.length,r=n.map(s=>`${t}[${s}]`),i=new Array(e-1);i[e-2]=r[e-1];for(let s=e-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}(n.map((s,o)=>o),t);return i.map((s,o)=>`int ${n[o]} = ${e} / ${i[o]}; ${o===i.length-1?`int ${n[o+1]} = ${e} - ${n[o]} * ${i[o]}`:`index -= ${n[o]} * ${i[o]}`};`).join("")}(["r","c","d"],"inputShape"):Tv(["r","c","d"],n)}\n      return ivec3(r, c, d);\n    }\n  `}(e,this.enableShapeUniforms)}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":SW(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};\n\n        ${r}\n\n        setOutput(result);\n      }\n    `}}class DDe{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,r){const i=$te(e,r),s=Bte(t,i,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const o=Lte(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const u=this.freeTextures[s].pop();return this.usedTextures[s].push(u),u}let a;return i===Jo.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Jo.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Jo.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Jo.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Jo.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(t,e,r,i){if(null==this.freeTextures)return;const s=$te(r,i),o=Bte(e,s,i);o in this.freeTextures||(this.freeTextures[o]=[]);const a=Lte(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),u=Ft().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const d=this.usedTextures[o],m=d&&d.indexOf(t);if(null==m||m<0)throw new Error("Cannot release a texture that was never provided by this texture manager");d[m]=d[d.length-1],d.pop(),this.log()}log(){if(!this.logEnabled)return;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${this.numFreeTextures+this.numUsedTextures})`);const e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Lte(n,t,e,r,i){const s=function kDe(n,t){switch(n){case Jo.PACKED_2X2_FLOAT32:return DW(t);case Jo.PACKED_2X2_FLOAT16:return MW(t);case Jo.UNPACKED_FLOAT32:return TW(t);case Jo.UNPACKED_FLOAT16:return AW(t);case Jo.PACKED_4X1_UNSIGNED_BYTE:return IW(t);default:throw new Error(`Unknown physical texture type ${n}`)}}(t,r);let o;if(i){const[u,d]=sb(n[0],n[1]);o=u*d}else{const[u,d]=NE(n[0],n[1]);o=u*d}const a=function MDe(n,t){if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===n.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(e,s);return o*a}function $te(n,t){if(n===Xu.UPLOAD)return Jo.PACKED_2X2_FLOAT32;if(n===Xu.RENDER||null==n)return function RDe(n){return Ft().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Jo.PACKED_2X2_FLOAT32:Jo.UNPACKED_FLOAT32:n?Jo.PACKED_2X2_FLOAT16:Jo.UNPACKED_FLOAT16}(t);if(n===Xu.DOWNLOAD||n===Xu.PIXELS)return Jo.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function Bte(n,t,e){return`${n[0]}_${n[1]}_${t}_${e}`}class Xh{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const Vte="return abs(x);",am="return x;";class um{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class WDe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length);const e=t.length,r=Ya("rc",e),i=Ki(e),s=function TDe(n,t){if(1===n)return"rc";let e="";for(let r=0;r<n;r++)e+=t[r],r<n-1&&(e+=",");return e}(e,r),o=r.slice(-2),a=e<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`\n      void main() {\n        ${i} rc = getOutputCoords();\n        vec4 packedInput = getA(${s});\n\n        setOutput(getChannel(packedInput, ${a}));\n      }\n    `}}const GDe=rO,mF={},KDe=Ft().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");let zte=(()=>{class n extends Zk{nextDataId(){return n.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Ft().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let r;if(null!=e){if(e instanceof pF)r=e;else{const i=ih(Ft().getNumber("WEBGL_VERSION"),e);r=new pF(i)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const i=ih(Ft().getNumber("WEBGL_VERSION"));r=new pF(i),this.binaryCache=function ZDe(n){return n in mF||(mF[n]={}),mF[n]}(Ft().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=r,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new DDe(this.gpgpu),this.numMBBeforeWarning=function YDe(){return null==Ft().global.screen?1024:Ft().global.screen.height*Ft().global.screen.width*window.devicePixelRatio*600/1024/1024}(),this.texData=new K4(this,jc())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,r,i,s,o,a){const u=this.makeTensorInfo(r,i),d=this.texData.get(u.dataId);d.isPacked=!1,d.texture={texture:e,texShape:[s,o]},d.texShape=[s,o];const m=IE(r),y=new mte(m,!1,a),_=this.runWebGLProgram(y,[u],i,[[s,o]]);return _.shape=r,d.texture=null,this.disposeIntermediateTensorInfo(u),_.dataId}write(e,r,i){if((Ft().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Ft().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===i&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:r,dtype:i,values:e,usage:Xu.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){this.texData.has(e)&&this.texData.get(e).refCount--}move(e,r,i,s,o){if(Ft().getBool("DEBUG")&&this.checkNumericalProblems(r),"complex64"===s)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:i,dtype:s,values:r,usage:Xu.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const r=this.texData.get(e),{values:i,dtype:s,complexTensorInfos:o,slice:a,shape:u,isPacked:d}=r;if(null!=a){let E;E=d?new um(u,am):new Xh(u,am);const D=this.runWebGLProgram(E,[{dataId:e,shape:u,dtype:s}],s),O=this.readSync(D.dataId);return this.disposeIntermediateTensorInfo(D),O}if(null!=i)return this.convertAndCacheOnCPU(e);if("string"===s)return i;const m=null!=this.activeTimers;let y,_;return m&&(y=aa()),_="complex64"===s?ld(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.getValuesFromTexture(e),m&&(this.downloadWaitMs+=aa()-y),this.convertAndCacheOnCPU(e,_)}read(e){var r=this;return(0,Nt.Z)(function*(){if(r.pendingRead.has(e)){const R=r.pendingRead.get(e);return new Promise($=>R.push($))}const i=r.texData.get(e),{values:s,shape:o,slice:a,dtype:u,complexTensorInfos:d,isPacked:m}=i;if(null!=a){let R;R=m?new um(o,am):new Xh(o,am);const $=r.runWebGLProgram(R,[{dataId:e,shape:o,dtype:u}],u),B=r.read($.dataId);return r.disposeIntermediateTensorInfo($),B}if(null!=s)return r.convertAndCacheOnCPU(e);if(Ft().getBool("DEBUG")&&!Ft().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Ft().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let _,E,y=null;if("complex64"!==u&&Ft().get("WEBGL_BUFFER_SUPPORTED")){_=r.decode(e);const R=r.texData.get(_.dataId);y=r.gpgpu.createBufferFromTexture(R.texture.texture,...oF(o))}if(r.pendingRead.set(e,[]),"complex64"!==u&&(yield r.gpgpu.createAndWaitForFence()),"complex64"===u){const R=yield Promise.all([r.read(d.real.dataId),r.read(d.imag.dataId)]);E=ld(R[0],R[1])}else if(null==y)E=r.getValuesFromTexture(e);else{const R=Xt(o);E=r.gpgpu.downloadFloat32MatrixFromBuffer(y,R)}if(null!=_&&r.disposeIntermediateTensorInfo(_),null!=y){const R=r.gpgpu.gl;Ln(R,()=>R.deleteBuffer(y))}const D=r.convertAndCacheOnCPU(e,E),O=r.pendingRead.get(e);return r.pendingRead.delete(e),O.forEach(R=>R(D)),r.pendingDisposal.has(e)&&(r.pendingDisposal.delete(e),r.disposeData(e)&&jc().removeDataId(e,r),r.pendingDeletes--),D})()}readToGPU(e,r={}){const i=this.texData.get(e),{values:s,shape:o,slice:a,dtype:u,isPacked:d,texture:m}=i;if("complex64"===u)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=a){let D;D=d?new um(o,am):new Xh(o,am);const O=this.runWebGLProgram(D,[{dataId:e,shape:o,dtype:u}],u),R=this.readToGPU(O,r);return this.disposeIntermediateTensorInfo(O),R}if(null==m)throw null!=s?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const y=this.decode(e,r.customTexShape),_=jc().makeTensorFromTensorInfo(y),E=this.texData.get(y.dataId);return Object.assign({tensorRef:_},E.texture)}bufferSync(e){const r=this.readSync(e.dataId);if("string"===e.dtype)try{const i=r.map(s=>Qf(s));return Zr(e.shape,e.dtype,i)}catch(i){throw new Error("Failed to decode encoded string bytes into utf-8")}return Zr(e.shape,e.dtype,r)}checkNumericalProblems(e){if(null!=e)for(let r=0;r<e.length;r++){const i=e[r];if(!Bee(i))throw Ft().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${i} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${i} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:r,dtype:i,isPacked:s}=this.texData.get(e),o=Xt(r);if(Ft().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const E=this.decode(e),D=this.texData.get(E.dataId),O=this.gpgpu.downloadMatrixFromPackedTexture(D.texture.texture,...oF(r)).subarray(0,o);return this.disposeIntermediateTensorInfo(E),O}const a=Ft().getBool("WEBGL_PACK")&&!0===s,u=a?IE(r):r,d=a?new RIe(u):new kIe(u),m=this.runWebGLProgram(d,[{shape:u,dtype:i,dataId:e}],"float32"),y=this.texData.get(m.dataId),_=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(y.texture.texture,y.texShape[0],y.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(m),_}timerAvailable(){return Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){var r=this;const i=this.activeTimers,s=[];let o=!1;null==this.programTimersStack?(this.programTimersStack=s,o=!0):this.activeTimers.push(s),this.activeTimers=s,e();const a=Lh(this.activeTimers.map(m=>m.query)).filter(m=>null!=m),u=Lh(this.activeTimers.map(m=>m.name)).filter(m=>null!=m);this.activeTimers=i,o&&(this.programTimersStack=null);const d={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(0,Nt.Z)(function*(){if(Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const m=yield Promise.all(a);d.kernelMs=y7(m),d.getExtraProfileInfo=()=>m.map((y,_)=>({name:u[_],ms:y})).map(y=>`${y.name}: ${y.ms}`).join(", ")}else d.kernelMs={error:"WebGL query timers are not supported in this environment."};return r.uploadWaitMs=0,r.downloadWaitMs=0,d})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:aa(),endMs:null}}endTimer(e){return Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=aa(),e)}getQueryTime(e){var r=this;return(0,Nt.Z)(function*(){return Ft().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?r.gpgpu.waitForQueryAndGetTime(e):e.endMs-e.startMs})()}disposeData(e,r=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(r?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!r&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:i}=this.texData.get(e);return null!=i&&(this.disposeData(i.real.dataId,r),this.disposeData(i.imag.dataId,r)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:r,dtype:i,texShape:s,usage:o,isPacked:a,slice:u}=this.texData.get(e),d=u&&u.origDataId||e,m=this.dataRefCount.get(d);m>1?this.dataRefCount.set(d,m-1):(this.dataRefCount.delete(d),null!=r&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(r,s,o,a)));const y=this.texData.get(e);y.texture=null,y.texShape=null,y.isPacked=!1,y.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,r=KDe){return Ft().getBool("WEBGL_CPU_FORWARD")&&e.every(i=>null==this.texData.get(i.dataId).texture&&Xt(i.shape)<r)}getGPGPUContext(){return this.gpgpu}where(e){_l("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const r=e.dataSync();return GDe(e.shape,r)}packedUnaryOp(e,r,i){const s=new um(e.shape,r),o=this.compileAndRun(s,[e],i);return jc().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const s=Rte(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(Ft().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Vte,e.dtype);const r=new Xh(e.shape,Vte),i=this.compileAndRun(r,[e]);return jc().makeTensorFromTensorInfo(i)}makeTensorInfo(e,r,i){let s;if("string"===r&&null!=i&&i.length>0&&Fh(i[0])){const o=i.map(a=>Ph(a));s=this.write(o,e,r)}else s=this.write(i,e,r);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:r}}makeOutput(e,r,i){return jc().makeTensorFromTensorInfo(this.makeTensorInfo(e,r,i),this)}unpackTensor(e){const r=new WDe(e.shape);return this.runWebGLProgram(r,[e],e.dtype)}packTensor(e){const r=new ADe(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)}packedReshape(e,r){const i=[Ev(e.shape),...Nv(e.shape)],s={dtype:e.dtype,shape:i,dataId:e.dataId},o=[Ev(r),...Nv(r)],a=new Pte(o,i),m=this.runWebGLProgram(a,[s],e.dtype,[i],!0);return{dataId:m.dataId,shape:r,dtype:m.dtype}}decode(e,r){const i=this.texData.get(e),{isPacked:s,shape:o,dtype:a}=i;null!=r&&De(Xt(o)<=r[0]*r[1]*4,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.");const u=IE(o);let d;d=s?new MIe(u):new DIe(u);const y=[null!=r?r:oF(u)];return{dtype:a,shape:o,dataId:this.runWebGLProgram(d,[{shape:u,dtype:a,dataId:e}],a,y,!0,r).dataId}}runWebGLProgram(e,r,i,s,o=!1,a){const u=this.makeTensorInfo(e.outputShape,i),d=this.texData.get(u.dataId);if(e.packedOutput&&(d.isPacked=!0),e.outPackingScheme===ib.DENSE){const B=null!=a?a:oF(e.outputShape);d.texShape=B.map(Q=>2*Q)}if(null!=e.outTexUsage&&(d.usage=e.outTexUsage),0===Xt(u.shape))return d.values=Wo(u.dtype,0),u;const m=[],y=r.map(B=>{if("complex64"===B.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let Q=this.texData.get(B.dataId);if(null==Q.texture){if(!e.packedInputs&&Xt(B.shape)<=Ft().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:B.shape,texData:null,isUniform:!0,uniformValues:Q.values};e.packedInputs&&(Q.isPacked=!0,Q.shape=B.shape)}if(this.uploadToGPU(B.dataId),!!Q.isPacked!=!!e.packedInputs)B=Q.isPacked?this.unpackTensor(B):this.packTensor(B),m.push(B),Q=this.texData.get(B.dataId);else if(Q.isPacked&&!DE(Q.shape,B.shape)){const ie=B,ye=B.shape;B.shape=Q.shape,B=this.packedReshape(B,ye),m.push(B),Q=this.texData.get(B.dataId),ie.shape=ye}return{shape:B.shape,texData:Q,isUniform:!1}});this.uploadToGPU(u.dataId);const _={shape:u.shape,texData:d,isUniform:!1},E=function IIe(n,t,e){let r="";t.concat(e).forEach(o=>{const a=null!=o.texData&&null!=o.texData.slice&&o.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!o.isUniform){const u=o.texData.texShape,{useSqueezeShape:d,uniformShape:m,keptDims:y}=NW(n.packedInputs,o.shape,u);let _="",E="",D="";if(1===m.length&&n.packedInputs){const ye=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];_=`${ye[0]>1}_${ye[1]>1}`}else if(2!==m.length||n.packedInputs){if(m.length>2&&!n.packedInputs){const ye=ur(m);D=`${ye[0]===u[1]}_${ye[ye.length-1]===u[1]}`}}else E=`${m[0]>1}_${m[1]>1}`;const O=o.shape.length,R=2===m.length&&ri(o.shape,u),$=1===Xt(o.shape),B=tv(o.shape,e.shape),Q=!n.packedInputs&&O===e.shape.length&&ri(u,e.texData.texShape);r+=`${O}_${Q}_${d?y:""}_${m.length}_${$}_${B}_${R}_${_}_${E}_${D}_${n.packedInputs||m.length>2?"":`${u[0]>1}_${u[1]>1}`}_${a}`}else r+=`${o.shape}_${o.isUniform?"uniform":o.texData.texShape}_${a}`});let s=n.constructor.name;return s+="_"+r+"_"+n.userCode+`${Ft().getNumber("WEBGL_VERSION")}`,s}(e,y,_),D=this.getAndSaveBinary(E,()=>function TIe(n,t,e,r){const i=e.map((m,y)=>{const _={logicalShape:m.shape,texShape:m.isUniform?null:m.texData.texShape,isUniform:m.isUniform,isPacked:!m.isUniform&&m.texData.isPacked,flatOffset:null};return null!=m.texData&&null!=m.texData.slice&&m.texData.slice.flatOffset>0&&(_.flatOffset=m.texData.slice.flatOffset),{name:t.variableNames[y],shapeInfo:_}}),s=i.map(m=>m.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=GAe(i,o,t),u=Uee(n.gl,a),d=n.createProgram(u);return Ft().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:a,webGLProgram:d,inShapeInfos:s,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:u,source:a,webGLProgram:d,inShapeInfos:s,outShapeInfo:o},dte(n,t,d))}(this.gpgpu,e,y,_)),O=null!=this.activeTimers;let R;O&&(R=this.startTimer()),Ft().get("ENGINE_COMPILE_ONLY")||function AIe(n,t,e,r,i){t.program.enableShapeUniforms||(pte(t.inShapeInfos,e),pte([t.outShapeInfo],[r]));const s=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(s.texture,o[0],o[1]):n.setOutputMatrixTexture(s.texture,o[0],o[1]),n.setProgram(t.webGLProgram),1===Ft().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&n.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&n.gl.uniform1f(t.nanLoc,NaN);for(let u=0;u<e.length;++u){const d=e[u],{uniform:m,offset:y,shape:_,texShape:E}=t.variablesLocations[u];if(_){const{uniformShape:D}=NW(t.program.packedInputs,d.shape,d.texData.texShape);switch(D.length){case 1:n.gl.uniform1iv(_,new Int32Array(D));break;case 2:n.gl.uniform2iv(_,new Int32Array(D));break;case 3:n.gl.uniform3iv(_,new Int32Array(D));break;case 4:n.gl.uniform4iv(_,new Int32Array(D))}}if(E&&n.gl.uniform2i(E,d.texData.texShape[0],d.texData.texShape[1]),null!=m){if(d.isUniform){if(Xt(d.shape)<2)n.gl.uniform1f(m,d.uniformValues[0]);else{let D=d.uniformValues;D instanceof Float32Array||(D=new Float32Array(D)),n.gl.uniform1fv(m,D)}continue}null!=d.texData.slice&&null!=y&&n.gl.uniform1i(y,d.texData.slice.flatOffset),n.setInputMatrixTexture(d.texData.texture.texture,m,u)}}const a=t.outShapeLocation;if(a)switch(r.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const u=ur(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(u));break;case 3:n.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(u));break;case 4:n.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(u))}}if(t.outTexShapeLocation&&n.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let u=0;u<t.program.customUniforms.length;++u){const d=t.program.customUniforms[u],m=t.customUniformLocations[u],y=i[u];if("float"===d.type)n.gl.uniform1fv(m,y);else if("vec2"===d.type)n.gl.uniform2fv(m,y);else if("vec3"===d.type)n.gl.uniform3fv(m,y);else if("vec4"===d.type)n.gl.uniform4fv(m,y);else if("int"===d.type)n.gl.uniform1iv(m,y);else if("ivec2"===d.type)n.gl.uniform2iv(m,y);else if("ivec3"===d.type)n.gl.uniform3iv(m,y);else{if("ivec4"!==d.type)throw Error(`uniform type ${d.type} is not supported yet.`);n.gl.uniform4iv(m,y)}}n.executeProgram()}(this.gpgpu,D,y,_,s),m.forEach(B=>this.disposeIntermediateTensorInfo(B)),O&&(R=this.endTimer(R),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(R)}));const $=Ft().get("WEBGL_FLUSH_THRESHOLD");if($>0){const B=aa();B-this.lastGlFlushTime>$&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=B)}if(!Ft().getBool("WEBGL_LAZILY_UNPACK")&&d.isPacked&&!1===o){const B=this.unpackTensor(u);return this.disposeIntermediateTensorInfo(u),B}return u}compileAndRun(e,r,i,s,o=!1){return this.runWebGLProgram(e,r,i=i||r[0].dtype,s,o)}getAndSaveBinary(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Ft().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(r=>{this.gpgpu.deleteProgram(this.binaryCache[r].webGLProgram),delete this.binaryCache[r]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ot(()=>{if(!Ft().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Ft().getBool("DEBUG");Ft().set("DEBUG",!1);const r=this.abs(hr(1e-8)).dataSync()[0];if(Ft().set("DEBUG",e),r>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const r=this.texData.get(e),{shape:i,dtype:s,values:o,texture:a,usage:u,isPacked:d}=r;if(null!=a)return;const m=null!=this.activeTimers;let y;m&&(y=aa());let _=r.texShape;if(null==_&&(_=nte(i,d),r.texShape=_),null!=o){const E=IE(i);let D,O=_[1],R=_[0];const $=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(d||!$)&&([O,R]=sb(_[0],_[1])),D=d?new FIe(E,$):new mte(E,$);const B=$?[R,O]:_,Q=this.makeTensorInfo(B,s),ie=this.texData.get(Q.dataId);ie.usage=$?Xu.PIXELS:Xu.UPLOAD,ie.texShape=B,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(Q.dataId),O,R,o);const Be=this.runWebGLProgram(D,[Q],s,[[R,O]],!0),He=this.texData.get(Be.dataId);r.texShape=He.texShape,r.isPacked=He.isPacked,r.usage=He.usage,Ft().get("ENGINE_COMPILE_ONLY")?this.disposeData(Be.dataId):(r.texture=He.texture,r.values=null,this.texData.delete(Be.dataId)),this.disposeIntermediateTensorInfo(Q),m&&(this.uploadWaitMs+=aa()-y)}else{const E=this.acquireTexture(_,u,s,d);r.texture=E}}convertAndCacheOnCPU(e,r){const i=this.texData.get(e),{dtype:s}=i;return null!=r&&(i.values=function QDe(n,t){if("float32"===t||"complex64"===t)return n;if("int32"===t||"bool"===t){const e="int32"===t?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<e.length;++r)e[r]=Math.round(n[r]);return e}throw new Error(`Unknown dtype ${t}`)}(r,s)),i.values}acquireTexture(e,r,i,s){if(this.numBytesInGPU+=this.computeBytes(e,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,r,s)}computeBytes(e,r){return e[0]*e[1]*wC(r)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}checkCompileCompletionAsync(){var e=this;return(0,Nt.Z)(function*(){const r=[];if(e.gpgpu.parallelCompilationExtension){for(const[,i]of Object.entries(e.binaryCache))r.push(e.checkCompletionAsync_(i));return Promise.all(r)}for(const[,i]of Object.entries(e.binaryCache)){const s=new Promise(o=>{try{e.checkCompletion_(i),o(!0)}catch(a){throw a}});r.push(s)}return Promise.all(r)})()}checkCompletionAsync_(e){var r=this;return(0,Nt.Z)(function*(){return r.gpgpu.gl.getProgramParameter(e.webGLProgram,r.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?r.checkCompletion_(e):(yield vH(),r.checkCompletionAsync_(e))})()}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS))throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)?(_W(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){const{variablesLocations:r,customUniformLocations:i,infLoc:s,nanLoc:o,outShapeLocation:a,outShapeStridesLocation:u,outTexShapeLocation:d}=dte(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=r,e.customUniformLocations=i,e.infLoc=s,e.nanLoc=o,e.outShapeLocation=a,e.outShapeStridesLocation=u,e.outTexShapeLocation=d}}createTensorFromGPUData(e,r,i){e.channels=e.channels||"RGBA";const{texture:s,height:o,width:a,channels:u}=e,d=jc().backend;if(!d.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const m=d.writeTexture(s,r,i,o,a,u);return jc().makeTensorFromDataId(m,r,i,d)}}return n.nextDataId=0,n})();const Ute="4.4.0";function Hte(){Ft().set("WEBGL_FORCE_F16_TEXTURES",!0)}hU()&&kU("webgl",()=>new zte,2);const JDe={forceHalfFloat:Hte};class hb{constructor(t,e,r){this.variableNames=["A","B"],this.outputShape=Fr(e,r),this.enableShapeUniforms=Oa(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const Iv="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class kE{constructor(t,e,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Fr(e,r);const s=this.outputShape.length;this.enableShapeUniforms=Oa(s);let o="";if(i)if(0===s||1===Xt(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o=`\n          ${Ki(s)} coords = getOutputCoords();\n        `,1===s)o+=this.enableShapeUniforms?"\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const u=Ya("coords",s);o+=this.enableShapeUniforms?`\n            bool nextRowOutOfBounds =\n              (${u[s-2]} + 1) >= outShape[${s} - 2];\n            bool nextColOutOfBounds =\n              (${u[s-1]} + 1) >= outShape[${s} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:`\n            bool nextRowOutOfBounds =\n              (${u[s-2]} + 1) >= ${this.outputShape[s-2]};\n            bool nextColOutOfBounds =\n              (${u[s-1]} + 1) >= ${this.outputShape[s-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}function Yu(n){const{inputs:t,backend:e}=n,{x:r}=t;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const eMe={kernelName:Y_,backendName:"webgl",kernelFunc:Yu};function lm(n){const{inputs:t,backend:e}=n,{real:r,imag:i}=t,s=e.makeTensorInfo(r.shape,"complex64"),o=e.texData.get(s.dataId),a=Yu({inputs:{x:r},backend:e}),u=Yu({inputs:{x:i},backend:e});return o.complexTensorInfos={real:a,imag:u},s}const tMe={kernelName:a2,backendName:"webgl",kernelFunc:lm},Wte="return (a < 0.) ? b * a : a;",Gte="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",rMe={kernelName:HC,backendName:"webgl",kernelFunc:function nMe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{alpha:s}=r,o=e.makeTensorInfo([],"float32",Yf(s,"float32")),a=Ft().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new kE(Gte,i.shape,o.shape):new hb(Wte,i.shape,o.shape),u=e.runWebGLProgram(a,[i,o],"float32");return e.disposeIntermediateTensorInfo(o),u}},jte="return (a < 0.) ? b * a : a;",qte="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",sMe={kernelName:uS,backendName:"webgl",kernelFunc:function iMe(n){const{inputs:t,backend:e}=n,{x:r,alpha:i}=t,s=Ft().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new kE(qte,r.shape,i.shape):new hb(jte,r.shape,i.shape);return e.runWebGLProgram(s,[r,i],"float32")}};function _i({opSnippet:n,packedOpSnippet:t,cpuKernelImpl:e,dtype:r}){return({inputs:i,backend:s})=>{const{x:o}=i,a=s,u=r||o.dtype;if(a.shouldExecuteOnCPU([o])&&null!=e){const y=a.texData.get(o.dataId),_=e(y.values,u);return a.makeTensorInfo(o.shape,u,_)}let m;return m=Ft().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new um(o.shape,t):new Xh(o.shape,n),a.runWebGLProgram(m,[o],u)}}function fa({opSnippet:n,packedOpSnippet:t,checkOutOfBounds:e=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}){return({inputs:o,backend:a})=>{const{a:u,b:d}=o,m=a;if(r&&"complex64"===u.dtype){const D=m.texData.get(u.dataId),O=m.texData.get(d.dataId),[R,$]=[[D.complexTensorInfos.real,O.complexTensorInfos.real],[D.complexTensorInfos.imag,O.complexTensorInfos.imag]].map(Q=>{const[ie,ye]=Q,Me={dataId:ie.dataId,dtype:ie.dtype,shape:u.shape},Be={dataId:ye.dataId,dtype:ye.dtype,shape:d.shape},He=new hb(n,u.shape,d.shape);return m.runWebGLProgram(He,[Me,Be],pu(ie.dtype,ye.dtype))}),B=lm({inputs:{real:R,imag:$},backend:m});return m.disposeIntermediateTensorInfo(R),m.disposeIntermediateTensorInfo($),B}const y=s||pu(u.dtype,d.dtype);if(("string"===u.dtype||"string"===d.dtype||m.shouldExecuteOnCPU([u,d]))&&null!=i){const D=m.texData.get(u.dataId).values,O=m.texData.get(d.dataId).values,R="string"===u.dtype?cd(D):D,$="string"===u.dtype?cd(O):O,[B,Q]=i(u.shape,d.shape,R,$,y),ie=m.makeTensorInfo(Q,y);return m.texData.get(ie.dataId).values=B,ie}let E;return E=Ft().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new kE(t,u.shape,d.shape,e):new hb(n,u.shape,d.shape),m.runWebGLProgram(E,[u,d],y)}}function RE(n,t=!1){if("linear"===n)return"return x;";if("relu"===n)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===n)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===n)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n";if("prelu"===n)return t?qte:jte;if("leakyrelu"===n)return t?Gte:Wte;if("sigmoid"===n)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}class Zte{constructor(t,e,r,i=!1,s=!1,o=!1,a=null,u=!1,d=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Oa(this.outputShape.length);const y=Math.ceil((i?t[1]:t[2])/2),_=i?"i * 2, rc.y":"rc.y, i * 2",E=s?"rc.z, i * 2":"i * 2, rc.z",D=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],O=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let R="",$="";a&&(R=u?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${a}\n        }`:d?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${a}\n        }`:`vec4 activation(vec4 x) {\n          ${a}\n        }`,$="result = activation(result);");const B=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),d&&this.variableNames.push("leakyreluAlpha");let Q="rc.x",ie="rc.x";t[0]<e[0]?Q=`imod(rc.x, ${t[0]})`:e[0]<t[0]&&(ie=`imod(rc.x, ${e[0]})`),this.userCode=`\n      ${R}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${y}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ${Q};\n        int batchB = ${ie};\n        for (int i = 0; i < ${y}; i++) {\n          vec4 a = getMatrixA(batchA, ${_});\n          vec4 b = getMatrixB(batchB, ${E});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${D[0]} * ${O[0]});\n          result += (${D[1]} * ${O[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${B}\n\n        ${$}\n\n        setOutput(result);\n      }\n    `}}class Xte{constructor(t,e,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Fr(e,r),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const Yte="return a * b;";function OW(n){const{inputs:t,backend:e}=n,{a:r,b:i}=t,s=pu(r.dtype,i.dtype);if("complex64"===r.dtype){const a=e.texData.get(r.dataId),u=e.texData.get(i.dataId),d=new Xte("return areal * breal - aimag * bimag;",r.shape,i.shape),m=new Xte("return areal * bimag + aimag * breal;",r.shape,i.shape),y=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],_=e.runWebGLProgram(d,y,"float32"),E=e.runWebGLProgram(m,y,"float32"),D=lm({inputs:{real:_,imag:E},backend:e});return e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(E),D}if(e.shouldExecuteOnCPU([r,i])){const a=e.texData.get(r.dataId),u=e.texData.get(i.dataId),[d,m]=rDe(r.shape,i.shape,a.values,u.values,s),y=e.makeTensorInfo(m,s);return e.texData.get(y.dataId).values=d,y}let o;return o=Ft().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new kE(Yte,r.shape,i.shape):new hb(Yte,r.shape,i.shape),e.runWebGLProgram(o,[r,i],s)}const oMe={kernelName:a0,backendName:"webgl",kernelFunc:OW};function Pn(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{shape:s}=r,o=e,a=Xt(i.shape),u=Q4(s,a),d=Xt(u);De(a===d,()=>`The new shape (${u}) has ${d} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const m=o.texData.get(i.dataId);return!m.isPacked||DE(i.shape,u)||null!==m.texture&&DE(m.shape,u)?(o.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype}):function aMe(n,t,e){const r=[Ev(n.shape),...Nv(n.shape)],i={dtype:n.dtype,shape:r,dataId:n.dataId},s=[Ev(t),...Nv(t)],o=new Pte(s,r),d=e.runWebGLProgram(o,[i],n.dtype,[r],!0);return{dataId:d.dataId,shape:t,dtype:d.dtype}}(i,u,o)}const uMe={kernelName:cS,backendName:"webgl",kernelFunc:Pn};class Qte{constructor(t,e){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];const a=4*Math.floor(r/4),u=r%4;let d="sumValue += dot(values, ones);";if(null!=e){const y=1/e;d=`sumValue += dot(values * ${Hg(y)?y.toPrecision(2):y}, ones);`}let m="";s%r>0&&(m=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${m}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${a}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${d}\n        }\n\n        int inIdx = inOffset + ${a};\n        if (${1===u}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${d}\n        } else if (${2===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${d}\n        } else if (${3===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${d}\n        }\n        setOutput(sumValue);\n      }\n    `}}class lMe{constructor(t,e){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:o}=t;this.outputShape=[i,o];let a="0.0",u="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",u="min"):"max"===e&&(a="-1.0 / 1e-20",u="max");let d=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?d="sumValue":"prod"===e?d="prodValue":"all"===e?d="allValue":"any"===e&&(d="anyValue");const m=4*Math.floor(r/4),y=r%4;let _=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${u}(values, minMaxValue);\n        if (${"min"===e} || ${"max"===e}) {\n          minMaxValue = ${u}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,E="vec4";"all"===e?(a="1.0",_="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",E="bvec4"):"any"===e&&(a="0.0",_="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",E="bvec4");let D="";s%r>0&&(D=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${a};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${D}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        vec4 minMaxValue = vec4(${a});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${m}; i += 4) {\n          int inIdx = inOffset + i;\n          ${E} values = ${E}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${_}\n        }\n\n        int inIdx = inOffset + ${m};\n        if (${1===y}) {\n          ${E} values = ${E}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${_}\n        } else if (${2===y}) {\n          ${E} values = ${E}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${_}\n        } else if (${3===y}) {\n          ${E} values = ${E}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${_}\n        }\n        setOutput(${d});\n      }\n    `}}function Dv(n,t,e,r){const i=function cMe(n){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const e=t.length?t[t.length-1].outSize:n[1],r=fO(e);t.push({inSize:e,windowSize:r,outSize:Math.ceil(e/r)})}return t}(n.shape);let s=n;for(let o=0;o<i.length;o++){const{inSize:a,windowSize:u,outSize:d}=i[o];let m,y;m="mean"===e?0===o?new Qte({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:d},a):new Qte({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:d}):new lMe({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:d},e),y=s,s=r.runWebGLProgram(m,[s],t),y.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(y)}return s}class hMe{constructor(t,e){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[e[o]];this.outputShape=r,this.rank=r.length;const i=Ki(this.rank),s=function fMe(n){const t=n.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let i=0;i<n.length;i++)r[n[i]]=e[i];return r.join()}(e);this.userCode=`\n    void main() {\n      ${i} resRC = getOutputCoords();\n      setOutput(getA(${s}));\n    }\n    `}}class dMe{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(t.length);for(let m=0;m<r.length;m++)r[m]=t[e[m]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=Ki(this.rank),s=Fte("rc",this.rank),o=new Array(this.rank);for(let m=0;m<e.length;m++)o[e[m]]=s[m];const a=`vec2(${o.slice(-2).join()})`,u=`++${s[this.rank-1]} < ${r[this.rank-1]}`,d=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`\n    void main() {\n      ${i} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${d};\n      if(${u}) {\n        result[1] = ${d};\n      }\n      --${s[this.rank-1]};\n      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {\n        result[2] = ${d};\n        if(${u}) {\n          result[3] = ${d};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function gF(n,t,e){const r=Ft().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dMe(n.shape,t):new hMe(n.shape,t);return e.runWebGLProgram(r,[n],n.dtype)}function vF(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r;return function pMe(n,t,e,r){const s=n.shape.length,o=Yr(t,n.shape);let a=o;const u=ks(a,s),d=null!=u;let m=n;d&&(m=gF(n,u,r),a=to(a.length,s)),ca("sum",a,s);const[y,_]=Ko(m.shape,a);let E=y;e&&(E=eo(y,o));const D=Xt(_),$=Pn({inputs:{x:m},attrs:{shape:[Xt(n.shape)/D,D]},backend:r}),Q=Dv($,yR(n.dtype),"sum",r),ie=Pn({inputs:{x:Q},attrs:{shape:E},backend:r});return r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(Q),d&&r.disposeIntermediateTensorInfo(m),ie}(i,s,o,e)}const mMe={kernelName:gS,backendName:"webgl",kernelFunc:vF};function Qa(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{perm:s}=r,o=e,u=new Array(i.shape.length);for(let m=0;m<u.length;m++)u[m]=i.shape[s[m]];let d;if(o.shouldExecuteOnCPU([i])){const y=o.texData.get(i.dataId).values,_=kW(y,i.shape,i.dtype,s,u);d=o.makeTensorInfo(u,i.dtype),o.texData.get(d.dataId).values=_}else d=gF(i,s,o);return d}const gMe={kernelName:Zg,backendName:"webgl",kernelFunc:Qa};function yF({a:n,b:t,transposeA:e,transposeB:r,backend:i,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:u=null}){const d=n.shape.length,m=t.shape.length,y=e?n.shape[d-2]:n.shape[d-1],_=r?t.shape[m-1]:t.shape[m-2],E=e?n.shape[d-1]:n.shape[d-2],D=r?t.shape[m-2]:t.shape[m-1],O=n.shape.slice(0,-2),R=t.shape.slice(0,-2),$=Xt(O),B=Xt(R),ie=Fr(n.shape.slice(0,-2),t.shape.slice(0,-2)).concat([E,D]);De(y===_,()=>`Error in matMul: inner shapes (${y}) and (${_}) of Tensors with shapes ${n.shape} and ${t.shape} and transposeA=${e} and transposeB=${r} must match.`);const ye=e?[$,y,E]:[$,E,y],Me=r?[B,D,_]:[B,_,D],Be=Pn({inputs:{x:n},backend:i,attrs:{shape:ye}}),He=Pn({inputs:{x:t},backend:i,attrs:{shape:Me}}),st=[Be,He],lt=Math.max($,B),It=e?Be.shape[1]:Be.shape[2],zt=null!=s,Wt=null!=o,qt="leakyrelu"===u,Kt=null!=u?RE(u,!0):null;let Rt;if((1===E||1===D)&&It>1e3&&!1===(zt||Wt||qt||null!=Kt)){let Ht=Be,ln=He;e&&(Ht=Qa({inputs:{x:Be},backend:i,attrs:{perm:[0,2,1]}}),st.push(Ht)),r&&(ln=Qa({inputs:{x:He},backend:i,attrs:{perm:[0,2,1]}}),st.push(ln));const An=1===D;let Tn=Ht;1!==D&&(Tn=Pn({inputs:{x:Ht},backend:i,attrs:{shape:[lt,It,1]}}),st.push(Tn));const In=1===D?2:1;let kn=ln;An&&(kn=Pn({inputs:{x:ln},backend:i,attrs:{shape:[lt,1,It]}}),st.push(kn));const Hn=OW({inputs:{a:Tn,b:kn},backend:i});Rt=vF({inputs:{x:Hn},backend:i,attrs:{axis:In,keepDims:!0}}),st.push(Hn)}else{const Ht=pu(n.dtype,t.dtype),ln=new Zte(ye,Me,[lt,E,D],e,r,zt,Kt,Wt,qt),vn=[Be,He];if(null!=s&&vn.push(s),Wt&&vn.push(o),qt){const An=i.makeTensorInfo([],"float32",Yf(a,"float32"));vn.push(An),st.push(An)}Rt=i.runWebGLProgram(ln,vn,Ht)}const Dt=Pn({inputs:{x:Rt},backend:i,attrs:{shape:ie}});st.push(Rt);for(const Ht of st)i.disposeIntermediateTensorInfo(Ht);return Dt}const yMe={kernelName:SS,backendName:"webgl",kernelFunc:function vMe(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s,bias:o,preluActivationWeights:a}=t,{transposeA:u,transposeB:d,activation:m,leakyreluAlpha:y}=r;return yF({a:i,b:s,transposeA:u,transposeB:d,backend:e,bias:o,preluActivationWeights:a,leakyreluAlpha:y,activation:m})}},ene="return abs(x);",bMe={kernelName:xC,backendName:"webgl",kernelFunc:function _Me(n){const{inputs:t,backend:e}=n,{x:r}=t;if(e.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const s=e.texData.get(r.dataId),o=Rte(s.values);return e.makeTensorInfo(r.shape,r.dtype,o)}let i;return i=Ft().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new um(r.shape,ene):new Xh(r.shape,ene),e.runWebGLProgram(i,[r],r.dtype)}},xMe=_i({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),CMe={kernelName:M_,backendName:"webgl",kernelFunc:xMe},EMe=_i({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),NMe={kernelName:k_,backendName:"webgl",kernelFunc:EMe},tne="return a + b;",TMe=fa({opSnippet:tne,packedOpSnippet:tne,supportsComplex:!0,cpuKernelImpl:LIe}),AMe={kernelName:qg,backendName:"webgl",kernelFunc:TMe};class IMe{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        float result = ${i};\n        setOutput(result);\n      }\n    `}}class DMe{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        vec4 result = ${i};\n        setOutput(result);\n      }\n    `}}const MMe={kernelName:CC,backendName:"webgl",kernelFunc:function _F(n){const{inputs:t,backend:e}=n,r=t;if(1===r.length)return Yu({inputs:{x:r[0]},backend:e});if(r.length>Ft().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(r.length/2),d=_F({inputs:r.slice(0,u),backend:e}),m=_F({inputs:r.slice(u),backend:e});return _F({inputs:[d,m],backend:e})}const i=r.map(u=>u.dtype).reduce((u,d)=>pu(u,d)),s=r.map(u=>u.shape),a=Ft().getBool("WEBGL_PACK")?new DMe(r[0].shape,s):new IMe(r[0].shape,s);return e.runWebGLProgram(a,r,i)}},RMe={kernelName:e2,backendName:"webgl",kernelFunc:function kMe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=Yr(s,i.shape);let d=u;const m=ks(d,a);let y=i;null!=m&&(y=Qa({inputs:{x:i},backend:e,attrs:{perm:m}}),d=to(d.length,a)),ca("all",d,a);const[_,E]=Ko(y.shape,d),O=Pn({inputs:{x:y},backend:e,attrs:{shape:[-1,Xt(E)]}}),R=Dv(O,O.dtype,"all",e);let $;return $=Pn(o?{inputs:{x:R},backend:e,attrs:{shape:eo(_,u)}}:{inputs:{x:R},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(O),e.disposeIntermediateTensorInfo(R),null!=m&&e.disposeIntermediateTensorInfo(y),$}},FMe={kernelName:t2,backendName:"webgl",kernelFunc:function OMe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=Yr(s,i.shape);let d=u;const m=ks(d,a);let y=i;null!=m&&(y=Qa({inputs:{x:i},backend:e,attrs:{perm:m}}),d=to(d.length,a)),ca("any",d,a);const[_,E]=Ko(y.shape,d),O=Pn({inputs:{x:y},backend:e,attrs:{shape:[-1,Xt(E)]}}),R=Dv(O,O.dtype,"any",e);let $;return $=Pn(o?{inputs:{x:R},backend:e,attrs:{shape:eo(_,u)}}:{inputs:{x:R},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(O),e.disposeIntermediateTensorInfo(R),null!=m&&e.disposeIntermediateTensorInfo(y),$}};class PMe{constructor(t,e,r){this.variableNames=["A"];const{windowSize:i,batchSize:s,outSize:o}=t;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,o],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${i};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${i}; i++) {\n          int inIdx = ${r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${"max"===e?">":"<"} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class LMe{constructor(t,e,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,De(t.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");const a=this.outputShape,u=a.length,d=Ki(u),m=Ya("coords",u);let y,_;if(1===o){_=u+1;const He=Ki(_);y=`\n        ${He} sourceLocR = ${He}(${m.join()}, 0);\n        ++${m[u-1]};\n        ${He} sourceLocG = ${He}(${m.join()}, 0);\n        ++${m[u-2]};\n        ${He} sourceLocA = ${He}(${m.join()}, 0);\n        --${m[u-1]};\n        ${He} sourceLocB = ${He}(${m.join()}, 0);\n        --${m[u-2]};`}else _=u,y=`\n        ${d} sourceLocR = coords;\n        ++${m[u-1]};\n        ${d} sourceLocG = coords;\n        ++${m[u-2]};\n        ${d} sourceLocA = coords;\n        --${m[u-1]};\n        ${d} sourceLocB = coords;\n        --${m[u-2]};`;const E=["x","y","z","w","u","v"].slice(0,_),D="."+E[_-1],O=E.map(He=>"int "+He),R=Ya("sourceLocR",_-1).concat("inIdx.r"),$=Ya("sourceLocG",_-1).concat("inIdx.g"),B=Ya("sourceLocB",_-1).concat("inIdx.b"),Q=Ya("sourceLocA",_-1).concat("inIdx.a"),ie="max"===r?"greaterThan":"lessThan",ye=i?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${R.join()}),\n                             getBestIndicesAChannel(${$.join()}),\n                             getBestIndicesAChannel(${B.join()}),\n                             getBestIndicesAChannel(${Q.join()})));`,Me=`vec4(\n            getAChannel(${R.join()}),\n            hasNextCol ? getAChannel(${$.join()}) : 0.,\n            hasNextRow ? getAChannel(${B.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${Q.join()}) : 0.)`,Be=i?"":`\n      float getBestIndicesAChannel(${O.join()}) {\n        return getChannel(getBestIndicesA(${E.join()}),\n                                          vec2(${E.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${O.join()}) {\n        return getChannel(getA(${E.join()}),\n                               vec2(${E.slice(-2).join()}));\n      }\n      ${Be}\n      void main() {\n        ${d} coords = getOutputCoords();\n        bool hasNextCol = ${m[u-1]} < ${a[u-1]-1};\n        bool hasNextRow = ${m[u-2]} < ${a[u-2]-1};\n        ${y}\n        ivec4 srcIdx = ivec4(sourceLocR${D}, sourceLocG${D},\n          sourceLocB${D}, sourceLocA${D}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${Me};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${ye}\n          vec4 candidate = ${Me};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${ie}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function nne(n,t,e,r=null){let i=t.shape[0],s=t.shape[1];null!=r&&(i=r.shape[0],s=r.shape[1]);const o=fO(s),a={windowSize:o,inSize:s,batchSize:i,outSize:Math.ceil(s/o)},u=new PMe(a,e,null==r),d=[t];null!=r&&d.push(r);const m=n.runWebGLProgram(u,d,"int32");if(1===m.shape[1])return m;const y=nne(n,t,e,m);return n.disposeIntermediateTensorInfo(m),y}function rne(n,t,e,r=null){const i=null!=r?r.shape:t.shape,o=fO(i[i.length-1]),a=new LMe(i,o,e,null==r),d=n.runWebGLProgram(a,null==r?[t]:[t,r],"int32");if(d.shape.length===t.shape.length){const m=rne(n,t,e,d);return n.disposeIntermediateTensorInfo(d),m}return d}function ine(n,t,e,r){const i=[e];if(ca("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!Ft().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const s=[],o=n.texData.get(t.dataId);let u=t;null!==o&&o.isPacked&&(u=n.unpackTensor(t),s.push(u));const[d,m]=Ko(u.shape,i),y=Xt(m),_=Pn({inputs:{x:u},backend:n,attrs:{shape:[-1,y]}});s.push(_);const E=nne(n,_,r);s.push(E);const D=Pn({inputs:{x:E},backend:n,attrs:{shape:d}});return s.forEach(O=>n.disposeIntermediateTensorInfo(O)),D}return rne(n,t,r)}const BMe={kernelName:SC,backendName:"webgl",kernelFunc:function $Me(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;let o=Yr(s,i.shape);const a=ks(o,i.shape.length);let u=i;const d=[];null!=a&&(u=Qa({inputs:{x:i},backend:e,attrs:{perm:a}}),d.push(u),o=to(o.length,u.shape.length)),ca("argMax",[o[0]],u.shape.length);const m=ine(e,u,o[0],"max");return d.forEach(y=>e.disposeIntermediateTensorInfo(y)),m}},zMe={kernelName:EC,backendName:"webgl",kernelFunc:function VMe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s}=r;let o=Yr(s,i.shape);const a=ks(o,i.shape.length);let u=i;const d=[];null!=a&&(u=Qa({inputs:{x:i},backend:e,attrs:{perm:a}}),d.push(u),o=to(o.length,u.shape.length)),ca("argMin",[o[0]],u.shape.length);const m=ine(e,u,o[0],"min");return d.forEach(y=>e.disposeIntermediateTensorInfo(y)),m}},HMe=_i({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),WMe={kernelName:R_,backendName:"webgl",kernelFunc:HMe},jMe=_i({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),qMe={kernelName:O_,backendName:"webgl",kernelFunc:jMe},KMe=_i({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),XMe={kernelName:F_,backendName:"webgl",kernelFunc:KMe},JMe=fa({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),eke={kernelName:L_,backendName:"webgl",kernelFunc:JMe},nke=_i({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),rke={kernelName:P_,backendName:"webgl",kernelFunc:nke};class OE{constructor(t,e,r,i=!1,s=!1){if(this.variableNames=["x"],"avg"===e&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideHeight,u=t.strideWidth,d=t.dilationHeight,m=t.dilationWidth,y=t.effectiveFilterHeight,_=t.effectiveFilterWidth,E=t.padInfo.top,D=t.padInfo.left;this.outputShape=t.outShape;const O="avg"===e;let B="0.0";if(O||(B="-1.0 / 1e-20"),r)return void(this.userCode=`\n        const ivec2 strides = ivec2(${a}, ${u});\n        const ivec2 pads = ivec2(${E}, ${D});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${y};\n              wR += ${d}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${_};\n                wC += ${m}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${i?s?`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`:`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`:`wR * ${_} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let ie=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(ie="avgValue / max(count, 1.0)");const ye=4*Math.floor(o/4),Me=o%4,Be=`\n      if (${O}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${a}, ${u});\n      const ivec2 pads = ivec2(${E}, ${D});\n      const float initializationValue = ${B};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${B});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${y};\n            wR += ${d}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${ye}; wC += 4) {\n            int xC = xCCorner + wC * ${m};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${m}, d),\n              getValue(batch, xR, xC + 2 * ${m}, d),\n              getValue(batch, xR, xC + 3 * ${m}, d)\n            );\n\n            ${Be}\n          }\n\n          int xC = xCCorner + ${ye};\n          if (${1===Me}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${Be}\n          } else if (${2===Me}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${m}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${Be}\n          } else if (${3===Me}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${m}, d),\n              getValue(batch, xR, xC + 2 * ${m}, d),\n              initializationValue\n            );\n\n            ${Be}\n          }\n        }\n        setOutput(${ie});\n      }\n    `}}class FW{constructor(t,e,r,i=!1,s=!1){if(this.variableNames=["x"],"avg"===e&&r)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,a=t.strideDepth,u=t.strideHeight,d=t.strideWidth,m=t.dilationDepth,y=t.dilationHeight,_=t.dilationWidth,E=t.effectiveFilterDepth,D=t.effectiveFilterHeight,O=t.effectiveFilterWidth,R=t.padInfo.front,$=t.padInfo.top,B=t.padInfo.left;this.outputShape=t.outShape;const Q="avg"===e;let ie="0.0";if(Q||(ie="-1.0 / 1e-20"),r)return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${a}, ${u}, ${d});\n        const ivec3 pads = ivec3(${R}, ${$}, ${B});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${E};\n              wD += ${m}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${D};\n                wR += ${y}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${O};\n                  wC += ${_}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${i?s?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${D} * ${O} +\n                      wR * ${O} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let Me=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(Me="avgValue / max(count, 1.0)");const Be=4*Math.floor(o/4),He=o%4,st=`\n      if (${Q}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${a}, ${u}, ${d});\n      const ivec3 pads = ivec3(${R}, ${$}, ${B});\n      const float initializationValue = ${ie};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${ie});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${E};\n            wD += ${m}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${D};\n            wR += ${y}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${Be}; wC += 4) {\n              int xC = xCCorner + wC * ${_};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${_}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${_}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${_}, ch)\n              );\n\n              ${st}\n            }\n\n            int xC = xCCorner + ${Be};\n            if (${1===He}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${st}\n            } else if (${2===He}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${_}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${st}\n            } else if (${3===He}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${_}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${_}, ch),\n                initializationValue\n              );\n\n              ${st}\n            }\n          }\n        }\n        setOutput(${Me});\n      }\n    `}}const ske={kernelName:NC,backendName:"webgl",kernelFunc:function ike(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;ob(i,"avgPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r;De(la(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const m=uc(i.shape,s,o,1,a,u);if(1===m.filterWidth&&1===m.filterHeight&&ri(m.inShape,m.outShape))return Yu({inputs:{x:i},backend:e});const y=new OE(m,"avg",!1);return e.runWebGLProgram(y,[i],"float32")}},ake={kernelName:TC,backendName:"webgl",kernelFunc:function oke(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:a,dimRoundingMode:u,dataFormat:d}=r,y=rd(i.shape,s,o,[1,1,1],a,u,d),_=new FW(y,"avg",!1);return e.runWebGLProgram(_,[i],"float32")}};class uke{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const u=t.effectiveFilterHeight,d=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${u-1-t.padInfo.top}, ${d-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${u};\n            wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${d};\n            wC+= ${t.dilationWidth}) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class lke{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const y=t.effectiveFilterDepth,_=t.effectiveFilterHeight,E=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${y-1-t.padInfo.front}, ${_-1-t.padInfo.top}, ${E-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterDepth*t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${y};\n            wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${_};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${E};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const hke={kernelName:r2,backendName:"webgl",kernelFunc:function cke(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s,{filterSize:a,strides:u,pad:d,dimRoundingMode:m}=r,_=rd(o.shape,a,u,[1,1,1],d,m),E=new lke(_);return e.runWebGLProgram(E,[i],o.dtype)}},dke={kernelName:n2,backendName:"webgl",kernelFunc:function fke(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s;ob([i,s],"avgPoolGrad");const{filterSize:a,strides:u,pad:d}=r,m=uc(o.shape,a,u,1,d),y=new uke(m);return e.runWebGLProgram(y,[i],o.dtype)}},mke={kernelName:AC,backendName:"webgl",kernelFunc:function pke(n){const{inputs:t,backend:e,attrs:r}=n,{a:i,b:s}=t,{transposeA:o,transposeB:a}=r;return yF({a:i,b:s,transposeA:o,transposeB:a,backend:e})}};class gke{constructor(t,e,r,i,s,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Fr(t,e),Fr(t,r);let a="0.0";null!=i&&(Fr(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="1.0";null!=s&&(Fr(t,s),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${a};\n        float scale = ${u};\n        float inv = scale * inversesqrt(variance + float(${o}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class vke{constructor(t,e,r,i,s,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Fr(t,e),Fr(t,r);let a="vec4(0.0)";null!=i&&(Fr(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="vec4(1.0)";null!=s&&(Fr(t,s),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${a};\n        vec4 scale = ${u};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${o}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const yke={kernelName:VC,backendName:"webgl",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r,mean:i,variance:s,offset:o,scale:a}=n;De(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),De(null==o||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),De(null==a||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=e;null==u&&(u=.001);const d=[r,i,s];let m=null;null!=o&&(m=o.shape,d.push(o));let y=null;null!=a&&(y=a.shape,d.push(a));const _=Ft().getBool("WEBGL_PACK_NORMALIZATION")?new vke(r.shape,i.shape,s.shape,m,y,u):new gke(r.shape,i.shape,s.shape,m,y,u);return t.runWebGLProgram(_,d,d[0].dtype)}};class _ke{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=Ki(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=function bke(n){if(1===n)return"sourceLoc";if(n<=6)return PW.slice(0,n).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}(this.rank);let i;i=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((o,a)=>`sourceLoc.${PW[a]} = start[${a}] + coords.${PW[a]};`).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${i}\n        setOutput(getSource(${r}));\n      }\n    `}}const PW=["x","y","z","w","u","v"];class wke{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=Ki(this.rank),r=Ya("coords",this.rank),i=Ya("sourceLoc",this.rank),s=1===this.rank?"sourceLoc":`vec2(${i.slice(-2).join()})`,o=`getChannel(getSource(${i.join()}), ${s})`,a=`\n      result.x = ${o};\n      if (++${r[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${i[this.rank-1]};\n        result.y = ${o};\n        --${i[this.rank-1]};\n      }\n    `,u=1===this.rank?"":`\n      --${r[this.rank-1]};\n      if (++${r[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${i[this.rank-2]};\n        result.z = ${o};\n        if (++${r[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${i[this.rank-1]};\n          result.w = ${o};\n        }\n      }\n    `,d=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((m,y)=>`start[${y}]`).join()});`:t.map((m,y)=>`${i[y]} = ${r[y]} + start[${y}];`).join("\n");this.userCode=`\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${d}\n        vec4 result = vec4(0.);\n        ${a}\n        ${u}\n        setOutput(result);\n      }\n    `}}function db(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,size:o}=r,[a,u]=MR(i,s,o);if(XU(i,a,u),0===Xt(u))return e.makeTensorInfo(u,i.dtype,[]);if(e.shouldExecuteOnCPU([i])||"string"===i.dtype){const y=e.texData.get(i.dataId),_=pDe(y.values,a,u,i.shape,i.dtype);return e.makeTensorInfo(u,i.dtype,_)}const{isPacked:d}=e.texData.get(i.dataId),m=QU(i.shape,a,u);if(d||!m){const y=Ft().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wke(u):new _ke(u);return e.runWebGLProgram(y,[i],i.dtype,[a])}return e.uploadToGPU(i.dataId),function xke(n,t,e,r){const i=r.texData.get(n.dataId),s=r.makeTensorInfo(e,n.dtype),o=r.texData.get(s.dataId);Object.assign(o,i),o.refCount=1,o.shape=e,o.dtype=n.dtype;let a=JU(t,ur(n.shape));i.slice&&(a+=i.slice.flatOffset),o.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||n.dataId};const u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),s}(i,a,u,e)}const Cke={kernelName:mS,backendName:"webgl",kernelFunc:db},Ske={kernelName:IC,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,crops:o}=r;De(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce((B,Q)=>B*Q),u=nE(i.shape,s,a),d=rE(u.length,s.length),m=iE(i.shape,s,a),y=wH(o,s.length),_=xH(m,o,s.length),E=[],D=Pn({inputs:{x:i},backend:e,attrs:{shape:u}}),O=Qa({inputs:{x:D},backend:e,attrs:{perm:d}}),R=Pn({inputs:{x:O},backend:e,attrs:{shape:m}}),$=db({inputs:{x:R},backend:e,attrs:{begin:y,size:_}});return E.push(D),E.push(O),E.push(R),E.forEach(B=>e.disposeIntermediateTensorInfo(B)),$}},Nke={kernelName:s2,backendName:"webgl",kernelFunc:function Eke(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o}=r,a=e.readSync(i.dataId),u=e.readSync(s.dataId),d=kte(a,u,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,d)}},Ake={kernelName:o2,backendName:"webgl",kernelFunc:function Tke(n){const{inputs:t,backend:e}=n,{s0:r,s1:i}=t,s=e.readSync(r.dataId),o=e.readSync(i.dataId),a=Fr(Array.from(s),Array.from(o));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}},sne=fa({opSnippet:"return float(a != b);",cpuKernelImpl:sDe,dtype:"bool"}),Ike={kernelName:rS,backendName:"webgl",kernelFunc:sne};function FE(n){const{inputs:t,backend:e}=n,{input:r}=t;return Yu({inputs:{x:e.texData.get(r.dataId).complexTensorInfos.real},backend:e})}const Dke={kernelName:z2,backendName:"webgl",kernelFunc:FE},Rke={kernelName:$_,backendName:"webgl",kernelFunc:function LW(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dtype:s}=r;if("complex64"===s){if("complex64"===i.dtype)return Yu({inputs:{x:i},backend:e});const o=vo(i.shape),a=LW({inputs:{x:i},backend:e,attrs:{dtype:"float32"}}),u=lm({inputs:{real:a,imag:o},backend:e});return o.dispose(),e.disposeIntermediateTensorInfo(a),u}if("complex64"===i.dtype){const o=FE({inputs:{input:i},backend:e}),a=LW({inputs:{x:o},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(o),a}if(!J4(i.dtype,s)){const o=Yu({inputs:{x:i},backend:e});return{dataId:o.dataId,shape:o.shape,dtype:s}}if(e.shouldExecuteOnCPU([i])){const o=e.texData.get(i.dataId).values,[a,u,d]=BIe(o,i.shape,i.dtype,s);return e.makeTensorInfo(a,u,d)}if("int32"===s)return function kke(n,t){const e=new Xh(n.shape,"return float(int(x));"),r=t.runWebGLProgram(e,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,e);if("bool"===s){const o=e.makeTensorInfo([],"bool",Wo("bool",1)),u=sne({inputs:{a:i,b:o},backend:e});return e.disposeIntermediateTensorInfo(o),u}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}},one="return ceil(x);",Oke=_i({opSnippet:one,packedOpSnippet:one,cpuKernelImpl:VIe}),Fke={kernelName:B_,backendName:"webgl",kernelFunc:Oke};class Pke{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class Lke{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const Bke={kernelName:V_,backendName:"webgl",kernelFunc:function $ke(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{clipValueMin:s,clipValueMax:o}=r;let a;return a=Ft().getBool("WEBGL_PACK_CLIP")?new Lke(i.shape):new Pke(i.shape),e.runWebGLProgram(a,[i],i.dtype,[[s],[o]])}};class Vke{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function ane(n,t){return{dataId:t.dataId,dtype:t.dtype,shape:n.shape}}const Uke={kernelName:DC,backendName:"webgl",kernelFunc:function zke(n){const{inputs:t,backend:e}=n,{x:r}=t,i=e.texData.get(r.dataId),s=new Vke(r.shape),o=[ane(r,i.complexTensorInfos.real),ane(r,i.complexTensorInfos.imag)];return e.runWebGLProgram(s,o,o[0].dtype)}};class Hke{constructor(t){this.outputShape=[],this.outputShape=Hh(t,1),this.variableNames=t.map((o,a)=>`T${a}`);const e=new Array(t.length-1);e[0]=t[0][1];for(let o=1;o<e.length;o++)e[o]=e[o-1]+t[o][1];const r=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<e.length;o++)r.push(`else if (yC < ${e[o]}) setOutput(getT${o}(yR, yC-${e[o-1]}));`);r.push(`else setOutput(getT${e.length}(yR, yC-${e[e.length-1]}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${r.join("\n        ")}\n      }\n    `}}class Wke{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Hh(t,e);const r=this.outputShape,i=r.length,s=Ki(i),o=Ya("coords",i),a=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((O,R)=>`T${R}`);const u=new Array(t.length-1);u[0]=t[0][e];for(let O=1;O<u.length;O++)u[O]=u[O-1]+t[O][e];const d=a[e],m=a.slice(-2),y=a.join();let _=`if (${d} < ${u[0]}) {\n        return getChannel(\n            getT0(${y}), vec2(${m.join()}));\n        }`;for(let O=1;O<u.length;O++){const R=u[O-1];_+=`\n        if (${d} < ${u[O]}  && ${d} >= ${u[O-1]}) {\n          return getChannel(\n            getT${O}(${bF(a,d,R)}),\n            vec2(${bF(m,d,R)}));\n        }`}const D=u[u.length-1];_+=`\n        return getChannel(\n          getT${u.length}(${bF(a,d,D)}),\n          vec2(${bF(m,d,D)}));`,this.userCode=`\n      float getValue(${a.map(O=>"int "+O)}) {\n        ${_}\n      }\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[i-1]} = ${o[i-1]} + 1;\n        if (${o[i-1]} < ${r[i-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[i-2]} = ${o[i-2]} + 1;\n        if (${o[i-2]} < ${r[i-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[i-1]} = ${o[i-1]} - 1;\n        if (${o[i-2]} < ${r[i-2]} &&\n            ${o[i-1]} < ${r[i-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function bF(n,t,e){const r=n.indexOf(t);return n.map((s,o)=>o===r?`${s} - ${e}`:s).join()}function wF(n){const{inputs:t,backend:e}=n,{input:r}=t;return Yu({inputs:{x:e.texData.get(r.dataId).complexTensorInfos.imag},backend:e})}const Gke={kernelName:T2,backendName:"webgl",kernelFunc:wF};function PE(n,t,e){const r=n[0].dtype;if("complex64"===r){const E=n.map(B=>FE({inputs:{input:B},backend:e})),D=n.map(B=>wF({inputs:{input:B},backend:e})),O=PE(E,t,e),R=PE(D,t,e),$=lm({inputs:{real:O,imag:R},backend:e});return E.forEach(B=>e.disposeIntermediateTensorInfo(B)),D.forEach(B=>e.disposeIntermediateTensorInfo(B)),e.disposeIntermediateTensorInfo(O),e.disposeIntermediateTensorInfo(R),$}let i=e.shouldExecuteOnCPU(n);if("string"===r&&(i=!0),i){const E=n.map(ie=>{const ye=Xt(ie.shape.slice(t));return Pn({inputs:{x:ie},backend:e,attrs:{shape:[-1,ye]}})}),D=E.map(ie=>({vals:e.readSync(ie.dataId),shape:ie.shape})),O=Hh(E.map(ie=>ie.shape),1),$=zIe(D,O,r,1===E[0].shape[0]),B=Hh(n.map(ie=>ie.shape),t),Q=e.makeTensorInfo(B,r,$);return E.forEach(ie=>e.disposeIntermediateTensorInfo(ie)),Q}const s=n.filter(E=>Xt(E.shape)>0),o=Ft().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(1===s.length){const E=o?new Xh(n[0].shape,am):new um(n[0].shape,am);return e.runWebGLProgram(E,n,r)}const a=Ft().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>a){const E=[];for(let O=0;O<s.length;O+=a){const R=s.slice(O,O+a);E.push(PE(R,t,e))}const D=PE(E,t,e);for(const O of E)e.disposeIntermediateTensorInfo(O);return D}if(o){const E=new Wke(s.map(D=>D.shape),t);return e.runWebGLProgram(E,s,r)}const{tensors2D:u,outShape:d}=function jke(n,t,e){const r=Hh(n.map(s=>s.shape),t);return{tensors2D:n.map(s=>Pn({inputs:{x:s},attrs:{shape:[-1,Xt(s.shape.slice(t))]},backend:e})),outShape:r}}(s,t,e),m=new Hke(u.map(E=>E.shape)),y=e.runWebGLProgram(m,u,r);u.forEach(E=>e.disposeIntermediateTensorInfo(E));const _=Pn({inputs:{x:y},attrs:{shape:d},backend:e});return e.disposeIntermediateTensorInfo(y),_}function une(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r,s=Yr(i,t[0].shape)[0];yH(t.map(d=>d.shape),s);const a=Hh(t.map(d=>d.shape),s);if(0===Xt(a))return e.makeTensorInfo(a,t[0].dtype,[]);const u=t.filter(d=>Xt(d.shape)>0);return 1===u.length?Yu({inputs:{x:u[0]},backend:e}):PE(u,s,e)}const qke={kernelName:MC,backendName:"webgl",kernelFunc:une};class lne{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,a=t.padInfo.left,u=t.strideHeight,d=t.strideWidth,m=t.dilationHeight,y=t.dilationWidth,_=t.filterHeight,E=t.filterWidth,D=4*Math.floor(t.inChannels/4),O=t.inChannels%4,R="channelsLast"===t.dataFormat,$=R?1:2,B=R?2:3,Q=R?3:1;let ie="",ye="";r&&(ie=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,ye="result = activation(result);");const Me=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${ie}\n\n      const ivec2 strides = ivec2(${u}, ${d});\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${Q}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${$}], coords[${B}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${_}; wR++) {\n          int xR = xRCorner + wR * ${m};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${E}; wC++) {\n            int xC = xCCorner + wC * ${y};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${D}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${R}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===O}) {\n\n              if (${R}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${D}) *\n                    getW(wR, wC, ${D}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${D}, xR, xC) *\n                    getW(wR, wC, ${D}, d2);\n              }\n\n            } else if (${2===O}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${D}, d2),\n                getW(wR, wC, ${D} + 1, d2)\n              );\n\n              if (${R}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${D}),\n                  getX(batch, xR, xC, ${D} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${D}, xR, xC),\n                  getX(batch, ${D} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===O}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${D}, d2),\n                getW(wR, wC, ${D} + 1, d2),\n                getW(wR, wC, ${D} + 2, d2)\n              );\n\n              if (${R}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${D}),\n                  getX(batch, xR, xC, ${D} + 1),\n                  getX(batch, xR, xC, ${D} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${D}, xR, xC),\n                  getX(batch, ${D} + 1, xR, xC),\n                  getX(batch, ${D} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${Me}\n        ${ye}\n        setOutput(result);\n      }\n    `}}class Zke{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,r=t.padInfo.top,i=t.padInfo.left,s=t.strideDepth,o=t.strideHeight,a=t.strideWidth,u=t.dilationDepth,d=t.dilationHeight,m=t.dilationWidth,y=t.filterDepth,_=t.filterHeight,E=t.filterWidth,D=4*Math.floor(t.inChannels/4),O=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${s}, ${o}, ${a});\n      const ivec3 pads = ivec3(${e}, ${r}, ${i});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${y}; wF++) {\n          int xF = xFCorner + wF * ${u};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${_}; wR++) {\n            int xR = xRCorner + wR * ${d};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${E}; wC++) {\n              int xC = xCCorner + wC * ${m};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${D}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===O}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${D}) *\n                  getW(wF, wR, wC, ${D}, d2);\n              } else if (${2===O}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${D}),\n                  getX(batch, xF, xR, xC, ${D} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${D}, d2),\n                  getW(wF, wR, wC, ${D} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===O}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${D}),\n                  getX(batch, xF, xR, xC, ${D} + 1),\n                  getX(batch, xF, xR, xC, ${D} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${D}, d2),\n                  getW(wF, wR, wC, ${D} + 1, d2),\n                  getW(wF, wR, wC, ${D} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class cne{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Oa(this.outputShape.length);const o=t.padInfo.left,a=t.strideWidth,u=t.dilationWidth,d=t.filterHeight,m=t.filterWidth,y=m;let _="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let R=0;R<m;R++)_+=`\n           vec4 xTexelC${2*R};\n           int xTexelC${2*R}Ready;\n           vec4 xTexelC${2*R+1};\n           int xTexelC${2*R+1}Ready;\n           vec4 xC${R};`;_+=`\n     for (int r = 0; r < ${d}; r++) {\n      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {\n       `;for(let R=0;R<m;R++)_+=`\n           xTexelC${2*R} = vec4(0.0);\n           xTexelC${2*R}Ready = 0;\n           xTexelC${2*R+1} = vec4(0.0);\n           xTexelC${2*R+1}Ready = 0;\n           xC${R} = vec4(0.0);`;_+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let R=0;R<(y+1)/2;R++){const $=2*R;if(_+=`\n           xC = xCCorner + ${$*u};\n           `,1===a){if($<m&&(o%2==1?(_+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$}Ready == 0) {\n                   xTexelC${$} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${$}.zw = vec2(0.0);\n                   }\n                   xTexelC${$}Ready = 1;\n                 }\n               `,_+=1===u&&$>0?`\n                 xC${$} = vec4(xTexelC${$-2}.zw, xTexelC${$}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${$} = vec4(previous.zw, xTexelC${$}.xy);\n                   } else {\n                     xC${$} = vec4(0.0, 0.0, xTexelC${$}.xy);\n                   }\n                   `):_+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${$}Ready == 0) {\n                   xTexelC${$} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${$}.zw = vec2(0.0);\n                   }\n                   xTexelC${$}Ready = 1;\n                 }\n\n                 xC${$} = xTexelC${$};\n                 `,$+1<m)){const B=o%2==0?Kk(u):u;u%2==0&&o%2==1||u%2!=0&&o%2!=1?(_+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${B};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$+1}Ready == 0) {\n                     xTexelC${$+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${$+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${$+1}Ready = 1;\n                   }\n                   `,_+=u>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${$+1} = vec4(previous.zw, xTexelC${$+1}.xy);\n                     } else {\n                      xC${$+1} = vec4(0.0, 0.0, xTexelC${$+1}.xy);\n                     }\n                     `:`\n                     xC${$+1} = vec4(xTexelC${$}.zw, xTexelC${$+1}.xy);\n                     `):_+=1===B?`\n                     xC${$+1} = xTexelC${$};\n                     `:`\n                     xCOffset = xC + ${B};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$+1}Ready == 0) {\n                       xTexelC${$+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${$+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${$+1}Ready = 1;\n                     }\n\n                     xC${$+1} = xTexelC${$+1};\n                     `}}else $<m&&(o%2==1?(_+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$}Ready == 0) {\n                   xTexelC${$} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${$}.zw = vec2(0.0);\n                   }\n                   xTexelC${$}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${$+1}Ready == 0) {\n                   xTexelC${$+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${$+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${$+1}Ready = 1;\n                 }\n\n                 xC${$} = vec4(xTexelC${$}.zw, xTexelC${$+1}.zw);\n               `,$+1<m&&(_+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${$+1} = vec4(xTexelC${$+1}.xy, final.xy);\n                 `)):(_+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${$}Ready == 0) {\n                   xTexelC${$} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${$}.zw = vec2(0.0);\n                   }\n                   xTexelC${$}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${$+1}Ready == 0) {\n                   xTexelC${$+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${$+1}.zw = vec2(0.);\n                   }\n                   xTexelC${$+1}Ready = 1;\n                 }\n\n                 xC${$} = vec4(\n                   xTexelC${$}.xy, xTexelC${$+1}.xy);\n               `,$+1<m&&(_+=`\n                   xC${$+1} = vec4(xTexelC${$}.zw, xTexelC${$+1}.zw);\n                 `)));$<m&&(_+=`\n             wTexel = getW(r, ${$}, d1, d2);\n             dotProd += xC${$}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${t.inChannels}) {\n               dotProd += xC${$}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,$+1<m&&(_+=`\n               wTexel = getW(r, ${$+1}, d1, d2);\n               dotProd += xC${$+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${t.inChannels}) {\n                 dotProd += xC${$+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}_+="\n     }\n   ",_+="\n     }\n   ",_+="\n     }\n   ";let E="",D="";r&&(E=i?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${r}\n         }`:s?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${r}\n         }`:`vec4 activation(vec4 x) {\n           ${r}\n         }`,D="result = activation(result);");const O=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${E}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${_}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${O}\n         ${D}\n         setOutput(result);\n       }\n     `}}class Kke{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Oa(this.outputShape.length);const{dataFormat:r}=e,i=Xa(),s="channelsLast"===r,o=s?1:2,a=s?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let d="";for(let m=0;m<=1;m++)for(let y=0;y<=1;y++)d+=`\n          blockIndex = rc.z + ${y};\n          pos = rc.y + ${m};\n\n          ${u}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${o}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${a}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${s}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*m+y}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*m+y}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${d}\n\n        ${i.output} = result;\n      }\n    `}}function xF(n,t){const e=n.length;return e>=3?t?[...n.slice(0,-3),n[e-3]*n[e-2],n[e-1]]:[...n.slice(0,-3),n[e-3],n[e-2]*n[e-1]]:!t&&1===e&&n[0]>1?[n[0],1]:null}function hne({x:n,filter:t,convInfo:e,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const u=n.shape,d=r.texData.get(n.dataId),m=e.inChannels,y=u[0]*u[1]*u[2],_=e.outChannels,E="channelsLast"===e.dataFormat;let R;const $=[];if(null!=s){const ie=xF(s.shape,E);null!=ie&&(s=Pn({inputs:{x:s},backend:r,attrs:{shape:ie}}),$.push(s))}if(null!=i){const ie=xF(i.shape,E);null!=ie&&(i=Pn({inputs:{x:i},backend:r,attrs:{shape:ie}}),$.push(i))}if((1!==y&&1!==_||!(m>1e3))&&d.isPacked&&E&&null!=d.texture&&u[2]%2!=0&&ri(d.shape.slice(-3),u.slice(-3))){const ye={dataId:n.dataId,shape:[1,u[0]*u[1]*(u[2]+1),e.inChannels],dtype:n.dtype},Me=d.shape;d.shape=d.shape.slice(),d.shape[d.shape.length-2]++,De(DE(d.shape,ye.shape),()=>`packed reshape ${d.shape} to ${ye.shape} isn't free`);const Be=Pn({inputs:{x:t},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}});$.push(Be);const He=yF({a:ye,b:Be,backend:r,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o}),st=r.texData.get(He.dataId);De(st.isPacked,()=>"batchMatMul result is expected to be packed"),d.shape=Me,st.shape=e.outShape,R=Yu({inputs:{x:He},backend:r}),R.shape=e.outShape,$.push(He)}else{const ie=e.outHeight*e.outWidth,ye=Pn({inputs:{x:n},backend:r,attrs:{shape:E?[e.batchSize,ie,e.inChannels]:[e.batchSize,e.inChannels,ie]}}),Me=Pn({inputs:{x:t},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}}),Be=yF({a:E?ye:Me,b:E?Me:ye,transposeA:!E,transposeB:!1,backend:r,bias:i,activation:a,preluActivationWeights:s,leakyreluAlpha:o});R=Pn({inputs:{x:Be},backend:r,attrs:{shape:e.outShape}}),$.push(ye),$.push(Me),$.push(Be)}for(const ie of $)r.disposeIntermediateTensorInfo(ie);return R}function fne({x:n,filter:t,convInfo:e,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:u,filterHeight:d,inChannels:m,outWidth:y,outHeight:_,dataFormat:E}=e,D="channelsLast"===E,O=u*d*m,R=_*y,$=[e.batchSize,O,R],ie=[];if(null!=s){const Dt=xF(s.shape,D);null!=Dt&&(s=Pn({inputs:{x:s},backend:r,attrs:{shape:Dt}}),ie.push(s))}if(null!=i){const Dt=xF(i.shape,D);null!=Dt&&(i=Pn({inputs:{x:i},backend:r,attrs:{shape:Dt}}),ie.push(i))}const ye=Pn({inputs:{x:t},backend:r,attrs:{shape:[1,O,Xt(t.shape)/O]}});ie.push(ye);const Me=new Kke($,e),He=r.runWebGLProgram(Me,[n],"float32",[n.shape,[e.padInfo.top,e.padInfo.left],[e.strideHeight,e.strideWidth],[e.dilationHeight,e.dilationWidth],[e.inChannels],[e.filterWidth*e.inChannels],[e.outWidth]]),st=Pn({inputs:{x:He},backend:r,attrs:{shape:$}});ie.push(He),ie.push(st);const lt=null!=i,It=null!=s,zt="leakyrelu"===a,Wt=a?RE(a,!0):null,qt=new Zte(D?st.shape:ye.shape,D?ye.shape:st.shape,D?[e.batchSize,R,e.outChannels]:[e.batchSize,e.outChannels,R],!0,!1,lt,Wt,It,zt),Kt=D?[st,ye]:[ye,st];if(i&&Kt.push(i),It&&Kt.push(s),zt){const Dt=r.makeTensorInfo([],"float32",Yf(o,"float32"));Kt.push(Dt),ie.push(Dt)}const Tt=r.runWebGLProgram(qt,Kt,"float32"),Rt=Pn({inputs:{x:Tt},backend:r,attrs:{shape:e.outShape}});ie.push(Tt);for(const Dt of ie)r.disposeIntermediateTensorInfo(Dt);return Rt}const Yke={kernelName:kC,backendName:"webgl",kernelFunc:function Xke(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:a,dataFormat:u,dilations:d,dimRoundingMode:m}=r,y=id(u),_=qo(i.shape,s.shape,o,d,a,m,!1,y);let E;if(1!==_.filterHeight||1!==_.filterWidth||1!==_.dilationHeight||1!==_.dilationWidth||1!==_.strideHeight||1!==_.strideWidth||"SAME"!==_.padInfo.type&&"VALID"!==_.padInfo.type)if(_.strideWidth<=2&&"channelsLast"===y&&Ft().getBool("WEBGL_EXP_CONV")){const O=new cne(_);E=e.runWebGLProgram(O,[i,s],"float32",[[_.padInfo.top,_.padInfo.left],[_.strideHeight,_.strideWidth],[_.dilationHeight,_.dilationWidth],[_.inHeight,_.inWidth]])}else if(Ft().getBool("WEBGL_CONV_IM2COL"))E=fne({x:i,filter:s,convInfo:_,backend:e});else{const O=new lne(_);E=e.runWebGLProgram(O,[i,s],"float32")}else E=hne({x:i,filter:s,convInfo:_,backend:e});const D=Pn({inputs:{x:E},backend:e,attrs:{shape:_.outShape}});return e.disposeIntermediateTensorInfo(E),D}};class Qke{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              ${"channelsLast"===t.dataFormat?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);"}\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Jke{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,r=t.filterWidth,o="channelsLast"===t.dataFormat;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${o?3:1}];\n\n        ivec2 dyCorner = ivec2(coords[${o?1:2}], coords[${o?2:3}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${o}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class e2e{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${t.strideDepth} - ${t.padInfo.front};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class t2e{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,r=t.filterHeight,i=t.filterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${r-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${t.strideDepth}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${r}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${r} - 1 - wR;\n\n            for (int wC = 0; wC < ${i}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${i} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const r2e={kernelName:u2,backendName:"webgl",kernelFunc:function n2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:a,dataFormat:u,dimRoundingMode:d,filterShape:m}=r,y=id(u),_=qo(i.shape,m,o,1,a,d,!1,y),E=new Qke(_);return e.runWebGLProgram(E,[i,s],"float32")}};class i2e{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=Oa(this.outputShape.length);const e=t.filterHeight,r=t.filterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            int wCPerm = ${r} - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    `}}const o2e={kernelName:RC,backendName:"webgl",kernelFunc:function s2e(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{inputShape:o,strides:a,pad:u,dataFormat:d,dimRoundingMode:m}=r,y=id(d),_=qo(o,s.shape,a,1,u,m,!1,y);if(Ft().getBool("WEBGL_PACK")&&"channelsLast"===y){const E=[[_.strideHeight,_.strideWidth]],D=new i2e(_);return e.runWebGLProgram(D,[i,s],"float32",E)}{const E=new Jke(_);return e.runWebGLProgram(E,[i,s],"float32")}}},u2e={kernelName:OC,backendName:"webgl",kernelFunc:function a2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r,d=zp(i.shape,s.shape,o,u,a),m=new Zke(d);return e.runWebGLProgram(m,[i,s],"float32")}},c2e={kernelName:l2,backendName:"webgl",kernelFunc:function l2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,pad:a,filterShape:u}=r,d=zp(i.shape,u,o,1,a),m=new e2e(d);return e.runWebGLProgram(m,[i,s],"float32")}},f2e={kernelName:c2,backendName:"webgl",kernelFunc:function h2e(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{pad:o,strides:a,inputShape:u}=r,d=zp(u,s.shape,a,1,o),m=new t2e(d);return e.runWebGLProgram(m,[i,s],"float32")}},m2e=_i({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n",packedOpSnippet:`\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ${Iv}\n  return result;\n`}),g2e={kernelName:z_,backendName:"webgl",kernelFunc:m2e},v2e=_i({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),y2e={kernelName:U_,backendName:"webgl",kernelFunc:v2e};class _2e{constructor(t,e,r,i,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,u,d]=t,[m]=e,[y,_]=r;this.outputShape=[m,y,_,d];const E="bilinear"===i?1:0,[D,O]=[a-1+".0",u-1+".0"],[R,$,B]=y>1?[""+(a-1)/(y-1),"(y2-y1) * height_ratio",`y1*${D} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${D}`],[Q,ie,ye]=_>1?[""+(u-1)/(_-1),"(x2-x1) * width_ratio",`x1*${O} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${O}`];this.userCode=`\n      const float height_ratio = float(${R});\n      const float width_ratio = float(${Q});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${o}) {\n          return;\n        }\n\n        float height_scale = ${$};\n        float width_scale = ${ie};\n\n        float in_y = ${B};\n        if( in_y < 0.0 || in_y > ${D} ) {\n          setOutput(float(${s}));\n          return;\n        }\n        float in_x = ${ye};\n        if( in_x < 0.0 || in_x > ${O} ) {\n          setOutput(float(${s}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${E} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const b2e={kernelName:f2,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{image:i,boxes:s,boxInd:o}=t,{cropSize:a,method:u,extrapolationValue:d}=r,m=new _2e(i.shape,s.shape,a,u,d);return e.runWebGLProgram(m,[i,s,o],"float32")}};var pb=(()=>{return(n=pb||(pb={})).Prod="*",n.Sum="+",pb;var n})();class dne{constructor(t,e,r,i){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,a=r?this.op===pb.Prod?"1.0":"0.0":`getX(${pne(s,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let d="",m="";r?(d=i?"end != "+(u-1):"end != 0",m=i?"end + 1":"end - 1"):(d=i?`end + pow2 < ${u}`:"end >= pow2",m=i?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${Ki(s)} coords = getOutputCoords();\n        int end = ${mne(s,"coords",this.op)};\n        float val = ${a};\n        int pow2 = int(pow(2.0, index));\n        if (${d}) {\n          int idx = ${m};\n          ${mne(s,"coords",this.op)} = idx;\n          val ${this.op}= getX(${pne(s,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function pne(n,t,e){if(1===n)return`${t}`;if(2===n)return`${t}.x, ${t}.y`;if(3===n)return`${t}.x, ${t}.y, ${t}.z`;if(4===n)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function mne(n,t,e){if(1===n)return`${t}`;if(2===n)return`${t}.y`;if(3===n)return`${t}.z`;if(4===n)return`${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function gne(n,t,e,r,i,s){const o=t.shape.length,a=ks([r],o);let u=t;null!=a&&(u=Qa({inputs:{x:t},backend:e,attrs:{perm:a}}));const d=to(1,o)[0];if(d!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);const m=u.shape[d];let y=Yu({inputs:{x:u},backend:e});for(let _=0;_<=Math.ceil(Math.log2(m))-1;_++){const E=new dne(n,u.shape,!1,s),O=y;y=e.runWebGLProgram(E,[y],y.dtype,[[_]]),e.disposeIntermediateTensorInfo(O)}if(i){const _=new dne(n,u.shape,i,s),E=y;y=e.runWebGLProgram(_,[y],y.dtype),e.disposeIntermediateTensorInfo(E)}if(null!=a){const E=Qa({inputs:{x:y},backend:e,attrs:{perm:Hp(a)}});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(u),E}return y}const x2e={kernelName:h2,backendName:"webgl",kernelFunc:function w2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return gne(pb.Prod,i,e,s,o,a)}},S2e={kernelName:FC,backendName:"webgl",kernelFunc:function C2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,exclusive:o,reverse:a}=r;return gne(pb.Sum,i,e,s,o,a)}},N2e={kernelName:d2,backendName:"webgl",kernelFunc:function E2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,weights:s}=t,{size:o,binaryOutput:a}=r;if(1===i.shape.length){const u=e.readSync(i.dataId),d=e.readSync(s.dataId),m=kte(u,d,s.dtype,s.shape,o);return e.makeTensorInfo([o],s.dtype,m)}if(2===i.shape.length){const u=e.bufferSync(i),d=e.bufferSync(s),m=$Ie(u,d,o,a);return e.makeTensorInfo(m.shape,s.dtype,m.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}};class T2e{constructor(t,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=r,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const I2e={kernelName:p2,backendName:"webgl",kernelFunc:function A2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockSize:s,dataFormat:o}=r,a=i.shape[0],y=("NHWC"===o?i.shape[1]:i.shape[2])*s,_=("NHWC"===o?i.shape[2]:i.shape[3])*s,E=("NHWC"===o?i.shape[3]:i.shape[1])/(s*s),O=new T2e("NHWC"===o?[a,y,_,E]:[a,E,y,_],s,o);return e.runWebGLProgram(O,[i],i.dtype)}};class vne{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Oa(this.outputShape.length);const o=t.filterHeight,a=t.filterWidth,u=t.outChannels/t.inChannels;let d="",m="";r&&(d=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:s?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,m="result = activation(result);");const y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${d}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${u};\n        int q = d2 - d1 * ${u};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${o}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${a}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${y}\n        ${m}\n        setOutput(result);\n      }\n    `}}class yne{constructor(t,e=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Oa(this.outputShape.length);const o=t.outChannels/t.inChannels,a=t.padInfo.left,u=t.strideWidth,d=t.dilationWidth,m=t.filterHeight,y=t.filterWidth,_=y;let E="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let $=0;$<y;$++)E+=`\n          vec4 xTexelC${2*$};\n          int xTexelC${2*$}Ready;\n          vec4 xTexelC${2*$+1};\n          int xTexelC${2*$+1}Ready;\n          vec4 xC${$};`;E+=`\n    for (int r = 0; r < ${m}; r++) {\n      `;for(let $=0;$<y;$++)E+=`\n          xTexelC${2*$} = vec4(0.0);\n          xTexelC${2*$}Ready = 0;\n          xTexelC${2*$+1} = vec4(0.0);\n          xTexelC${2*$+1}Ready = 0;\n          xC${$} = vec4(0.0);`;E+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let $=0;$<(_+1)/2;$++){const B=2*$;if(E+=`\n          xC = xCCorner + ${B*d};\n          `,1===u){if(B<y&&(a%2==1?(E+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${B}Ready == 0) {\n                  xTexelC${B} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${B}.zw = vec2(0.0);\n                  }\n                  xTexelC${B}Ready = 1;\n                }\n              `,E+=1===d&&B>0?`\n                xC${B} = vec4(xTexelC${B-2}.zw, xTexelC${B}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${B} = vec4(previous.zw, xTexelC${B}.xy);\n                  } else {\n                    xC${B} = vec4(0.0, 0.0, xTexelC${B}.xy);\n                  }\n                  `):E+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${B}Ready == 0) {\n                  xTexelC${B} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${B}.zw = vec2(0.0);\n                  }\n                  xTexelC${B}Ready = 1;\n                }\n\n                xC${B} = xTexelC${B};\n                `,B+1<y)){const Q=a%2==0?Kk(d):d;d%2==0&&a%2==1||d%2!=0&&a%2!=1?(E+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${Q};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${B+1}Ready == 0) {\n                    xTexelC${B+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${B+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${B+1}Ready = 1;\n                  }\n                  `,E+=d>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${B+1} = vec4(previous.zw, xTexelC${B+1}.xy);\n                    } else {\n                     xC${B+1} = vec4(0.0, 0.0, xTexelC${B+1}.xy);\n                    }\n                    `:`\n                    xC${B+1} = vec4(xTexelC${B}.zw, xTexelC${B+1}.xy);\n                    `):E+=1===Q?`\n                    xC${B+1} = xTexelC${B};\n                    `:`\n                    xCOffset = xC + ${Q};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${B+1}Ready == 0) {\n                      xTexelC${B+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${B+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${B+1}Ready = 1;\n                    }\n\n                    xC${B+1} = xTexelC${B+1};\n                    `}}else B<y&&(a%2==1?(E+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${B}Ready == 0) {\n                  xTexelC${B} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${B}.zw = vec2(0.0);\n                  }\n                  xTexelC${B}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${B+1}Ready == 0) {\n                  xTexelC${B+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${B+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${B+1}Ready = 1;\n                }\n\n                xC${B} = vec4(xTexelC${B}.zw, xTexelC${B+1}.zw);\n              `,B+1<y&&(E+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${B+1} = vec4(xTexelC${B+1}.xy, final.xy);\n                `)):(E+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${B}Ready == 0) {\n                  xTexelC${B} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${B}.zw = vec2(0.0);\n                  }\n                  xTexelC${B}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${B+1}Ready == 0) {\n                  xTexelC${B+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${B+1}.zw = vec2(0.);\n                  }\n                  xTexelC${B+1}Ready = 1;\n                }\n\n                xC${B} = vec4(\n                  xTexelC${B}.xy, xTexelC${B+1}.xy);\n              `,B+1<y&&(E+=`\n                  xC${B+1} = vec4(xTexelC${B}.zw, xTexelC${B+1}.zw);\n                `)));B<y&&(E+=`\n            wTexel = getW(r, ${B}, d1, q);\n            dotProd += xC${B} * vec4(wTexel.xz, wTexel.xz);\n          `,B+1<y&&(E+=`\n              wTexel = getW(r, ${B+1}, d1, q);\n              dotProd += xC${B+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}E+="\n    }\n  ",E+="\n      }\n    ";let D="",O="";r&&(D=i?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:s?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`vec4 activation(vec4 x) {\n          ${r}\n        }`,O="result = activation(result);");const R=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${D}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${E}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${R}\n        ${O}\n        setOutput(result);\n      }\n    `}}const M2e={kernelName:PC,backendName:"webgl",kernelFunc:function D2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u,dimRoundingMode:d}=r;let m=u;null==m&&(m=[1,1]),De(la(o,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${m}'`);const y=qo(i.shape,s.shape,o,m,a,d,!0);let _;return _=Ft().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels==1?new yne(y):new vne(y),e.runWebGLProgram(_,[i,s],"float32",[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]])}};class k2e{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${t.outChannels/t.inChannels} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class R2e{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,r=t.filterWidth,u=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${r-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${u}; dm++) {\n              int d2 = d1 * ${u} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const F2e={kernelName:m2,backendName:"webgl",kernelFunc:function O2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,dy:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:d,filterShape:m}=r,y=qo(i.shape,m,o,a,u,d,!0),_=new k2e(y);return e.runWebGLProgram(_,[i,s],"float32")}},L2e={kernelName:g2,backendName:"webgl",kernelFunc:function P2e(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,filter:s}=t,{strides:o,dilations:a,pad:u,dimRoundingMode:d,inputShape:m}=r,y=qo(m,s.shape,o,a,u,d,!0),_=new R2e(y);return e.runWebGLProgram(_,[i,s],"float32")}};class $2e{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const V2e={kernelName:v2,backendName:"webgl",kernelFunc:function B2e(n){const{inputs:t,backend:e}=n,{x:r}=t,i=[...r.shape,...r.shape],s=Xt(r.shape),o=Pn({inputs:{x:r},backend:e,attrs:{shape:[s]}}),a=new $2e(s),u=e.runWebGLProgram(a,[o],o.dtype),d=Pn({inputs:{x:u},backend:e,attrs:{shape:i}});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(u),d}};class z2e{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:r,padInfo:i,strideHeight:s,strideWidth:o,filterHeight:a,filterWidth:u,dilationHeight:d,dilationWidth:m}=t,{top:y,left:_}=i;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${o});\n      const ivec2 pads = ivec2(${y}, ${_});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${a}; h++) {\n          int hIn = hBeg + h * ${d};\n\n          if (hIn >= 0 && hIn < ${e}) {\n            for (int w = 0; w < ${u}; w++) {\n              int wIn = wBeg + w * ${m};\n\n              if (wIn >= 0 && wIn < ${r}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const H2e={kernelName:LC,backendName:"webgl",kernelFunc:function U2e(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s}=t,{strides:o,pad:a,dilations:u}=r,d=LS(i.shape,s.shape,o,a,"NHWC",u);let m;const y=new z2e(d);m=e.runWebGLProgram(y,[i,s],"float32");const _=Pn({inputs:{x:m},backend:e,attrs:{shape:d.outShape}});return e.disposeIntermediateTensorInfo(m),_}},G2e={kernelName:b2,backendName:"webgl",kernelFunc:function W2e(n){const{inputs:t,backend:e,attrs:r}=n,{equation:i}=r,s=t,{allDims:o,summedDims:a,idDims:u}=MH(i,s.length);RH(o.length,u,s);const{path:d,steps:m}=OH(a,u),y=m.length;let _=null,E=o.length;const D=[];for(let O=0;O<y;++O){for(const R of m[O]){const{permutationIndices:$,expandDims:B}=kH(E,u[R]);let Q;FH($)?Q=s[R]:(Q=Qa({inputs:{x:s[R]},backend:e,attrs:{perm:$}}),D.push(Q));const ie=Q.shape.slice();for(let ye=0;ye<B.length;++ye)ie.splice(B[ye],0,1);ri(Q.shape,ie)||(Q=Pn({inputs:{x:Q},backend:e,attrs:{shape:ie}}),D.push(Q)),null===_?_=Q:(_=OW({inputs:{a:Q,b:_},backend:e}),D.push(_))}O<y-1&&(d[O]>=0&&(_=vF({inputs:{x:_},backend:e,attrs:{axis:d[O]-(o.length-E),keepDims:!1}}),D.push(_)),E--)}for(const O of D)O!==_&&e.disposeIntermediateTensorInfo(O);return _}},j2e=_i({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),q2e={kernelName:W_,backendName:"webgl",kernelFunc:j2e},X2e={kernelName:w2,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e}=n,{dy:r,y:i}=t,s=Ft().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new kE("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new hb("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,i.shape);return e.runWebGLProgram(s,[r,i],r.dtype)}},Y2e=fa({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:UIe}),Q2e={kernelName:$C,backendName:"webgl",kernelFunc:Y2e},eRe=_i({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${CH};\n  float a1 = ${SH};\n  float a2 = ${EH};\n  float a3 = ${NH};\n  float a4 = ${TH};\n  float a5 = ${AH};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`}),tRe={kernelName:G_,backendName:"webgl",kernelFunc:eRe},_ne=_i({opSnippet:"if (isnan(x)) return x;\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:HIe,dtype:"float32"}),rRe={kernelName:j_,backendName:"webgl",kernelFunc:_ne};function $W(n){const{inputs:t,attrs:e,backend:r}=n,{dim:i}=e,{input:s}=t,o=s.shape.length,a=s.shape.slice();let u=i;return i<0&&(De(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),u=o+i+1),a.splice(u,0,1),Pn({inputs:{x:s},backend:r,attrs:{shape:a}})}const iRe={kernelName:BC,backendName:"webgl",kernelFunc:$W},bne="return exp(x) - 1.0;",sRe=_i({opSnippet:bne,packedOpSnippet:bne,cpuKernelImpl:WIe}),oRe={kernelName:q_,backendName:"webgl",kernelFunc:sRe};class wne{constructor(t,e,r){this.variableNames=["real","imag"];const i=e[1];this.outputShape=e;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${i}.0`:"1.0";let a;if("real"===t)a="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);a="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${s};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${a}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${i});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${i}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${o};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function xne(n,t,e){const r=e.texData.get(n.dataId),i=Xt(n.shape),s=n.shape[n.shape.length-1],a=Pn({inputs:{x:n},backend:e,attrs:{shape:[i/s,s]}}),u=a.shape,d=new wne("real",u,t),m=new wne("imag",u,t),y=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],_=e.runWebGLProgram(d,y,"float32"),E=e.runWebGLProgram(m,y,"float32"),D=lm({inputs:{real:_,imag:E},backend:e});e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(E);const O=Pn({inputs:{x:D},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(D),O}const uRe={kernelName:x2,backendName:"webgl",kernelFunc:function aRe(n){const{inputs:t,backend:e}=n,{input:r}=t;return xne(r,!1,e)}};class lRe{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function LE(n){const{backend:t,attrs:e}=n,{shape:r,value:i}=e;let{dtype:s}=e;if(s=s||Gg(i),"string"===s){const o=Ws(s,Xt(r));return o.fill(i),t.makeTensorInfo(r,s,o)}{const o=new lRe(r,i);return t.runWebGLProgram(o,[],s,[[i]])}}const cRe={kernelName:C2,backendName:"webgl",kernelFunc:LE};class hRe{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${e} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${e}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const fRe={kernelName:S2,backendName:"webgl",kernelFunc:({inputs:n,backend:t})=>{const{image:e}=n,r=t,i=new hRe(e.shape);return r.runWebGLProgram(i,[e],e.dtype)}},Cne="return floor(x);",dRe=_i({opSnippet:Cne,packedOpSnippet:Cne,cpuKernelImpl:GIe}),pRe={kernelName:Z_,backendName:"webgl",kernelFunc:dRe},mRe=fa({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),gRe={kernelName:K_,backendName:"webgl",kernelFunc:mRe};class vRe{constructor(t){this.variableNames=["A"];const e=Xa(),[r,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class yRe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=Xa(),[r,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${i}.0, ${r}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}const _Re={kernelName:oR,backendName:"webgl",kernelFunc:function bRe(n){const{inputs:t,backend:e,attrs:r}=n;let{pixels:i}=t;const{numChannels:s}=r,o="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,a="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,[u,d]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],m=[d,u],y=[d,u,s];if(a||o){const O=Ft().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(null==mb||O!==BW)&&(BW=O,mb=document.createElement("canvas").getContext("2d",{willReadFrequently:BW})),mb.canvas.width=u,mb.canvas.height=d,mb.drawImage(i,0,0,u,d),i=mb.canvas}const _=e.makeTensorInfo(m,"int32");e.texData.get(_.dataId).usage=Xu.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(_.dataId),i);const E=Ft().getBool("WEBGL_PACK")?new yRe(y):new vRe(y),D=e.runWebGLProgram(E,[_],"int32");return e.disposeData(_.dataId),D}};let mb,BW=Ft().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const xRe={kernelName:ES,backendName:"webgl",kernelFunc:function wRe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:d,dataFormat:m,dilations:y,dimRoundingMode:_,activation:E,leakyreluAlpha:D}=r,O=id(m),R=qo(i.shape,s.shape,u,y,d,_,!1,O);let $;const B=[],Q=null!=o,ie=null!=a,ye="leakyrelu"===E,Me=()=>{const He=[i,s],st=(lt,It)=>{if("NCHW"===It&&1===lt.shape.length&&1!==lt.shape[0]){const zt=Pn({inputs:{x:lt},backend:e,attrs:{shape:[lt.shape[0],1,1]}});return B.push(zt),zt}return lt};if(Q&&He.push(st(o,m)),ie&&He.push(st(a,m)),ye){const lt=e.makeTensorInfo([],"float32",Yf(D,"float32"));He.push(lt),B.push(lt)}return He};if(1!==R.filterHeight||1!==R.filterWidth||1!==R.dilationHeight||1!==R.dilationWidth||1!==R.strideHeight||1!==R.strideWidth||"SAME"!==R.padInfo.type&&"VALID"!==R.padInfo.type)if(R.strideWidth<=2&&"channelsLast"===O&&Ft().getBool("WEBGL_EXP_CONV")){const He=E?RE(E,!0):null,st=new cne(R,Q,He,ie,ye),lt=[[R.padInfo.top,R.padInfo.left],[R.strideHeight,R.strideWidth],[R.dilationHeight,R.dilationWidth],[R.inHeight,R.inWidth]],It=Me();$=e.runWebGLProgram(st,It,"float32",lt)}else if(Ft().getBool("WEBGL_CONV_IM2COL"))$=fne({x:i,filter:s,convInfo:R,backend:e,bias:o,activation:E,preluActivationWeights:a,leakyreluAlpha:D});else{const He=E?RE(E,!1):null,st=new lne(R,Q,He,ie,ye),lt=Me();$=e.runWebGLProgram(st,lt,"float32")}else $=hne({x:i,filter:s,convInfo:R,backend:e,bias:o,activation:E,preluActivationWeights:a,leakyreluAlpha:D});const Be=Pn({inputs:{x:$},backend:e,attrs:{shape:R.outShape}});return B.push($),B.forEach(He=>e.disposeIntermediateTensorInfo(He)),Be}},SRe={kernelName:NS,backendName:"webgl",kernelFunc:function CRe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,filter:s,bias:o,preluActivationWeights:a}=t,{strides:u,pad:d,dilations:m,dimRoundingMode:y,activation:_,leakyreluAlpha:E}=r,D=[];let O=m;null==O&&(O=[1,1]),De(la(u,O),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${O}'`);const R=qo(i.shape,s.shape,u,O,d,y,!0),$=Ft().getBool("WEBGL_PACK_DEPTHWISECONV")&&R.strideWidth<=2&&R.outChannels/R.inChannels==1,B=_?RE(_,$):null,Q=[i,s],ie=null!=o,ye=null!=a,Me="leakyrelu"===_;if(ie&&Q.push(o),ye&&Q.push(a),Me){const lt=e.makeTensorInfo([],"float32",Yf(E,"float32"));Q.push(lt),D.push(lt)}let Be;Be=$?new yne(R,ie,B,ye,Me):new vne(R,ie,B,ye,Me);const st=e.runWebGLProgram(Be,Q,"float32",[[R.padInfo.top,R.padInfo.left],[R.strideHeight,R.strideWidth],[R.dilationHeight,R.dilationWidth],[R.inHeight,R.inWidth]]);return D.forEach(lt=>e.disposeIntermediateTensorInfo(lt)),st}};class ERe{constructor(t,e,r,i){this.sliceDim=t,this.strides=e,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const s=Ki(r.length);let o="\n    int index;";for(let a=0;a<this.sliceDim;a++)o+=`\n          index = round(getIndices(coords[0], ${a}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};\n          flattenIndex += index * ${this.strides[a]};`;this.userCode=`\n         void main() {\n          ${s} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${o}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}const TRe={kernelName:E2,backendName:"webgl",kernelFunc:function NRe(n){const{inputs:t,backend:e}=n,{params:r,indices:i}=t,s=i.shape,o=s[s.length-1],a=Xt(r.shape),[u,d,m,y]=IR(r,i),_=Pn({inputs:{x:i},backend:e,attrs:{shape:[d,o]}}),E=Pn({inputs:{x:r},backend:e,attrs:{shape:[Xt(r.shape)/m,m]}});if(e.shouldExecuteOnCPU([r,i])||"string"===r.dtype){const $=e.readSync(i.dataId),B=e.bufferSync(r),Q=jIe($,B,r.dtype,d,o,m,y,r.shape,a);return e.makeTensorInfo(u,r.dtype,Q.values)}const D=new ERe(o,y,[d,m],r.shape),O=e.runWebGLProgram(D,[E,_],E.dtype),R=Pn({inputs:{x:O},backend:e,attrs:{shape:u}});return e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(O),R}};class ARe{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const r=Ki(this.rank),i=function IRe(n,t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<n.length;i++)r.push(2===i?"index":`${e[i]}`);return r.join()}(t);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${i}));\n      }\n    `}}function Sne(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,indices:s}=t,{axis:o,batchDims:a}=r,u=Yr(o,i.shape)[0];if(Ft().get("DEBUG")){const B=e.readSync(s.dataId),Q=i.shape[u];for(let ie=0;ie<B.length;++ie){const ye=B[ie];De(ye<=Q-1&&ye>=0,()=>`GatherV2: the index value ${ye} is not in [0, ${Q-1}]`)}}const d=$H(i,s,u,a),m=Xt(s.shape),y=[],_=Pn({inputs:{x:i},backend:e,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),E=Pn({inputs:{x:s},backend:e,attrs:{shape:[d.batchSize,m/d.batchSize]}});y.push(_),y.push(E);const D=[d.batchSize,d.outerSize,m/d.batchSize,d.sliceSize];if(e.shouldExecuteOnCPU([i,s])||"string"===i.dtype){const B=e.bufferSync(E),Q=e.bufferSync(_),ie=qIe(Q,B,D);return y.forEach(ye=>e.disposeIntermediateTensorInfo(ye)),e.makeTensorInfo(d.outputShape,ie.dtype,ie.values)}const O=new ARe(_.shape,D),R=e.runWebGLProgram(O,[_,E],_.dtype);y.push(R);const $=Pn({inputs:{x:R},backend:e,attrs:{shape:d.outputShape}});return y.forEach(B=>e.disposeIntermediateTensorInfo(B)),$}const DRe={kernelName:zC,backendName:"webgl",kernelFunc:Sne},MRe=fa({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:ZIe,dtype:"bool"}),kRe={kernelName:UC,backendName:"webgl",kernelFunc:MRe},RRe=fa({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:KIe}),ORe={kernelName:X_,backendName:"webgl",kernelFunc:RRe},PRe={kernelName:N2,backendName:"webgl",kernelFunc:function FRe(n){const{inputs:t,backend:e}=n,{input:r}=t;return xne(r,!0,e)}},LRe=_i({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),$Re={kernelName:Q_,backendName:"webgl",kernelFunc:LRe},BRe=_i({opSnippet:"return float(isinf(x));",dtype:"bool"}),VRe={kernelName:J_,backendName:"webgl",kernelFunc:BRe},zRe=_i({opSnippet:"return float(isnan(x));",dtype:"bool"}),URe={kernelName:e0,backendName:"webgl",kernelFunc:zRe},HRe=fa({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:XIe,dtype:"bool"}),WRe={kernelName:WC,backendName:"webgl",kernelFunc:HRe},GRe=fa({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:YIe,dtype:"bool"}),jRe={kernelName:GC,backendName:"webgl",kernelFunc:GRe},ZRe={kernelName:A2,backendName:"webgl",kernelFunc:function qRe(n){const{backend:t,attrs:e}=n,{start:r,stop:i,num:s}=e,o=QIe(r,i,s);return t.makeTensorInfo([o.length],"float32",o)}},XRe=_i({opSnippet:"if (isnan(x)) return x;\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:JIe}),YRe={kernelName:t0,backendName:"webgl",kernelFunc:XRe},JRe=_i({opSnippet:"if (isnan(x)) return x;\n  return log(1.0 + x);\n"}),eOe={kernelName:n0,backendName:"webgl",kernelFunc:JRe},tOe=fa({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),nOe={kernelName:jC,backendName:"webgl",kernelFunc:tOe},rOe=_i({opSnippet:"return float(!(x >= 1.0));"}),iOe={kernelName:qC,backendName:"webgl",kernelFunc:rOe},sOe=fa({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),oOe={kernelName:ZC,backendName:"webgl",kernelFunc:sOe};class aOe{constructor(t,e,r,i,s){this.variableNames=["x"],this.outputShape=[];const o=e,a=t[3]-1;let u;this.outputShape=t;const d=`float(${r}) + float(${i}) * sum`;u=.5===s?`inversesqrt(${d})`:1===s?`1.0/(${d})`:`exp(log(${d}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${o}; j <= ${o}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${a}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${u};\n        setOutput(val);\n      }\n    `}}class uOe{constructor(t,e,r,i,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=e,a=t[3]-1;let u;this.outputShape=t;const d=`float(${r}) + float(${i}) * sum`;u=.5===s?`inversesqrt(${d})`:1===s?`1.0/(${d})`:`exp(log(${d}) * float(-${s}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${o};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${o}; j <= ${o}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${u};\n        setOutput(result);\n      }\n    `}}const lOe={kernelName:KC,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{depthRadius:s,bias:o,alpha:a,beta:u}=r,d=Ft().getBool("WEBGL_PACK_NORMALIZATION")?new uOe(i.shape,s,o,a,u):new aOe(i.shape,s,o,a,u);return e.runWebGLProgram(d,[i],i.dtype)}};class cOe{constructor(t,e,r,i,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=r,this.alpha=i,this.beta=s,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${i}) * norm + float(${r});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${i})\n                * float(${s})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${s});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const hOe={kernelName:I2,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i,y:s,dy:o}=t,{depthRadius:a,bias:u,alpha:d,beta:m}=r,y=new cOe(i.shape,a,u,d,m);return e.runWebGLProgram(y,[i,s,o],i.dtype)}};function Ene(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reductionIndices:s,keepDims:o}=r,a=i.shape.length,u=Yr(s,i.shape);let d=u;const m=ks(d,a),y=null!=m,_=e.shouldExecuteOnCPU([i]);let E=i;if(y){if(_){const Q=e.texData.get(E.dataId).values,ie=new Array(a);for(let Be=0;Be<ie.length;Be++)ie[Be]=i.shape[m[Be]];const ye=kW(Q,i.shape,i.dtype,m,ie);E=e.makeTensorInfo(ie,i.dtype),e.texData.get(E.dataId).values=ye}else E=gF(i,m,e);d=to(d.length,a)}ca("max",d,a);const[D,O]=Ko(E.shape,d);let $,R=D;if(o&&(R=eo(D,u)),_){const Q=e.texData.get(E.dataId).values,ie=eDe(Q,Xt(O),R,i.dtype);$=e.makeTensorInfo(R,i.dtype),e.texData.get($.dataId).values=ie}else $=function fOe(n,t,e,r){const i=Xt(t),a=Pn({inputs:{x:n},attrs:{shape:[Xt(n.shape)/i,i]},backend:r}),u=Dv(a,n.dtype,"max",r),d=Pn({inputs:{x:u},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),d}(E,O,R,e);return y&&e.disposeIntermediateTensorInfo(E),$}const dOe={kernelName:XC,backendName:"webgl",kernelFunc:Ene},gOe=fa({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:tDe}),vOe={kernelName:r0,backendName:"webgl",kernelFunc:gOe},_Oe={kernelName:YC,backendName:"webgl",kernelFunc:function yOe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;ob(i,"maxPool");const{filterSize:s,strides:o,pad:a,dimRoundingMode:u}=r;De(la(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);const m=uc(i.shape,s,o,1,a,u);if(1===m.filterWidth&&1===m.filterHeight&&ri(m.inShape,m.outShape))return Yu({inputs:{x:i},backend:e});const y=new OE(m,"max",!1);return e.runWebGLProgram(y,[i],i.dtype)}},wOe={kernelName:QC,backendName:"webgl",kernelFunc:function bOe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{filterSize:s,strides:o,pad:a,dataFormat:u,dimRoundingMode:d}=r,y=rd(i.shape,s,o,[1,1,1],a,d,u),_=new FW(y,"max",!1);return e.runWebGLProgram(_,[i],i.dtype)}};class xOe{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const s=t.effectiveFilterHeight,o=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${s-1-t.padInfo.top}, ${o-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${s};\n          wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${o}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${s*o-1} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${o} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class COe{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const u=t.effectiveFilterDepth,d=t.effectiveFilterHeight,m=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${u-1-t.padInfo.front}, ${d-1-t.padInfo.top}, ${m-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${u};\n           wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${d};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${m};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${u*d*m-1} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${d} * ${m} +\n                  wR * ${m} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const EOe={kernelName:M2,backendName:"webgl",kernelFunc:function SOe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s}=t,o=s,{filterSize:a,strides:u,pad:d,dimRoundingMode:m}=r,_=rd(o.shape,a,u,[1,1,1],d,m),E=new FW(_,"max",!0),D=e.runWebGLProgram(E,[o],o.dtype),O=new COe(_),R=e.runWebGLProgram(O,[i,D],o.dtype);return e.disposeIntermediateTensorInfo(D),R}},TOe={kernelName:D2,backendName:"webgl",kernelFunc:function NOe(n){const{inputs:t,backend:e,attrs:r}=n,{dy:i,input:s,output:o}=t,a=s;ob([s,o],"maxPoolGrad");const{filterSize:u,strides:d,pad:m,dimRoundingMode:y}=r,_=uc(a.shape,u,d,1,m,y),D=new OE(_,"max",!0),O=e.runWebGLProgram(D,[a],a.dtype),R=new xOe(_),$=e.runWebGLProgram(R,[i,O],a.dtype);return e.disposeIntermediateTensorInfo(O),$}},IOe={kernelName:k2,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:r}=n,{filterSize:i,strides:s,pad:o,includeBatchInIndex:a}=t,u=e;De(4===r.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const d=[1,1];De(la(s,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${d}'`);const m=uc(r.shape,i,s,d,o),[y,_]=function AOe(n,t,e,r){let i=new OE(e,"max",!1);const s=r.runWebGLProgram(i,[n],"float32");return i=new OE(e,"max",!0,!0,t),[s,r.runWebGLProgram(i,[n],"float32")]}(r,a,m,u);return[y,_]}},MOe={kernelName:JC,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:r}=n,{keepDims:i,axis:s}=t,o=e,a=r.shape.length,u=Yr(s,r.shape);let d=u;const m=ks(d,a),y=null!=m,_=o.shouldExecuteOnCPU([r]),E=[];let D=r;if(y){if(_){const ie=o.texData.get(D.dataId).values,ye=new Array(a);for(let He=0;He<ye.length;He++)ye[He]=r.shape[m[He]];const Me=kW(ie,r.shape,r.dtype,m,ye);D=o.makeTensorInfo(ye,r.dtype),o.texData.get(D.dataId).values=Me}else D=gF(r,m,o);E.push(D),d=to(d.length,a)}ca("sum",d,a);const[O,R]=Ko(D.shape,d);let $=O;i&&($=eo(O,u));const B=function DOe(n,t,e,r){const i=Xt(t),a=Pn({inputs:{x:n},attrs:{shape:[Xt(n.shape)/i,i]},backend:r}),u=Dv(a,"float32","mean",r),d=Pn({inputs:{x:u},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),d}(D,R,$,o);for(const Q of E)o.disposeIntermediateTensorInfo(Q);return B}},ROe={kernelName:eS,backendName:"webgl",kernelFunc:function kOe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=Yr(s,i.shape);let d=u;const m=ks(d,a);let y=i;null!=m&&(y=Qa({inputs:{x:i},backend:e,attrs:{perm:m}}),d=to(d.length,i.shape.length)),ca("min",d,a);const[_,E]=Ko(y.shape,d),O=Pn({inputs:{x:y},backend:e,attrs:{shape:[-1,Xt(E)]}}),R=Dv(O,O.dtype,"min",e);let $;return $=Pn(o?{inputs:{x:R},backend:e,attrs:{shape:eo(_,u)}}:{inputs:{x:R},backend:e,attrs:{shape:_}}),e.disposeIntermediateTensorInfo(O),e.disposeIntermediateTensorInfo(R),null!=m&&e.disposeIntermediateTensorInfo(y),$}},POe=fa({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:nDe}),LOe={kernelName:s0,backendName:"webgl",kernelFunc:POe};class $Oe{constructor(t,e,r){this.variableNames=["x"],this.outputShape=e.map((m,y)=>m[0]+t[y]+m[1]);const i=t.length,s=Ki(i),o=e.map(m=>m[0]).join(","),a=e.map((m,y)=>m[0]+t[y]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),d="reflect"===r?0:1;this.userCode=1!==i?`\n      ${s} start = ${s}(${o});\n      ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        for (int i = 0; i < ${i}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${d};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${d};\n          }\n        }\n        ${s} coords = outC - start;\n        setOutput(getX(${u}));\n      }\n    `:`\n        int start = ${o};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${d};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${d};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class BOe{constructor(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((D,O)=>D[0]+t[O]+D[1]);const i=t.length,s=Ki(i),o=e.map(D=>D[0]).join(","),a=e.map((D,O)=>D[0]+t[O]).join(","),u=Ya("rc",i),d=Ya("source",i),m=`${u[i-1]} < ${this.outputShape[i-1]}`,y=1===i?"source":`vec2(${d.slice(-2).join()})`,_="reflect"===r?0:1;let E="";if(1===i){const D=`\n        ${s} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${_};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${_};\n        }\n        source -= start;\n      `;E=`\n        ${s} rc = outputLoc;\n        ${D}\n        result[0] = getChannel(getX(${d.join()}), ${y});\n        ${u[i-1]} += 1;\n        if(${m}) {\n          ${D}\n          result[1] = getChannel(getX(${d.join()}), ${y});\n        }\n      `}else{const D=`\n        ${s} source = rc;\n        ${s} lt = ${s}(lessThan(source, start));\n        ${s} gte = ${s}(greaterThanEqual(source, end));\n        ${s} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${_}) +\n                gte * ((end - 1) * 2 - source + ${_});\n        source -= start;\n      `;E=`\n        ${s} rc = outputLoc;\n        ${D}\n        result[0] = getChannel(getX(${d.join()}), ${y});\n        ${u[i-1]} += 1;\n        if(${m}) {\n          ${D}\n          result[1] = getChannel(getX(${d.join()}), ${y});\n        }\n        rc = outputLoc;\n        ${u[i-2]} += 1;\n        if(${u[i-2]} < ${this.outputShape[i-2]}) {\n          ${D}\n          result[2] = getChannel(getX(${d.join()}), ${y});\n          ${u[i-1]} += 1;\n          if(${m}) {\n            ${D}\n            result[3] = getChannel(getX(${d.join()}), ${y});\n          }\n        }\n      `}this.userCode=`\n      const ${s} start = ${s}(${o});\n      const ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${E}\n        setOutput(result);\n      }\n    `}}const VOe={kernelName:tS,backendName:"webgl",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:r}=n,{paddings:i,mode:s}=e,o=Ft().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BOe(r.shape,i,s):new $Oe(r.shape,i,s);return t.runWebGLProgram(o,[r],r.dtype)}},HOe=fa({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),WOe={kernelName:o0,backendName:"webgl",kernelFunc:HOe};class GOe{constructor(t,e,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}}const Nne=fa({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),jOe={kernelName:H_,backendName:"webgl",kernelFunc:Nne},Tne="return a - b;",Ane=fa({opSnippet:Tne,packedOpSnippet:Tne,supportsComplex:!0,cpuKernelImpl:CDe}),qOe={kernelName:x0,backendName:"webgl",kernelFunc:Ane};function Ine(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{dim:s}=r,o=Yr([s],i.shape),a=Ene({inputs:{x:i},backend:e,attrs:{reductionIndices:o,keepDims:!1}}),u=eo(a.shape,o),d=Pn({inputs:{x:a},backend:e,attrs:{shape:u}}),m=Ane({inputs:{a:i,b:d},backend:e}),y=_ne({inputs:{x:m},backend:e}),_=vF({inputs:{x:y},backend:e,attrs:{axis:o,keepDims:!1}}),E=Pn({inputs:{x:_},backend:e,attrs:{shape:u}}),D=Nne({inputs:{a:y,b:E},backend:e});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(_),e.disposeIntermediateTensorInfo(E),D}const ZOe={kernelName:_S,backendName:"webgl",kernelFunc:Ine},XOe={kernelName:R2,backendName:"webgl",kernelFunc:function KOe(n){const{inputs:t,backend:e,attrs:r}=n,{logits:i}=t,{numSamples:s,seed:o,normalized:a}=r,u=a?i:Ine({inputs:{logits:i},backend:e,attrs:{dim:i.shape.length-1}}),y=new GOe(u.shape[0],u.shape[1],s),E=e.runWebGLProgram(y,[u],"int32",[[o]]);return a||e.disposeIntermediateTensorInfo(u),E}},eFe={kernelName:nS,backendName:"webgl",kernelFunc:function JOe(n){const{inputs:t,backend:e}=n,{x:r}=t;if(e.shouldExecuteOnCPU([r])){const s=e.texData.get(r.dataId),[o,a]=iDe(s.values,r.shape,r.dtype);return e.makeTensorInfo(a,r.dtype,o)}let i;return i=Ft().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new um(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new Xh(r.shape,"if (isnan(x)) return x;\n  return -x;\n"),e.runWebGLProgram(i,[r],r.dtype)}},tFe=lO,rFe={kernelName:O2,backendName:"webgl",kernelFunc:function nFe(n){_l("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=r,d=e.readSync(i.dataId),m=e.readSync(s.dataId),{selectedIndices:y}=tFe(d,m,o,a,u);return e.makeTensorInfo([y.length],"int32",new Int32Array(y))}},iFe=cO,oFe={kernelName:F2,backendName:"webgl",kernelFunc:function sFe(n){_l("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:d}=r,m=e.readSync(i.dataId),y=e.readSync(s.dataId),{selectedIndices:_,validOutputs:E}=iFe(m,y,o,a,u,d);return[e.makeTensorInfo([_.length],"int32",new Int32Array(_)),e.makeTensorInfo([],"int32",new Int32Array([E]))]}},aFe=hO,lFe={kernelName:P2,backendName:"webgl",kernelFunc:function uFe(n){_l("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:r}=n,{boxes:i,scores:s}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:d}=r,m=e.readSync(i.dataId),y=e.readSync(s.dataId),_=o,E=a,D=u,O=d,{selectedIndices:R,selectedScores:$}=aFe(m,y,_,E,D,O);return[e.makeTensorInfo([R.length],"int32",new Int32Array(R)),e.makeTensorInfo([$.length],"float32",new Float32Array($))]}};class cFe{constructor(t,e,r,i){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${i}), float(${r}),\n                      float(index == coords.y)));\n      }\n    `}}const hFe={kernelName:sS,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{indices:i}=t,{dtype:s,depth:o,onValue:a,offValue:u}=r,d=Xt(i.shape),m=new cFe(d,o,a,u),y=Pn({inputs:{x:i},backend:e,attrs:{shape:[d]}}),_=e.runWebGLProgram(m,[y],s);e.disposeIntermediateTensorInfo(y);const D=Pn({inputs:{x:_},backend:e,attrs:{shape:[...i.shape,o]}});return e.disposeIntermediateTensorInfo(_),D}};function CF(n){const{inputs:t,backend:e}=n,{x:r}=t;if("complex64"===r.dtype){const i=FE({inputs:{input:r},backend:e}),s=CF({inputs:{x:i},backend:e}),o=wF({inputs:{input:r},backend:e}),a=CF({inputs:{x:o},backend:e}),u=lm({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),u}return LE({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:e})}const fFe={kernelName:CS,backendName:"webgl",kernelFunc:CF},dFe={kernelName:iS,backendName:"webgl",kernelFunc:function Dne(n){const{inputs:t,backend:e}=n,{x:r}=t;if("string"===r.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===r.dtype){const i=FE({inputs:{input:r},backend:e}),s=Dne({inputs:{x:i},backend:e}),o=wF({inputs:{input:r},backend:e}),a=CF({inputs:{x:o},backend:e}),u=lm({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(a),u}return LE({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:e})}},mFe={kernelName:oS,backendName:"webgl",kernelFunc:function pFe(n){const{inputs:t,backend:e,attrs:r}=n,{axis:i}=r;if(1===t.length)return $W({inputs:{input:t[0]},backend:e,attrs:{dim:i}});const s=t[0].shape,o=t[0].dtype;t.forEach(m=>{sa(s,m.shape,"All tensors passed to stack must have matching shapes"),De(o===m.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],d=une({inputs:t.map(m=>{const y=$W({inputs:{input:m},backend:e,attrs:{dim:i}});return a.push(y),y}),backend:e,attrs:{axis:i}});return a.forEach(m=>e.disposeIntermediateTensorInfo(m)),d}};class gFe{constructor(t,e,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((d,m)=>d[0]+t[m]+d[1]);const i=t.length,s=Ki(i),o=e.map(d=>d[0]).join(","),a=e.map((d,m)=>d[0]+t[m]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?`\n      ${s} start = ${s}(${o});\n      ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${s} coords = outC - start;\n          setOutput(getX(${u}));\n        }\n      }\n    `:`\n        int start = ${o};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class vFe{constructor(t,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((O,R)=>O[0]+t[R]+O[1]);const i=t.length,s=Ki(i),o=e.map(O=>O[0]).join(","),a=e.map((O,R)=>O[0]+t[R]).join(","),u=Ya("rc",i),d=Ya("source",i),m=`${u[i-1]} < ${this.outputShape[i-1]}`,y=1===i?"source":`vec2(${d.slice(-2).join()})`,_=[`${s} rc = outputLoc;`,`${u[i-1]} += 1;\n       if(${m}) {\n      `,1===i?"":`}\n       rc = outputLoc;\n       ${u[i-2]} += 1;\n       if(${u[i-2]} < ${this.outputShape[i-2]}) {`,1===i?"":`  ${u[i-1]} += 1;\n         if(${m}) {`],E=1===i?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let D="";for(let O=0,R=1===i?2:4;O<R;O++)D+=`\n        ${_[O]}\n        if (${E}) {\n          result[${O}] = float(value);\n        } else {\n          ${s} source = rc - start;\n          result[${O}] = getChannel(getX(${d.join()}), ${y});\n        }\n      `;D+=1===i?"} ":"}}",this.userCode=`\n      const ${s} start = ${s}(${o});\n      const ${s} end = ${s}(${a});\n\n      void main() {\n        ${s} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${D}\n        setOutput(result);\n      }\n    `}}const Mne=n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{paddings:s,constantValue:o}=r;if(0===Xt(i.shape))return LE({backend:e,attrs:{shape:s.map((m,y)=>m[0]+i.shape[y]+m[1]),value:o,dtype:i.dtype}});const a=Ft().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vFe(i.shape,s,o):new gFe(i.shape,s,o);return e.runWebGLProgram(a,[i],i.dtype,[[o]])},yFe={kernelName:aS,backendName:"webgl",kernelFunc:Mne},wFe=fa({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  \n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n\n  return result;\n"}),xFe={kernelName:u0,backendName:"webgl",kernelFunc:wFe},SFe={kernelName:lS,backendName:"webgl",kernelFunc:function CFe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{axis:s,keepDims:o}=r,a=i.shape.length,u=[],d=Yr(s,i.shape);let m=d;const y=ks(m,a);let E,_=i;if(null!=y&&(_=Qa({inputs:{x:i},backend:e,attrs:{perm:y}}),m=to(m.length,a),u.push(_)),ca("prod",m,a),e.shouldExecuteOnCPU([_])){const D=e.texData.get(_.dataId).values,{outVals:O,outShape:R,outDtype:$}=oDe(_.shape,_.dtype,D,m);E=e.makeTensorInfo(R,$,O)}else{const[D,O]=Ko(_.shape,m),R=Xt(O),$=Pn({inputs:{x:_},backend:e,attrs:{shape:[-1,R]}}),Q=Dv($,yR(i.dtype),"prod",e);E=Pn({inputs:{x:Q},backend:e,attrs:{shape:D}}),u.push($),u.push(Q)}if(o){u.push(E);const D=eo(E.shape,d);E=Pn({inputs:{x:E},backend:e,attrs:{shape:D}})}return u.forEach(D=>e.disposeIntermediateTensorInfo(D)),E}},NFe={kernelName:L2,backendName:"webgl",kernelFunc:function EFe(n){const{inputs:t,backend:e,attrs:r}=n,{paramsNestedSplits:i,paramsDenseValues:s,indices:o}=t,{outputRaggedRank:a}=r,u=i.map($=>e.readSync($.dataId)),d=i.map($=>$.shape),m=e.readSync(s.dataId),y=e.readSync(o.dataId),[_,E,D]=aDe(u,d,m,s.shape,s.dtype,y,o.shape,a),O=_.map($=>e.makeTensorInfo([$.length],"int32",$)),R=e.makeTensorInfo(D,s.dtype,E);return O.concat([R])}},AFe={kernelName:$2,backendName:"webgl",kernelFunc:function TFe(n){const{inputs:t,backend:e}=n,{starts:r,limits:i,deltas:s}=t,o=e.readSync(r.dataId),a=e.readSync(i.dataId),u=e.readSync(s.dataId),[d,m]=uDe(o,r.shape,r.dtype,a,i.shape,u,s.shape);return[e.makeTensorInfo([d.length],"int32",d),e.makeTensorInfo([m.length],r.dtype,m)]}},DFe={kernelName:B2,backendName:"webgl",kernelFunc:function IFe(n){const{inputs:t,backend:e,attrs:r}=n,{shape:i,values:s,defaultValue:o,rowPartitionTensors:a}=t,{rowPartitionTypes:u}=r,d=e.readSync(i.dataId),m=e.readSync(s.dataId),y=e.readSync(o.dataId),_=a.map(R=>e.readSync(R.dataId)),E=a.map(R=>R.shape),[D,O]=lDe(d,i.shape,m,s.shape,s.dtype,y,o.shape,_,E,u);return e.makeTensorInfo(D,s.dtype,O)}},kne=n=>{const{backend:t,attrs:e}=n,{start:r,stop:i,step:s,dtype:o}=e,a=cDe(r,i,s,o);return t.makeTensorInfo([a.length],o,a)},MFe={kernelName:V2,backendName:"webgl",kernelFunc:kne},kFe=_i({opSnippet:"return 1.0 / x;"}),RFe={kernelName:l0,backendName:"webgl",kernelFunc:kFe},FFe=_i({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),PFe={kernelName:c0,backendName:"webgl",kernelFunc:FFe},$Fe=_i({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),BFe={kernelName:h0,backendName:"webgl",kernelFunc:$Fe};class VFe{constructor(t,e,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,a,u,d]=t;this.outputShape=[o,e,r,d];const m=[i&&e>1?a-1:a,i&&r>1?u-1:u],y=[i&&e>1?e-1:e,i&&r>1?r-1:r];let _;_=s?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${m[0]/y[0]},\n          ${m[1]/y[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${_};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class zFe{constructor(t,e,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,d]=t;this.outputShape=[o,e,r,d];const m=[i&&e>1?a-1:a,i&&r>1?u-1:u],y=[i&&e>1?e-1:e,i&&r>1?r-1:r];let _;_=s?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${m[0]/y[0]},\n          ${m[1]/y[1]},\n          ${m[1]/y[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,\n                                     ${u}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${_};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${d-1};\n        bool hasNextRow = coords.z < ${r-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const HFe={kernelName:fS,backendName:"webgl",kernelFunc:function UFe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[u,d]=a,m=Ft().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new zFe(i.shape,u,d,s,o):new VFe(i.shape,u,d,s,o);return e.runWebGLProgram(m,[i],"float32")}};class WFe{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,i,s]=e,[,o,a]=t,u=[r&&o>1?i-1:i,r&&a>1?s-1:s],d=[r&&o>1?o-1:o,r&&a>1?a-1:a],m=u[0]/d[0],y=u[1]/d[1],_=1/m,E=1/y,D=2*Math.ceil(_)+2,O=2*Math.ceil(E)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${m});\n        const float widthScale = float(${y});\n\n        const float invHeightScale = float(${_});\n        const float invWidthScale = float(${E});\n\n        const int winHeight = int(${D});\n        const int winWidth = int(${O});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const jFe={kernelName:H2,backendName:"webgl",kernelFunc:function GFe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r,a=new WFe(s.shape,i.shape,o);return e.runWebGLProgram(a,[s],s.dtype)}};class qFe{constructor(t,e,r,i,s){this.variableNames=["A"],this.outputShape=[];const[o,a,u,d]=t;this.outputShape=[o,e,r,d];const m=[i&&e>1?a-1:a,i&&r>1?u-1:u],y=[i&&e>1?e-1:e,i&&r>1?r-1:r];let E;E=s?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${m[0]/y[0]},\n          ${m[1]/y[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${E};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${i?"0.5":"0.0"})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class ZFe{constructor(t,e,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,u,d]=t;this.outputShape=[o,e,r,d];const m=[i&&e>1?a-1:a,i&&r>1?u-1:u],y=[i&&e>1?e-1:e,i&&r>1?r-1:r];let E;E=s?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${m[0]/y[0]},\n          ${m[1]/y[1]},\n          ${m[1]/y[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,\n                                     ${u}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${E};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${i?"0.5":"0.0"})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${d-1};\n        bool hasNextRow = coords.z < ${r-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}const XFe={kernelName:hS,backendName:"webgl",kernelFunc:function KFe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i}=t,{alignCorners:s,halfPixelCenters:o,size:a}=r,[u,d]=a,m=Ft().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ZFe(i.shape,u,d,s,o):new qFe(i.shape,u,d,s,o);return e.runWebGLProgram(m,[i],i.dtype)}};class YFe{constructor(t,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,i,s]=e,[,o,a]=t,u=[r&&o>1?i-1:i,r&&a>1?s-1:s],d=[r&&o>1?o-1:o,r&&a>1?a-1:a],m=u[0]/d[0],y=u[1]/d[1],_=1/m,E=1/y,D=2*Math.ceil(_)+2,O=2*Math.ceil(E)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${m});\n        const float widthScale = float(${y});\n\n        const float invHeightScale = float(${_});\n        const float invWidthScale = float(${E});\n\n        const int winHeight = int(${D});\n        const int winWidth = int(${O});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${o}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${u[0]}) *\n                (float(dyR) / float(${d[0]}));\n\n            float sourceFracCol =\n                float(${u[1]}) *\n                  (float(dyC) / float(${d[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${i}) - 1),\n                ${r} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${s}) - 1),\n                ${r} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const JFe={kernelName:U2,backendName:"webgl",kernelFunc:function QFe(n){const{inputs:t,backend:e,attrs:r}=n,{images:i,dy:s}=t,{alignCorners:o}=r,a=new YFe(s.shape,i.shape,o);return e.runWebGLProgram(a,[s],s.dtype)}};class ePe{constructor(t,e){this.variableNames=["x"];const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=t,1===r)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const s=t.map((a,u)=>(a=>-1!==e.indexOf(a)&&1!==t[a]?`${t[a]} - coords[${a}] - 1`:`coords[${a}]`)(u)).join(","),o=Ki(r);this.userCode=`\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${s}));\n      }\n    `}}class tPe{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=t.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=t;const i=Ya("rc",r),s=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Ki(r);function _(D){const O=t.map((B,Q)=>function E(D,O){return-1!==e.indexOf(D)&&1!==t[D]?`${t[D]} - ${O[D]} - 1`:`${O[D]}`}(Q,D));return`getChannel(getX(${O.join(",")}), vec2(${O.slice(-2).join(",")}))`}this.userCode=1===r?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${s}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${a} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function u(D){return _(D)}(i.slice())};\n          if(${s}){\n            result.g = ${function d(D){return D[r-1]="("+D[r-1]+" + 1)",_(D)}(i.slice())};\n          }\n          if(${o}) {\n            result.b = ${function m(D){return D[r-2]="("+D[r-2]+" + 1)",_(D)}(i.slice())};\n            if(${s}) {\n              result.a = ${function y(D){return D[r-1]="("+D[r-1]+" + 1)",D[r-2]="("+D[r-2]+" + 1)",_(D)}(i.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const rPe={kernelName:dS,backendName:"webgl",kernelFunc:function nPe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{dims:s}=r,o=i.shape.length,a=Yr(s,i.shape);if(0===o)return Yu({inputs:{x:i},backend:e});const u=Ft().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tPe(i.shape,a):new ePe(i.shape,a);return e.runWebGLProgram(u,[i],i.dtype)}};class iPe{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=t[1],i=t[2];this.outputShape=t;let s="";s="number"==typeof e?`float outputValue = ${e.toFixed(2)};`:`\n        vec3 fill = vec3(${e.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${s}\n          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const sPe={kernelName:aR,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:r}=n,{radians:i,fillValue:s,center:o}=t,a=e,u=new iPe(r.shape,s),[d,m]=bH(o,r.shape[1],r.shape[2]),y=[[d,m,Math.sin(i),Math.cos(i)]];return a.runWebGLProgram(u,[r],r.dtype,y)}},oPe=_i({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),aPe={kernelName:f0,backendName:"webgl",kernelFunc:oPe},uPe=_i({opSnippet:"return inversesqrt(x);",cpuKernelImpl:hDe}),lPe={kernelName:d0,backendName:"webgl",kernelFunc:uPe};class VW{constructor(t,e,r,i,s,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const d=Ki(s.length),m=Ki(o.length);let y="";1===r?y="i":2===r&&(y="i, j");let E="";1===i?E="i":2===i&&(E="i, coords[1]");let O="";u&&(O="coords[0], coords[1]"),this.userCode=`\n        ${d} strides = ${d}(${s});\n\n        void main() {\n          ${m} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(getIndices(${y}));\n              flattenedIndex += index * ${e>1?"strides[j]":"strides"};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates(${E});\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(${O}), sum, float(found)));\n        }\n      `}}class cPe{constructor(t,e,r,i,s,o,a=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const d=Ki(s.length),m=Ki(o.length);let y="";1===r?y="i":2===r&&(y="i, j");let E="";1===i?E="i":2===i&&(E="i, coords[1]");let O="";u&&(O="coords[0], coords[1]"),this.userCode=`\n        ${d} strides = ${d}(${s});\n\n        void main() {\n          ${m} coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ${t}; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ${e}; j+=2) {\n              ivec4 index = round(getIndices(${y}));\n              flattenedIndex += index.xz * ${e>1?"strides[j]":"strides"};\n              if (j + 1 < ${e}) {\n                flattenedIndex += index.yw * ${e>1?"strides[j + 1]":"strides"};\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = getUpdates(${E});\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(getDefaultValue(${O}), sum, found));\n        }\n      `}}const fPe={kernelName:W2,backendName:"webgl",kernelFunc:function hPe(n){const{inputs:t,backend:e,attrs:r}=n,{indices:i,updates:s}=t,{shape:o}=r,{sliceRank:a,numUpdates:u,sliceSize:d,strides:m,outputSize:y}=Vp(0,i,o),_=[y/d,d];if(0===y)return e.makeTensorInfo(o,i.dtype);const E=Pn({inputs:{x:i},backend:e,attrs:{shape:[u,a]}}),D=Pn({inputs:{x:s},backend:e,attrs:{shape:[u,d]}}),O=e.makeTensorInfo([],"float32",new Float32Array([0]));let R;R=Ft().getBool("WEBGL_PACK")?new cPe(u,a,E.shape.length,D.shape.length,m,_):new VW(u,a,E.shape.length,D.shape.length,m,_);const $=e.runWebGLProgram(R,[D,E,O],D.dtype),B=Pn({inputs:{x:$},backend:e,attrs:{shape:o}});return e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(D),e.disposeIntermediateTensorInfo($),e.disposeIntermediateTensorInfo(O),B}};class dPe{constructor(t,e,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];const o=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,a=2===Ft().getNumber("WEBGL_VERSION")?"while (left < right) {":o;this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${a}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${"left"===i?"<":"<="} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}const mPe={kernelName:j2,backendName:"webgl",kernelFunc:function pPe(n){const{inputs:t,backend:e,attrs:r}=n,{sortedSequence:i,values:s}=t,{side:o}=r,a=new dPe(i.shape[0],i.shape[1],s.shape[1],o);return e.runWebGLProgram(a,[i,s],"int32",[[i.shape[1]]])}};class gPe{constructor(t,e,r){let i,s;if(this.variableNames=["c","a","b"],this.outputShape=e,r>4)throw Error(`Where for rank ${r} is not yet supported`);if(1===r)s="resRC",i="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],d=[];for(let m=0;m<e.length;m++)d.push(`${a[m]}`),m<t&&u.push(`${a[m]}`);i=u.join(),s=d.join()}const o=Ki(r);this.userCode=`\n      void main() {\n        ${o} resRC = getOutputCoords();\n        float cVal = getC(${i});\n        if (cVal >= 1.0) {\n          setOutput(getA(${s}));\n        } else {\n          setOutput(getB(${s}));\n        }\n      }\n    `}}const yPe={kernelName:pS,backendName:"webgl",kernelFunc:function vPe(n){const{inputs:t,backend:e}=n,{condition:r,t:i,e:s}=t,o=new gPe(r.shape.length,i.shape,i.shape.length);return e.runWebGLProgram(o,[r,i,s],pu(i.dtype,s.dtype))}},bPe=_i({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${dO};\n  float scale = ${pO};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),wPe={kernelName:p0,backendName:"webgl",kernelFunc:bPe},CPe=_i({opSnippet:"if (isnan(x)) return x;\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:dDe}),SPe={kernelName:y0,backendName:"webgl",kernelFunc:CPe},EPe=_i({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),NPe={kernelName:v0,backendName:"webgl",kernelFunc:EPe},IPe=_i({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n",packedOpSnippet:`\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ${Iv}\n  return result;\n`}),DPe={kernelName:m0,backendName:"webgl",kernelFunc:IPe},MPe=_i({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),kPe={kernelName:g0,backendName:"webgl",kernelFunc:MPe},RPe=_i({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),OPe={kernelName:_0,backendName:"webgl",kernelFunc:RPe},FPe={kernelName:vS,backendName:"webgl",kernelFunc:n=>{const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{blockShape:s,paddings:o}=r;De(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=s.reduce(($,B)=>$*B),u=[[0,0]];u.push(...o);for(let $=1+s.length;$<i.shape.length;++$)u.push([0,0]);const d=[],m=Mne({inputs:{x:i},backend:e,attrs:{paddings:u,constantValue:0}}),y=nE(m.shape,s,a,!1),_=rE(y.length,s.length,!1),E=iE(m.shape,s,a,!1),D=Pn({inputs:{x:m},backend:e,attrs:{shape:y}}),O=Qa({inputs:{x:D},backend:e,attrs:{perm:_}}),R=Pn({inputs:{x:O},backend:e,attrs:{shape:E}});return d.push(m),d.push(D),d.push(O),d.forEach($=>e.disposeIntermediateTensorInfo($)),R}},LPe={kernelName:q2,backendName:"webgl",kernelFunc:function PPe(n){const{inputs:t,backend:e}=n,{indices:r,values:i,denseShape:s,defaultValue:o}=t;if(1!==s.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${s.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n         ${i.shape}`);if(0!==o.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${o.shape}`);const a=e.readSync(r.dataId),u=e.readSync(i.dataId),d=e.readSync(s.dataId),m=e.readSync(o.dataId)[0],[y,_,E,D,O]=mDe(a,r.shape,r.dtype,u,i.dtype,d,m);return[e.makeTensorInfo(_,r.dtype,y),e.makeTensorInfo([_[0]],i.dtype,E),e.makeTensorInfo([D.length],"bool",new Uint8Array(D.map(R=>Number(R)))),e.makeTensorInfo([O.length],r.dtype,new Int32Array(O))]}},BPe={kernelName:Z2,backendName:"webgl",kernelFunc:function $Pe(n){const{inputs:t,backend:e}=n,{inputIndices:r,inputShape:i,newShape:s}=t;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(1!==s.shape.length)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(e.readSync(i.dataId)),a=e.readSync(r.dataId),u=Array.from(e.readSync(s.dataId)),[d,m,y]=gDe(a,r.shape,r.dtype,o,u);return[e.makeTensorInfo(m,r.dtype,d),e.makeTensorInfo([y.length],s.dtype,new Int32Array(y))]}},zPe={kernelName:K2,backendName:"webgl",kernelFunc:function VPe(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${s.shape}`);const o=e.readSync(r.dataId),a=e.readSync(i.dataId),u=e.readSync(s.dataId),[d,m]=Ote(o,r.shape,r.dtype,a,u,!0);return e.makeTensorInfo(m,r.dtype,d)}},HPe={kernelName:X2,backendName:"webgl",kernelFunc:function UPe(n){const{inputs:t,backend:e}=n,{data:r,indices:i,segmentIds:s}=t;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${i.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${s.shape}`);const o=e.readSync(r.dataId),a=e.readSync(i.dataId),u=e.readSync(s.dataId),[d,m]=Ote(o,r.shape,r.dtype,a,u);return e.makeTensorInfo(m,r.dtype,d)}},GPe={kernelName:Y2,backendName:"webgl",kernelFunc:function WPe(n){const{inputs:t,backend:e,attrs:r}=n,{sparseIndices:i,sparseValues:s,defaultValue:o}=t,{outputShape:a}=r,{sliceRank:u,numUpdates:d,sliceSize:m,strides:y,outputSize:_}=Vp(0,i,a);if("string"===s.dtype){const $=e.bufferSync(i),B=e.bufferSync(s),Q=Qf(e.readSync(o.dataId)[0]),ie=fDe($,B,a,_,m,d,u,y,Q,!1);return e.makeTensorInfo(a,ie.dtype,ie.values)}const D=new VW(d,u,i.shape.length,s.shape.length,y,[_,1],!1),O=e.runWebGLProgram(D,[s,i,o],s.dtype),R=Pn({inputs:{x:O},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(O),R}},qPe={kernelName:yS,backendName:"webgl",kernelFunc:function jPe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{numOrSizeSplits:s,axis:o}=r,a=Yr(o,i.shape)[0],u=PH(i,s,a),m=new Array(i.shape.length).fill(0),y=i.shape.slice();return u.map(_=>{const E=[...y];E[a]=_;const D=db({inputs:{x:i},backend:e,attrs:{begin:m,size:E}});return m[a]+=_,D})}},Rne="return sqrt(x);",ZPe=_i({opSnippet:Rne,packedOpSnippet:Rne,cpuKernelImpl:vDe}),KPe={kernelName:b0,backendName:"webgl",kernelFunc:ZPe},XPe=_i({opSnippet:"return x * x;"}),YPe={kernelName:Q2,backendName:"webgl",kernelFunc:XPe},One="return (a - b) * (a - b);",QPe=fa({opSnippet:One,packedOpSnippet:One}),JPe={kernelName:w0,backendName:"webgl",kernelFunc:QPe},tLe={kernelName:bS,backendName:"webgl",kernelFunc:function eLe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t;if("string"!==i.dtype)throw new Error("Input must be of datatype string");const o=cd(e.readSync(i.dataId)),a=yDe(o,"string",r);return e.makeTensorInfo(i.shape,"string",a)}},rLe={kernelName:N0,backendName:"webgl",kernelFunc:function nLe({inputs:n,attrs:t,backend:e}){const{x:r}=n,s=new Xh(r.shape,`if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float(${t.alpha});\n  `);return e.runWebGLProgram(s,[r],r.dtype)}};class iLe{constructor(t,e,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,s=Ki(r.length),o=Ki(r.length);let a="";if(1===i)a="coords * strides + begin";else{let u=0;a=r.map((d,m)=>(u++,1===r.length?`coords * strides[${m}] + begin[${m}]`:`coords[${u-1}] * strides[${m}] + begin[${m}]`)).join(",")}this.userCode=`\n      ${s} begin = ${s}(${t});\n      ${s} strides = ${s}(${e});\n\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${a}));\n      }\n    `}}const oLe={kernelName:J2,backendName:"webgl",kernelFunc:function sLe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{begin:s,end:o,strides:a,beginMask:u,endMask:d,ellipsisMask:m,newAxisMask:y,shrinkAxisMask:_}=r,{finalShapeSparse:E,finalShape:D,isIdentity:O,sliceDim0:R,isSimpleSlice:$,begin:B,end:Q,strides:ie}=e5(i.shape,s,o,a,u,d,m,y,_);let ye;if(O)ye=Pn({inputs:{x:i},backend:e,attrs:{shape:D}});else if(R||$){De(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const Be=YU(B,Q,ie),He=db({inputs:{x:i},backend:e,attrs:{begin:B,size:Be}});ye=Pn({inputs:{x:He},backend:e,attrs:{shape:D}}),e.disposeIntermediateTensorInfo(He)}else if(e.shouldExecuteOnCPU([i])){const He=e.readSync(i.dataId),st=Zr(i.shape,i.dtype,He),lt=_De(E,st,ie,B);ye=e.makeTensorInfo(D,i.dtype,lt.values)}else{const He=new iLe(B,ie,E);ye=e.runWebGLProgram(He,[i],i.dtype)}const Me=Pn({inputs:{x:ye},backend:e,attrs:{shape:D}});return e.disposeIntermediateTensorInfo(ye),Me}},uLe={kernelName:eR,backendName:"webgl",kernelFunc:function aLe(n){const{inputs:t,backend:e,attrs:r}=n,{separator:i,nGramWidths:s,leftPad:o,rightPad:a,padWidth:u,preserveShortSequences:d}=r,{data:m,dataSplits:y}=t,_=e.readSync(m.dataId),E=e.readSync(y.dataId),[D,O]=bDe(_,E,i,s,o,a,u,d);return[e.makeTensorInfo([D.length],"string",D),e.makeTensorInfo(y.shape,"int32",O)]}},cLe={kernelName:tR,backendName:"webgl",kernelFunc:function lLe(n){const{inputs:t,backend:e,attrs:r}=n,{skipEmpty:i}=r,{input:s,delimiter:o}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(0!==o.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=e.readSync(s.dataId),u=e.readSync(o.dataId)[0],[d,m,y]=wDe(a,u,i),_=m.length;return[e.makeTensorInfo([_,2],"int32",d),e.makeTensorInfo([_],"string",m),e.makeTensorInfo([2],"int32",new Int32Array(y))]}},fLe={kernelName:nR,backendName:"webgl",kernelFunc:function hLe(n){const{inputs:t,backend:e,attrs:r}=n,{numBuckets:i}=r,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=e.readSync(s.dataId),a=xDe(o,i);return e.makeTensorInfo(s.shape,"int32",a)}},dLe=_i({opSnippet:"return tan(x);"}),pLe={kernelName:C0,backendName:"webgl",kernelFunc:dLe},mLe=_i({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),gLe={kernelName:S0,backendName:"webgl",kernelFunc:mLe},yLe={kernelName:G2,backendName:"webgl",kernelFunc:function vLe(n){const{inputs:t,backend:e}=n,{tensor:i,indices:s,updates:o}=t,{sliceRank:a,numUpdates:u,sliceSize:d,strides:m,outputSize:y}=Vp(0,s,i.shape),_=[y/d,d];if(0===y)return e.makeTensorInfo(i.shape,s.dtype);const E=Pn({inputs:{x:s},backend:e,attrs:{shape:[u,a]}}),D=Pn({inputs:{x:o},backend:e,attrs:{shape:[u,d]}}),O=Pn({inputs:{x:i},backend:e,attrs:{shape:_}}),R=new VW(u,a,E.shape.length,D.shape.length,m,_,!1,!0),$=e.runWebGLProgram(R,[D,E,O],O.dtype),B=Pn({inputs:{x:$},backend:e,attrs:{shape:i.shape}});return e.disposeIntermediateTensorInfo(E),e.disposeIntermediateTensorInfo(D),e.disposeIntermediateTensorInfo(O),e.disposeIntermediateTensorInfo($),B}};class _Le{constructor(t,e){this.variableNames=["A"];const r=new Array(t.length);for(let o=0;o<r.length;o++)r[o]=t[o]*e[o];this.outputShape=r,this.rank=r.length;const i=Ki(this.rank),s=function bLe(n){const t=n.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${n[0]})`;const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<n.length;i++)r.push(`imod(${e[i]}, ${n[i]})`);return r.join()}(t);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        setOutput(getA(${s}));\n      }\n    `}}function Fne(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{reps:s}=r;if("string"===i.dtype||i.shape.length>5){const u=e.readSync(i.dataId),d="string"===i.dtype?u.map(_=>Qf(_)):u,m=Zr(i.shape,i.dtype,d),y=SDe(m,s);return e.makeTensorInfo(y.shape,y.dtype,y.values)}const o=new _Le(i.shape,s);return e.runWebGLProgram(o,[i],i.dtype)}const wLe={kernelName:E0,backendName:"webgl",kernelFunc:Fne};class xLe{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class CLe{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function Mv(n,t){null!==t&&n.disposeIntermediateTensorInfo(t)}function Pne(n){let t=1;for(;t<n;)t*=2;return t}const ELe={kernelName:rR,backendName:"webgl",kernelFunc:function SLe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i}=t,{k:s,sorted:o}=r,a=Ft().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=Ft().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),d=i.shape,m=d[d.length-1];if(e.shouldExecuteOnCPU([i])||m<a||s>u){const lt=e.readSync(i.dataId),[It,zt]=EDe(lt,d,i.dtype,s,o);return[e.makeTensorInfo(It.shape,It.dtype,It.values),e.makeTensorInfo(zt.shape,zt.dtype,zt.values)]}if(0===s)return d[d.length-1]=0,[e.makeTensorInfo(d,i.dtype,[]),e.makeTensorInfo(d,"int32",[])];if(1===m)return[i,LE({attrs:{shape:d,dtype:"int32",value:0},backend:e})];const y=e.texData.get(i.dataId),_=null!==y&&y.isPacked,E=_?e.unpackTensor(i):i,O=Xt(d)/m,R=Pn({inputs:{x:E},attrs:{shape:[O,m]},backend:e});_&&Mv(e,E);const $=Pne(s),B=Pne(m);let Q=null;const ie=()=>null===Q?[R,R]:[R,Q],ye=(lt,It,zt)=>{const Wt=ie(),qt=new xLe(zt),Rt=Q;Q=e.runWebGLProgram(qt,Wt,"int32",[[m],[null===Q?1:0],[Number.NEGATIVE_INFINITY],[lt],[It]]),Mv(e,Rt)};for(let lt=1;lt<$;lt*=2){const It=2*lt;for(let zt=lt;zt>=1;zt/=2)ye(It,zt,[O,B])}for(let lt=B;lt>$;lt/=2){const It=ie(),zt=new CLe([O,lt/2]),Kt=Q;Q=e.runWebGLProgram(zt,It,"int32",[[m],[null===Q?1:0],[$]]),Mv(e,Kt);const Tt=$/2,Rt=2*Tt;for(let Dt=Tt;Dt>=1;Dt/=2)ye(Rt,Dt,Q.shape)}let Me=Q;Q=db({inputs:{x:Q},backend:e,attrs:{begin:0,size:[O,s]}}),Mv(e,Me);let Be=Sne({inputs:{x:R,indices:Q},backend:e,attrs:{axis:1,batchDims:1}});Mv(e,R);const He=d.slice(0,-1);He.push(s),Me=Q,Q=Pn({inputs:{x:Q},attrs:{shape:He},backend:e}),Mv(e,Me);const st=Be;return Be=Pn({inputs:{x:Be},attrs:{shape:He},backend:e}),Mv(e,st),[Be,Q]}};class NLe{constructor(t,e,r,i,s,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a="nearest"===r?1:2;let u;switch(i){case"constant":default:u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${u} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${u} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${u} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${s});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${s});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${e}));\n                float mapY = mapCoord(inY, float(${t}));\n\n                if (${a} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}const ALe={kernelName:iR,backendName:"webgl",kernelFunc:function TLe(n){const{inputs:t,backend:e,attrs:r}=n,{image:i,transforms:s}=t,{interpolation:o,fillMode:a,fillValue:u,outputShape:d}=r,[m,y,_,E]=i.shape,[D,O]=null!=d?d:[y,_],$=new NLe(y,_,o,a,u,[m,D,O,E]);return e.runWebGLProgram($,[i,s],"float32")}},DLe={kernelName:sR,backendName:"webgl",kernelFunc:function ILe(n){const{inputs:t,attrs:e,backend:r}=n,{axis:i}=e,{x:s}=t;ob(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(s.dataId),{outputValues:a,outputShape:u,indices:d}=NDe(o,i,s.shape,s.dtype);return[r.makeTensorInfo(u,s.dtype,a),r.makeTensorInfo([d.length],"int32",d)]}},kLe={kernelName:wS,backendName:"webgl",kernelFunc:function MLe(n){const{inputs:t,backend:e,attrs:r}=n,{value:i}=t;let{axis:s}=r;s<0&&(s+=i.shape.length);const o=i,a=o.shape.length,u=i.shape[s],d=new Array(a-1);let m=0;for(let O=0;O<a;O++)O!==s&&(d[m++]=o.shape[O]);const y=[],_=new Array(a).fill(0),E=o.shape.slice();E[s]=1;const D=new Array(u);for(let O=0;O<D.length;O++){_[s]=O;const R=db({inputs:{x:o},backend:e,attrs:{begin:_,size:E}}),$=Pn({inputs:{x:R},backend:e,attrs:{shape:d}});D[O]=$,y.push(R)}return y.forEach(O=>e.disposeIntermediateTensorInfo(O)),D}};class RLe{constructor(t,e){this.variableNames=["x","segmentIds"];const r=t.windowSize,i=t.batchSize,s=t.inSize,o=t.numSegments,a=o*Math.ceil(s/r);this.outputShape=[i,a];const m=4*Math.floor(r/4),y=r%4,_="\n        sumValue += dot(values, segFilter);\n    ";let E="";s%r>0&&(E=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return initializationValue;\n        }\n      `);let D="";s%r>0&&(D=`\n        if (inIdx < 0 || inIdx >= ${s}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${E}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${D}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${o})) * float(${r}));\n        int currentSeg = int(mod(float(outIdx), float(${o})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${m}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${_}\n        }\n\n        int inIdx = inOffset + ${m};\n        if (${1===y}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${_}\n        } else if (${2===y}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${_}\n        } else if (${3===y}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${_}\n        }\n        setOutput(sumValue);\n      }\n    `}}const PLe=[yMe,bMe,CMe,NMe,AMe,MMe,RMe,FMe,BMe,zMe,WMe,qMe,XMe,eke,rke,ske,ake,hke,dke,mke,yke,Ske,Nke,Ake,Rke,Fke,Bke,tMe,Uke,qke,Yke,r2e,o2e,u2e,c2e,f2e,g2e,y2e,b2e,x2e,S2e,N2e,I2e,M2e,F2e,L2e,V2e,H2e,G2e,q2e,X2e,Q2e,tRe,rRe,iRe,oRe,uRe,cRe,fRe,pRe,gRe,_Re,xRe,SRe,TRe,DRe,kRe,ORe,eMe,PRe,Gke,$Re,VRe,URe,rMe,WRe,jRe,ZRe,YRe,eOe,nOe,iOe,oOe,lOe,hOe,dOe,vOe,_Oe,wOe,EOe,TOe,IOe,MOe,ROe,LOe,VOe,WOe,XOe,oMe,eFe,rFe,oFe,lFe,Ike,hFe,dFe,mFe,yFe,xFe,sMe,SFe,NFe,AFe,DFe,MFe,Dke,jOe,RFe,PFe,BFe,uMe,HFe,jFe,XFe,JFe,rPe,sPe,aPe,lPe,fPe,mPe,yPe,wPe,SPe,NPe,DPe,kPe,Cke,ZOe,OPe,FPe,LPe,BPe,zPe,HPe,GPe,qPe,KPe,YPe,JPe,tLe,rLe,oLe,uLe,cLe,fLe,qOe,mMe,pLe,gLe,yLe,wLe,ELe,ALe,gMe,DLe,kLe,{kernelName:xS,backendName:"webgl",kernelFunc:function OLe(n){const{inputs:t,backend:e,attrs:r}=n,{x:i,segmentIds:s}=t,{numSegments:o}=r,a=i.shape.length,u=[];let d=0;const m=ks([d],a);let y=i;null!=m&&(y=Qa({inputs:{x:i},backend:e,attrs:{perm:m}}),u.push(y),d=to(1,a)[0]);const _=sX(y.shape,d,o),E=Xt([y.shape[d]]),D=Pn({inputs:{x:y},backend:e,attrs:{shape:[-1,E]}});u.push(D);const O=yR(i.dtype),R=(ie,ye,Me,Be,He)=>{const st=ie.shape[0],lt=ie.shape[1],It=iX(lt,He),Wt=new RLe({windowSize:It,inSize:lt,batchSize:st,numSegments:He},ye),qt=e.compileAndRun(Wt,[ie,Me],Be);if(u.push(qt),qt.shape[1]===He)return qt;const Kt=kne({backend:e,attrs:{start:0,stop:He,step:1,dtype:"float32"}}),Tt=Fne({inputs:{x:Kt},backend:e,attrs:{reps:[lt/It]}});return u.push(Kt),u.push(Tt),R(qt,ye,Tt,Be,He)},B=Pn({inputs:{x:R(D,"unsortedSegmentSum",s,O,o)},backend:e,attrs:{shape:_}});let Q=B;if(null!=m){u.push(B);const ie=Hp(m);Q=Qa({inputs:{x:Q},backend:e,attrs:{perm:ie}})}return u.forEach(ie=>e.disposeIntermediateTensorInfo(ie)),Q}},fFe];for(const n of PLe)cR(n);const $Le={"tfjs-core":kZ,"tfjs-backend-cpu":_ee,"tfjs-backend-webgl":Ute,"tfjs-data":bJ,"tfjs-layers":OO,"tfjs-converter":eJ,tfjs:"4.4.0"};var vc=z(8407);const{isArray:BLe}=Array,{getPrototypeOf:VLe,prototype:zLe,keys:ULe}=Object;function Lne(n){if(1===n.length){const t=n[0];if(BLe(t))return{args:t,keys:null};if(function HLe(n){return n&&"object"==typeof n&&VLe(n)===zLe}(t)){const e=ULe(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}function $ne(n,t){return n.reduce((e,r,i)=>(e[r]=t[i],e),{})}function Bne(...n){const t=cf(n),{args:e,keys:r}=Lne(n),i=new $i(s=>{const{length:o}=e;if(!o)return void s.complete();const a=new Array(o);let u=o,d=o;for(let m=0;m<o;m++){let y=!1;ro(e[m]).subscribe(Bn(s,_=>{y||(y=!0,d--),a[m]=_},()=>u--,void 0,()=>{(!u||!y)&&(d||s.next(r?$ne(r,a):a),s.complete())}))}});return t?i.pipe(W4(t)):i}let Vne=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(nn(Mf),nn(As))},n.\u0275dir=sr({type:n}),n})(),kv=(()=>{class n extends Vne{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Bo(n)))(r||n)}}(),n.\u0275dir=sr({type:n,features:[oi]}),n})();const Yh=new Qn("NgValueAccessor"),GLe={provide:Yh,useExisting:Di(()=>SF),multi:!0},qLe=new Qn("CompositionEventMode");let SF=(()=>{class n extends Vne{constructor(e,r,i){super(e,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function jLe(){const n=rc()?rc().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(nn(Mf),nn(As),nn(qLe,8))},n.\u0275dir=sr({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&Vs("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[Hi([GLe]),oi]}),n})();function cm(n){return null==n||0===n.length}function Une(n){return null!=n&&"number"==typeof n.length}const Ja=new Qn("NgValidators"),hm=new Qn("NgAsyncValidators"),ZLe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class $E{static min(t){return function Hne(n){return t=>{if(cm(t.value)||cm(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function Wne(n){return t=>{if(cm(t.value)||cm(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return function Gne(n){return cm(n.value)?{required:!0}:null}(t)}static requiredTrue(t){return function jne(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function qne(n){return cm(n.value)||ZLe.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function Zne(n){return t=>cm(t.value)||!Une(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function Kne(n){return t=>Une(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static pattern(t){return function Xne(n){if(!n)return EF;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(cm(r.value))return null;const i=r.value;return t.test(i)?null:{pattern:{requiredPattern:e,actualValue:i}}}}(t)}static nullValidator(t){return null}static compose(t){return nre(t)}static composeAsync(t){return rre(t)}}function EF(n){return null}function Yne(n){return null!=n}function Qne(n){const t=Fc(n)?Cc(n):n;return oI(t),t}function Jne(n){let t={};return n.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function ere(n,t){return t.map(e=>e(n))}function tre(n){return n.map(t=>function KLe(n){return!n.validate}(t)?t:e=>t.validate(e))}function nre(n){if(!n)return null;const t=n.filter(Yne);return 0==t.length?null:function(e){return Jne(ere(e,t))}}function zW(n){return null!=n?nre(tre(n)):null}function rre(n){if(!n)return null;const t=n.filter(Yne);return 0==t.length?null:function(e){return Bne(ere(e,t).map(Qne)).pipe(qs(Jne))}}function UW(n){return null!=n?rre(tre(n)):null}function ire(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function sre(n){return n._rawValidators}function ore(n){return n._rawAsyncValidators}function HW(n){return n?Array.isArray(n)?n:[n]:[]}function NF(n,t){return Array.isArray(n)?n.includes(t):n===t}function are(n,t){const e=HW(t);return HW(n).forEach(i=>{NF(e,i)||e.push(i)}),e}function ure(n,t){return HW(t).filter(e=>!NF(n,e))}class lre{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=zW(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=UW(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class gd extends lre{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class xu extends lre{get formDirective(){return null}get path(){return null}}class cre{constructor(t){this._cd=t}is(t){var e,r,i;return"submitted"===t?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(i=null===(r=this._cd)||void 0===r?void 0:r.control)||void 0===i?void 0:i[t])}}let hre=(()=>{class n extends cre{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(nn(gd,2))},n.\u0275dir=sr({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&Ua("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))},features:[oi]}),n})(),fre=(()=>{class n extends cre{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(nn(xu,10))},n.\u0275dir=sr({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&Ua("ng-untouched",r.is("untouched"))("ng-touched",r.is("touched"))("ng-pristine",r.is("pristine"))("ng-dirty",r.is("dirty"))("ng-valid",r.is("valid"))("ng-invalid",r.is("invalid"))("ng-pending",r.is("pending"))("ng-submitted",r.is("submitted"))},features:[oi]}),n})();function BE(n,t){jW(n,t),t.valueAccessor.writeValue(n.value),function r$e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&pre(n,t)})}(n,t),function s$e(n,t){const e=(r,i)=>{t.valueAccessor.writeValue(r),i&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function i$e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&pre(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function n$e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function IF(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),MF(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function DF(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function jW(n,t){const e=sre(n);null!==t.validator?n.setValidators(ire(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=ore(n);null!==t.asyncValidator?n.setAsyncValidators(ire(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();DF(t._rawValidators,i),DF(t._rawAsyncValidators,i)}function MF(n,t){let e=!1;if(null!==n){if(null!==t.validator){const i=sre(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==t.validator);s.length!==i.length&&(e=!0,n.setValidators(s))}}if(null!==t.asyncValidator){const i=ore(n);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==t.asyncValidator);s.length!==i.length&&(e=!0,n.setAsyncValidators(s))}}}const r=()=>{};return DF(t._rawValidators,r),DF(t._rawAsyncValidators,r),e}function pre(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function mre(n,t){jW(n,t)}function vre(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function KW(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const VE="VALID",kF="INVALID",gb="PENDING",zE="DISABLED";function YW(n){return(RF(n)?n.validators:n)||null}function yre(n){return Array.isArray(n)?zW(n):n||null}function QW(n,t){return(RF(t)?t.asyncValidators:n)||null}function _re(n){return Array.isArray(n)?UW(n):n||null}function RF(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const bre=n=>n instanceof UE,JW=n=>n instanceof OF;function wre(n){return bre(n)?n.value:n.getRawValue()}function xre(n,t){const e=JW(n),r=n.controls;if(!(e?Object.keys(r):r).length)throw new jn(1e3,"");if(!r[t])throw new jn(1001,"")}function Cre(n,t){JW(n),n._forEachChild((r,i)=>{if(void 0===t[i])throw new jn(1002,"")})}class e8{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=yre(this._rawValidators),this._composedAsyncValidatorFn=_re(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===VE}get invalid(){return this.status===kF}get pending(){return this.status==gb}get disabled(){return this.status===zE}get enabled(){return this.status!==zE}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=yre(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=_re(t)}addValidators(t){this.setValidators(are(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(are(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(ure(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(ure(t,this._rawAsyncValidators))}hasValidator(t){return NF(this._rawValidators,t)}hasAsyncValidator(t){return NF(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=gb,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=zE,this.errors=null,this._forEachChild(r=>{r.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=VE,this._forEachChild(r=>{r.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===VE||this.status===gb)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?zE:VE}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=gb,this._hasOwnPendingAsyncValidator=!0;const e=Qne(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function l$e(n,t,e){if(null==t||(Array.isArray(t)||(t=t.split(e)),Array.isArray(t)&&0===t.length))return null;let r=n;return t.forEach(i=>{r=JW(r)?r.controls.hasOwnProperty(i)?r.controls[i]:null:(n=>n instanceof h$e)(r)&&r.at(i)||null}),r}(this,t,".")}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new ho,this.statusChanges=new ho}_calculateStatus(){return this._allControlsDisabled()?zE:this.errors?kF:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(gb)?gb:this._anyControlsHaveStatus(kF)?kF:VE}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){RF(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class UE extends e8{constructor(t=null,e,r){super(YW(e),QW(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),RF(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){KW(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){KW(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class OF extends e8{constructor(t,e,r){super(YW(e),QW(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){Cre(this,t),Object.keys(t).forEach(r=>{xre(this,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{this.controls[r]&&this.controls[r].patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,i)=>{r.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=wre(e),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const r=this.controls[e];if(this.contains(e)&&t(r))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,r)=>((e.enabled||this.disabled)&&(t[r]=e.value),t))}_reduceChildren(t,e){let r=t;return this._forEachChild((i,s)=>{r=e(r,i,s)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class h$e extends e8{constructor(t,e,r){super(YW(e),QW(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){Cre(this,t),t.forEach((r,i)=>{xre(this,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,i)=>{r.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>wre(t))}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const f$e={provide:xu,useExisting:Di(()=>FF)},HE=(()=>Promise.resolve(null))();let FF=(()=>{class n extends xu{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new ho,this.form=new OF({},zW(e),UW(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){HE.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),BE(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){HE.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){HE.then(()=>{const r=this._findContainer(e.path),i=new OF({});mre(i,e),r.registerControl(e.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){HE.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){HE.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,vre(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(nn(Ja,10),nn(hm,10))},n.\u0275dir=sr({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&Vs("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Hi([f$e]),oi]}),n})(),Are=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=sr({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const m$e={provide:Yh,useExisting:Di(()=>t8),multi:!0};let t8=(()=>{class n extends kv{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Bo(n)))(r||n)}}(),n.\u0275dir=sr({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,r){1&e&&Vs("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[Hi([m$e]),oi]}),n})(),Ire=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({}),n})();const n8=new Qn("NgModelWithFormControlWarning"),b$e={provide:xu,useExisting:Di(()=>WE)};let WE=(()=>{class n extends xu{constructor(e,r){super(),this.validators=e,this.asyncValidators=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ho,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(MF(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return BE(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){IF(e.control||null,e,!1),KW(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,vre(this.form,this.directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,i=this.form.get(e.path);r!==i&&(IF(r||null,e),bre(i)&&(BE(i,e),e.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);mre(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function o$e(n,t){return MF(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){jW(this.form,this),this._oldForm&&MF(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(nn(Ja,10),nn(hm,10))},n.\u0275dir=sr({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&Vs("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Hi([b$e]),oi,Hl]}),n})();const C$e={provide:gd,useExisting:Di(()=>s8)};let s8=(()=>{class n extends gd{constructor(e,r,i,s,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new ho,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function ZW(n,t){if(!t)return null;let e,r,i;return Array.isArray(t),t.forEach(s=>{s.constructor===SF?e=s:function u$e(n){return Object.getPrototypeOf(n.constructor)===kv}(s)?r=s:i=s}),i||r||e||null}(0,s)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),function qW(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return function AF(n,t){return[...t.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(nn(xu,13),nn(Ja,10),nn(hm,10),nn(Yh,10),nn(n8,8))},n.\u0275dir=sr({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Hi([C$e]),oi,Hl]}),n})(),Gre=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[Ire]]}),n})(),B$e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[Gre]}),n})(),V$e=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:n8,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[Gre]}),n})();var GE=(()=>{return(n=GE||(GE={}))[n.Complete=0]="Complete",n[n.Progess=1]="Progess",n[n.Error=2]="Error",GE;var n})(),z$e=z(8660);let U$e=(()=>{class n{constructor(){this.Message="",this.messageTimeout=null}LogMessage(e,r=!1){this.clearMessageTimeout(),this.Message=e,r&&(this.messageTimeout=setTimeout(this.clearMessage,3e3))}clearMessageTimeout(){null!=this.messageTimeout&&(clearTimeout(this.messageTimeout),this.messageTimeout=null)}clearMessage(){this.Message=""}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function l8(n,t,e){const r=pt(n)||t||e?{next:n,error:t,complete:e}:n;return r?Pi((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(Bn(s,u=>{var d;null===(d=r.next)||void 0===d||d.call(r,u),s.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),s.complete()},u=>{var d;a=!1,null===(d=r.error)||void 0===d||d.call(r,u),s.error(u)},()=>{var u,d;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(d=r.finalize)||void 0===d||d.call(r)}))}):ko}function jre(n){return Pi((t,e)=>{let s,r=null,i=!1;r=t.subscribe(Bn(e,void 0,void 0,o=>{s=ro(n(o,jre(n)(t))),r?(r.unsubscribe(),r=null,s.subscribe(e)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(e))})}class j$e{}class fm{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const i=e.slice(0,r),s=i.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(i,r),this.maybeSetNormalizedName(e,i))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof fm?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new fm;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof fm?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const i=("a"===t.op?this.headers.get(e):void 0)||[];i.push(...r),this.headers.set(e,i);break;case"d":const s=t.value;if(s){let o=this.headers.get(e);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class q$e{encodeKey(t){return qre(t)}encodeValue(t){return qre(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const K$e=/%(\d[a-f0-9])/gi,X$e={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function qre(n){return encodeURIComponent(n).replace(K$e,(t,e)=>{var r;return null!==(r=X$e[e])&&void 0!==r?r:t})}function Zre(n){return`${n}`}class dm{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new q$e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Z$e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[t.decodeKey(i),""]:[t.decodeKey(i.slice(0,s)),t.decodeValue(i.slice(s+1))],u=e.get(o)||[];u.push(a),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e];this.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const i=t[r];Array.isArray(i)?i.forEach(s=>{e.push({param:r,value:s,op:"a"})}):e.push({param:r,value:i,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new dm({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Zre(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const i=r.indexOf(Zre(t.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Y$e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function Kre(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function Xre(n){return"undefined"!=typeof Blob&&n instanceof Blob}function Yre(n){return"undefined"!=typeof FormData&&n instanceof FormData}class jE{constructor(t,e,r,i){let s;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function Q$e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new fm),this.context||(this.context=new Y$e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const a=e.indexOf("?");this.urlWithParams=e+(-1===a?"?":a<e.length-1?"&":"")+o}}else this.params=new dm,this.urlWithParams=e}serializeBody(){return null===this.body?null:Kre(this.body)||Xre(this.body)||Yre(this.body)||function J$e(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof dm?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Yre(this.body)?null:Xre(this.body)?this.body.type||null:Kre(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof dm?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var e;const r=t.method||this.method,i=t.url||this.url,s=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,u=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let d=t.headers||this.headers,m=t.params||this.params;const y=null!==(e=t.context)&&void 0!==e?e:this.context;return void 0!==t.setHeaders&&(d=Object.keys(t.setHeaders).reduce((_,E)=>_.set(E,t.setHeaders[E]),d)),t.setParams&&(m=Object.keys(t.setParams).reduce((_,E)=>_.set(E,t.setParams[E]),m)),new jE(r,i,o,{params:m,headers:d,context:y,reportProgress:u,responseType:s,withCredentials:a})}}var Fa=(()=>((Fa=Fa||{})[Fa.Sent=0]="Sent",Fa[Fa.UploadProgress=1]="UploadProgress",Fa[Fa.ResponseHeader=2]="ResponseHeader",Fa[Fa.DownloadProgress=3]="DownloadProgress",Fa[Fa.Response=4]="Response",Fa[Fa.User=5]="User",Fa))();class c8 extends class eBe{constructor(t,e=200,r="OK"){this.headers=t.headers||new fm,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}{constructor(t={}){super(t),this.type=Fa.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new c8({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}function h8(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let Jre=(()=>{class n{constructor(e){this.handler=e}request(e,r,i={}){let s;if(e instanceof jE)s=e;else{let u,d;u=i.headers instanceof fm?i.headers:new fm(i.headers),i.params&&(d=i.params instanceof dm?i.params:new dm({fromObject:i.params})),s=new jE(e,r,void 0!==i.body?i.body:null,{headers:u,context:i.context,params:d,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const o=Uf(s).pipe(function G$e(n,t){return pt(t)?bc(n,t,1):bc(n,1)}(u=>this.handler.handle(u)));if(e instanceof jE||"events"===i.observe)return o;const a=o.pipe(a4(u=>u instanceof c8));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(qs(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return a.pipe(qs(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return a.pipe(qs(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return a.pipe(qs(u=>u.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new dm).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,i={}){return this.request("PATCH",e,h8(i,r))}post(e,r,i={}){return this.request("POST",e,h8(i,r))}put(e,r,i={}){return this.request("PUT",e,h8(i,r))}}return n.\u0275fac=function(e){return new(e||n)(dn(j$e))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();const nBe=["*"];let PF;function qE(n){var t;return(null===(t=function rBe(){if(void 0===PF&&(PF=null,"undefined"!=typeof window)){const n=window;void 0!==n.trustedTypes&&(PF=n.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return PF}())||void 0===t?void 0:t.createHTML(n))||n}function eie(n){return Error(`Unable to find icon with the name "${n}"`)}function tie(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function nie(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class Ov{constructor(t,e,r){this.url=t,this.svgText=e,this.options=r}}let LF=(()=>{class n{constructor(e,r,i,s){this._httpClient=e,this._sanitizer=r,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=i}addSvgIcon(e,r,i){return this.addSvgIconInNamespace("",e,r,i)}addSvgIconLiteral(e,r,i){return this.addSvgIconLiteralInNamespace("",e,r,i)}addSvgIconInNamespace(e,r,i,s){return this._addSvgIconConfig(e,r,new Ov(i,null,s))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,r,i,s){const o=this._sanitizer.sanitize(Ai.HTML,i);if(!o)throw nie(i);const a=qE(o);return this._addSvgIconConfig(e,r,new Ov("",a,s))}addSvgIconSet(e,r){return this.addSvgIconSetInNamespace("",e,r)}addSvgIconSetLiteral(e,r){return this.addSvgIconSetLiteralInNamespace("",e,r)}addSvgIconSetInNamespace(e,r,i){return this._addSvgIconSetConfig(e,new Ov(r,null,i))}addSvgIconSetLiteralInNamespace(e,r,i){const s=this._sanitizer.sanitize(Ai.HTML,r);if(!s)throw nie(r);const o=qE(s);return this._addSvgIconSetConfig(e,new Ov("",o,i))}registerFontClassAlias(e,r=e){return this._fontCssClassesByAlias.set(e,r),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const r=this._sanitizer.sanitize(Ai.RESOURCE_URL,e);if(!r)throw tie(e);const i=this._cachedIconsByUrl.get(r);return i?Uf($F(i)):this._loadSvgIconFromConfig(new Ov(e,null)).pipe(l8(s=>this._cachedIconsByUrl.set(r,s)),qs(s=>$F(s)))}getNamedSvgIcon(e,r=""){const i=rie(r,e);let s=this._svgIconConfigs.get(i);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(r,e),s)return this._svgIconConfigs.set(i,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(r);return o?this._getSvgFromIconSetConfigs(e,o):function H$e(n,t){const e=pt(n)?n:()=>n,r=i=>i.error(e());return new $i(t?i=>t.schedule(r,0,i):r)}(eie(i))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Uf($F(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(qs(r=>$F(r)))}_getSvgFromIconSetConfigs(e,r){const i=this._extractIconWithNameFromAnySet(e,r);return i?Uf(i):Bne(r.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(jre(a=>{const d=`Loading icon set URL: ${this._sanitizer.sanitize(Ai.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(d)),Uf(null)})))).pipe(qs(()=>{const o=this._extractIconWithNameFromAnySet(e,r);if(!o)throw eie(e);return o}))}_extractIconWithNameFromAnySet(e,r){for(let i=r.length-1;i>=0;i--){const s=r[i];if(s.svgText&&s.svgText.toString().indexOf(e)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,e,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(l8(r=>e.svgText=r),qs(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Uf(null):this._fetchIcon(e).pipe(l8(r=>e.svgText=r))}_extractSvgIconFromSet(e,r,i){const s=e.querySelector(`[id="${r}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,i);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),i);const a=this._svgElementFromString(qE("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,i)}_svgElementFromString(e){const r=this._document.createElement("DIV");r.innerHTML=e;const i=r.querySelector("svg");if(!i)throw Error("<svg> tag not found");return i}_toSvgElement(e){const r=this._svgElementFromString(qE("<svg></svg>")),i=e.attributes;for(let s=0;s<i.length;s++){const{name:o,value:a}=i[s];"id"!==o&&r.setAttribute(o,a)}for(let s=0;s<e.childNodes.length;s++)e.childNodes[s].nodeType===this._document.ELEMENT_NODE&&r.appendChild(e.childNodes[s].cloneNode(!0));return r}_setSvgAttributes(e,r){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),r&&r.viewBox&&e.setAttribute("viewBox",r.viewBox),e}_fetchIcon(e){var r;const{url:i,options:s}=e,o=null!==(r=null==s?void 0:s.withCredentials)&&void 0!==r&&r;if(!this._httpClient)throw function iBe(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const a=this._sanitizer.sanitize(Ai.RESOURCE_URL,i);if(!a)throw tie(i);const u=this._inProgressUrlFetches.get(a);if(u)return u;const d=this._httpClient.get(a,{responseType:"text",withCredentials:o}).pipe(qs(m=>qE(m)),function W$e(n){return Pi((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}(()=>this._inProgressUrlFetches.delete(a)),zv());return this._inProgressUrlFetches.set(a,d),d}_addSvgIconConfig(e,r,i){return this._svgIconConfigs.set(rie(e,r),i),this}_addSvgIconSetConfig(e,r){const i=this._iconSetConfigs.get(e);return i?i.push(r):this._iconSetConfigs.set(e,[r]),this}_svgElementFromConfig(e){if(!e.svgElement){const r=this._svgElementFromString(e.svgText);this._setSvgAttributes(r,e.options),e.svgElement=r}return e.svgElement}_getIconConfigFromResolvers(e,r){for(let i=0;i<this._resolvers.length;i++){const s=this._resolvers[i](r,e);if(s)return oBe(s)?new Ov(s.url,null,s.options):new Ov(s,null)}}}return n.\u0275fac=function(e){return new(e||n)(dn(Jre,8),dn(S_),dn(vi,8),dn(Mc))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function $F(n){return n.cloneNode(!0)}function rie(n,t){return n+":"+t}function oBe(n){return!(!n.url||!n.options)}const aBe=U4(class{constructor(n){this._elementRef=n}}),uBe=new Qn("mat-icon-location",{providedIn:"root",factory:function lBe(){const n=py(vi),t=n?n.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),iie=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],cBe=iie.map(n=>`[${n}]`).join(", "),hBe=/^url\(['"]?#(.*?)['"]?\)$/;let fBe=(()=>{class n extends aBe{constructor(e,r,i,s,o){super(e),this._iconRegistry=r,this._location=s,this._errorHandler=o,this._inline=!1,this._currentIconFetch=mr.EMPTY,i||e.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(e){this._inline=Gf(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const r=this._cleanupFontValue(e);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const r=this._cleanupFontValue(e);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}_splitIconName(e){if(!e)return["",""];const r=e.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let r=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){const i=e.childNodes[r];(1!==i.nodeType||"svg"===i.nodeName.toLowerCase())&&i.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,r=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();r!=this._previousFontSetClass&&(this._previousFontSetClass&&e.classList.remove(this._previousFontSetClass),r&&e.classList.add(r),this._previousFontSetClass=r),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const r=this._elementsWithExternalReferences;r&&r.forEach((i,s)=>{i.forEach(o=>{s.setAttribute(o.name,`url('${e}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(e){const r=e.querySelectorAll(cBe),i=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<r.length;s++)iie.forEach(o=>{const a=r[s],u=a.getAttribute(o),d=u?u.match(hBe):null;if(d){let m=i.get(a);m||(m=[],i.set(a,m)),m.push({name:o,value:d[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[r,i]=this._splitIconName(e);r&&(this._svgNamespace=r),i&&(this._svgName=i),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(i,r).pipe(bC(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${r}:${i}! ${s.message}`))})}}}return n.\u0275fac=function(e){return new(e||n)(nn(As),nn(LF),jm("aria-hidden"),nn(uBe),nn(Mc))},n.\u0275cmp=Vl({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(e,r){2&e&&(Na("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet),Ua("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[oi],ngContentSelectors:nBe,decls:1,vars:0,template:function(e,r){1&e&&(Bx(),Ou(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),n})(),dBe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[Hc],Hc]}),n})();const sie=Fg({passive:!0});let pBe=(()=>{class n{constructor(e,r){this._platform=e,this._ngZone=r,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return ma;const r=jf(e),i=this._monitoredElements.get(r);if(i)return i.subject;const s=new Qi,o="cdk-text-field-autofilled",a=u=>{"cdk-text-field-autofill-start"!==u.animationName||r.classList.contains(o)?"cdk-text-field-autofill-end"===u.animationName&&r.classList.contains(o)&&(r.classList.remove(o),this._ngZone.run(()=>s.next({target:u.target,isAutofilled:!1}))):(r.classList.add(o),this._ngZone.run(()=>s.next({target:u.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{r.addEventListener("animationstart",a,sie),r.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(r,{subject:s,unlisten:()=>{r.removeEventListener("animationstart",a,sie)}}),s}stopMonitoring(e){const r=jf(e),i=this._monitoredElements.get(r);i&&(i.unlisten(),i.subject.complete(),r.classList.remove("cdk-text-field-autofill-monitored"),r.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(r))}ngOnDestroy(){this._monitoredElements.forEach((e,r)=>this.stopMonitoring(r))}}return n.\u0275fac=function(e){return new(e||n)(dn(Da),dn(Oi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),oie=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({}),n})();const mBe=new Qn("MAT_INPUT_VALUE_ACCESSOR"),gBe=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let vBe=0;const yBe=Lae(class{constructor(n,t,e,r){this._defaultErrorStateMatcher=n,this._parentForm=t,this._parentFormGroup=e,this.ngControl=r}});let _Be=(()=>{class n extends yBe{constructor(e,r,i,s,o,a,u,d,m,y){super(a,s,o,i),this._elementRef=e,this._platform=r,this._autofillMonitor=d,this._formField=y,this._uid="mat-input-"+vBe++,this.focused=!1,this.stateChanges=new Qi,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(D=>lk().has(D)),this._iOSKeyupListener=D=>{const O=D.target;!O.value&&0===O.selectionStart&&0===O.selectionEnd&&(O.setSelectionRange(1,1),O.setSelectionRange(0,0))};const _=this._elementRef.nativeElement,E=_.nodeName.toLowerCase();this._inputValueAccessor=u||_,this._previousNativeValue=this.value,this.id=this.id,r.IOS&&m.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===E,this._isTextarea="textarea"===E,this._isInFormField=!!y,this._isNativeSelect&&(this.controlType=_.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(e){this._disabled=Gf(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){var e,r,i,s;return null!==(s=null!==(e=this._required)&&void 0!==e?e:null===(i=null===(r=this.ngControl)||void 0===r?void 0:r.control)||void 0===i?void 0:i.hasValidator($E.required))&&void 0!==s&&s}set required(e){this._required=Gf(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&lk().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=Gf(e)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){var e,r;const i=(null===(r=null===(e=this._formField)||void 0===e?void 0:e._hideControlPlaceholder)||void 0===r?void 0:r.call(e))?null:this.placeholder;if(i!==this._previousPlaceholder){const s=this._elementRef.nativeElement;this._previousPlaceholder=i,i?s.setAttribute("placeholder",i):s.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_validateType(){gBe.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,r=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&r&&r.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return n.\u0275fac=function(e){return new(e||n)(nn(As),nn(Da),nn(gd,10),nn(FF,8),nn(WE,8),nn(a7),nn(mBe,10),nn(pBe),nn(Oi),nn(v7,8))},n.\u0275dir=sr({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:12,hostBindings:function(e,r){1&e&&Vs("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&e&&(Qx("disabled",r.disabled)("required",r.required),Na("id",r.id)("data-placeholder",r.placeholder)("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required),Ua("mat-input-server",r._isServer)("mat-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Hi([{provide:j4,useExisting:n}]),oi,Hl]}),n})(),bBe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({providers:[a7],imports:[[oie,Z4,Hc],oie,Z4]}),n})();const ZE={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:r}=ZE;r&&(t=r.requestAnimationFrame,e=r.cancelAnimationFrame);const i=t(s=>{e=void 0,n(s)});return new mr(()=>null==e?void 0:e(i))},requestAnimationFrame(...n){const{delegate:t}=ZE;return((null==t?void 0:t.requestAnimationFrame)||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=ZE;return((null==t?void 0:t.cancelAnimationFrame)||cancelAnimationFrame)(...n)},delegate:void 0};new class xBe extends c4{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let i;t=t||r.shift();do{if(i=t.execute(t.state,t.delay))break}while((t=r[0])&&t.id===e&&r.shift());if(this._active=!1,i){for(;(t=r[0])&&t.id===e&&r.shift();)t.unsubscribe();throw i}}}(class wBe extends l4{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,r=0){return null!==r&&r>0?super.requestAsyncId(t,e,r):(t.actions.push(this),t._scheduled||(t._scheduled=ZE.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(t,e,r);const{actions:s}=t;null!=e&&(null===(i=s[s.length-1])||void 0===i?void 0:i.id)!==e&&(ZE.cancelAnimationFrame(e),t._scheduled=void 0)}});let f8,SBe=1;const BF={};function aie(n){return n in BF&&(delete BF[n],!0)}const EBe={setImmediate(n){const t=SBe++;return BF[t]=!0,f8||(f8=Promise.resolve()),f8.then(()=>aie(t)&&n()),t},clearImmediate(n){aie(n)}},{setImmediate:NBe,clearImmediate:TBe}=EBe,VF={setImmediate(...n){const{delegate:t}=VF;return((null==t?void 0:t.setImmediate)||NBe)(...n)},clearImmediate(n){const{delegate:t}=VF;return((null==t?void 0:t.clearImmediate)||TBe)(n)},delegate:void 0};new class IBe extends c4{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:r}=this;let i;t=t||r.shift();do{if(i=t.execute(t.state,t.delay))break}while((t=r[0])&&t.id===e&&r.shift());if(this._active=!1,i){for(;(t=r[0])&&t.id===e&&r.shift();)t.unsubscribe();throw i}}}(class ABe extends l4{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,r=0){return null!==r&&r>0?super.requestAsyncId(t,e,r):(t.actions.push(this),t._scheduled||(t._scheduled=VF.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,r=0){var i;if(null!=r?r>0:this.delay>0)return super.recycleAsyncId(t,e,r);const{actions:s}=t;null!=e&&(null===(i=s[s.length-1])||void 0===i?void 0:i.id)!==e&&(VF.clearImmediate(e),t._scheduled=void 0)}});function uie(n,t=h4){return function MBe(n){return Pi((t,e)=>{let r=!1,i=null,s=null,o=!1;const a=()=>{if(null==s||s.unsubscribe(),s=null,r){r=!1;const d=i;i=null,e.next(d)}o&&e.complete()},u=()=>{s=null,o&&e.complete()};t.subscribe(Bn(e,d=>{r=!0,i=d,s||ro(n(d)).subscribe(s=Bn(e,a,u))},()=>{o=!0,(!r||!s||s.closed)&&e.complete()}))})}(()=>function RBe(n=0,t,e=vse){let r=-1;return null!=t&&(lf(t)?e=t:r=t),new $i(i=>{let s=function kBe(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;s<0&&(s=0);let o=0;return e.schedule(function(){i.closed||(i.next(o++),0<=r?this.schedule(void 0,r):i.complete())},s)})}(n,t))}let lie=(()=>{class n{constructor(e,r,i){this._ngZone=e,this._platform=r,this._scrolled=new Qi,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=i}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const r=this.scrollContainers.get(e);r&&(r.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new $i(r=>{this._globalSubscription||this._addGlobalListener();const i=e>0?this._scrolled.pipe(uie(e)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Uf()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(e,r){const i=this.getAncestorScrollContainers(e);return this.scrolled(r).pipe(a4(s=>!s||i.indexOf(s)>-1))}getAncestorScrollContainers(e){const r=[];return this.scrollContainers.forEach((i,s)=>{this._scrollableContainsElement(s,e)&&r.push(s)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,r){let i=jf(r),s=e.getElementRef().nativeElement;do{if(i==s)return!0}while(i=i.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>jk(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(e){return new(e||n)(dn(Oi),dn(Da),dn(vi,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),cie=(()=>{class n{constructor(e,r,i){this._platform=e,this._change=new Qi,this._changeListener=s=>{this._change.next(s)},this._document=i,r.runOutsideAngular(()=>{if(e.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,r=this._getWindow(),i=e.documentElement,s=i.getBoundingClientRect();return{top:-s.top||e.body.scrollTop||r.scrollY||i.scrollTop||0,left:-s.left||e.body.scrollLeft||r.scrollX||i.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(uie(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(e){return new(e||n)(dn(Da),dn(Oi),dn(vi,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),d8=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({}),n})(),hie=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({imports:[[Dh,d8],Dh,d8]}),n})();class p8{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class fie extends p8{constructor(t,e,r,i){super(),this.component=t,this.viewContainerRef=e,this.injector=r,this.componentFactoryResolver=i}}class PBe extends p8{constructor(t,e,r){super(),this.templateRef=t,this.viewContainerRef=e,this.context=r}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class LBe extends p8{constructor(t){super(),this.element=t instanceof As?t.nativeElement:t}}class BBe extends class $Be{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof fie?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof PBe?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof LBe?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}{constructor(t,e,r,i,s){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=r,this._defaultInjector=i,this.attachDomPortal=o=>{const a=o.element,u=this._document.createComment("dom-portal");a.parentNode.insertBefore(u,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{u.parentNode&&u.parentNode.replaceChild(a,u)})},this._document=s}attachComponentPortal(t){const r=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let i;return t.viewContainerRef?(i=t.viewContainerRef.createComponent(r,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>i.destroy())):(i=r.create(t.injector||this._defaultInjector||ra.NULL),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(i.hostView),i.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=t,i}attachTemplatePortal(t){let e=t.viewContainerRef,r=e.createEmbeddedView(t.templateRef,t.context);return r.rootNodes.forEach(i=>this.outletElement.appendChild(i)),r.detectChanges(),this.setDisposeFn(()=>{let i=e.indexOf(r);-1!==i&&e.remove(i)}),this._attachedPortal=t,r}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let VBe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({}),n})();const die=Kz();class zBe{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=To(-this._previousScrollPosition.left),t.style.top=To(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,r=t.style,i=this._document.body.style,s=r.scrollBehavior||"",o=i.scrollBehavior||"";this._isEnabled=!1,r.left=this._previousHTMLStyles.left,r.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),die&&(r.scrollBehavior=i.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),die&&(r.scrollBehavior=s,i.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,r=this._viewportRuler.getViewportSize();return e.scrollHeight>r.height||e.scrollWidth>r.width}}class UBe{constructor(t,e,r,i){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=r,this._config=i,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class pie{enable(){}disable(){}attach(){}}function m8(n,t){return t.some(e=>n.bottom<e.top||n.top>e.bottom||n.right<e.left||n.left>e.right)}function mie(n,t){return t.some(e=>n.top<e.top||n.bottom>e.bottom||n.left<e.left||n.right>e.right)}class HBe{constructor(t,e,r,i){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=r,this._config=i,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:r,height:i}=this._viewportRuler.getViewportSize();m8(e,[{width:r,height:i,bottom:i,right:r,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let WBe=(()=>{class n{constructor(e,r,i,s){this._scrollDispatcher=e,this._viewportRuler=r,this._ngZone=i,this.noop=()=>new pie,this.close=o=>new UBe(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new zBe(this._viewportRuler,this._document),this.reposition=o=>new HBe(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(e){return new(e||n)(dn(lie),dn(cie),dn(Oi),dn(vi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class GBe{constructor(t){if(this.scrollStrategy=new pie,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const r of e)void 0!==t[r]&&(this[r]=t[r])}}}class jBe{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}class qBe{constructor(t,e,r,i,s,o,a,u,d){this._portalOutlet=t,this._host=e,this._pane=r,this._config=i,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=u,this._outsideClickDispatcher=d,this._backdropElement=null,this._backdropClick=new Qi,this._attachments=new Qi,this._detachments=new Qi,this._locationChanges=mr.EMPTY,this._backdropClickHandler=m=>this._backdropClick.next(m),this._backdropTransitionendHandler=m=>{this._disposeBackdrop(m.target)},this._keydownEvents=new Qi,this._outsidePointerEvents=new Qi,i.scrollStrategy&&(this._scrollStrategy=i.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=i.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(bC(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){var t;const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),null===(t=this._host)||void 0===t||t.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=To(this._config.width),t.height=To(this._config.height),t.minWidth=To(this._config.minWidth),t.minHeight=To(this._config.minHeight),t.maxWidth=To(this._config.maxWidth),t.maxHeight=To(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;!t||(t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500)))}_toggleClasses(t,e,r){const i=xk(e||[]).filter(s=>!!s);i.length&&(r?t.classList.add(...i):t.classList.remove(...i))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(Lu(ei(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}let gie=(()=>{class n{constructor(e,r){this._platform=r,this._document=e}ngOnDestroy(){var e;null===(e=this._containerElement)||void 0===e||e.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||hC()){const i=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let s=0;s<i.length;s++)i[s].remove()}const r=this._document.createElement("div");r.classList.add(e),hC()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}}return n.\u0275fac=function(e){return new(e||n)(dn(vi),dn(Da))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const vie="cdk-overlay-connected-position-bounding-box",ZBe=/([A-Za-z%]+)$/;class KBe{constructor(t,e,r,i,s){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Qi,this._resizeSubscription=mr.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){this._validatePositions(),t.hostElement.classList.add(vie),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,r=this._viewportRect,i=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let u=this._getOriginPoint(t,i,a),d=this._getOverlayPoint(u,e,a),m=this._getOverlayFit(d,e,r,a);if(m.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,u);this._canFitWithFlexibleDimensions(m,d,r)?s.push({position:a,origin:u,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(u,a)}):(!o||o.overlayFit.visibleArea<m.visibleArea)&&(o={overlayFit:m,overlayPoint:d,originPoint:u,position:a,overlayRect:e})}if(s.length){let a=null,u=-1;for(const d of s){const m=d.boundingBoxRect.width*d.boundingBoxRect.height*(d.position.weight||1);m>u&&(u=m,a=d)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Fv(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(vie),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,r){let i,s;if("center"==r.originX)i=t.left+t.width/2;else{const o=this._isRtl()?t.right:t.left,a=this._isRtl()?t.left:t.right;i="start"==r.originX?o:a}return e.left<0&&(i-=e.left),s="center"==r.originY?t.top+t.height/2:"top"==r.originY?t.top:t.bottom,e.top<0&&(s-=e.top),{x:i,y:s}}_getOverlayPoint(t,e,r){let i,s;return i="center"==r.overlayX?-e.width/2:"start"===r.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,s="center"==r.overlayY?-e.height/2:"top"==r.overlayY?0:-e.height,{x:t.x+i,y:t.y+s}}_getOverlayFit(t,e,r,i){const s=_ie(e);let{x:o,y:a}=t,u=this._getOffset(i,"x"),d=this._getOffset(i,"y");u&&(o+=u),d&&(a+=d);let _=0-a,E=a+s.height-r.height,D=this._subtractOverflows(s.width,0-o,o+s.width-r.width),O=this._subtractOverflows(s.height,_,E),R=D*O;return{visibleArea:R,isCompletelyWithinViewport:s.width*s.height===R,fitsInViewportVertically:O===s.height,fitsInViewportHorizontally:D==s.width}}_canFitWithFlexibleDimensions(t,e,r){if(this._hasFlexibleDimensions){const i=r.bottom-e.y,s=r.right-e.x,o=yie(this._overlayRef.getConfig().minHeight),a=yie(this._overlayRef.getConfig().minWidth),d=t.fitsInViewportHorizontally||null!=a&&a<=s;return(t.fitsInViewportVertically||null!=o&&o<=i)&&d}return!1}_pushOverlayOnScreen(t,e,r){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const i=_ie(e),s=this._viewportRect,o=Math.max(t.x+i.width-s.width,0),a=Math.max(t.y+i.height-s.height,0),u=Math.max(s.top-r.top-t.y,0),d=Math.max(s.left-r.left-t.x,0);let m=0,y=0;return m=i.width<=s.width?d||-o:t.x<this._viewportMargin?s.left-r.left-t.x:0,y=i.height<=s.height?u||-a:t.y<this._viewportMargin?s.top-r.top-t.y:0,this._previousPushAmount={x:m,y},{x:t.x+m,y:t.y+y}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const r=this._getScrollVisibility(),i=new jBe(t,r);this._positionChanges.next(i)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let r,i=t.overlayY;r="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let s=0;s<e.length;s++)e[s].style.transformOrigin=`${r} ${i}`}_calculateBoundingBoxRect(t,e){const r=this._viewportRect,i=this._isRtl();let s,o,a,m,y,_;if("top"===e.overlayY)o=t.y,s=r.height-o+this._viewportMargin;else if("bottom"===e.overlayY)a=r.height-t.y+2*this._viewportMargin,s=r.height-a+this._viewportMargin;else{const E=Math.min(r.bottom-t.y+r.top,t.y),D=this._lastBoundingBoxSize.height;s=2*E,o=t.y-E,s>D&&!this._isInitialRender&&!this._growAfterOpen&&(o=t.y-D/2)}if("end"===e.overlayX&&!i||"start"===e.overlayX&&i)_=r.width-t.x+this._viewportMargin,m=t.x-this._viewportMargin;else if("start"===e.overlayX&&!i||"end"===e.overlayX&&i)y=t.x,m=r.right-t.x;else{const E=Math.min(r.right-t.x+r.left,t.x),D=this._lastBoundingBoxSize.width;m=2*E,y=t.x-E,m>D&&!this._isInitialRender&&!this._growAfterOpen&&(y=t.x-D/2)}return{top:o,left:y,bottom:a,right:_,width:m,height:s}}_setBoundingBoxStyles(t,e){const r=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(r.height=Math.min(r.height,this._lastBoundingBoxSize.height),r.width=Math.min(r.width,this._lastBoundingBoxSize.width));const i={};if(this._hasExactPosition())i.top=i.left="0",i.bottom=i.right=i.maxHeight=i.maxWidth="",i.width=i.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;i.height=To(r.height),i.top=To(r.top),i.bottom=To(r.bottom),i.width=To(r.width),i.left=To(r.left),i.right=To(r.right),i.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",i.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",s&&(i.maxHeight=To(s)),o&&(i.maxWidth=To(o))}this._lastBoundingBoxSize=r,Fv(this._boundingBox.style,i)}_resetBoundingBoxStyles(){Fv(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Fv(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const r={},i=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(i){const m=this._viewportRuler.getViewportScrollPosition();Fv(r,this._getExactOverlayY(e,t,m)),Fv(r,this._getExactOverlayX(e,t,m))}else r.position="static";let a="",u=this._getOffset(e,"x"),d=this._getOffset(e,"y");u&&(a+=`translateX(${u}px) `),d&&(a+=`translateY(${d}px)`),r.transform=a.trim(),o.maxHeight&&(i?r.maxHeight=To(o.maxHeight):s&&(r.maxHeight="")),o.maxWidth&&(i?r.maxWidth=To(o.maxWidth):s&&(r.maxWidth="")),Fv(this._pane.style,r)}_getExactOverlayY(t,e,r){let i={top:"",bottom:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r)),"bottom"===t.overlayY?i.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":i.top=To(s.y),i}_getExactOverlayX(t,e,r){let o,i={left:"",right:""},s=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,r)),o=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===o?i.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":i.left=To(s.x),i}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),r=this._scrollables.map(i=>i.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:mie(t,r),isOriginOutsideView:m8(t,r),isOverlayClipped:mie(e,r),isOverlayOutsideView:m8(e,r)}}_subtractOverflows(t,...e){return e.reduce((r,i)=>r-Math.max(i,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,r=this._viewportRuler.getViewportScrollPosition();return{top:r.top+this._viewportMargin,left:r.left+this._viewportMargin,right:r.left+t-this._viewportMargin,bottom:r.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&xk(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof As)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,r=t.height||0;return{top:t.y,bottom:t.y+r,left:t.x,right:t.x+e,height:r,width:e}}}function Fv(n,t){for(let e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function yie(n){if("number"!=typeof n&&null!=n){const[t,e]=n.split(ZBe);return e&&"px"!==e?null:parseFloat(t)}return n||null}function _ie(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const bie="cdk-global-overlay-wrapper";class XBe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(bie),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,r=this._overlayRef.getConfig(),{width:i,height:s,maxWidth:o,maxHeight:a}=r,u=!("100%"!==i&&"100vw"!==i||o&&"100%"!==o&&"100vw"!==o),d=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a);t.position=this._cssPosition,t.marginLeft=u?"0":this._leftOffset,t.marginTop=d?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,u?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=d?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,r=e.style;e.classList.remove(bie),r.justifyContent=r.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let YBe=(()=>{class n{constructor(e,r,i,s){this._viewportRuler=e,this._document=r,this._platform=i,this._overlayContainer=s}global(){return new XBe}flexibleConnectedTo(e){return new KBe(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(e){return new(e||n)(dn(cie),dn(vi),dn(Da),dn(gie))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),wie=(()=>{class n{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const r=this._attachedOverlays.indexOf(e);r>-1&&this._attachedOverlays.splice(r,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(e){return new(e||n)(dn(vi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),QBe=(()=>{class n extends wie{constructor(e,r){super(e),this._ngZone=r,this._keydownListener=i=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(i)):a.next(i);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(e){return new(e||n)(dn(vi),dn(Oi,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JBe=(()=>{class n extends wie{constructor(e,r,i){super(e),this._platform=r,this._ngZone=i,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Uc(s)},this._clickListener=s=>{const o=Uc(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const u=this._attachedOverlays.slice();for(let d=u.length-1;d>-1;d--){const m=u[d];if(m._outsidePointerEvents.observers.length<1||!m.hasAttached())continue;if(m.overlayElement.contains(o)||m.overlayElement.contains(a))break;const y=m._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>y.next(s)):y.next(s)}}}add(e){if(super.add(e),!this._isAttached){const r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(e){return new(e||n)(dn(vi),dn(Da),dn(Oi,8))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),e3e=0,zF=(()=>{class n{constructor(e,r,i,s,o,a,u,d,m,y,_){this.scrollStrategies=e,this._overlayContainer=r,this._componentFactoryResolver=i,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=u,this._document=d,this._directionality=m,this._location=y,this._outsideClickDispatcher=_}create(e){const r=this._createHostElement(),i=this._createPaneElement(r),s=this._createPortalOutlet(i),o=new GBe(e);return o.direction=o.direction||this._directionality.value,new qBe(s,r,i,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(e){const r=this._document.createElement("div");return r.id="cdk-overlay-"+e3e++,r.classList.add("cdk-overlay-pane"),e.appendChild(r),r}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(fl)),new BBe(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(e){return new(e||n)(dn(WBe),dn(gie),dn($c),dn(YBe),dn(QBe),dn(ra),dn(Oi),dn(vi),dn(uC),dn(qV),dn(JBe))},n.\u0275prov=yn({token:n,factory:n.\u0275fac}),n})();const r3e={provide:new Qn("cdk-connected-overlay-scroll-strategy"),deps:[zF],useFactory:function n3e(n){return()=>n.scrollStrategies.reposition()}};let i3e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({providers:[zF,r3e],imports:[[Dh,VBe,hie],hie]}),n})();function xie(n,t,e){n?io(e,n,t):t()}const Cie=new Set;let vb,a3e=(()=>{class n{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):l3e}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function u3e(n){if(!Cie.has(n))try{vb||(vb=document.createElement("style"),vb.setAttribute("type","text/css"),document.head.appendChild(vb)),vb.sheet&&(vb.sheet.insertRule(`@media ${n} {body{ }}`,0),Cie.add(n))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return n.\u0275fac=function(e){return new(e||n)(dn(Da))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function l3e(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let c3e=(()=>{class n{constructor(e,r){this._mediaMatcher=e,this._zone=r,this._queries=new Map,this._destroySubject=new Qi}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return Sie(xk(e)).some(i=>this._registerQuery(i).mql.matches)}observe(e){let s=function s3e(...n){const t=eu(n),e=cf(n),{args:r,keys:i}=Lne(n);if(0===r.length)return Cc([],t);const s=new $i(function o3e(n,t,e=ko){return r=>{xie(t,()=>{const{length:i}=n,s=new Array(i);let o=i,a=i;for(let u=0;u<i;u++)xie(t,()=>{const d=Cc(n[u],t);let m=!1;d.subscribe(Bn(r,y=>{s[u]=y,m||(m=!0,a--),a||r.next(e(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,i?o=>$ne(i,o):ko));return e?s.pipe(W4(e)):s}(Sie(xk(e)).map(o=>this._registerQuery(o).observable));return s=G4(s.pipe(bC(1)),s.pipe(tq(1),rq(0))),s.pipe(qs(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:u,query:d})=>{a.matches=a.matches||u,a.breakpoints[d]=u}),a}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const r=this._mediaMatcher.matchMedia(e),s={observable:new $i(o=>{const a=u=>this._zone.run(()=>o.next(u));return r.addListener(a),()=>{r.removeListener(a)}}).pipe(qk(r),qs(({matches:o})=>({query:e,matches:o})),Lu(this._destroySubject)),mql:r};return this._queries.set(e,s),s}}return n.\u0275fac=function(e){return new(e||n)(dn(a3e),dn(Oi))},n.\u0275prov=yn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Sie(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}const f3e=["tooltip"],Eie="tooltip-panel",Nie=Fg({passive:!0}),Tie=new Qn("mat-tooltip-scroll-strategy"),g3e={provide:Tie,deps:[zF],useFactory:function m3e(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},v3e=new Qn("mat-tooltip-default-options",{providedIn:"root",factory:function y3e(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let _3e=(()=>{class n{constructor(e,r,i,s,o,a,u,d,m,y,_,E){this._overlay=e,this._elementRef=r,this._scrollDispatcher=i,this._viewContainerRef=s,this._ngZone=o,this._platform=a,this._ariaDescriber=u,this._focusMonitor=d,this._dir=y,this._defaultOptions=_,this._position="below",this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new Qi,this._scrollStrategy=m,this._document=E,_&&(_.position&&(this.position=_.position),_.touchGestures&&(this.touchGestures=_.touchGestures)),y.change.pipe(Lu(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}get position(){return this._position}set position(e){var r;e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),null===(r=this._tooltipInstance)||void 0===r||r.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(e){this._disabled=Gf(e),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=u4(e)}get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=u4(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=e?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Lu(this._destroyed)).subscribe(e=>{e?"keyboard"===e&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([r,i])=>{e.removeEventListener(r,i,Nie)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible()&&!this._tooltipInstance._showTimeoutId&&!this._tooltipInstance._hideTimeoutId)return;const r=this._createOverlay();this._detach(),this._portal=this._portal||new fie(this._tooltipComponent,this._viewContainerRef);const i=this._tooltipInstance=r.attach(this._portal).instance;i._triggerElement=this._elementRef.nativeElement,i._mouseLeaveHideDelay=this._hideDelay,i.afterHidden().pipe(Lu(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),i.show(e)}hide(e=this.hideDelay){this._tooltipInstance&&this._tooltipInstance.hide(e)}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){var e;if(this._overlayRef)return this._overlayRef;const r=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),i=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(r);return i.positionChanges.pipe(Lu(this._destroyed)).subscribe(s=>{this._updateCurrentPositionClass(s.connectionPair),this._tooltipInstance&&s.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:i,panelClass:`${this._cssClassPrefix}-${Eie}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Lu(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Lu(this._destroyed)).subscribe(()=>{var s;return null===(s=this._tooltipInstance)||void 0===s?void 0:s._handleBodyInteraction()}),this._overlayRef.keydownEvents().pipe(Lu(this._destroyed)).subscribe(s=>{this._isTooltipVisible()&&27===s.keyCode&&!function fse(n,...t){return t.length?t.some(e=>n[e]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}(s)&&(s.preventDefault(),s.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),(null===(e=this._defaultOptions)||void 0===e?void 0:e.disableTooltipInteractivity)&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){const r=e.getConfig().positionStrategy,i=this._getOrigin(),s=this._getOverlayPosition();r.withPositions([this._addOffset(Object.assign(Object.assign({},i.main),s.main)),this._addOffset(Object.assign(Object.assign({},i.fallback),s.fallback))])}_addOffset(e){return e}_getOrigin(){const e=!this._dir||"ltr"==this._dir.value,r=this.position;let i;"above"==r||"below"==r?i={originX:"center",originY:"above"==r?"top":"bottom"}:"before"==r||"left"==r&&e||"right"==r&&!e?i={originX:"start",originY:"center"}:("after"==r||"right"==r&&e||"left"==r&&!e)&&(i={originX:"end",originY:"center"});const{x:s,y:o}=this._invertPosition(i.originX,i.originY);return{main:i,fallback:{originX:s,originY:o}}}_getOverlayPosition(){const e=!this._dir||"ltr"==this._dir.value,r=this.position;let i;"above"==r?i={overlayX:"center",overlayY:"bottom"}:"below"==r?i={overlayX:"center",overlayY:"top"}:"before"==r||"left"==r&&e||"right"==r&&!e?i={overlayX:"end",overlayY:"center"}:("after"==r||"right"==r&&e||"left"==r&&!e)&&(i={overlayX:"start",overlayY:"center"});const{x:s,y:o}=this._invertPosition(i.overlayX,i.overlayY);return{main:i,fallback:{overlayX:s,overlayY:o}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe(bC(1),Lu(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,r){return"above"===this.position||"below"===this.position?"top"===r?r="bottom":"bottom"===r&&(r="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:r}}_updateCurrentPositionClass(e){const{overlayY:r,originX:i,originY:s}=e;let o;if(o="center"===r?this._dir&&"rtl"===this._dir.value?"end"===i?"left":"right":"start"===i?"left":"right":"bottom"===r&&"top"===s?"above":"below",o!==this._currentPosition){const a=this._overlayRef;if(a){const u=`${this._cssClassPrefix}-${Eie}-`;a.removePanelClass(u+this._currentPosition),a.addPanelClass(u+o)}this._currentPosition=o}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",()=>{this._setupPointerExitEventsIfNeeded(),this.show()}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",()=>{this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",r=>{var i;const s=r.relatedTarget;(!s||!(null===(i=this._overlayRef)||void 0===i?void 0:i.overlayElement.contains(s)))&&this.hide()}],["wheel",r=>this._wheelListener(r)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const r=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};e.push(["touchend",r],["touchcancel",r])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([r,i])=>{this._elementRef.nativeElement.addEventListener(r,i,Nie)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){const r=this._document.elementFromPoint(e.clientX,e.clientY),i=this._elementRef.nativeElement;r!==i&&!i.contains(r)&&this.hide()}}_disableNativeGesturesIfNecessary(){const e=this.touchGestures;if("off"!==e){const r=this._elementRef.nativeElement,i=r.style;("on"===e||"INPUT"!==r.nodeName&&"TEXTAREA"!==r.nodeName)&&(i.userSelect=i.msUserSelect=i.webkitUserSelect=i.MozUserSelect="none"),("on"===e||!r.draggable)&&(i.webkitUserDrag="none"),i.touchAction="none",i.webkitTapHighlightColor="transparent"}}}return n.\u0275fac=function(e){!function rI(){throw new Error("invalid")}()},n.\u0275dir=sr({type:n,inputs:{position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),n})(),b3e=(()=>{class n extends _3e{constructor(e,r,i,s,o,a,u,d,m,y,_,E){super(e,r,i,s,o,a,u,d,m,y,_,E),this._tooltipComponent=x3e}}return n.\u0275fac=function(e){return new(e||n)(nn(zF),nn(As),nn(lie),nn(Pu),nn(Oi),nn(Da),nn(xse),nn(pq),nn(Tie),nn(uC,8),nn(v3e,8),nn(vi))},n.\u0275dir=sr({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-tooltip-trigger"],exportAs:["matTooltip"],features:[oi]}),n})(),w3e=(()=>{class n{constructor(e,r){this._changeDetectorRef=e,this._visibility="initial",this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new Qi,this._animationsDisabled="NoopAnimations"===r}show(e){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&this.hide(this._mouseLeaveHideDelay)}_onShow(){}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){const r=this._tooltip.nativeElement,i=this._showAnimation,s=this._hideAnimation;if(r.classList.remove(e?s:i),r.classList.add(e?i:s),this._isVisible=e,e&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const o=getComputedStyle(r);("0s"===o.getPropertyValue("animation-duration")||"none"===o.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(r.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}}return n.\u0275fac=function(e){return new(e||n)(nn(Eg),nn(zg,8))},n.\u0275dir=sr({type:n}),n})(),x3e=(()=>{class n extends w3e{constructor(e,r,i){super(e,i),this._breakpointObserver=r,this._isHandset=this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)"),this._showAnimation="mat-tooltip-show",this._hideAnimation="mat-tooltip-hide"}}return n.\u0275fac=function(e){return new(e||n)(nn(Eg),nn(c3e),nn(zg,8))},n.\u0275cmp=Vl({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(e,r){if(1&e&&Ii(f3e,7),2&e){let i;mn(i=Aa())&&(r._tooltip=i.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(e,r){1&e&&Vs("mouseleave",function(s){return r._handleMouseLeave(s)}),2&e&&Gx("zoom",r.isVisible()?1:null)},features:[oi],decls:4,vars:6,consts:[[1,"mat-tooltip",3,"ngClass","animationend"],["tooltip",""]],template:function(e,r){if(1&e&&(Kr(0,"div",0,1),Vs("animationend",function(s){return r._handleAnimationEnd(s)}),function GD(n,t){const e=fi();let r;const i=n+20;e.firstCreatePass?(r=function jD(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[i]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(i,r.onDestroy)):r=e.data[i];const s=r.factory||(r.factory=_f(r.type)),o=Po(nn);try{const a=Jb(!1),u=s();return Jb(a),function q$(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,xn(),i,u),u}finally{Po(o)}}(2,"async"),zs(3),Gr()),2&e){let i;Ua("mat-tooltip-handset",null==(i=qD(2,4,r._isHandset))?null:i.matches),Ri("ngClass",r.tooltipClass),Li(3),pp(r.message)}},directives:[az],pipes:[dz],styles:[".mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis;transform:scale(0)}.mat-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}.mat-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-tooltip-show{0%{opacity:0;transform:scale(0)}50%{opacity:.5;transform:scale(0.99)}100%{opacity:1;transform:scale(1)}}@keyframes mat-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1)}}.mat-tooltip-show{animation:mat-tooltip-show 200ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-tooltip-hide{animation:mat-tooltip-hide 100ms cubic-bezier(0, 0, 0.2, 1) forwards}\n"],encapsulation:2,changeDetection:0}),n})(),C3e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n}),n.\u0275inj=Ci({providers:[g3e],imports:[[Rse,Dp,i3e,Hc],Hc,d8]}),n})(),S3e=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Vl({type:n,selectors:[["app-loading-spinner"]],decls:13,vars:0,consts:[[1,"sk-circle"],[1,"sk-circle1","sk-child"],[1,"sk-circle2","sk-child"],[1,"sk-circle3","sk-child"],[1,"sk-circle4","sk-child"],[1,"sk-circle5","sk-child"],[1,"sk-circle6","sk-child"],[1,"sk-circle7","sk-child"],[1,"sk-circle8","sk-child"],[1,"sk-circle9","sk-child"],[1,"sk-circle10","sk-child"],[1,"sk-circle11","sk-child"],[1,"sk-circle12","sk-child"]],template:function(e,r){1&e&&(Kr(0,"div",0),lo(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11)(12,"div",12),Gr())},styles:['.sk-circle[_ngcontent-%COMP%]{margin:100px auto;width:40px;height:40px;position:relative}.sk-circle[_ngcontent-%COMP%]   .sk-child[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;left:0;top:0}.sk-circle[_ngcontent-%COMP%]   .sk-child[_ngcontent-%COMP%]:before{content:"";display:block;margin:0 auto;width:15%;height:15%;background-color:#333;border-radius:100%;animation:sk-circleBounceDelay 1.2s infinite ease-in-out both}.sk-circle[_ngcontent-%COMP%]   .sk-circle2[_ngcontent-%COMP%]{transform:rotate(30deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle3[_ngcontent-%COMP%]{transform:rotate(60deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle4[_ngcontent-%COMP%]{transform:rotate(90deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle5[_ngcontent-%COMP%]{transform:rotate(120deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle6[_ngcontent-%COMP%]{transform:rotate(150deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle7[_ngcontent-%COMP%]{transform:rotate(180deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle8[_ngcontent-%COMP%]{transform:rotate(210deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle9[_ngcontent-%COMP%]{transform:rotate(240deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle10[_ngcontent-%COMP%]{transform:rotate(270deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle11[_ngcontent-%COMP%]{transform:rotate(300deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle12[_ngcontent-%COMP%]{transform:rotate(330deg)}.sk-circle[_ngcontent-%COMP%]   .sk-circle2[_ngcontent-%COMP%]:before{animation-delay:-1.1s}.sk-circle[_ngcontent-%COMP%]   .sk-circle3[_ngcontent-%COMP%]:before{animation-delay:-1s}.sk-circle[_ngcontent-%COMP%]   .sk-circle4[_ngcontent-%COMP%]:before{animation-delay:-.9s}.sk-circle[_ngcontent-%COMP%]   .sk-circle5[_ngcontent-%COMP%]:before{animation-delay:-.8s}.sk-circle[_ngcontent-%COMP%]   .sk-circle6[_ngcontent-%COMP%]:before{animation-delay:-.7s}.sk-circle[_ngcontent-%COMP%]   .sk-circle7[_ngcontent-%COMP%]:before{animation-delay:-.6s}.sk-circle[_ngcontent-%COMP%]   .sk-circle8[_ngcontent-%COMP%]:before{animation-delay:-.5s}.sk-circle[_ngcontent-%COMP%]   .sk-circle9[_ngcontent-%COMP%]:before{animation-delay:-.4s}.sk-circle[_ngcontent-%COMP%]   .sk-circle10[_ngcontent-%COMP%]:before{animation-delay:-.3s}.sk-circle[_ngcontent-%COMP%]   .sk-circle11[_ngcontent-%COMP%]:before{animation-delay:-.2s}.sk-circle[_ngcontent-%COMP%]   .sk-circle12[_ngcontent-%COMP%]:before{animation-delay:-.1s}@keyframes sk-circleBounceDelay{0%,80%,to{transform:scale(0)}40%{transform:scale(1)}}']}),n})(),E3e=(()=>{class n{constructor(){this.markers=new vc.LayerGroup,this.miniMarkers=new vc.LayerGroup,this.icons=[],this.miniIcons=[],this.colors=[]}ngAfterViewInit(){this.initMap()}initMap(){this.map=vc.map("map",{center:[39.8282,-98.5795],zoom:4,layers:[this.markers,this.miniMarkers]}),vc.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,minZoom:4,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(this.map);for(let i=0;i<25;i++){var r=Math.floor(16777215*Math.random()).toString(16);this.colors.push(`#${r}`);let o=vc.divIcon({className:"map-pin",iconSize:[25,25],html:`<span style="\n      background-color: #${r};\n      width: 1.25rem;\n      height: 1.25rem;\n      display: block;\n      left: 0;\n      top: 0;\n      position: relative;\n      border-radius: 1.25rem;\n      border: 1px solid #FFFFFF" />`}),u=vc.divIcon({className:"mini-pin-mini",iconSize:[10,10],html:`<span style="\n      background-color: #${r};\n      width: 1rem;\n      height: 1rem;\n      display: block;\n      left: 0;\n      top: 0;\n      position: relative;\n      border-radius: 1rem;\n      border: 1px solid #FFFFFF" />`});this.icons.push(o),this.miniIcons.push(u)}}PanTo(e){this.map.panTo(e)}UpdateMapMarkers(e){for(let o in e){let a=0,u=0,d=parseInt(o);[a,u]=this.getAveragePoint(e[o]);var r=vc.marker([a,u],{icon:this.icons[d]});r.on("click",m=>{this.displayPointsInCluster(e,d)}),r.addTo(this.markers)}console.log("creating convex hulls");for(let o in e){let a=parseInt(o);var i=this.convexHull(e[o]);vc.polygon(i,{color:this.colors[a]}).addTo(this.markers)}}ClearMarkers(){this.markers.clearLayers()}UpdateMapCenter(e){let r=0,i=0;for(let s=0;s<e.length;s++)r+=e[s][0],i+=e[s][1];r/=e.length,i/=e.length,this.map.panTo(new vc.LatLng(r,i))}displayPointsInCluster(e,r){this.miniMarkers.clearLayers();let i=e[r];for(let o=0;o<i.length;o++)vc.marker([i[o][0],i[o][1]],{icon:this.miniIcons[r]}).addTo(this.miniMarkers);console.log(`displaying points in cluster ${r}`)}getAveragePoint(e){let r=0,i=0;for(let s=0;s<e.length;s++)r+=e[s][0],i+=e[s][1];return r/=e.length,i/=e.length,[r,i]}cross(e,r,i){return(e[0]-i[0])*(r[1]-i[1])-(e[1]-i[1])*(r[0]-i[0])}convexHull(e){e.sort(function(o,a){return o[0]==a[0]?o[1]-a[1]:o[0]-a[0]});for(var r=[],i=0;i<e.length;i++){for(;r.length>=2&&this.cross(r[r.length-2],r[r.length-1],e[i])<=0;)r.pop();r.push(e[i])}var s=[];for(i=e.length-1;i>=0;i--){for(;s.length>=2&&this.cross(s[s.length-2],s[s.length-1],e[i])<=0;)s.pop();s.push(e[i])}return s.pop(),r.pop(),r.concat(s)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Vl({type:n,selectors:[["app-map"]],decls:1,vars:0,consts:[["id","map"]],template:function(e,r){1&e&&lo(0,"div",0)},styles:["#map[_ngcontent-%COMP%]{height:100%;width:100%}"]}),n})();const N3e=["map"];function T3e(n,t){1&n&&(Kr(0,"mat-error"),zs(1,"Must be between 1 and 2000."),Gr())}function A3e(n,t){1&n&&(Kr(0,"mat-error"),zs(1,"Invalid Minimum Clusters."),Gr())}function I3e(n,t){1&n&&(Kr(0,"mat-error"),zs(1,"Invalid Maximum Clusters."),Gr())}function D3e(n,t){if(1&n){const e=dg();Kr(0,"button",21),Vs("click",function(){return Fm(e),cu().SaveFile()}),zs(1," Download Clustered Data "),Gr()}if(2&n){const e=cu();Ri("disabled",e.settingsForm.invalid||e.showSpinner||null==e.uploadedFile)}}function M3e(n,t){1&n&&lo(0,"app-loading-spinner")}function k3e(n,t){if(1&n&&(Kr(0,"p"),zs(1),Gr()),2&n){const e=cu();Li(1),pp(e.loadLoggerService.Message)}}let R3e=(()=>{class n{constructor(e){this.loadLoggerService=e,this.title="geo-cluster",this.LONGITUDE="longitude",this.LATITUDE="latitude",this.clusters=[],this.markers=new vc.LayerGroup,this.miniMarkers=new vc.LayerGroup,this.uploadedFile=void 0,this.UploadedFileName="",this.icons=[],this.miniIcons=[],this.colors=[],this.visiblePoints=[],this.showSpinner=!1,this.settingsForm=new OF({minimumClusterCount:new UE(5,[$E.min(2)]),maximumClusterCount:new UE(20,[$E.max(20)]),maxDistance:new UE(500,[$E.min(1),$E.max(1e3)])})}ngAfterViewInit(){(0,Fue.setBackend)(_t)}UploadedFileChanged(e){if(!e.target.files[0])return;this.uploadedFile=e.target.files[0];let r=new FileReader;r.onload=i=>{console.log("done"),z$e().fromString(r.result).then(s=>{if(this.dataFrame=s,!this.isValidCsvFile())return alert("Invalid file: missing longitude or latitude information"),this.uploadedFile=void 0,void(this.UploadedFileName="");this.UploadedFileName=this.uploadedFile.name,this.setLongitudeAndLatitudeConstants(),this.addClusterColumn(),this.dataFrameLocations=new Array(this.dataFrame.length).fill([0,0]);for(let o=0;o<this.dataFrame.length;o++)this.dataFrameLocations[o]=[parseFloat(this.dataFrame[o][this.LATITUDE]),parseFloat(this.dataFrame[o][this.LONGITUDE])]})},r.onprogress=i=>{i.lengthComputable&&console.log("Progress: "+i.loaded/i.total*100)},r.readAsText(this.uploadedFile)}SaveFile(){for(let a=0;a<this.dataFrame.length;a++)this.dataFrame[a].cluster=this.dataFrameLocations[a][2];let i=function e(a){let u=a.map(d=>Object.values(d));return u.unshift(Object.keys(a[0])),`${u.join("\n").replace(/,/g,",")}`}(this.dataFrame);const s=new Blob([i],{type:"text/csv"}),o=document.createElement("a");o.href=URL.createObjectURL(s),o.download="ClusteredData.csv",o.click(),o.remove()}resetClusterValues(){for(let e=0;e<this.dataFrame.length;e++)this.dataFrame[e].cluster=0}addClusterColumn(){for(let e=0;e<this.dataFrame.length;e++)this.dataFrame[e].cluster=0}isValidCsvFile(){return!(!this.dataFrame[0].longitude&&!this.dataFrame[0].Longitude||!this.dataFrame[0].latitude&&!this.dataFrame[0].Latitude)}setLongitudeAndLatitudeConstants(){this.LONGITUDE=this.dataFrame[0].longitude?"longitude":"Longitude",this.LATITUDE=this.dataFrame[0].latitude?"latitude":"Latitude"}FindValidClusters(){if(0!=this.dataFrameLocations.length)if(this.settingsForm.controls.minimumClusterCount.value>=this.settingsForm.controls.maximumClusterCount.value)alert("Minimum Clusters must be less than Maximum Clusters");else if(this.mapComponent.ClearMarkers(),this.clusters=[],this.resetClusterValues(),this.showSpinner=!0,this.loadLoggerService.LogMessage(""),"undefined"!=typeof Worker){const e=new Worker(z.tu(new URL(z.p+z.u(676),z.b)));e.onmessage=({data:r})=>{let i=r;i.status==GE.Progess?this.loadLoggerService.LogMessage(i.message||""):i.status==GE.Error?(this.loadLoggerService.LogMessage(i.message||"",!0),this.showSpinner=!1):(this.dataFrameLocations=i.data.points,this.clusters=i.data.clusters,console.log(this.clusters),console.log(this.dataFrameLocations),this.mapComponent.ClearMarkers(),this.mapComponent.UpdateMapMarkers(this.clusters),this.loadLoggerService.LogMessage(""),this.showSpinner=!1)},console.log("Starting worker"),console.log(this.dataFrameLocations),e.postMessage({points:this.dataFrameLocations,clusters:this.clusters,minimumClusters:this.settingsForm.controls.minimumClusterCount.value,maximumClusters:this.settingsForm.controls.maximumClusterCount.value,maxDistance:this.settingsForm.controls.maxDistance.value})}else console.warn("Workers aren't available"),this.showSpinner=!1;else alert("No data to cluster")}}return n.\u0275fac=function(e){return new(e||n)(nn(U$e))},n.\u0275cmp=Vl({type:n,selectors:[["app-root"]],viewQuery:function(e,r){if(1&e&&Ii(N3e,5),2&e){let i;mn(i=Aa())&&(r.mapComponent=i.first)}},decls:47,vars:9,consts:[[1,"page-container"],[1,"header"],[1,"inputs-container"],[1,"file-upload-container"],["type","file",1,"file-input",3,"change"],["fileUpload",""],[1,"file-upload"],["mat-mini-fab","","color","accent",1,"upload-btn",3,"click"],[1,"cluster-settings-form",3,"formGroup"],[1,"cluster-diameter-settings"],["appearance","outline","color","primary",1,"cluster-settings-wide-form-field"],["matInput","","type","number","formControlName","maxDistance"],["matSuffix","","matTooltipPosition","right","matTooltip","The maximum distance between any two points in a cluster","matTooltipClass","primary-tooltip"],[4,"ngIf"],[1,"cluster-settings-container"],["appearance","outline","color","primary"],["matInput","","type","number","formControlName","minimumClusterCount"],["matSuffix","","matTooltipPosition","right","matTooltip","The minimum number of clusters to search for","matTooltipClass","primary-tooltip"],["matInput","","type","number","formControlName","maximumClusterCount"],["matSuffix","","matTooltipPosition","right","matTooltip","The maximum number of clusters to search for","matTooltipClass","primary-tooltip"],[1,"buttons-container"],["mat-raised-button","",1,"cluster-button",3,"disabled","click"],["mat-raised-button","","class","cluster-button",3,"disabled","click",4,"ngIf"],[1,"log-container"],[1,"map-container"],["map",""]],template:function(e,r){if(1&e){const i=dg();Kr(0,"div",0)(1,"div",1)(2,"h1"),zs(3,"Location Clusterer"),Gr()(),Kr(4,"div",2)(5,"div",3)(6,"input",4,5),Vs("change",function(o){return r.UploadedFileChanged(o)}),Gr(),Kr(8,"div",6),zs(9),Kr(10,"button",7),Vs("click",function(){return Fm(i),function GA(n){return Pd(function aP(){return Ir.lFrame.contextLView}(),20+n)}(7).click()}),Kr(11,"mat-icon"),zs(12,"attach_file"),Gr()()()(),Kr(13,"form",8)(14,"div",9)(15,"mat-form-field",10)(16,"mat-label"),zs(17,"Maximum Cluster Diameter (miles)"),Gr(),lo(18,"input",11),Kr(19,"mat-icon",12),zs(20,"help_outline"),Gr(),So(21,T3e,2,0,"mat-error",13),Gr()(),Kr(22,"div",14)(23,"mat-form-field",15)(24,"mat-label"),zs(25,"Minimum Clusters"),Gr(),lo(26,"input",16),Kr(27,"mat-icon",17),zs(28,"help_outline"),Gr(),So(29,A3e,2,0,"mat-error",13),Gr(),Kr(30,"mat-form-field",15)(31,"mat-label"),zs(32,"Maximum Clusters"),Gr(),lo(33,"input",18),Kr(34,"mat-icon",19),zs(35,"help_outline"),Gr(),So(36,I3e,2,0,"mat-error",13),Gr()(),Kr(37,"div",20)(38,"button",21),Vs("click",function(){return r.FindValidClusters()}),zs(39," Generate Clusters "),Gr(),So(40,D3e,2,1,"button",22),Gr()()(),Kr(41,"div",23),So(42,M3e,1,0,"app-loading-spinner",13),So(43,k3e,2,1,"p",13),Gr(),Kr(44,"div",24),lo(45,"app-map",null,25),Gr()()}2&e&&(Li(9),Ky(" ",r.UploadedFileName||"No file uploaded yet."," "),Li(4),Ri("formGroup",r.settingsForm),Li(8),Ri("ngIf",r.settingsForm.controls.maxDistance.invalid&&(r.settingsForm.controls.maxDistance.dirty||r.settingsForm.controls.maxDistance.touched)),Li(8),Ri("ngIf",r.settingsForm.controls.minimumClusterCount.invalid&&(r.settingsForm.controls.minimumClusterCount.dirty||r.settingsForm.controls.minimumClusterCount.touched)),Li(7),Ri("ngIf",r.settingsForm.controls.maximumClusterCount.invalid&&(r.settingsForm.controls.maximumClusterCount.dirty||r.settingsForm.controls.maximumClusterCount.touched)),Li(2),Ri("disabled",r.settingsForm.invalid||r.showSpinner||null==r.uploadedFile),Li(2),Ri("ngIf",!r.showSpinner&&r.clusters.length>0),Li(2),Ri("ngIf",r.showSpinner),Li(1),Ri("ngIf",""!=r.loadLoggerService.Message))},directives:[Yae,fBe,Are,fre,WE,Oue,q4,_Be,t8,SF,hre,s8,Due,b3e,Ig,Eue,S3e,E3e],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box;margin:0;padding:0}html[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{margin:0;height:100%}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{margin:0;font-family:Roboto,Helvetica Neue,sans-serif}.page-container[_ngcontent-%COMP%]{width:100vw;height:100vh;display:flex;flex-direction:column;align-items:center;font-family:Open Sans,sans-serif}.header[_ngcontent-%COMP%]{height:10vh;display:flex;width:100vw;flex-direction:column;justify-content:center;align-items:center}.inputs-container[_ngcontent-%COMP%]{width:100vw;display:flex;flex-direction:column;align-items:center;gap:20px}.cluster-settings-form[_ngcontent-%COMP%]{padding-bottom:15px}.cluster-settings-wide-form-field[_ngcontent-%COMP%]{width:min(260px,70vw)}.input-error[_ngcontent-%COMP%]{display:block;color:red;padding:0;margin:0}.file-upload-container[_ngcontent-%COMP%]{width:min(900px,70vw);display:flex;justify-content:center}.file-upload[_ngcontent-%COMP%]{padding-top:10px;width:min(400px,70vw);display:flex;justify-content:center;align-items:center;gap:10px;font-family:Open Sans,sans-serif}.file-input[_ngcontent-%COMP%]{display:none}.cluster-diameter-settings[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:min(900px,70vw);justify-content:center;align-items:center;gap:10px}.cluster-settings-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:min(900px,70vw);justify-content:center;gap:10px}.cluster-settings-form-field[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif}.buttons-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}.cluster-button[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#fff;margin:0 10px;background-image:linear-gradient(to right,var(--theme-gradient-color1),var(--theme-gradient-color2))}.log-container[_ngcontent-%COMP%]{height:5vh;width:90vw;color:#000;display:flex;flex-direction:row;justify-content:center;align-items:center;gap:10px}.map-container[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0003,0 6px 20px #00000030;height:60vh;width:70vw;overflow:hidden;margin:10px}"]}),n})(),O3e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=Vi({type:n,bootstrap:[R3e]}),n.\u0275inj=Ci({providers:[],imports:[[Fz,kae,Qae,Z4,bBe,dBe,B$e,V$e,C3e]]}),n})();(function YG(){vM=!1})(),Oz().bootstrapModule(O3e).catch(n=>console.error(n))},1006:function(rt,Ae){var G;!function(K){"use strict";var ue=Math.cosh||function(W){return Math.abs(W)<1e-9?1-W:.5*(Math.exp(W)+Math.exp(-W))},re=Math.sinh||function(W){return Math.abs(W)<1e-9?W:.5*(Math.exp(W)-Math.exp(-W))},be=function(){throw SyntaxError("Invalid Param")};function V(W,J){var H=Math.abs(W),Y=Math.abs(J);return 0===W?Math.log(Y):0===J?Math.log(H):H<3e3&&Y<3e3?.5*Math.log(W*W+J*J):(W/=2,J/=2,.5*Math.log(W*W+J*J)+Math.LN2)}function ge(W,J){if(!(this instanceof ge))return new ge(W,J);var H=function(W,J){var H={re:0,im:0};if(null==W)H.re=H.im=0;else if(void 0!==J)H.re=W,H.im=J;else switch(typeof W){case"object":if("im"in W&&"re"in W)H.re=W.re,H.im=W.im;else if("abs"in W&&"arg"in W){if(!Number.isFinite(W.abs)&&Number.isFinite(W.arg))return ge.INFINITY;H.re=W.abs*Math.cos(W.arg),H.im=W.abs*Math.sin(W.arg)}else if("r"in W&&"phi"in W){if(!Number.isFinite(W.r)&&Number.isFinite(W.phi))return ge.INFINITY;H.re=W.r*Math.cos(W.phi),H.im=W.r*Math.sin(W.phi)}else 2===W.length?(H.re=W[0],H.im=W[1]):be();break;case"string":H.im=H.re=0;var Y=W.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),me=1,te=0;null===Y&&be();for(var ce=0;ce<Y.length;ce++){var xe=Y[ce];" "===xe||"\t"===xe||"\n"===xe||("+"===xe?me++:"-"===xe?te++:"i"===xe||"I"===xe?(me+te===0&&be()," "===Y[ce+1]||isNaN(Y[ce+1])?H.im+=parseFloat((te%2?"-":"")+"1"):(H.im+=parseFloat((te%2?"-":"")+Y[ce+1]),ce++),me=te=0):((me+te===0||isNaN(xe))&&be(),"i"===Y[ce+1]||"I"===Y[ce+1]?(H.im+=parseFloat((te%2?"-":"")+xe),ce++):H.re+=parseFloat((te%2?"-":"")+xe),me=te=0))}me+te>0&&be();break;case"number":H.im=0,H.re=W;break;default:be()}return isNaN(H.re)||isNaN(H.im),H}(W,J);this.re=H.re,this.im=H.im}ge.prototype={re:0,im:0,sign:function(){var W=this.abs();return new ge(this.re/W,this.im/W)},add:function(W,J){var H=new ge(W,J);return this.isInfinite()&&H.isInfinite()?ge.NAN:this.isInfinite()||H.isInfinite()?ge.INFINITY:new ge(this.re+H.re,this.im+H.im)},sub:function(W,J){var H=new ge(W,J);return this.isInfinite()&&H.isInfinite()?ge.NAN:this.isInfinite()||H.isInfinite()?ge.INFINITY:new ge(this.re-H.re,this.im-H.im)},mul:function(W,J){var H=new ge(W,J);return this.isInfinite()&&H.isZero()||this.isZero()&&H.isInfinite()?ge.NAN:this.isInfinite()||H.isInfinite()?ge.INFINITY:0===H.im&&0===this.im?new ge(this.re*H.re,0):new ge(this.re*H.re-this.im*H.im,this.re*H.im+this.im*H.re)},div:function(W,J){var H=new ge(W,J);if(this.isZero()&&H.isZero()||this.isInfinite()&&H.isInfinite())return ge.NAN;if(this.isInfinite()||H.isZero())return ge.INFINITY;if(this.isZero()||H.isInfinite())return ge.ZERO;W=this.re,J=this.im;var te,ce,Y=H.re,me=H.im;return 0===me?new ge(W/Y,J/Y):Math.abs(Y)<Math.abs(me)?new ge((W*(ce=Y/me)+J)/(te=Y*ce+me),(J*ce-W)/te):new ge((W+J*(ce=me/Y))/(te=me*ce+Y),(J-W*ce)/te)},pow:function(W,J){var H=new ge(W,J);if(W=this.re,J=this.im,H.isZero())return ge.ONE;if(0===H.im){if(0===J&&W>0)return new ge(Math.pow(W,H.re),0);if(0===W)switch((H.re%4+4)%4){case 0:return new ge(Math.pow(J,H.re),0);case 1:return new ge(0,Math.pow(J,H.re));case 2:return new ge(-Math.pow(J,H.re),0);case 3:return new ge(0,-Math.pow(J,H.re))}}if(0===W&&0===J&&H.re>0&&H.im>=0)return ge.ZERO;var Y=Math.atan2(J,W),me=V(W,J);return W=Math.exp(H.re*me-H.im*Y),J=H.im*me+H.re*Y,new ge(W*Math.cos(J),W*Math.sin(J))},sqrt:function(){var Y,me,W=this.re,J=this.im,H=this.abs();if(W>=0){if(0===J)return new ge(Math.sqrt(W),0);Y=.5*Math.sqrt(2*(H+W))}else Y=Math.abs(J)/Math.sqrt(2*(H-W));return me=W<=0?.5*Math.sqrt(2*(H-W)):Math.abs(J)/Math.sqrt(2*(H+W)),new ge(Y,J<0?-me:me)},exp:function(){var W=Math.exp(this.re);return new ge(W*Math.cos(this.im),W*Math.sin(this.im))},expm1:function(){var W=this.re,J=this.im;return new ge(Math.expm1(W)*Math.cos(J)+function(W){var J=Math.PI/4;if(-J>W||W>J)return Math.cos(W)-1;var H=W*W;return H*(H*(H*(H*(H*(H*(H*(H/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(J),Math.exp(W)*Math.sin(J))},log:function(){var W=this.re,J=this.im;return new ge(V(W,J),Math.atan2(J,W))},abs:function(){return W=this.re,J=this.im,H=Math.abs(W),Y=Math.abs(J),H<3e3&&Y<3e3?Math.sqrt(H*H+Y*Y):(H<Y?(H=Y,Y=W/J):Y=J/W,H*Math.sqrt(1+Y*Y));var W,J,H,Y},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){var W=this.re,J=this.im;return new ge(Math.sin(W)*ue(J),Math.cos(W)*re(J))},cos:function(){var W=this.re,J=this.im;return new ge(Math.cos(W)*ue(J),-Math.sin(W)*re(J))},tan:function(){var W=2*this.re,J=2*this.im,H=Math.cos(W)+ue(J);return new ge(Math.sin(W)/H,re(J)/H)},cot:function(){var W=2*this.re,J=2*this.im,H=Math.cos(W)-ue(J);return new ge(-Math.sin(W)/H,re(J)/H)},sec:function(){var W=this.re,J=this.im,H=.5*ue(2*J)+.5*Math.cos(2*W);return new ge(Math.cos(W)*ue(J)/H,Math.sin(W)*re(J)/H)},csc:function(){var W=this.re,J=this.im,H=.5*ue(2*J)-.5*Math.cos(2*W);return new ge(Math.sin(W)*ue(J)/H,-Math.cos(W)*re(J)/H)},asin:function(){var W=this.re,J=this.im,H=new ge(J*J-W*W+1,-2*W*J).sqrt(),Y=new ge(H.re-J,H.im+W).log();return new ge(Y.im,-Y.re)},acos:function(){var W=this.re,J=this.im,H=new ge(J*J-W*W+1,-2*W*J).sqrt(),Y=new ge(H.re-J,H.im+W).log();return new ge(Math.PI/2-Y.im,Y.re)},atan:function(){var W=this.re,J=this.im;if(0===W){if(1===J)return new ge(0,1/0);if(-1===J)return new ge(0,-1/0)}var H=W*W+(1-J)*(1-J),Y=new ge((1-J*J-W*W)/H,-2*W/H).log();return new ge(-.5*Y.im,.5*Y.re)},acot:function(){var W=this.re,J=this.im;if(0===J)return new ge(Math.atan2(1,W),0);var H=W*W+J*J;return 0!==H?new ge(W/H,-J/H).atan():new ge(0!==W?W/0:0,0!==J?-J/0:0).atan()},asec:function(){var W=this.re,J=this.im;if(0===W&&0===J)return new ge(0,1/0);var H=W*W+J*J;return 0!==H?new ge(W/H,-J/H).acos():new ge(0!==W?W/0:0,0!==J?-J/0:0).acos()},acsc:function(){var W=this.re,J=this.im;if(0===W&&0===J)return new ge(Math.PI/2,1/0);var H=W*W+J*J;return 0!==H?new ge(W/H,-J/H).asin():new ge(0!==W?W/0:0,0!==J?-J/0:0).asin()},sinh:function(){var W=this.re,J=this.im;return new ge(re(W)*Math.cos(J),ue(W)*Math.sin(J))},cosh:function(){var W=this.re,J=this.im;return new ge(ue(W)*Math.cos(J),re(W)*Math.sin(J))},tanh:function(){var W=2*this.re,J=2*this.im,H=ue(W)+Math.cos(J);return new ge(re(W)/H,Math.sin(J)/H)},coth:function(){var W=2*this.re,J=2*this.im,H=ue(W)-Math.cos(J);return new ge(re(W)/H,-Math.sin(J)/H)},csch:function(){var W=this.re,J=this.im,H=Math.cos(2*J)-ue(2*W);return new ge(-2*re(W)*Math.cos(J)/H,2*ue(W)*Math.sin(J)/H)},sech:function(){var W=this.re,J=this.im,H=Math.cos(2*J)+ue(2*W);return new ge(2*ue(W)*Math.cos(J)/H,-2*re(W)*Math.sin(J)/H)},asinh:function(){var W=this.im;this.im=-this.re,this.re=W;var J=this.asin();return this.re=-this.im,this.im=W,W=J.re,J.re=-J.im,J.im=W,J},acosh:function(){var W=this.acos();if(W.im<=0){var J=W.re;W.re=-W.im,W.im=J}else J=W.im,W.im=-W.re,W.re=J;return W},atanh:function(){var W=this.re,J=this.im,H=W>1&&0===J,Y=1-W,me=1+W,te=Y*Y+J*J,ce=0!==te?new ge((me*Y-J*J)/te,(J*Y+me*J)/te):new ge(-1!==W?W/0:0,0!==J?J/0:0),xe=ce.re;return ce.re=V(ce.re,ce.im)/2,ce.im=Math.atan2(ce.im,xe)/2,H&&(ce.im=-ce.im),ce},acoth:function(){var W=this.re,J=this.im;if(0===W&&0===J)return new ge(0,Math.PI/2);var H=W*W+J*J;return 0!==H?new ge(W/H,-J/H).atanh():new ge(0!==W?W/0:0,0!==J?-J/0:0).atanh()},acsch:function(){var W=this.re,J=this.im;if(0===J)return new ge(0!==W?Math.log(W+Math.sqrt(W*W+1)):1/0,0);var H=W*W+J*J;return 0!==H?new ge(W/H,-J/H).asinh():new ge(0!==W?W/0:0,0!==J?-J/0:0).asinh()},asech:function(){var W=this.re,J=this.im;if(this.isZero())return ge.INFINITY;var H=W*W+J*J;return 0!==H?new ge(W/H,-J/H).acosh():new ge(0!==W?W/0:0,0!==J?-J/0:0).acosh()},inverse:function(){if(this.isZero())return ge.INFINITY;if(this.isInfinite())return ge.ZERO;var W=this.re,J=this.im,H=W*W+J*J;return new ge(W/H,-J/H)},conjugate:function(){return new ge(this.re,-this.im)},neg:function(){return new ge(-this.re,-this.im)},ceil:function(W){return W=Math.pow(10,W||0),new ge(Math.ceil(this.re*W)/W,Math.ceil(this.im*W)/W)},floor:function(W){return W=Math.pow(10,W||0),new ge(Math.floor(this.re*W)/W,Math.floor(this.im*W)/W)},round:function(W){return W=Math.pow(10,W||0),new ge(Math.round(this.re*W)/W,Math.round(this.im*W)/W)},equals:function(W,J){var H=new ge(W,J);return Math.abs(H.re-this.re)<=ge.EPSILON&&Math.abs(H.im-this.im)<=ge.EPSILON},clone:function(){return new ge(this.re,this.im)},toString:function(){var W=this.re,J=this.im,H="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(W)<ge.EPSILON&&(W=0),Math.abs(J)<ge.EPSILON&&(J=0),0===J?H+W:(0!==W?(H+=W,H+=" ",J<0?(J=-J,H+="-"):H+="+",H+=" "):J<0&&(J=-J,H+="-"),1!==J&&(H+=J),H+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},ge.ZERO=new ge(0,0),ge.ONE=new ge(1,0),ge.I=new ge(0,1),ge.PI=new ge(Math.PI,0),ge.E=new ge(Math.E,0),ge.INFINITY=new ge(1/0,1/0),ge.NAN=new ge(NaN,NaN),ge.EPSILON=1e-15,void 0!==(G=function(){return ge}.apply(Ae,[]))&&(rt.exports=G)}()},8660:rt=>{rt.exports=function(Ae){var z={};function G(K){if(z[K])return z[K].exports;var ue=z[K]={i:K,l:!1,exports:{}};return Ae[K].call(ue.exports,ue,ue.exports,G),ue.l=!0,ue.exports}return G.m=Ae,G.c=z,G.d=function(K,ue,re){G.o(K,ue)||Object.defineProperty(K,ue,{enumerable:!0,get:re})},G.r=function(K){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(K,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(K,"__esModule",{value:!0})},G.t=function(K,ue){if(1&ue&&(K=G(K)),8&ue||4&ue&&"object"==typeof K&&K&&K.__esModule)return K;var re=Object.create(null);if(G.r(re),Object.defineProperty(re,"default",{enumerable:!0,value:K}),2&ue&&"string"!=typeof K)for(var X in K)G.d(re,X,function(se){return K[se]}.bind(null,X));return re},G.n=function(K){var ue=K&&K.__esModule?function(){return K.default}:function(){return K};return G.d(ue,"a",ue),ue},G.o=function(K,ue){return Object.prototype.hasOwnProperty.call(K,ue)},G.p="",G(G.s=32)}([function(Ae,z){var G;G=function(){return this}();try{G=G||Function("return this")()||(0,eval)("this")}catch(K){"object"==typeof window&&(G=window)}Ae.exports=G},function(Ae,z,G){"use strict";var K=G(6),ue=Object.keys||function(H){var Y=[];for(var me in H)Y.push(me);return Y};Ae.exports=ge;var re=G(5);re.inherits=G(2);var X=G(23),se=G(14);re.inherits(ge,X);for(var be=ue(se.prototype),V=0;V<be.length;V++){var ee=be[V];ge.prototype[ee]||(ge.prototype[ee]=se.prototype[ee])}function ge(H){if(!(this instanceof ge))return new ge(H);X.call(this,H),se.call(this,H),H&&!1===H.readable&&(this.readable=!1),H&&!1===H.writable&&(this.writable=!1),this.allowHalfOpen=!0,H&&!1===H.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",W)}function W(){this.allowHalfOpen||this._writableState.ended||K.nextTick(J,this)}function J(H){H.end()}Object.defineProperty(ge.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(ge.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(H){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=H,this._writableState.destroyed=H)}}),ge.prototype._destroy=function(H,Y){this.push(null),this.end(),K.nextTick(Y,H)}},function(Ae,z){Ae.exports="function"==typeof Object.create?function(G,K){G.super_=K,G.prototype=Object.create(K.prototype,{constructor:{value:G,enumerable:!1,writable:!0,configurable:!0}})}:function(G,K){G.super_=K;var ue=function(){};ue.prototype=K.prototype,G.prototype=new ue,G.prototype.constructor=G}},function(Ae,z,G){"use strict";(function(K){var ue=G(38),re=G(39),X=G(40);function se(){return V.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function be(he,_e){if(se()<_e)throw new RangeError("Invalid typed array length");return V.TYPED_ARRAY_SUPPORT?(he=new Uint8Array(_e)).__proto__=V.prototype:(null===he&&(he=new V(_e)),he.length=_e),he}function V(he,_e,Fe){if(!(V.TYPED_ARRAY_SUPPORT||this instanceof V))return new V(he,_e,Fe);if("number"==typeof he){if("string"==typeof _e)throw new Error("If encoding is specified then the first argument must be a string");return W(this,he)}return ee(this,he,_e,Fe)}function ee(he,_e,Fe,yt){if("number"==typeof _e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&_e instanceof ArrayBuffer?function(_t,pt,Sn,Gn){if(Sn<0||pt.byteLength<Sn)throw new RangeError("'offset' is out of bounds");if(pt.byteLength<Sn+(Gn||0))throw new RangeError("'length' is out of bounds");return pt=void 0===Sn&&void 0===Gn?new Uint8Array(pt):void 0===Gn?new Uint8Array(pt,Sn):new Uint8Array(pt,Sn,Gn),V.TYPED_ARRAY_SUPPORT?(_t=pt).__proto__=V.prototype:_t=J(_t,pt),_t}(he,_e,Fe,yt):"string"==typeof _e?function(_t,pt,Sn){if("string"==typeof Sn&&""!==Sn||(Sn="utf8"),!V.isEncoding(Sn))throw new TypeError('"encoding" must be a valid string encoding');var Gn=0|Y(pt,Sn),_r=(_t=be(_t,Gn)).write(pt,Sn);return _r!==Gn&&(_t=_t.slice(0,_r)),_t}(he,_e,Fe):function(_t,pt){if(V.isBuffer(pt)){var Sn=0|H(pt.length);return 0===(_t=be(_t,Sn)).length||pt.copy(_t,0,0,Sn),_t}if(pt){if("undefined"!=typeof ArrayBuffer&&pt.buffer instanceof ArrayBuffer||"length"in pt)return"number"!=typeof pt.length||(Gn=pt.length)!=Gn?be(_t,0):J(_t,pt);if("Buffer"===pt.type&&X(pt.data))return J(_t,pt.data)}var Gn;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(he,_e)}function ge(he){if("number"!=typeof he)throw new TypeError('"size" argument must be a number');if(he<0)throw new RangeError('"size" argument must not be negative')}function W(he,_e){if(ge(_e),he=be(he,_e<0?0:0|H(_e)),!V.TYPED_ARRAY_SUPPORT)for(var Fe=0;Fe<_e;++Fe)he[Fe]=0;return he}function J(he,_e){var Fe=_e.length<0?0:0|H(_e.length);he=be(he,Fe);for(var yt=0;yt<Fe;yt+=1)he[yt]=255&_e[yt];return he}function H(he){if(he>=se())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+se().toString(16)+" bytes");return 0|he}function Y(he,_e){if(V.isBuffer(he))return he.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(he)||he instanceof ArrayBuffer))return he.byteLength;"string"!=typeof he&&(he=""+he);var Fe=he.length;if(0===Fe)return 0;for(var yt=!1;;)switch(_e){case"ascii":case"latin1":case"binary":return Fe;case"utf8":case"utf-8":case void 0:return Vt(he).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Fe;case"hex":return Fe>>>1;case"base64":return Qt(he).length;default:if(yt)return Vt(he).length;_e=(""+_e).toLowerCase(),yt=!0}}function me(he,_e,Fe){var yt=he[_e];he[_e]=he[Fe],he[Fe]=yt}function te(he,_e,Fe,yt,_t){if(0===he.length)return-1;if("string"==typeof Fe?(yt=Fe,Fe=0):Fe>2147483647?Fe=2147483647:Fe<-2147483648&&(Fe=-2147483648),Fe=+Fe,isNaN(Fe)&&(Fe=_t?0:he.length-1),Fe<0&&(Fe=he.length+Fe),Fe>=he.length){if(_t)return-1;Fe=he.length-1}else if(Fe<0){if(!_t)return-1;Fe=0}if("string"==typeof _e&&(_e=V.from(_e,yt)),V.isBuffer(_e))return 0===_e.length?-1:ce(he,_e,Fe,yt,_t);if("number"==typeof _e)return _e&=255,V.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?_t?Uint8Array.prototype.indexOf.call(he,_e,Fe):Uint8Array.prototype.lastIndexOf.call(he,_e,Fe):ce(he,[_e],Fe,yt,_t);throw new TypeError("val must be string, number or Buffer")}function ce(he,_e,Fe,yt,_t){var pt,Sn=1,Gn=he.length,_r=_e.length;if(void 0!==yt&&("ucs2"===(yt=String(yt).toLowerCase())||"ucs-2"===yt||"utf16le"===yt||"utf-16le"===yt)){if(he.length<2||_e.length<2)return-1;Sn=2,Gn/=2,_r/=2,Fe/=2}function mr(xs,ct){return 1===Sn?xs[ct]:xs.readUInt16BE(ct*Sn)}if(_t){var Br=-1;for(pt=Fe;pt<Gn;pt++)if(mr(he,pt)===mr(_e,-1===Br?0:pt-Br)){if(-1===Br&&(Br=pt),pt-Br+1===_r)return Br*Sn}else-1!==Br&&(pt-=pt-Br),Br=-1}else for(Fe+_r>Gn&&(Fe=Gn-_r),pt=Fe;pt>=0;pt--){for(var Ps=!0,Yi=0;Yi<_r;Yi++)if(mr(he,pt+Yi)!==mr(_e,Yi)){Ps=!1;break}if(Ps)return pt}return-1}function xe(he,_e,Fe,yt){Fe=Number(Fe)||0;var _t=he.length-Fe;yt?(yt=Number(yt))>_t&&(yt=_t):yt=_t;var pt=_e.length;if(pt%2!=0)throw new TypeError("Invalid hex string");yt>pt/2&&(yt=pt/2);for(var Sn=0;Sn<yt;++Sn){var Gn=parseInt(_e.substr(2*Sn,2),16);if(isNaN(Gn))return Sn;he[Fe+Sn]=Gn}return Sn}function Pe(he,_e,Fe,yt){return rn(Vt(_e,he.length-Fe),he,Fe,yt)}function Ke(he,_e,Fe,yt){return rn(function(_t){for(var pt=[],Sn=0;Sn<_t.length;++Sn)pt.push(255&_t.charCodeAt(Sn));return pt}(_e),he,Fe,yt)}function Ve(he,_e,Fe,yt){return Ke(he,_e,Fe,yt)}function it(he,_e,Fe,yt){return rn(Qt(_e),he,Fe,yt)}function bt(he,_e,Fe,yt){return rn(function(_t,pt){for(var Sn,Gn,mr=[],Br=0;Br<_t.length&&!((pt-=2)<0);++Br)Gn=(Sn=_t.charCodeAt(Br))>>8,mr.push(Sn%256),mr.push(Gn);return mr}(_e,he.length-Fe),he,Fe,yt)}function $e(he,_e,Fe){return ue.fromByteArray(0===_e&&Fe===he.length?he:he.slice(_e,Fe))}function Ne(he,_e,Fe){Fe=Math.min(he.length,Fe);for(var yt=[],_t=_e;_t<Fe;){var pt,Sn,Gn,_r,mr=he[_t],Br=null,Ps=mr>239?4:mr>223?3:mr>191?2:1;if(_t+Ps<=Fe)switch(Ps){case 1:mr<128&&(Br=mr);break;case 2:128==(192&(pt=he[_t+1]))&&(_r=(31&mr)<<6|63&pt)>127&&(Br=_r);break;case 3:Sn=he[_t+2],128==(192&(pt=he[_t+1]))&&128==(192&Sn)&&(_r=(15&mr)<<12|(63&pt)<<6|63&Sn)>2047&&(_r<55296||_r>57343)&&(Br=_r);break;case 4:Sn=he[_t+2],Gn=he[_t+3],128==(192&(pt=he[_t+1]))&&128==(192&Sn)&&128==(192&Gn)&&(_r=(15&mr)<<18|(63&pt)<<12|(63&Sn)<<6|63&Gn)>65535&&_r<1114112&&(Br=_r)}null===Br?(Br=65533,Ps=1):Br>65535&&(yt.push((Br-=65536)>>>10&1023|55296),Br=56320|1023&Br),yt.push(Br),_t+=Ps}return function(Yi){var xs=Yi.length;if(xs<=we)return String.fromCharCode.apply(String,Yi);for(var ct="",ze=0;ze<xs;)ct+=String.fromCharCode.apply(String,Yi.slice(ze,ze+=we));return ct}(yt)}z.Buffer=V,z.SlowBuffer=function(he){return+he!=he&&(he=0),V.alloc(+he)},z.INSPECT_MAX_BYTES=50,V.TYPED_ARRAY_SUPPORT=void 0!==K.TYPED_ARRAY_SUPPORT?K.TYPED_ARRAY_SUPPORT:function(){try{var he=new Uint8Array(1);return he.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===he.foo()&&"function"==typeof he.subarray&&0===he.subarray(1,1).byteLength}catch(_e){return!1}}(),z.kMaxLength=se(),V.poolSize=8192,V._augment=function(he){return he.__proto__=V.prototype,he},V.from=function(he,_e,Fe){return ee(null,he,_e,Fe)},V.TYPED_ARRAY_SUPPORT&&(V.prototype.__proto__=Uint8Array.prototype,V.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&V[Symbol.species]===V&&Object.defineProperty(V,Symbol.species,{value:null,configurable:!0})),V.alloc=function(he,_e,Fe){return pt=_e,Sn=Fe,ge(_t=he),_t<=0?be(null,_t):void 0!==pt?"string"==typeof Sn?be(null,_t).fill(pt,Sn):be(null,_t).fill(pt):be(null,_t);var _t,pt,Sn},V.allocUnsafe=function(he){return W(null,he)},V.allocUnsafeSlow=function(he){return W(null,he)},V.isBuffer=function(he){return!(null==he||!he._isBuffer)},V.compare=function(he,_e){if(!V.isBuffer(he)||!V.isBuffer(_e))throw new TypeError("Arguments must be Buffers");if(he===_e)return 0;for(var Fe=he.length,yt=_e.length,_t=0,pt=Math.min(Fe,yt);_t<pt;++_t)if(he[_t]!==_e[_t]){Fe=he[_t],yt=_e[_t];break}return Fe<yt?-1:yt<Fe?1:0},V.isEncoding=function(he){switch(String(he).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},V.concat=function(he,_e){if(!X(he))throw new TypeError('"list" argument must be an Array of Buffers');if(0===he.length)return V.alloc(0);var Fe;if(void 0===_e)for(_e=0,Fe=0;Fe<he.length;++Fe)_e+=he[Fe].length;var yt=V.allocUnsafe(_e),_t=0;for(Fe=0;Fe<he.length;++Fe){var pt=he[Fe];if(!V.isBuffer(pt))throw new TypeError('"list" argument must be an Array of Buffers');pt.copy(yt,_t),_t+=pt.length}return yt},V.byteLength=Y,V.prototype._isBuffer=!0,V.prototype.swap16=function(){var he=this.length;if(he%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var _e=0;_e<he;_e+=2)me(this,_e,_e+1);return this},V.prototype.swap32=function(){var he=this.length;if(he%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var _e=0;_e<he;_e+=4)me(this,_e,_e+3),me(this,_e+1,_e+2);return this},V.prototype.swap64=function(){var he=this.length;if(he%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var _e=0;_e<he;_e+=8)me(this,_e,_e+7),me(this,_e+1,_e+6),me(this,_e+2,_e+5),me(this,_e+3,_e+4);return this},V.prototype.toString=function(){var he=0|this.length;return 0===he?"":0===arguments.length?Ne(this,0,he):function(_e,Fe,yt){var _t=!1;if((void 0===Fe||Fe<0)&&(Fe=0),Fe>this.length||((void 0===yt||yt>this.length)&&(yt=this.length),yt<=0)||(yt>>>=0)<=(Fe>>>=0))return"";for(_e||(_e="utf8");;)switch(_e){case"hex":return at(this,Fe,yt);case"utf8":case"utf-8":return Ne(this,Fe,yt);case"ascii":return qe(this,Fe,yt);case"latin1":case"binary":return Ye(this,Fe,yt);case"base64":return $e(this,Fe,yt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return At(this,Fe,yt);default:if(_t)throw new TypeError("Unknown encoding: "+_e);_e=(_e+"").toLowerCase(),_t=!0}}.apply(this,arguments)},V.prototype.equals=function(he){if(!V.isBuffer(he))throw new TypeError("Argument must be a Buffer");return this===he||0===V.compare(this,he)},V.prototype.inspect=function(){var he="",_e=z.INSPECT_MAX_BYTES;return this.length>0&&(he=this.toString("hex",0,_e).match(/.{2}/g).join(" "),this.length>_e&&(he+=" ... ")),"<Buffer "+he+">"},V.prototype.compare=function(he,_e,Fe,yt,_t){if(!V.isBuffer(he))throw new TypeError("Argument must be a Buffer");if(void 0===_e&&(_e=0),void 0===Fe&&(Fe=he?he.length:0),void 0===yt&&(yt=0),void 0===_t&&(_t=this.length),_e<0||Fe>he.length||yt<0||_t>this.length)throw new RangeError("out of range index");if(yt>=_t&&_e>=Fe)return 0;if(yt>=_t)return-1;if(_e>=Fe)return 1;if(this===he)return 0;for(var pt=(_t>>>=0)-(yt>>>=0),Sn=(Fe>>>=0)-(_e>>>=0),Gn=Math.min(pt,Sn),_r=this.slice(yt,_t),mr=he.slice(_e,Fe),Br=0;Br<Gn;++Br)if(_r[Br]!==mr[Br]){pt=_r[Br],Sn=mr[Br];break}return pt<Sn?-1:Sn<pt?1:0},V.prototype.includes=function(he,_e,Fe){return-1!==this.indexOf(he,_e,Fe)},V.prototype.indexOf=function(he,_e,Fe){return te(this,he,_e,Fe,!0)},V.prototype.lastIndexOf=function(he,_e,Fe){return te(this,he,_e,Fe,!1)},V.prototype.write=function(he,_e,Fe,yt){if(void 0===_e)yt="utf8",Fe=this.length,_e=0;else if(void 0===Fe&&"string"==typeof _e)yt=_e,Fe=this.length,_e=0;else{if(!isFinite(_e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");_e|=0,isFinite(Fe)?(Fe|=0,void 0===yt&&(yt="utf8")):(yt=Fe,Fe=void 0)}var _t=this.length-_e;if((void 0===Fe||Fe>_t)&&(Fe=_t),he.length>0&&(Fe<0||_e<0)||_e>this.length)throw new RangeError("Attempt to write outside buffer bounds");yt||(yt="utf8");for(var pt=!1;;)switch(yt){case"hex":return xe(this,he,_e,Fe);case"utf8":case"utf-8":return Pe(this,he,_e,Fe);case"ascii":return Ke(this,he,_e,Fe);case"latin1":case"binary":return Ve(this,he,_e,Fe);case"base64":return it(this,he,_e,Fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return bt(this,he,_e,Fe);default:if(pt)throw new TypeError("Unknown encoding: "+yt);yt=(""+yt).toLowerCase(),pt=!0}},V.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var we=4096;function qe(he,_e,Fe){var yt="";Fe=Math.min(he.length,Fe);for(var _t=_e;_t<Fe;++_t)yt+=String.fromCharCode(127&he[_t]);return yt}function Ye(he,_e,Fe){var yt="";Fe=Math.min(he.length,Fe);for(var _t=_e;_t<Fe;++_t)yt+=String.fromCharCode(he[_t]);return yt}function at(he,_e,Fe){var yt=he.length;(!_e||_e<0)&&(_e=0),(!Fe||Fe<0||Fe>yt)&&(Fe=yt);for(var _t="",pt=_e;pt<Fe;++pt)_t+=xt(he[pt]);return _t}function At(he,_e,Fe){for(var yt=he.slice(_e,Fe),_t="",pt=0;pt<yt.length;pt+=2)_t+=String.fromCharCode(yt[pt]+256*yt[pt+1]);return _t}function Ut(he,_e,Fe){if(he%1!=0||he<0)throw new RangeError("offset is not uint");if(he+_e>Fe)throw new RangeError("Trying to access beyond buffer length")}function Mt(he,_e,Fe,yt,_t,pt){if(!V.isBuffer(he))throw new TypeError('"buffer" argument must be a Buffer instance');if(_e>_t||_e<pt)throw new RangeError('"value" argument is out of bounds');if(Fe+yt>he.length)throw new RangeError("Index out of range")}function sn(he,_e,Fe,yt){_e<0&&(_e=65535+_e+1);for(var _t=0,pt=Math.min(he.length-Fe,2);_t<pt;++_t)he[Fe+_t]=(_e&255<<8*(yt?_t:1-_t))>>>8*(yt?_t:1-_t)}function je(he,_e,Fe,yt){_e<0&&(_e=4294967295+_e+1);for(var _t=0,pt=Math.min(he.length-Fe,4);_t<pt;++_t)he[Fe+_t]=_e>>>8*(yt?_t:3-_t)&255}function We(he,_e,Fe,yt,_t,pt){if(Fe+yt>he.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("Index out of range")}function tt(he,_e,Fe,yt,_t){return _t||We(he,0,Fe,4),re.write(he,_e,Fe,yt,23,4),Fe+4}function Pt(he,_e,Fe,yt,_t){return _t||We(he,0,Fe,8),re.write(he,_e,Fe,yt,52,8),Fe+8}V.prototype.slice=function(he,_e){var Fe,yt=this.length;if((he=~~he)<0?(he+=yt)<0&&(he=0):he>yt&&(he=yt),(_e=void 0===_e?yt:~~_e)<0?(_e+=yt)<0&&(_e=0):_e>yt&&(_e=yt),_e<he&&(_e=he),V.TYPED_ARRAY_SUPPORT)(Fe=this.subarray(he,_e)).__proto__=V.prototype;else{var _t=_e-he;Fe=new V(_t,void 0);for(var pt=0;pt<_t;++pt)Fe[pt]=this[pt+he]}return Fe},V.prototype.readUIntLE=function(he,_e,Fe){he|=0,_e|=0,Fe||Ut(he,_e,this.length);for(var yt=this[he],_t=1,pt=0;++pt<_e&&(_t*=256);)yt+=this[he+pt]*_t;return yt},V.prototype.readUIntBE=function(he,_e,Fe){he|=0,_e|=0,Fe||Ut(he,_e,this.length);for(var yt=this[he+--_e],_t=1;_e>0&&(_t*=256);)yt+=this[he+--_e]*_t;return yt},V.prototype.readUInt8=function(he,_e){return _e||Ut(he,1,this.length),this[he]},V.prototype.readUInt16LE=function(he,_e){return _e||Ut(he,2,this.length),this[he]|this[he+1]<<8},V.prototype.readUInt16BE=function(he,_e){return _e||Ut(he,2,this.length),this[he]<<8|this[he+1]},V.prototype.readUInt32LE=function(he,_e){return _e||Ut(he,4,this.length),(this[he]|this[he+1]<<8|this[he+2]<<16)+16777216*this[he+3]},V.prototype.readUInt32BE=function(he,_e){return _e||Ut(he,4,this.length),16777216*this[he]+(this[he+1]<<16|this[he+2]<<8|this[he+3])},V.prototype.readIntLE=function(he,_e,Fe){he|=0,_e|=0,Fe||Ut(he,_e,this.length);for(var yt=this[he],_t=1,pt=0;++pt<_e&&(_t*=256);)yt+=this[he+pt]*_t;return yt>=(_t*=128)&&(yt-=Math.pow(2,8*_e)),yt},V.prototype.readIntBE=function(he,_e,Fe){he|=0,_e|=0,Fe||Ut(he,_e,this.length);for(var yt=_e,_t=1,pt=this[he+--yt];yt>0&&(_t*=256);)pt+=this[he+--yt]*_t;return pt>=(_t*=128)&&(pt-=Math.pow(2,8*_e)),pt},V.prototype.readInt8=function(he,_e){return _e||Ut(he,1,this.length),128&this[he]?-1*(255-this[he]+1):this[he]},V.prototype.readInt16LE=function(he,_e){_e||Ut(he,2,this.length);var Fe=this[he]|this[he+1]<<8;return 32768&Fe?4294901760|Fe:Fe},V.prototype.readInt16BE=function(he,_e){_e||Ut(he,2,this.length);var Fe=this[he+1]|this[he]<<8;return 32768&Fe?4294901760|Fe:Fe},V.prototype.readInt32LE=function(he,_e){return _e||Ut(he,4,this.length),this[he]|this[he+1]<<8|this[he+2]<<16|this[he+3]<<24},V.prototype.readInt32BE=function(he,_e){return _e||Ut(he,4,this.length),this[he]<<24|this[he+1]<<16|this[he+2]<<8|this[he+3]},V.prototype.readFloatLE=function(he,_e){return _e||Ut(he,4,this.length),re.read(this,he,!0,23,4)},V.prototype.readFloatBE=function(he,_e){return _e||Ut(he,4,this.length),re.read(this,he,!1,23,4)},V.prototype.readDoubleLE=function(he,_e){return _e||Ut(he,8,this.length),re.read(this,he,!0,52,8)},V.prototype.readDoubleBE=function(he,_e){return _e||Ut(he,8,this.length),re.read(this,he,!1,52,8)},V.prototype.writeUIntLE=function(he,_e,Fe,yt){he=+he,_e|=0,Fe|=0,yt||Mt(this,he,_e,Fe,Math.pow(2,8*Fe)-1,0);var _t=1,pt=0;for(this[_e]=255&he;++pt<Fe&&(_t*=256);)this[_e+pt]=he/_t&255;return _e+Fe},V.prototype.writeUIntBE=function(he,_e,Fe,yt){he=+he,_e|=0,Fe|=0,yt||Mt(this,he,_e,Fe,Math.pow(2,8*Fe)-1,0);var _t=Fe-1,pt=1;for(this[_e+_t]=255&he;--_t>=0&&(pt*=256);)this[_e+_t]=he/pt&255;return _e+Fe},V.prototype.writeUInt8=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,1,255,0),V.TYPED_ARRAY_SUPPORT||(he=Math.floor(he)),this[_e]=255&he,_e+1},V.prototype.writeUInt16LE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,2,65535,0),V.TYPED_ARRAY_SUPPORT?(this[_e]=255&he,this[_e+1]=he>>>8):sn(this,he,_e,!0),_e+2},V.prototype.writeUInt16BE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,2,65535,0),V.TYPED_ARRAY_SUPPORT?(this[_e]=he>>>8,this[_e+1]=255&he):sn(this,he,_e,!1),_e+2},V.prototype.writeUInt32LE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,4,4294967295,0),V.TYPED_ARRAY_SUPPORT?(this[_e+3]=he>>>24,this[_e+2]=he>>>16,this[_e+1]=he>>>8,this[_e]=255&he):je(this,he,_e,!0),_e+4},V.prototype.writeUInt32BE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,4,4294967295,0),V.TYPED_ARRAY_SUPPORT?(this[_e]=he>>>24,this[_e+1]=he>>>16,this[_e+2]=he>>>8,this[_e+3]=255&he):je(this,he,_e,!1),_e+4},V.prototype.writeIntLE=function(he,_e,Fe,yt){if(he=+he,_e|=0,!yt){var _t=Math.pow(2,8*Fe-1);Mt(this,he,_e,Fe,_t-1,-_t)}var pt=0,Sn=1,Gn=0;for(this[_e]=255&he;++pt<Fe&&(Sn*=256);)he<0&&0===Gn&&0!==this[_e+pt-1]&&(Gn=1),this[_e+pt]=(he/Sn>>0)-Gn&255;return _e+Fe},V.prototype.writeIntBE=function(he,_e,Fe,yt){if(he=+he,_e|=0,!yt){var _t=Math.pow(2,8*Fe-1);Mt(this,he,_e,Fe,_t-1,-_t)}var pt=Fe-1,Sn=1,Gn=0;for(this[_e+pt]=255&he;--pt>=0&&(Sn*=256);)he<0&&0===Gn&&0!==this[_e+pt+1]&&(Gn=1),this[_e+pt]=(he/Sn>>0)-Gn&255;return _e+Fe},V.prototype.writeInt8=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,1,127,-128),V.TYPED_ARRAY_SUPPORT||(he=Math.floor(he)),he<0&&(he=255+he+1),this[_e]=255&he,_e+1},V.prototype.writeInt16LE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,2,32767,-32768),V.TYPED_ARRAY_SUPPORT?(this[_e]=255&he,this[_e+1]=he>>>8):sn(this,he,_e,!0),_e+2},V.prototype.writeInt16BE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,2,32767,-32768),V.TYPED_ARRAY_SUPPORT?(this[_e]=he>>>8,this[_e+1]=255&he):sn(this,he,_e,!1),_e+2},V.prototype.writeInt32LE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,4,2147483647,-2147483648),V.TYPED_ARRAY_SUPPORT?(this[_e]=255&he,this[_e+1]=he>>>8,this[_e+2]=he>>>16,this[_e+3]=he>>>24):je(this,he,_e,!0),_e+4},V.prototype.writeInt32BE=function(he,_e,Fe){return he=+he,_e|=0,Fe||Mt(this,he,_e,4,2147483647,-2147483648),he<0&&(he=4294967295+he+1),V.TYPED_ARRAY_SUPPORT?(this[_e]=he>>>24,this[_e+1]=he>>>16,this[_e+2]=he>>>8,this[_e+3]=255&he):je(this,he,_e,!1),_e+4},V.prototype.writeFloatLE=function(he,_e,Fe){return tt(this,he,_e,!0,Fe)},V.prototype.writeFloatBE=function(he,_e,Fe){return tt(this,he,_e,!1,Fe)},V.prototype.writeDoubleLE=function(he,_e,Fe){return Pt(this,he,_e,!0,Fe)},V.prototype.writeDoubleBE=function(he,_e,Fe){return Pt(this,he,_e,!1,Fe)},V.prototype.copy=function(he,_e,Fe,yt){if(Fe||(Fe=0),yt||0===yt||(yt=this.length),_e>=he.length&&(_e=he.length),_e||(_e=0),yt>0&&yt<Fe&&(yt=Fe),yt===Fe||0===he.length||0===this.length)return 0;if(_e<0)throw new RangeError("targetStart out of bounds");if(Fe<0||Fe>=this.length)throw new RangeError("sourceStart out of bounds");if(yt<0)throw new RangeError("sourceEnd out of bounds");yt>this.length&&(yt=this.length),he.length-_e<yt-Fe&&(yt=he.length-_e+Fe);var _t,pt=yt-Fe;if(this===he&&Fe<_e&&_e<yt)for(_t=pt-1;_t>=0;--_t)he[_t+_e]=this[_t+Fe];else if(pt<1e3||!V.TYPED_ARRAY_SUPPORT)for(_t=0;_t<pt;++_t)he[_t+_e]=this[_t+Fe];else Uint8Array.prototype.set.call(he,this.subarray(Fe,Fe+pt),_e);return pt},V.prototype.fill=function(he,_e,Fe,yt){if("string"==typeof he){if("string"==typeof _e?(yt=_e,_e=0,Fe=this.length):"string"==typeof Fe&&(yt=Fe,Fe=this.length),1===he.length){var _t=he.charCodeAt(0);_t<256&&(he=_t)}if(void 0!==yt&&"string"!=typeof yt)throw new TypeError("encoding must be a string");if("string"==typeof yt&&!V.isEncoding(yt))throw new TypeError("Unknown encoding: "+yt)}else"number"==typeof he&&(he&=255);if(_e<0||this.length<_e||this.length<Fe)throw new RangeError("Out of range index");if(Fe<=_e)return this;var pt;if(_e>>>=0,Fe=void 0===Fe?this.length:Fe>>>0,he||(he=0),"number"==typeof he)for(pt=_e;pt<Fe;++pt)this[pt]=he;else{var Sn=V.isBuffer(he)?he:Vt(new V(he,yt).toString()),Gn=Sn.length;for(pt=0;pt<Fe-_e;++pt)this[pt+_e]=Sn[pt%Gn]}return this};var Ue=/[^+\/0-9A-Za-z-_]/g;function xt(he){return he<16?"0"+he.toString(16):he.toString(16)}function Vt(he,_e){var Fe;_e=_e||1/0;for(var yt=he.length,_t=null,pt=[],Sn=0;Sn<yt;++Sn){if((Fe=he.charCodeAt(Sn))>55295&&Fe<57344){if(!_t){if(Fe>56319){(_e-=3)>-1&&pt.push(239,191,189);continue}if(Sn+1===yt){(_e-=3)>-1&&pt.push(239,191,189);continue}_t=Fe;continue}if(Fe<56320){(_e-=3)>-1&&pt.push(239,191,189),_t=Fe;continue}Fe=65536+(_t-55296<<10|Fe-56320)}else _t&&(_e-=3)>-1&&pt.push(239,191,189);if(_t=null,Fe<128){if((_e-=1)<0)break;pt.push(Fe)}else if(Fe<2048){if((_e-=2)<0)break;pt.push(Fe>>6|192,63&Fe|128)}else if(Fe<65536){if((_e-=3)<0)break;pt.push(Fe>>12|224,Fe>>6&63|128,63&Fe|128)}else{if(!(Fe<1114112))throw new Error("Invalid code point");if((_e-=4)<0)break;pt.push(Fe>>18|240,Fe>>12&63|128,Fe>>6&63|128,63&Fe|128)}}return pt}function Qt(he){return ue.toByteArray(function(_e){if((_e=(Fe=_e,Fe.trim?Fe.trim():Fe.replace(/^\s+|\s+$/g,"")).replace(Ue,"")).length<2)return"";for(var Fe;_e.length%4!=0;)_e+="=";return _e}(he))}function rn(he,_e,Fe,yt){for(var _t=0;_t<yt&&!(_t+Fe>=_e.length||_t>=he.length);++_t)_e[_t+Fe]=he[_t];return _t}}).call(this,G(0))},function(Ae,z){var G,K,ue=Ae.exports={};function re(){throw new Error("setTimeout has not been defined")}function X(){throw new Error("clearTimeout has not been defined")}function se(me){if(G===setTimeout)return setTimeout(me,0);if((G===re||!G)&&setTimeout)return G=setTimeout,setTimeout(me,0);try{return G(me,0)}catch(te){try{return G.call(null,me,0)}catch(ce){return G.call(this,me,0)}}}!function(){try{G="function"==typeof setTimeout?setTimeout:re}catch(me){G=re}try{K="function"==typeof clearTimeout?clearTimeout:X}catch(me){K=X}}();var be,V=[],ee=!1,ge=-1;function W(){ee&&be&&(ee=!1,be.length?V=be.concat(V):ge=-1,V.length&&J())}function J(){if(!ee){var me=se(W);ee=!0;for(var te=V.length;te;){for(be=V,V=[];++ge<te;)be&&be[ge].run();ge=-1,te=V.length}be=null,ee=!1,function(ce){if(K===clearTimeout)return clearTimeout(ce);if((K===X||!K)&&clearTimeout)return K=clearTimeout,clearTimeout(ce);try{K(ce)}catch(xe){try{return K.call(null,ce)}catch(Pe){return K.call(this,ce)}}}(me)}}function H(me,te){this.fun=me,this.array=te}function Y(){}ue.nextTick=function(me){var te=new Array(arguments.length-1);if(arguments.length>1)for(var ce=1;ce<arguments.length;ce++)te[ce-1]=arguments[ce];V.push(new H(me,te)),1!==V.length||ee||se(J)},H.prototype.run=function(){this.fun.apply(null,this.array)},ue.title="browser",ue.browser=!0,ue.env={},ue.argv=[],ue.version="",ue.versions={},ue.on=Y,ue.addListener=Y,ue.once=Y,ue.off=Y,ue.removeListener=Y,ue.removeAllListeners=Y,ue.emit=Y,ue.prependListener=Y,ue.prependOnceListener=Y,ue.listeners=function(me){return[]},ue.binding=function(me){throw new Error("process.binding is not supported")},ue.cwd=function(){return"/"},ue.chdir=function(me){throw new Error("process.chdir is not supported")},ue.umask=function(){return 0}},function(Ae,z,G){(function(K){function ue(re){return Object.prototype.toString.call(re)}z.isArray=function(re){return Array.isArray?Array.isArray(re):"[object Array]"===ue(re)},z.isBoolean=function(re){return"boolean"==typeof re},z.isNull=function(re){return null===re},z.isNullOrUndefined=function(re){return null==re},z.isNumber=function(re){return"number"==typeof re},z.isString=function(re){return"string"==typeof re},z.isSymbol=function(re){return"symbol"==typeof re},z.isUndefined=function(re){return void 0===re},z.isRegExp=function(re){return"[object RegExp]"===ue(re)},z.isObject=function(re){return"object"==typeof re&&null!==re},z.isDate=function(re){return"[object Date]"===ue(re)},z.isError=function(re){return"[object Error]"===ue(re)||re instanceof Error},z.isFunction=function(re){return"function"==typeof re},z.isPrimitive=function(re){return null===re||"boolean"==typeof re||"number"==typeof re||"string"==typeof re||"symbol"==typeof re||void 0===re},z.isBuffer=K.isBuffer}).call(this,G(3).Buffer)},function(Ae,z,G){"use strict";(function(K){Ae.exports=!K.version||0===K.version.indexOf("v0.")||0===K.version.indexOf("v1.")&&0!==K.version.indexOf("v1.8.")?{nextTick:function(ue,re,X,se){if("function"!=typeof ue)throw new TypeError('"callback" argument must be a function');var be,V,ee=arguments.length;switch(ee){case 0:case 1:return K.nextTick(ue);case 2:return K.nextTick(function(){ue.call(null,re)});case 3:return K.nextTick(function(){ue.call(null,re,X)});case 4:return K.nextTick(function(){ue.call(null,re,X,se)});default:for(be=new Array(ee-1),V=0;V<be.length;)be[V++]=arguments[V];return K.nextTick(function(){ue.apply(null,be)})}}}:K}).call(this,G(4))},function(Ae,z,G){var K=G(3),ue=K.Buffer;function re(se,be){for(var V in se)be[V]=se[V]}function X(se,be,V){return ue(se,be,V)}ue.from&&ue.alloc&&ue.allocUnsafe&&ue.allocUnsafeSlow?Ae.exports=K:(re(K,z),z.Buffer=X),re(ue,X),X.from=function(se,be,V){if("number"==typeof se)throw new TypeError("Argument must not be a number");return ue(se,be,V)},X.alloc=function(se,be,V){if("number"!=typeof se)throw new TypeError("Argument must be a number");var ee=ue(se);return void 0!==be?"string"==typeof V?ee.fill(be,V):ee.fill(be):ee.fill(0),ee},X.allocUnsafe=function(se){if("number"!=typeof se)throw new TypeError("Argument must be a number");return ue(se)},X.allocUnsafeSlow=function(se){if("number"!=typeof se)throw new TypeError("Argument must be a number");return K.SlowBuffer(se)}},function(Ae,z,G){var K=G(17)(Object,"create");Ae.exports=K},function(Ae,z,G){var K=G(31);Ae.exports=function(ue,re){for(var X=ue.length;X--;)if(K(ue[X][0],re))return X;return-1}},function(Ae,z,G){var K=G(96);Ae.exports=function(ue,re){var X=ue.__data__;return K(re)?X["string"==typeof re?"string":"hash"]:X.map}},function(Ae,z,G){(function(K){var ue=void 0!==K&&K||"undefined"!=typeof self&&self||window,re=Function.prototype.apply;function X(se,be){this._id=se,this._clearFn=be}z.setTimeout=function(){return new X(re.call(setTimeout,ue,arguments),clearTimeout)},z.setInterval=function(){return new X(re.call(setInterval,ue,arguments),clearInterval)},z.clearTimeout=z.clearInterval=function(se){se&&se.close()},X.prototype.unref=X.prototype.ref=function(){},X.prototype.close=function(){this._clearFn.call(ue,this._id)},z.enroll=function(se,be){clearTimeout(se._idleTimeoutId),se._idleTimeout=be},z.unenroll=function(se){clearTimeout(se._idleTimeoutId),se._idleTimeout=-1},z._unrefActive=z.active=function(se){clearTimeout(se._idleTimeoutId);var be=se._idleTimeout;be>=0&&(se._idleTimeoutId=setTimeout(function(){se._onTimeout&&se._onTimeout()},be))},G(35),z.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==K&&K.setImmediate||this&&this.setImmediate,z.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==K&&K.clearImmediate||this&&this.clearImmediate}).call(this,G(0))},function(Ae,z){function G(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function K(X){return"function"==typeof X}function ue(X){return"object"==typeof X&&null!==X}function re(X){return void 0===X}Ae.exports=G,G.EventEmitter=G,G.prototype._events=void 0,G.prototype._maxListeners=void 0,G.defaultMaxListeners=10,G.prototype.setMaxListeners=function(X){if("number"!=typeof X||X<0||isNaN(X))throw TypeError("n must be a positive number");return this._maxListeners=X,this},G.prototype.emit=function(X){var se,be,V,ee,ge,W;if(this._events||(this._events={}),"error"===X&&(!this._events.error||ue(this._events.error)&&!this._events.error.length)){if((se=arguments[1])instanceof Error)throw se;var J=new Error('Uncaught, unspecified "error" event. ('+se+")");throw J.context=se,J}if(re(be=this._events[X]))return!1;if(K(be))switch(arguments.length){case 1:be.call(this);break;case 2:be.call(this,arguments[1]);break;case 3:be.call(this,arguments[1],arguments[2]);break;default:ee=Array.prototype.slice.call(arguments,1),be.apply(this,ee)}else if(ue(be))for(ee=Array.prototype.slice.call(arguments,1),V=(W=be.slice()).length,ge=0;ge<V;ge++)W[ge].apply(this,ee);return!0},G.prototype.on=G.prototype.addListener=function(X,se){var be;if(!K(se))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",X,K(se.listener)?se.listener:se),this._events[X]?ue(this._events[X])?this._events[X].push(se):this._events[X]=[this._events[X],se]:this._events[X]=se,ue(this._events[X])&&!this._events[X].warned&&(be=re(this._maxListeners)?G.defaultMaxListeners:this._maxListeners)&&be>0&&this._events[X].length>be&&(this._events[X].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[X].length),"function"==typeof console.trace&&console.trace()),this},G.prototype.once=function(X,se){if(!K(se))throw TypeError("listener must be a function");var be=!1;function V(){this.removeListener(X,V),be||(be=!0,se.apply(this,arguments))}return V.listener=se,this.on(X,V),this},G.prototype.removeListener=function(X,se){var be,V,ee,ge;if(!K(se))throw TypeError("listener must be a function");if(!this._events||!this._events[X])return this;if(ee=(be=this._events[X]).length,V=-1,be===se||K(be.listener)&&be.listener===se)delete this._events[X],this._events.removeListener&&this.emit("removeListener",X,se);else if(ue(be)){for(ge=ee;ge-- >0;)if(be[ge]===se||be[ge].listener&&be[ge].listener===se){V=ge;break}if(V<0)return this;1===be.length?(be.length=0,delete this._events[X]):be.splice(V,1),this._events.removeListener&&this.emit("removeListener",X,se)}return this},G.prototype.removeAllListeners=function(X){var se,be;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[X]&&delete this._events[X],this;if(0===arguments.length){for(se in this._events)"removeListener"!==se&&this.removeAllListeners(se);return this.removeAllListeners("removeListener"),this._events={},this}if(K(be=this._events[X]))this.removeListener(X,be);else if(be)for(;be.length;)this.removeListener(X,be[be.length-1]);return delete this._events[X],this},G.prototype.listeners=function(X){return this._events&&this._events[X]?K(this._events[X])?[this._events[X]]:this._events[X].slice():[]},G.prototype.listenerCount=function(X){if(this._events){var se=this._events[X];if(K(se))return 1;if(se)return se.length}return 0},G.listenerCount=function(X,se){return X.listenerCount(se)}},function(Ae,z,G){(z=Ae.exports=G(23)).Stream=z,z.Readable=z,z.Writable=G(14),z.Duplex=G(1),z.Transform=G(27),z.PassThrough=G(45)},function(Ae,z,G){"use strict";(function(K,ue,re){var X=G(6);function se(Ne){var we=this;this.next=null,this.entry=null,this.finish=function(){!function(qe,Ye,at){var At=qe.entry;for(qe.entry=null;At;){var Ut=At.callback;Ye.pendingcb--,Ut(void 0),At=At.next}Ye.corkedRequestsFree?Ye.corkedRequestsFree.next=qe:Ye.corkedRequestsFree=qe}(we,Ne)}}Ae.exports=xe;var be,V=!K.browser&&["v0.10","v0.9."].indexOf(K.version.slice(0,5))>-1?ue:X.nextTick;xe.WritableState=ce;var ee=G(5);ee.inherits=G(2);var ge,W={deprecate:G(44)},J=G(24),H=G(7).Buffer,Y=re.Uint8Array||function(){},me=G(25);function te(){}function ce(Ne,we){be=be||G(1);var qe=we instanceof be;this.objectMode=!!(Ne=Ne||{}).objectMode,qe&&(this.objectMode=this.objectMode||!!Ne.writableObjectMode);var Ye=Ne.highWaterMark,at=Ne.writableHighWaterMark;this.highWaterMark=Ye||0===Ye?Ye:qe&&(at||0===at)?at:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===Ne.decodeStrings),this.defaultEncoding=Ne.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Mt){!function(sn,je){var xt,We=sn._writableState,tt=We.sync,Pt=We.writecb;if((xt=We).writing=!1,xt.writecb=null,xt.length-=xt.writelen,xt.writelen=0,je)!function(xt,Vt,Qt,rn,he){--Vt.pendingcb,Qt?(X.nextTick(he,rn),X.nextTick($e,xt,Vt),xt._writableState.errorEmitted=!0,xt.emit("error",rn)):(he(rn),xt._writableState.errorEmitted=!0,xt.emit("error",rn),$e(xt,Vt))}(sn,We,tt,je,Pt);else{var Ue=it(We);Ue||We.corked||We.bufferProcessing||!We.bufferedRequest||Ve(sn,We),tt?V(Ke,sn,We,Ue,Pt):Ke(sn,We,Ue,Pt)}}(we,Mt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new se(this)}function xe(Ne){if(be=be||G(1),!(ge.call(xe,this)||this instanceof be))return new xe(Ne);this._writableState=new ce(Ne,this),this.writable=!0,Ne&&("function"==typeof Ne.write&&(this._write=Ne.write),"function"==typeof Ne.writev&&(this._writev=Ne.writev),"function"==typeof Ne.destroy&&(this._destroy=Ne.destroy),"function"==typeof Ne.final&&(this._final=Ne.final)),J.call(this)}function Pe(Ne,we,qe,Ye,at,At,Ut){we.writelen=Ye,we.writecb=Ut,we.writing=!0,we.sync=!0,qe?Ne._writev(at,we.onwrite):Ne._write(at,At,we.onwrite),we.sync=!1}function Ke(Ne,we,qe,Ye){var at,At;qe||(at=Ne,0===(At=we).length&&At.needDrain&&(At.needDrain=!1,at.emit("drain"))),we.pendingcb--,Ye(),$e(Ne,we)}function Ve(Ne,we){we.bufferProcessing=!0;var qe=we.bufferedRequest;if(Ne._writev&&qe&&qe.next){var at=new Array(we.bufferedRequestCount),At=we.corkedRequestsFree;At.entry=qe;for(var Ut=0,Mt=!0;qe;)at[Ut]=qe,qe.isBuf||(Mt=!1),qe=qe.next,Ut+=1;at.allBuffers=Mt,Pe(Ne,we,!0,we.length,at,"",At.finish),we.pendingcb++,we.lastBufferedRequest=null,At.next?(we.corkedRequestsFree=At.next,At.next=null):we.corkedRequestsFree=new se(we),we.bufferedRequestCount=0}else{for(;qe;){var sn=qe.chunk;if(Pe(Ne,we,!1,we.objectMode?1:sn.length,sn,qe.encoding,qe.callback),qe=qe.next,we.bufferedRequestCount--,we.writing)break}null===qe&&(we.lastBufferedRequest=null)}we.bufferedRequest=qe,we.bufferProcessing=!1}function it(Ne){return Ne.ending&&0===Ne.length&&null===Ne.bufferedRequest&&!Ne.finished&&!Ne.writing}function bt(Ne,we){Ne._final(function(qe){we.pendingcb--,qe&&Ne.emit("error",qe),we.prefinished=!0,Ne.emit("prefinish"),$e(Ne,we)})}function $e(Ne,we){var Ye,at,qe=it(we);return qe&&(Ye=Ne,(at=we).prefinished||at.finalCalled||("function"==typeof Ye._final?(at.pendingcb++,at.finalCalled=!0,X.nextTick(bt,Ye,at)):(at.prefinished=!0,Ye.emit("prefinish"))),0===we.pendingcb&&(we.finished=!0,Ne.emit("finish"))),qe}ee.inherits(xe,J),ce.prototype.getBuffer=function(){for(var Ne=this.bufferedRequest,we=[];Ne;)we.push(Ne),Ne=Ne.next;return we},function(){try{Object.defineProperty(ce.prototype,"buffer",{get:W.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(Ne){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(ge=Function.prototype[Symbol.hasInstance],Object.defineProperty(xe,Symbol.hasInstance,{value:function(Ne){return!!ge.call(this,Ne)||this===xe&&Ne&&Ne._writableState instanceof ce}})):ge=function(Ne){return Ne instanceof this},xe.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},xe.prototype.write=function(Ne,we,qe){var Ut,Ye=this._writableState,at=!1,At=!Ye.objectMode&&(H.isBuffer(Ut=Ne)||Ut instanceof Y);return At&&!H.isBuffer(Ne)&&(Ne=function(Ut){return H.from(Ut)}(Ne)),"function"==typeof we&&(qe=we,we=null),At?we="buffer":we||(we=Ye.defaultEncoding),"function"!=typeof qe&&(qe=te),Ye.ended?function(Ut,Mt){var sn=new Error("write after end");Ut.emit("error",sn),X.nextTick(Mt,sn)}(this,qe):(At||function(Ut,Mt,sn,je){var We=!0,tt=!1;return null===sn?tt=new TypeError("May not write null values to stream"):"string"==typeof sn||void 0===sn||Mt.objectMode||(tt=new TypeError("Invalid non-string/buffer chunk")),tt&&(Ut.emit("error",tt),X.nextTick(je,tt),We=!1),We}(this,Ye,Ne,qe))&&(Ye.pendingcb++,at=function(Ut,Mt,sn,je,We,tt){if(!sn){var Pt=(rn=je,(Qt=Mt).objectMode||!1===Qt.decodeStrings||"string"!=typeof rn||(rn=H.from(rn,We)),rn);je!==Pt&&(sn=!0,We="buffer",je=Pt)}var Qt,rn,Ue=Mt.objectMode?1:je.length;Mt.length+=Ue;var xt=Mt.length<Mt.highWaterMark;if(xt||(Mt.needDrain=!0),Mt.writing||Mt.corked){var Vt=Mt.lastBufferedRequest;Mt.lastBufferedRequest={chunk:je,encoding:We,isBuf:sn,callback:tt,next:null},Vt?Vt.next=Mt.lastBufferedRequest:Mt.bufferedRequest=Mt.lastBufferedRequest,Mt.bufferedRequestCount+=1}else Pe(Ut,Mt,!1,Ue,je,We,tt);return xt}(this,Ye,At,Ne,we,qe)),at},xe.prototype.cork=function(){this._writableState.corked++},xe.prototype.uncork=function(){var Ne=this._writableState;Ne.corked&&(Ne.corked--,Ne.writing||Ne.corked||Ne.finished||Ne.bufferProcessing||!Ne.bufferedRequest||Ve(this,Ne))},xe.prototype.setDefaultEncoding=function(Ne){if("string"==typeof Ne&&(Ne=Ne.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Ne+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+Ne);return this._writableState.defaultEncoding=Ne,this},Object.defineProperty(xe.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),xe.prototype._write=function(Ne,we,qe){qe(new Error("_write() is not implemented"))},xe.prototype._writev=null,xe.prototype.end=function(Ne,we,qe){var At,Ut,Ye=this._writableState;"function"==typeof Ne?(qe=Ne,Ne=null,we=null):"function"==typeof we&&(qe=we,we=null),null!=Ne&&this.write(Ne,we),Ye.corked&&(Ye.corked=1,this.uncork()),Ye.ending||Ye.finished||(this,Ut=qe,(At=Ye).ending=!0,$e(this,At),Ut&&(At.finished?X.nextTick(Ut):this.once("finish",Ut)),At.ended=!0,this.writable=!1)},Object.defineProperty(xe.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(Ne){this._writableState&&(this._writableState.destroyed=Ne)}}),xe.prototype.destroy=me.destroy,xe.prototype._undestroy=me.undestroy,xe.prototype._destroy=function(Ne,we){this.end(),we(Ne)}}).call(this,G(4),G(11).setImmediate,G(0))},function(Ae,z,G){(function(K,ue,re){Ae.exports=function X(se,be,V){function ee(J,H){if(!be[J]){if(!se[J]){var Y="function"==typeof _dereq_&&_dereq_;if(!H&&Y)return Y(J,!0);if(ge)return ge(J,!0);var me=new Error("Cannot find module '"+J+"'");throw me.code="MODULE_NOT_FOUND",me}var te=be[J]={exports:{}};se[J][0].call(te.exports,function(ce){return ee(se[J][1][ce]||ce)},te,te.exports,X,se,be,V)}return be[J].exports}for(var ge="function"==typeof _dereq_&&_dereq_,W=0;W<V.length;W++)ee(V[W]);return ee}({1:[function(X,se,be){"use strict";se.exports=function(V){var ee=V._SomePromiseArray;function ge(W){var J=new ee(W),H=J.promise();return J.setHowMany(1),J.setUnwrap(),J.init(),H}V.any=function(W){return ge(W)},V.prototype.any=function(){return ge(this)}}},{}],2:[function(X,se,be){"use strict";var V;try{throw new Error}catch(te){V=te}var ee=X("./schedule"),ge=X("./queue"),W=X("./util");function J(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new ge(16),this._normalQueue=new ge(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var te=this;this.drainQueues=function(){te._drainQueues()},this._schedule=ee}function H(te,ce,xe){this._lateQueue.push(te,ce,xe),this._queueTick()}function Y(te,ce,xe){this._normalQueue.push(te,ce,xe),this._queueTick()}function me(te){this._normalQueue._pushOne(te),this._queueTick()}J.prototype.setScheduler=function(te){var ce=this._schedule;return this._schedule=te,this._customScheduler=!0,ce},J.prototype.hasCustomScheduler=function(){return this._customScheduler},J.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},J.prototype.disableTrampolineIfNecessary=function(){W.hasDevTools&&(this._trampolineEnabled=!1)},J.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},J.prototype.fatalError=function(te,ce){ce?(K.stderr.write("Fatal "+(te instanceof Error?te.stack:te)+"\n"),K.exit(2)):this.throwLater(te)},J.prototype.throwLater=function(te,ce){if(1===arguments.length&&(ce=te,te=function(){throw ce}),"undefined"!=typeof setTimeout)setTimeout(function(){te(ce)},0);else try{this._schedule(function(){te(ce)})}catch(xe){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},W.hasDevTools?(J.prototype.invokeLater=function(te,ce,xe){this._trampolineEnabled?H.call(this,te,ce,xe):this._schedule(function(){setTimeout(function(){te.call(ce,xe)},100)})},J.prototype.invoke=function(te,ce,xe){this._trampolineEnabled?Y.call(this,te,ce,xe):this._schedule(function(){te.call(ce,xe)})},J.prototype.settlePromises=function(te){this._trampolineEnabled?me.call(this,te):this._schedule(function(){te._settlePromises()})}):(J.prototype.invokeLater=H,J.prototype.invoke=Y,J.prototype.settlePromises=me),J.prototype._drainQueue=function(te){for(;te.length()>0;){var ce=te.shift();if("function"==typeof ce){var xe=te.shift(),Pe=te.shift();ce.call(xe,Pe)}else ce._settlePromises()}},J.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},J.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},J.prototype._reset=function(){this._isTickUsed=!1},se.exports=J,se.exports.firstLineError=V},{"./queue":26,"./schedule":29,"./util":36}],3:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W){var J=!1,H=function(ce,xe){this._reject(xe)},Y=function(ce,xe){xe.promiseRejectionQueued=!0,xe.bindingPromise._then(H,H,null,this,ce)},me=function(ce,xe){0==(50397184&this._bitField)&&this._resolveCallback(xe.target)},te=function(ce,xe){xe.promiseRejectionQueued||this._reject(ce)};V.prototype.bind=function(ce){J||(J=!0,V.prototype._propagateFrom=W.propagateFromFunction(),V.prototype._boundValue=W.boundValueFunction());var xe=ge(ce),Pe=new V(ee);Pe._propagateFrom(this,1);var Ke=this._target();if(Pe._setBoundTo(xe),xe instanceof V){var Ve={promiseRejectionQueued:!1,promise:Pe,target:Ke,bindingPromise:xe};Ke._then(ee,Y,void 0,Pe,Ve),xe._then(me,te,void 0,Pe,Ve),Pe._setOnCancel(xe)}else Pe._resolveCallback(Ke);return Pe},V.prototype._setBoundTo=function(ce){void 0!==ce?(this._bitField=2097152|this._bitField,this._boundTo=ce):this._bitField=-2097153&this._bitField},V.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},V.bind=function(ce,xe){return V.resolve(xe).bind(ce)}}},{}],4:[function(X,se,be){"use strict";var V;"undefined"!=typeof Promise&&(V=Promise);var ee=X("./promise")();ee.noConflict=function(){try{Promise===ee&&(Promise=V)}catch(ge){}return ee},se.exports=ee},{"./promise":22}],5:[function(X,se,be){"use strict";var V=Object.create;if(V){var ee=V(null),ge=V(null);ee[" size"]=ge[" size"]=0}se.exports=function(W){var J=X("./util"),H=J.canEvaluate;function Y(ce){return function(xe,Pe){var Ke;if(null!=xe&&(Ke=xe[Pe]),"function"!=typeof Ke){var Ve="Object "+J.classString(xe)+" has no method '"+J.toString(Pe)+"'";throw new W.TypeError(Ve)}return Ke}(ce,this.pop()).apply(ce,this)}function me(ce){return ce[this]}function te(ce){var xe=+this;return xe<0&&(xe=Math.max(0,xe+ce.length)),ce[xe]}W.prototype.call=function(ce){var xe=[].slice.call(arguments,1);return xe.push(ce),this._then(Y,void 0,void 0,xe,void 0)},W.prototype.get=function(ce){var xe;if("number"==typeof ce)xe=te;else if(H){var Pe=(void 0)(ce);xe=null!==Pe?Pe:me}else xe=me;return this._then(xe,void 0,void 0,ce,void 0)}}},{"./util":36}],6:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W){var J=X("./util"),H=J.tryCatch,Y=J.errorObj,me=V._async;V.prototype.break=V.prototype.cancel=function(){if(!W.cancellation())return this._warn("cancellation is disabled");for(var te=this,ce=te;te._isCancellable();){if(!te._cancelBy(ce)){ce._isFollowing()?ce._followee().cancel():ce._cancelBranched();break}var xe=te._cancellationParent;if(null==xe||!xe._isCancellable()){te._isFollowing()?te._followee().cancel():te._cancelBranched();break}te._isFollowing()&&te._followee().cancel(),te._setWillBeCancelled(),ce=te,te=xe}},V.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},V.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},V.prototype._cancelBy=function(te){return te===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},V.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},V.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),me.invoke(this._cancelPromises,this,void 0))},V.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},V.prototype._unsetOnCancel=function(){this._onCancelField=void 0},V.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},V.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},V.prototype._doInvokeOnCancel=function(te,ce){if(J.isArray(te))for(var xe=0;xe<te.length;++xe)this._doInvokeOnCancel(te[xe],ce);else if(void 0!==te)if("function"==typeof te){if(!ce){var Pe=H(te).call(this._boundValue());Pe===Y&&(this._attachExtraTrace(Pe.e),me.throwLater(Pe.e))}}else te._resultCancelled(this)},V.prototype._invokeOnCancel=function(){var te=this._onCancel();this._unsetOnCancel(),me.invoke(this._doInvokeOnCancel,this,te)},V.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},V.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(X,se,be){"use strict";se.exports=function(V){var ee=X("./util"),ge=X("./es5").keys,W=ee.tryCatch,J=ee.errorObj;return function(H,Y,me){return function(te){var ce=me._boundValue();e:for(var xe=0;xe<H.length;++xe){var Pe=H[xe];if(Pe===Error||null!=Pe&&Pe.prototype instanceof Error){if(te instanceof Pe)return W(Y).call(ce,te)}else if("function"==typeof Pe){var Ke=W(Pe).call(ce,te);if(Ke===J)return Ke;if(Ke)return W(Y).call(ce,te)}else if(ee.isObject(te)){for(var Ve=ge(Pe),it=0;it<Ve.length;++it){var bt=Ve[it];if(Pe[bt]!=te[bt])continue e}return W(Y).call(ce,te)}}return V}}}},{"./es5":13,"./util":36}],8:[function(X,se,be){"use strict";se.exports=function(V){var ee=!1,ge=[];function W(){this._trace=new W.CapturedTrace(J())}function J(){var H=ge.length-1;if(H>=0)return ge[H]}return V.prototype._promiseCreated=function(){},V.prototype._pushContext=function(){},V.prototype._popContext=function(){return null},V._peekContext=V.prototype._peekContext=function(){},W.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,ge.push(this._trace))},W.prototype._popContext=function(){if(void 0!==this._trace){var H=ge.pop(),Y=H._promiseCreated;return H._promiseCreated=null,Y}return null},W.CapturedTrace=null,W.create=function(){if(ee)return new W},W.deactivateLongStackTraces=function(){},W.activateLongStackTraces=function(){var H=V.prototype._pushContext,Y=V.prototype._popContext,me=V._peekContext,te=V.prototype._peekContext,ce=V.prototype._promiseCreated;W.deactivateLongStackTraces=function(){V.prototype._pushContext=H,V.prototype._popContext=Y,V._peekContext=me,V.prototype._peekContext=te,V.prototype._promiseCreated=ce,ee=!1},ee=!0,V.prototype._pushContext=W.prototype._pushContext,V.prototype._popContext=W.prototype._popContext,V._peekContext=V.prototype._peekContext=J,V.prototype._promiseCreated=function(){var xe=this._peekContext();xe&&null==xe._promiseCreated&&(xe._promiseCreated=this)}},W}},{}],9:[function(X,se,be){"use strict";se.exports=function(V,ee){var ge,W,J,H=V._getDomain,Y=V._async,me=X("./errors").Warning,te=X("./util"),ce=te.canAttachTrace,xe=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,Pe=/\((?:timers\.js):\d+:\d+\)/,Ke=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,Ve=null,it=null,bt=!1,$e=0!=te.env("BLUEBIRD_DEBUG"),Ne=!(0==te.env("BLUEBIRD_WARNINGS")||!$e&&!te.env("BLUEBIRD_WARNINGS")),we=!(0==te.env("BLUEBIRD_LONG_STACK_TRACES")||!$e&&!te.env("BLUEBIRD_LONG_STACK_TRACES")),qe=0!=te.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(Ne||!!te.env("BLUEBIRD_W_FORGOTTEN_RETURN"));V.prototype.suppressUnhandledRejections=function(){var ze=this._target();ze._bitField=-1048577&ze._bitField|524288},V.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var ze=this;setTimeout(function(){ze._notifyUnhandledRejection()},1)}},V.prototype._notifyUnhandledRejectionIsHandled=function(){Sn("rejectionHandled",ge,void 0,this)},V.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},V.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},V.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var ze=this._settledValue();this._setUnhandledRejectionIsNotified(),Sn("unhandledRejection",W,ze,this)}},V.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},V.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},V.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},V.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},V.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},V.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},V.prototype._warn=function(ze,et,ft){return Fe(ze,et,ft||this)},V.onPossiblyUnhandledRejection=function(ze){var et=H();W="function"==typeof ze?null===et?ze:te.domainBind(et,ze):void 0},V.onUnhandledRejectionHandled=function(ze){var et=H();ge="function"==typeof ze?null===et?ze:te.domainBind(et,ze):void 0};var Ye=function(){};V.longStackTraces=function(){if(Y.haveItemsQueued()&&!ct.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!ct.longStackTraces&&_r()){var ze=V.prototype._captureStackTrace,et=V.prototype._attachExtraTrace;ct.longStackTraces=!0,Ye=function(){if(Y.haveItemsQueued()&&!ct.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");V.prototype._captureStackTrace=ze,V.prototype._attachExtraTrace=et,ee.deactivateLongStackTraces(),Y.enableTrampoline(),ct.longStackTraces=!1},V.prototype._captureStackTrace=he,V.prototype._attachExtraTrace=_e,ee.activateLongStackTraces(),Y.disableTrampolineIfNecessary()}},V.hasLongStackTraces=function(){return ct.longStackTraces&&_r()};var at=function(){try{if("function"==typeof CustomEvent){var ze=new CustomEvent("CustomEvent");return te.global.dispatchEvent(ze),function(et,ft){var Gt=new CustomEvent(et.toLowerCase(),{detail:ft,cancelable:!0});return!te.global.dispatchEvent(Gt)}}return"function"==typeof Event?(ze=new Event("CustomEvent"),te.global.dispatchEvent(ze),function(et,ft){var Gt=new Event(et.toLowerCase(),{cancelable:!0});return Gt.detail=ft,!te.global.dispatchEvent(Gt)}):((ze=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),te.global.dispatchEvent(ze),function(et,ft){var Gt=document.createEvent("CustomEvent");return Gt.initCustomEvent(et.toLowerCase(),!1,!0,ft),!te.global.dispatchEvent(Gt)})}catch(et){}return function(){return!1}}(),At=te.isNode?function(){return K.emit.apply(K,arguments)}:te.global?function(ze){var et="on"+ze.toLowerCase(),ft=te.global[et];return!!ft&&(ft.apply(te.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function Ut(ze,et){return{promise:et}}var Mt={promiseCreated:Ut,promiseFulfilled:Ut,promiseRejected:Ut,promiseResolved:Ut,promiseCancelled:Ut,promiseChained:function(ze,et,ft){return{promise:et,child:ft}},warning:function(ze,et){return{warning:et}},unhandledRejection:function(ze,et,ft){return{reason:et,promise:ft}},rejectionHandled:Ut},sn=function(ze){var et=!1;try{et=At.apply(null,arguments)}catch(Gt){Y.throwLater(Gt),et=!0}var ft=!1;try{ft=at(ze,Mt[ze].apply(null,arguments))}catch(Gt){Y.throwLater(Gt),ft=!0}return ft||et};function je(){return!1}function We(ze,et,ft){var Gt=this;try{ze(et,ft,function(bn){if("function"!=typeof bn)throw new TypeError("onCancel must be a function, got: "+te.toString(bn));Gt._attachCancellationCallback(bn)})}catch(bn){return bn}}function tt(ze){if(!this._isCancellable())return this;var et=this._onCancel();void 0!==et?te.isArray(et)?et.push(ze):this._setOnCancel([et,ze]):this._setOnCancel(ze)}function Pt(){return this._onCancelField}function Ue(ze){this._onCancelField=ze}function xt(){this._cancellationParent=void 0,this._onCancelField=void 0}function Vt(ze,et){if(0!=(1&et)){this._cancellationParent=ze;var ft=ze._branchesRemainingToCancel;void 0===ft&&(ft=0),ze._branchesRemainingToCancel=ft+1}0!=(2&et)&&ze._isBound()&&this._setBoundTo(ze._boundTo)}V.config=function(ze){if("longStackTraces"in(ze=Object(ze))&&(ze.longStackTraces?V.longStackTraces():!ze.longStackTraces&&V.hasLongStackTraces()&&Ye()),"warnings"in ze){var et=ze.warnings;ct.warnings=!!et,qe=ct.warnings,te.isObject(et)&&"wForgottenReturn"in et&&(qe=!!et.wForgottenReturn)}if("cancellation"in ze&&ze.cancellation&&!ct.cancellation){if(Y.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");V.prototype._clearCancellationData=xt,V.prototype._propagateFrom=Vt,V.prototype._onCancel=Pt,V.prototype._setOnCancel=Ue,V.prototype._attachCancellationCallback=tt,V.prototype._execute=We,Qt=Vt,ct.cancellation=!0}return"monitoring"in ze&&(ze.monitoring&&!ct.monitoring?(ct.monitoring=!0,V.prototype._fireEvent=sn):!ze.monitoring&&ct.monitoring&&(ct.monitoring=!1,V.prototype._fireEvent=je)),V},V.prototype._fireEvent=je,V.prototype._execute=function(ze,et,ft){try{ze(et,ft)}catch(Gt){return Gt}},V.prototype._onCancel=function(){},V.prototype._setOnCancel=function(ze){},V.prototype._attachCancellationCallback=function(ze){},V.prototype._captureStackTrace=function(){},V.prototype._attachExtraTrace=function(){},V.prototype._clearCancellationData=function(){},V.prototype._propagateFrom=function(ze,et){};var Qt=function(ze,et){0!=(2&et)&&ze._isBound()&&this._setBoundTo(ze._boundTo)};function rn(){var ze=this._boundTo;return void 0!==ze&&ze instanceof V?ze.isFulfilled()?ze.value():void 0:ze}function he(){this._trace=new Yi(this._peekContext())}function _e(ze,et){if(ce(ze)){var ft=this._trace;if(void 0!==ft&&et&&(ft=ft._parent),void 0!==ft)ft.attachExtraTrace(ze);else if(!ze.__stackCleaned__){var Gt=_t(ze);te.notEnumerableProp(ze,"stack",Gt.message+"\n"+Gt.stack.join("\n")),te.notEnumerableProp(ze,"__stackCleaned__",!0)}}}function Fe(ze,et,ft){if(ct.warnings){var Gt,bn=new me(ze);if(et)ft._attachExtraTrace(bn);else if(ct.longStackTraces&&(Gt=V._peekContext()))Gt.attachExtraTrace(bn);else{var wn=_t(bn);bn.stack=wn.message+"\n"+wn.stack.join("\n")}sn("warning",bn)||pt(bn,"",!0)}}function yt(ze){for(var et=[],ft=0;ft<ze.length;++ft){var Gt=ze[ft],bn="    (No stack trace)"===Gt||Ve.test(Gt),wn=bn&&mr(Gt);bn&&!wn&&(bt&&" "!==Gt.charAt(0)&&(Gt="    "+Gt),et.push(Gt))}return et}function _t(ze){var et=ze.stack,ft=ze.toString();return et="string"==typeof et&&et.length>0?function(Gt){for(var bn=Gt.stack.replace(/\s+$/g,"").split("\n"),wn=0;wn<bn.length;++wn){var on=bn[wn];if("    (No stack trace)"===on||Ve.test(on))break}return wn>0&&"SyntaxError"!=Gt.name&&(bn=bn.slice(wn)),bn}(ze):["    (No stack trace)"],{message:ft,stack:"SyntaxError"==ze.name?et:yt(et)}}function pt(ze,et,ft){var Gt;"undefined"!=typeof console&&(Gt=te.isObject(ze)?et+it(ze.stack,ze):et+String(ze),"function"==typeof J?J(Gt,ft):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(Gt))}function Sn(ze,et,ft,Gt){var bn=!1;try{"function"==typeof et&&(bn=!0,"rejectionHandled"===ze?et(Gt):et(ft,Gt))}catch(wn){Y.throwLater(wn)}"unhandledRejection"===ze?sn(ze,ft,Gt)||bn||pt(ft,"Unhandled rejection "):sn(ze,Gt)}function Gn(ze){var et,ft;if("function"==typeof ze)et="[function "+(ze.name||"anonymous")+"]";else{if(et=ze&&"function"==typeof ze.toString?ze.toString():te.toString(ze),/\[object [a-zA-Z0-9$_]+\]/.test(et))try{et=JSON.stringify(ze)}catch(ft){}0===et.length&&(et="(empty array)")}return"(<"+((ft=et).length<41?ft:ft.substr(0,38)+"...")+">, no stack trace)"}function _r(){return"function"==typeof xs}var mr=function(){return!1},Br=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function Ps(ze){var et=ze.match(Br);if(et)return{fileName:et[1],line:parseInt(et[2],10)}}function Yi(ze){this._parent=ze,this._promisesCreated=0;var et=this._length=1+(void 0===ze?0:ze._length);xs(this,Yi),et>32&&this.uncycle()}te.inherits(Yi,Error),ee.CapturedTrace=Yi,Yi.prototype.uncycle=function(){var ze=this._length;if(!(ze<2)){for(var et=[],ft={},Gt=0,bn=this;void 0!==bn;++Gt)et.push(bn),bn=bn._parent;for(Gt=(ze=this._length=Gt)-1;Gt>=0;--Gt){var wn=et[Gt].stack;void 0===ft[wn]&&(ft[wn]=Gt)}for(Gt=0;Gt<ze;++Gt){var on=ft[et[Gt].stack];if(void 0!==on&&on!==Gt){on>0&&(et[on-1]._parent=void 0,et[on-1]._length=1),et[Gt]._parent=void 0,et[Gt]._length=1;var En=Gt>0?et[Gt-1]:this;on<ze-1?(En._parent=et[on+1],En._parent.uncycle(),En._length=En._parent._length+1):(En._parent=void 0,En._length=1);for(var Zn=En._length+1,Nr=Gt-2;Nr>=0;--Nr)et[Nr]._length=Zn,Zn++;return}}}},Yi.prototype.attachExtraTrace=function(ze){if(!ze.__stackCleaned__){this.uncycle();for(var et=_t(ze),ft=et.message,Gt=[et.stack],bn=this;void 0!==bn;)Gt.push(yt(bn.stack.split("\n"))),bn=bn._parent;(function(wn){for(var on=wn[0],En=1;En<wn.length;++En){for(var Zn=wn[En],Nr=on.length-1,ji=on[Nr],bi=-1,js=Zn.length-1;js>=0;--js)if(Zn[js]===ji){bi=js;break}for(js=bi;js>=0&&on[Nr]===Zn[js];--js)on.pop(),Nr--;on=Zn}})(Gt),function(wn){for(var on=0;on<wn.length;++on)(0===wn[on].length||on+1<wn.length&&wn[on][0]===wn[on+1][0])&&(wn.splice(on,1),on--)}(Gt),te.notEnumerableProp(ze,"stack",function(wn,on){for(var En=0;En<on.length-1;++En)on[En].push("From previous event:"),on[En]=on[En].join("\n");return En<on.length&&(on[En]=on[En].join("\n")),wn+"\n"+on.join("\n")}(ft,Gt)),te.notEnumerableProp(ze,"__stackCleaned__",!0)}};var xs=function(){var ze=/^\s*at\s*/,et=function(wn,on){return"string"==typeof wn?wn:void 0!==on.name&&void 0!==on.message?on.toString():Gn(on)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,Ve=ze,it=et;var ft=Error.captureStackTrace;return mr=function(wn){return xe.test(wn)},function(wn,on){Error.stackTraceLimit+=6,ft(wn,on),Error.stackTraceLimit-=6}}var Gt,bn=new Error;if("string"==typeof bn.stack&&bn.stack.split("\n")[0].indexOf("stackDetection@")>=0)return Ve=/@/,it=et,bt=!0,function(wn){wn.stack=(new Error).stack};try{throw new Error}catch(wn){Gt="stack"in wn}return"stack"in bn||!Gt||"number"!=typeof Error.stackTraceLimit?(it=function(wn,on){return"string"==typeof wn?wn:"object"!=typeof on&&"function"!=typeof on||void 0===on.name||void 0===on.message?Gn(on):on.toString()},null):(Ve=ze,it=et,function(wn){Error.stackTraceLimit+=6;try{throw new Error}catch(on){wn.stack=on.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(J=function(ze){console.warn(ze)},te.isNode&&K.stderr.isTTY?J=function(ze,et){console.warn((et?"\x1b[33m":"\x1b[31m")+ze+"\x1b[0m\n")}:te.isNode||"string"!=typeof(new Error).stack||(J=function(ze,et){console.warn("%c"+ze,et?"color: darkorange":"color: red")}));var ct={warnings:Ne,longStackTraces:!1,cancellation:!1,monitoring:!1};return we&&V.longStackTraces(),{longStackTraces:function(){return ct.longStackTraces},warnings:function(){return ct.warnings},cancellation:function(){return ct.cancellation},monitoring:function(){return ct.monitoring},propagateFromFunction:function(){return Qt},boundValueFunction:function(){return rn},checkForgottenReturns:function(ze,et,ft,Gt,bn){if(void 0===ze&&null!==et&&qe){if(void 0!==bn&&bn._returnedNonUndefined()||0==(65535&Gt._bitField))return;ft&&(ft+=" ");var wn="",on="";if(et._trace){for(var En=et._trace.stack.split("\n"),Zn=yt(En),Nr=Zn.length-1;Nr>=0;--Nr){var ji=Zn[Nr];if(!Pe.test(ji)){var bi=ji.match(Ke);bi&&(wn="at "+bi[1]+":"+bi[2]+":"+bi[3]+" ");break}}if(Zn.length>0){var js=Zn[0];for(Nr=0;Nr<En.length;++Nr)if(En[Nr]===js){Nr>0&&(on="\n"+En[Nr-1]);break}}}Gt._warn("a promise was created in a "+ft+"handler "+wn+"but was not returned from it, see http://goo.gl/rRqMUw"+on,!0,et)}},setBounds:function(ze,et){if(_r()){for(var ft,Gt,bn=ze.stack.split("\n"),wn=et.stack.split("\n"),on=-1,En=-1,Zn=0;Zn<bn.length;++Zn)if(Nr=Ps(bn[Zn])){ft=Nr.fileName,on=Nr.line;break}for(Zn=0;Zn<wn.length;++Zn){var Nr;if(Nr=Ps(wn[Zn])){Gt=Nr.fileName,En=Nr.line;break}}on<0||En<0||!ft||!Gt||ft!==Gt||on>=En||(mr=function(ji){if(xe.test(ji))return!0;var bi=Ps(ji);return!!(bi&&bi.fileName===ft&&on<=bi.line&&bi.line<=En)})}},warn:Fe,deprecated:function(ze,et){var ft=ze+" is deprecated and will be removed in a future version.";return et&&(ft+=" Use "+et+" instead."),Fe(ft)},CapturedTrace:Yi,fireDomEvent:at,fireGlobalEvent:At}}},{"./errors":12,"./util":36}],10:[function(X,se,be){"use strict";se.exports=function(V){function ee(){return this.value}function ge(){throw this.reason}V.prototype.return=V.prototype.thenReturn=function(W){return W instanceof V&&W.suppressUnhandledRejections(),this._then(ee,void 0,void 0,{value:W},void 0)},V.prototype.throw=V.prototype.thenThrow=function(W){return this._then(ge,void 0,void 0,{reason:W},void 0)},V.prototype.catchThrow=function(W){if(arguments.length<=1)return this._then(void 0,ge,void 0,{reason:W},void 0);var J=arguments[1];return this.caught(W,function(){throw J})},V.prototype.catchReturn=function(W){if(arguments.length<=1)return W instanceof V&&W.suppressUnhandledRejections(),this._then(void 0,ee,void 0,{value:W},void 0);var J=arguments[1];return J instanceof V&&J.suppressUnhandledRejections(),this.caught(W,function(){return J})}}},{}],11:[function(X,se,be){"use strict";se.exports=function(V,ee){var ge=V.reduce,W=V.all;function J(){return W(this)}V.prototype.each=function(H){return ge(this,H,ee,0)._then(J,void 0,void 0,this,void 0)},V.prototype.mapSeries=function(H){return ge(this,H,ee,ee)},V.each=function(H,Y){return ge(H,Y,ee,0)._then(J,void 0,void 0,H,void 0)},V.mapSeries=function(H,Y){return ge(H,Y,ee,ee)}}},{}],12:[function(X,se,be){"use strict";var V,ee,ge=X("./es5"),W=ge.freeze,J=X("./util"),H=J.inherits,Y=J.notEnumerableProp;function me(Ne,we){function qe(Ye){if(!(this instanceof qe))return new qe(Ye);Y(this,"message","string"==typeof Ye?Ye:we),Y(this,"name",Ne),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return H(qe,Error),qe}var te=me("Warning","warning"),ce=me("CancellationError","cancellation error"),xe=me("TimeoutError","timeout error"),Pe=me("AggregateError","aggregate error");try{V=TypeError,ee=RangeError}catch(Ne){V=me("TypeError","type error"),ee=me("RangeError","range error")}for(var Ke="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),Ve=0;Ve<Ke.length;++Ve)"function"==typeof Array.prototype[Ke[Ve]]&&(Pe.prototype[Ke[Ve]]=Array.prototype[Ke[Ve]]);ge.defineProperty(Pe.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),Pe.prototype.isOperational=!0;var it=0;function bt(Ne){if(!(this instanceof bt))return new bt(Ne);Y(this,"name","OperationalError"),Y(this,"message",Ne),this.cause=Ne,this.isOperational=!0,Ne instanceof Error?(Y(this,"message",Ne.message),Y(this,"stack",Ne.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}Pe.prototype.toString=function(){var Ne=Array(4*it+1).join(" "),we="\n"+Ne+"AggregateError of:\n";it++,Ne=Array(4*it+1).join(" ");for(var qe=0;qe<this.length;++qe){for(var Ye=this[qe]===this?"[Circular AggregateError]":this[qe]+"",at=Ye.split("\n"),At=0;At<at.length;++At)at[At]=Ne+at[At];we+=(Ye=at.join("\n"))+"\n"}return it--,we},H(bt,Error);var $e=Error.__BluebirdErrorTypes__;$e||($e=W({CancellationError:ce,TimeoutError:xe,OperationalError:bt,RejectionError:bt,AggregateError:Pe}),ge.defineProperty(Error,"__BluebirdErrorTypes__",{value:$e,writable:!1,enumerable:!1,configurable:!1})),se.exports={Error,TypeError:V,RangeError:ee,CancellationError:$e.CancellationError,OperationalError:$e.OperationalError,TimeoutError:$e.TimeoutError,AggregateError:$e.AggregateError,Warning:te}},{"./es5":13,"./util":36}],13:[function(X,se,be){var V=function(){"use strict";return void 0===this}();if(V)se.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:V,propertyIsWritable:function(H,Y){var me=Object.getOwnPropertyDescriptor(H,Y);return!(me&&!me.writable&&!me.set)}};else{var ee={}.hasOwnProperty,ge={}.toString,W={}.constructor.prototype,J=function(H){var Y=[];for(var me in H)ee.call(H,me)&&Y.push(me);return Y};se.exports={isArray:function(H){try{return"[object Array]"===ge.call(H)}catch(Y){return!1}},keys:J,names:J,defineProperty:function(H,Y,me){return H[Y]=me.value,H},getDescriptor:function(H,Y){return{value:H[Y]}},freeze:function(H){return H},getPrototypeOf:function(H){try{return Object(H).constructor.prototype}catch(Y){return W}},isES5:V,propertyIsWritable:function(){return!0}}}},{}],14:[function(X,se,be){"use strict";se.exports=function(V,ee){var ge=V.map;V.prototype.filter=function(W,J){return ge(this,W,J,ee)},V.filter=function(W,J,H){return ge(W,J,H,ee)}}},{}],15:[function(X,se,be){"use strict";se.exports=function(V,ee,ge){var W=X("./util"),J=V.CancellationError,H=W.errorObj,Y=X("./catch_filter")(ge);function me(Ve,it,bt){this.promise=Ve,this.type=it,this.handler=bt,this.called=!1,this.cancelPromise=null}function te(Ve){this.finallyHandler=Ve}function ce(Ve,it){return null!=Ve.cancelPromise&&(arguments.length>1?Ve.cancelPromise._reject(it):Ve.cancelPromise._cancel(),Ve.cancelPromise=null,!0)}function xe(){return Ke.call(this,this.promise._target()._settledValue())}function Pe(Ve){if(!ce(this,Ve))return H.e=Ve,H}function Ke(Ve){var it=this.promise,bt=this.handler;if(!this.called){this.called=!0;var $e=this.isFinallyHandler()?bt.call(it._boundValue()):bt.call(it._boundValue(),Ve);if($e===ge)return $e;if(void 0!==$e){it._setReturnedNonUndefined();var Ne=ee($e,it);if(Ne instanceof V){if(null!=this.cancelPromise){if(Ne._isCancelled()){var we=new J("late cancellation observer");return it._attachExtraTrace(we),H.e=we,H}Ne.isPending()&&Ne._attachCancellationCallback(new te(this))}return Ne._then(xe,Pe,void 0,this,void 0)}}}return it.isRejected()?(ce(this),H.e=Ve,H):(ce(this),Ve)}return me.prototype.isFinallyHandler=function(){return 0===this.type},te.prototype._resultCancelled=function(){ce(this.finallyHandler)},V.prototype._passThrough=function(Ve,it,bt,$e){return"function"!=typeof Ve?this.then():this._then(bt,$e,void 0,new me(this,it,Ve),void 0)},V.prototype.lastly=V.prototype.finally=function(Ve){return this._passThrough(Ve,0,Ke,Ke)},V.prototype.tap=function(Ve){return this._passThrough(Ve,1,Ke)},V.prototype.tapCatch=function(Ve){var it=arguments.length;if(1===it)return this._passThrough(Ve,1,void 0,Ke);var bt,$e=new Array(it-1),Ne=0;for(bt=0;bt<it-1;++bt){var we=arguments[bt];if(!W.isObject(we))return V.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+W.classString(we)));$e[Ne++]=we}$e.length=Ne;var qe=arguments[bt];return this._passThrough(Y($e,qe,this),1,void 0,Ke)},me}},{"./catch_filter":7,"./util":36}],16:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W,J,H){var Y=X("./errors").TypeError,me=X("./util"),te=me.errorObj,ce=me.tryCatch,xe=[];function Pe(Ke,Ve,it,bt){if(H.cancellation()){var $e=new V(ge),Ne=this._finallyPromise=new V(ge);this._promise=$e.lastly(function(){return Ne}),$e._captureStackTrace(),$e._setOnCancel(this)}else(this._promise=new V(ge))._captureStackTrace();this._stack=bt,this._generatorFunction=Ke,this._receiver=Ve,this._generator=void 0,this._yieldHandlers="function"==typeof it?[it].concat(xe):xe,this._yieldedPromise=null,this._cancellationPhase=!1}me.inherits(Pe,J),Pe.prototype._isResolved=function(){return null===this._promise},Pe.prototype._cleanup=function(){this._promise=this._generator=null,H.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},Pe.prototype._promiseCancelled=function(){if(!this._isResolved()){var Ke;if(void 0!==this._generator.return)this._promise._pushContext(),Ke=ce(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var Ve=new V.CancellationError("generator .return() sentinel");V.coroutine.returnSentinel=Ve,this._promise._attachExtraTrace(Ve),this._promise._pushContext(),Ke=ce(this._generator.throw).call(this._generator,Ve),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(Ke)}},Pe.prototype._promiseFulfilled=function(Ke){this._yieldedPromise=null,this._promise._pushContext();var Ve=ce(this._generator.next).call(this._generator,Ke);this._promise._popContext(),this._continue(Ve)},Pe.prototype._promiseRejected=function(Ke){this._yieldedPromise=null,this._promise._attachExtraTrace(Ke),this._promise._pushContext();var Ve=ce(this._generator.throw).call(this._generator,Ke);this._promise._popContext(),this._continue(Ve)},Pe.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof V){var Ke=this._yieldedPromise;this._yieldedPromise=null,Ke.cancel()}},Pe.prototype.promise=function(){return this._promise},Pe.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},Pe.prototype._continue=function(Ke){var Ve=this._promise;if(Ke===te)return this._cleanup(),this._cancellationPhase?Ve.cancel():Ve._rejectCallback(Ke.e,!1);var it=Ke.value;if(!0===Ke.done)return this._cleanup(),this._cancellationPhase?Ve.cancel():Ve._resolveCallback(it);var bt=W(it,this._promise);if(bt instanceof V||null!==(bt=function(Ne,we,qe){for(var Ye=0;Ye<we.length;++Ye){qe._pushContext();var at=ce(we[Ye])(Ne);if(qe._popContext(),at===te){qe._pushContext();var At=V.reject(te.e);return qe._popContext(),At}var Ut=W(at,qe);if(Ut instanceof V)return Ut}return null}(bt,this._yieldHandlers,this._promise))){var $e=(bt=bt._target())._bitField;0==(50397184&$e)?(this._yieldedPromise=bt,bt._proxy(this,null)):0!=(33554432&$e)?V._async.invoke(this._promiseFulfilled,this,bt._value()):0!=(16777216&$e)?V._async.invoke(this._promiseRejected,this,bt._reason()):this._promiseCancelled()}else this._promiseRejected(new Y("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(it))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},V.coroutine=function(Ke,Ve){if("function"!=typeof Ke)throw new Y("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var it=Object(Ve).yieldHandler,bt=Pe,$e=(new Error).stack;return function(){var Ne=Ke.apply(this,arguments),we=new bt(void 0,void 0,it,$e),qe=we.promise();return we._generator=Ne,we._promiseFulfilled(void 0),qe}},V.coroutine.addYieldHandler=function(Ke){if("function"!=typeof Ke)throw new Y("expecting a function but got "+me.classString(Ke));xe.push(Ke)},V.spawn=function(Ke){if(H.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof Ke)return ee("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var Ve=new Pe(Ke,this),it=Ve.promise();return Ve._run(V.spawn),it}}},{"./errors":12,"./util":36}],17:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W,J,H){X("./util"),V.join=function(){var me,te=arguments.length-1;te>0&&"function"==typeof arguments[te]&&(me=arguments[te]);var ce=[].slice.call(arguments);me&&ce.pop();var xe=new ee(ce).promise();return void 0!==me?xe.spread(me):xe}}},{"./util":36}],18:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W,J,H){var Y=V._getDomain,me=X("./util"),te=me.tryCatch,ce=me.errorObj,xe=V._async;function Pe(Ve,it,bt,$e){this.constructor$(Ve),this._promise._captureStackTrace();var Ne=Y();this._callback=null===Ne?it:me.domainBind(Ne,it),this._preservedValues=$e===J?new Array(this.length()):null,this._limit=bt,this._inFlight=0,this._queue=[],xe.invoke(this._asyncInit,this,void 0)}function Ke(Ve,it,bt,$e){if("function"!=typeof it)return ge("expecting a function but got "+me.classString(it));var Ne=0;if(void 0!==bt){if("object"!=typeof bt||null===bt)return V.reject(new TypeError("options argument must be an object but it is "+me.classString(bt)));if("number"!=typeof bt.concurrency)return V.reject(new TypeError("'concurrency' must be a number but it is "+me.classString(bt.concurrency)));Ne=bt.concurrency}return new Pe(Ve,it,Ne="number"==typeof Ne&&isFinite(Ne)&&Ne>=1?Ne:0,$e).promise()}me.inherits(Pe,ee),Pe.prototype._asyncInit=function(){this._init$(void 0,-2)},Pe.prototype._init=function(){},Pe.prototype._promiseFulfilled=function(Ve,it){var bt=this._values,$e=this.length(),Ne=this._preservedValues,we=this._limit;if(it<0){if(bt[it=-1*it-1]=Ve,we>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(we>=1&&this._inFlight>=we)return bt[it]=Ve,this._queue.push(it),!1;null!==Ne&&(Ne[it]=Ve);var qe=this._promise,Ye=this._callback,at=qe._boundValue();qe._pushContext();var At=te(Ye).call(at,Ve,it,$e),Ut=qe._popContext();if(H.checkForgottenReturns(At,Ut,null!==Ne?"Promise.filter":"Promise.map",qe),At===ce)return this._reject(At.e),!0;var Mt=W(At,this._promise);if(Mt instanceof V){var sn=(Mt=Mt._target())._bitField;if(0==(50397184&sn))return we>=1&&this._inFlight++,bt[it]=Mt,Mt._proxy(this,-1*(it+1)),!1;if(0==(33554432&sn))return 0!=(16777216&sn)?(this._reject(Mt._reason()),!0):(this._cancel(),!0);At=Mt._value()}bt[it]=At}return++this._totalResolved>=$e&&(null!==Ne?this._filter(bt,Ne):this._resolve(bt),!0)},Pe.prototype._drainQueue=function(){for(var Ve=this._queue,it=this._limit,bt=this._values;Ve.length>0&&this._inFlight<it;){if(this._isResolved())return;var $e=Ve.pop();this._promiseFulfilled(bt[$e],$e)}},Pe.prototype._filter=function(Ve,it){for(var bt=it.length,$e=new Array(bt),Ne=0,we=0;we<bt;++we)Ve[we]&&($e[Ne++]=it[we]);$e.length=Ne,this._resolve($e)},Pe.prototype.preservedValues=function(){return this._preservedValues},V.prototype.map=function(Ve,it){return Ke(this,Ve,it,null)},V.map=function(Ve,it,bt,$e){return Ke(Ve,it,bt,$e)}}},{"./util":36}],19:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W,J){var H=X("./util"),Y=H.tryCatch;V.method=function(me){if("function"!=typeof me)throw new V.TypeError("expecting a function but got "+H.classString(me));return function(){var te=new V(ee);te._captureStackTrace(),te._pushContext();var ce=Y(me).apply(this,arguments),xe=te._popContext();return J.checkForgottenReturns(ce,xe,"Promise.method",te),te._resolveFromSyncValue(ce),te}},V.attempt=V.try=function(me){if("function"!=typeof me)return W("expecting a function but got "+H.classString(me));var te,ce=new V(ee);if(ce._captureStackTrace(),ce._pushContext(),arguments.length>1){J.deprecated("calling Promise.try with more than 1 argument");var xe=arguments[1],Pe=arguments[2];te=H.isArray(xe)?Y(me).apply(Pe,xe):Y(me).call(Pe,xe)}else te=Y(me)();var Ke=ce._popContext();return J.checkForgottenReturns(te,Ke,"Promise.try",ce),ce._resolveFromSyncValue(te),ce},V.prototype._resolveFromSyncValue=function(me){me===H.errorObj?this._rejectCallback(me.e,!1):this._resolveCallback(me,!0)}}},{"./util":36}],20:[function(X,se,be){"use strict";var V=X("./util"),ee=V.maybeWrapAsError,ge=X("./errors").OperationalError,W=X("./es5"),J=/^(?:name|message|stack|cause)$/;function H(Y){var me,Pe;if((Pe=Y)instanceof Error&&W.getPrototypeOf(Pe)===Error.prototype){(me=new ge(Y)).name=Y.name,me.message=Y.message,me.stack=Y.stack;for(var te=W.keys(Y),ce=0;ce<te.length;++ce){var xe=te[ce];J.test(xe)||(me[xe]=Y[xe])}return me}return V.markAsOriginatingFromRejection(Y),Y}se.exports=function(Y,me){return function(te,ce){if(null!==Y){if(te){var xe=H(ee(te));Y._attachExtraTrace(xe),Y._reject(xe)}else if(me){var Pe=[].slice.call(arguments,1);Y._fulfill(Pe)}else Y._fulfill(ce);Y=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(X,se,be){"use strict";se.exports=function(V){var ee=X("./util"),ge=V._async,W=ee.tryCatch,J=ee.errorObj;function H(te,ce){if(!ee.isArray(te))return Y.call(this,te,ce);var xe=W(ce).apply(this._boundValue(),[null].concat(te));xe===J&&ge.throwLater(xe.e)}function Y(te,ce){var xe=this._boundValue(),Pe=void 0===te?W(ce).call(xe,null):W(ce).call(xe,null,te);Pe===J&&ge.throwLater(Pe.e)}function me(te,ce){if(!te){var xe=new Error(te+"");xe.cause=te,te=xe}var Pe=W(ce).call(this._boundValue(),te);Pe===J&&ge.throwLater(Pe.e)}V.prototype.asCallback=V.prototype.nodeify=function(te,ce){if("function"==typeof te){var xe=Y;void 0!==ce&&Object(ce).spread&&(xe=H),this._then(xe,me,void 0,this,te)}return this}}},{"./util":36}],22:[function(X,se,be){"use strict";se.exports=function(){var V=function(){return new Pe("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},ee=function(){return new je.PromiseInspection(this._target())},ge=function(Ue){return je.reject(new Pe(Ue))};function W(){}var J,H={},Y=X("./util");Y.notEnumerableProp(je,"_getDomain",J=Y.isNode?function(){var Ue=K.domain;return void 0===Ue&&(Ue=null),Ue}:function(){return null});var me=X("./es5"),te=X("./async"),ce=new te;me.defineProperty(je,"_async",{value:ce});var xe=X("./errors"),Pe=je.TypeError=xe.TypeError;je.RangeError=xe.RangeError;var Ke=je.CancellationError=xe.CancellationError;je.TimeoutError=xe.TimeoutError,je.OperationalError=xe.OperationalError,je.RejectionError=xe.OperationalError,je.AggregateError=xe.AggregateError;var Ve=function(){},it={},bt={},$e=X("./thenables")(je,Ve),Ne=X("./promise_array")(je,Ve,$e,ge,W),we=X("./context")(je),qe=we.create,Ye=X("./debuggability")(je,we),at=X("./finally")(je,$e,bt),At=X("./catch_filter")(bt),Ut=X("./nodeback"),Mt=Y.errorObj,sn=Y.tryCatch;function je(Ue){Ue!==Ve&&function(xt,Vt){if(null==xt||xt.constructor!==je)throw new Pe("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof Vt)throw new Pe("expecting a function but got "+Y.classString(Vt))}(this,Ue),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(Ue),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function We(Ue){this.promise._resolveCallback(Ue)}function tt(Ue){this.promise._rejectCallback(Ue,!1)}function Pt(Ue){var xt=new je(Ve);xt._fulfillmentHandler0=Ue,xt._rejectionHandler0=Ue,xt._promise0=Ue,xt._receiver0=Ue}return je.prototype.toString=function(){return"[object Promise]"},je.prototype.caught=je.prototype.catch=function(Ue){var xt=arguments.length;if(xt>1){var Vt,Qt=new Array(xt-1),rn=0;for(Vt=0;Vt<xt-1;++Vt){var he=arguments[Vt];if(!Y.isObject(he))return ge("Catch statement predicate: expecting an object but got "+Y.classString(he));Qt[rn++]=he}return Qt.length=rn,this.then(void 0,At(Qt,Ue=arguments[Vt],this))}return this.then(void 0,Ue)},je.prototype.reflect=function(){return this._then(ee,ee,void 0,this,void 0)},je.prototype.then=function(Ue,xt){if(Ye.warnings()&&arguments.length>0&&"function"!=typeof Ue&&"function"!=typeof xt){var Vt=".then() only accepts functions but was passed: "+Y.classString(Ue);arguments.length>1&&(Vt+=", "+Y.classString(xt)),this._warn(Vt)}return this._then(Ue,xt,void 0,void 0,void 0)},je.prototype.done=function(Ue,xt){this._then(Ue,xt,void 0,void 0,void 0)._setIsFinal()},je.prototype.spread=function(Ue){return"function"!=typeof Ue?ge("expecting a function but got "+Y.classString(Ue)):this.all()._then(Ue,void 0,void 0,it,void 0)},je.prototype.toJSON=function(){var Ue={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(Ue.fulfillmentValue=this.value(),Ue.isFulfilled=!0):this.isRejected()&&(Ue.rejectionReason=this.reason(),Ue.isRejected=!0),Ue},je.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new Ne(this).promise()},je.prototype.error=function(Ue){return this.caught(Y.originatesFromRejection,Ue)},je.getNewLibraryCopy=se.exports,je.is=function(Ue){return Ue instanceof je},je.fromNode=je.fromCallback=function(Ue){var xt=new je(Ve);xt._captureStackTrace();var Vt=arguments.length>1&&!!Object(arguments[1]).multiArgs,Qt=sn(Ue)(Ut(xt,Vt));return Qt===Mt&&xt._rejectCallback(Qt.e,!0),xt._isFateSealed()||xt._setAsyncGuaranteed(),xt},je.all=function(Ue){return new Ne(Ue).promise()},je.cast=function(Ue){var xt=$e(Ue);return xt instanceof je||((xt=new je(Ve))._captureStackTrace(),xt._setFulfilled(),xt._rejectionHandler0=Ue),xt},je.resolve=je.fulfilled=je.cast,je.reject=je.rejected=function(Ue){var xt=new je(Ve);return xt._captureStackTrace(),xt._rejectCallback(Ue,!0),xt},je.setScheduler=function(Ue){if("function"!=typeof Ue)throw new Pe("expecting a function but got "+Y.classString(Ue));return ce.setScheduler(Ue)},je.prototype._then=function(Ue,xt,Vt,Qt,rn){var he=void 0!==rn,_e=he?rn:new je(Ve),Fe=this._target(),yt=Fe._bitField;he||(_e._propagateFrom(this,3),_e._captureStackTrace(),void 0===Qt&&0!=(2097152&this._bitField)&&(Qt=0!=(50397184&yt)?this._boundValue():Fe===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,_e));var _t=J();if(0!=(50397184&yt)){var pt,Sn,Gn=Fe._settlePromiseCtx;0!=(33554432&yt)?(Sn=Fe._rejectionHandler0,pt=Ue):0!=(16777216&yt)?(Sn=Fe._fulfillmentHandler0,pt=xt,Fe._unsetRejectionIsUnhandled()):(Gn=Fe._settlePromiseLateCancellationObserver,Sn=new Ke("late cancellation observer"),Fe._attachExtraTrace(Sn),pt=xt),ce.invoke(Gn,Fe,{handler:null===_t?pt:"function"==typeof pt&&Y.domainBind(_t,pt),promise:_e,receiver:Qt,value:Sn})}else Fe._addCallbacks(Ue,xt,_e,Qt,_t);return _e},je.prototype._length=function(){return 65535&this._bitField},je.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},je.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},je.prototype._setLength=function(Ue){this._bitField=-65536&this._bitField|65535&Ue},je.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},je.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},je.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},je.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},je.prototype._isFinal=function(){return(4194304&this._bitField)>0},je.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},je.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},je.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},je.prototype._setAsyncGuaranteed=function(){ce.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},je.prototype._receiverAt=function(Ue){var xt=0===Ue?this._receiver0:this[4*Ue-4+3];if(xt!==H)return void 0===xt&&this._isBound()?this._boundValue():xt},je.prototype._promiseAt=function(Ue){return this[4*Ue-4+2]},je.prototype._fulfillmentHandlerAt=function(Ue){return this[4*Ue-4+0]},je.prototype._rejectionHandlerAt=function(Ue){return this[4*Ue-4+1]},je.prototype._boundValue=function(){},je.prototype._migrateCallback0=function(Ue){var xt=Ue._fulfillmentHandler0,Vt=Ue._rejectionHandler0,Qt=Ue._promise0,rn=Ue._receiverAt(0);void 0===rn&&(rn=H),this._addCallbacks(xt,Vt,Qt,rn,null)},je.prototype._migrateCallbackAt=function(Ue,xt){var Vt=Ue._fulfillmentHandlerAt(xt),Qt=Ue._rejectionHandlerAt(xt),rn=Ue._promiseAt(xt),he=Ue._receiverAt(xt);void 0===he&&(he=H),this._addCallbacks(Vt,Qt,rn,he,null)},je.prototype._addCallbacks=function(Ue,xt,Vt,Qt,rn){var he=this._length();if(he>=65531&&(he=0,this._setLength(0)),0===he)this._promise0=Vt,this._receiver0=Qt,"function"==typeof Ue&&(this._fulfillmentHandler0=null===rn?Ue:Y.domainBind(rn,Ue)),"function"==typeof xt&&(this._rejectionHandler0=null===rn?xt:Y.domainBind(rn,xt));else{var _e=4*he-4;this[_e+2]=Vt,this[_e+3]=Qt,"function"==typeof Ue&&(this[_e+0]=null===rn?Ue:Y.domainBind(rn,Ue)),"function"==typeof xt&&(this[_e+1]=null===rn?xt:Y.domainBind(rn,xt))}return this._setLength(he+1),he},je.prototype._proxy=function(Ue,xt){this._addCallbacks(void 0,void 0,xt,Ue,null)},je.prototype._resolveCallback=function(Ue,xt){if(0==(117506048&this._bitField)){if(Ue===this)return this._rejectCallback(V(),!1);var Vt=$e(Ue,this);if(!(Vt instanceof je))return this._fulfill(Ue);xt&&this._propagateFrom(Vt,2);var Qt=Vt._target();if(Qt!==this){var rn=Qt._bitField;if(0==(50397184&rn)){var he=this._length();he>0&&Qt._migrateCallback0(this);for(var _e=1;_e<he;++_e)Qt._migrateCallbackAt(this,_e);this._setFollowing(),this._setLength(0),this._setFollowee(Qt)}else if(0!=(33554432&rn))this._fulfill(Qt._value());else if(0!=(16777216&rn))this._reject(Qt._reason());else{var Fe=new Ke("late cancellation observer");Qt._attachExtraTrace(Fe),this._reject(Fe)}}else this._reject(V())}},je.prototype._rejectCallback=function(Ue,xt,Vt){var Qt=Y.ensureErrorObject(Ue),rn=Qt===Ue;if(!rn&&!Vt&&Ye.warnings()){var he="a promise was rejected with a non-error: "+Y.classString(Ue);this._warn(he,!0)}this._attachExtraTrace(Qt,!!xt&&rn),this._reject(Ue)},je.prototype._resolveFromExecutor=function(Ue){if(Ue!==Ve){var xt=this;this._captureStackTrace(),this._pushContext();var Vt=!0,Qt=this._execute(Ue,function(rn){xt._resolveCallback(rn)},function(rn){xt._rejectCallback(rn,Vt)});Vt=!1,this._popContext(),void 0!==Qt&&xt._rejectCallback(Qt,!0)}},je.prototype._settlePromiseFromHandler=function(Ue,xt,Vt,Qt){var rn=Qt._bitField;if(0==(65536&rn)){var he;Qt._pushContext(),xt===it?Vt&&"number"==typeof Vt.length?he=sn(Ue).apply(this._boundValue(),Vt):(he=Mt).e=new Pe("cannot .spread() a non-array: "+Y.classString(Vt)):he=sn(Ue).call(xt,Vt);var _e=Qt._popContext();0==(65536&(rn=Qt._bitField))&&(he===bt?Qt._reject(Vt):he===Mt?Qt._rejectCallback(he.e,!1):(Ye.checkForgottenReturns(he,_e,"",Qt,this),Qt._resolveCallback(he)))}},je.prototype._target=function(){for(var Ue=this;Ue._isFollowing();)Ue=Ue._followee();return Ue},je.prototype._followee=function(){return this._rejectionHandler0},je.prototype._setFollowee=function(Ue){this._rejectionHandler0=Ue},je.prototype._settlePromise=function(Ue,xt,Vt,Qt){var rn=Ue instanceof je,he=this._bitField,_e=0!=(134217728&he);0!=(65536&he)?(rn&&Ue._invokeInternalOnCancel(),Vt instanceof at&&Vt.isFinallyHandler()?(Vt.cancelPromise=Ue,sn(xt).call(Vt,Qt)===Mt&&Ue._reject(Mt.e)):xt===ee?Ue._fulfill(ee.call(Vt)):Vt instanceof W?Vt._promiseCancelled(Ue):rn||Ue instanceof Ne?Ue._cancel():Vt.cancel()):"function"==typeof xt?rn?(_e&&Ue._setAsyncGuaranteed(),this._settlePromiseFromHandler(xt,Vt,Qt,Ue)):xt.call(Vt,Qt,Ue):Vt instanceof W?Vt._isResolved()||(0!=(33554432&he)?Vt._promiseFulfilled(Qt,Ue):Vt._promiseRejected(Qt,Ue)):rn&&(_e&&Ue._setAsyncGuaranteed(),0!=(33554432&he)?Ue._fulfill(Qt):Ue._reject(Qt))},je.prototype._settlePromiseLateCancellationObserver=function(Ue){var xt=Ue.handler,Vt=Ue.promise,Qt=Ue.receiver,rn=Ue.value;"function"==typeof xt?Vt instanceof je?this._settlePromiseFromHandler(xt,Qt,rn,Vt):xt.call(Qt,rn,Vt):Vt instanceof je&&Vt._reject(rn)},je.prototype._settlePromiseCtx=function(Ue){this._settlePromise(Ue.promise,Ue.handler,Ue.receiver,Ue.value)},je.prototype._settlePromise0=function(Ue,xt,Vt){var Qt=this._promise0,rn=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(Qt,Ue,rn,xt)},je.prototype._clearCallbackDataAtIndex=function(Ue){var xt=4*Ue-4;this[xt+2]=this[xt+3]=this[xt+0]=this[xt+1]=void 0},je.prototype._fulfill=function(Ue){var xt=this._bitField;if(!((117506048&xt)>>>16)){if(Ue===this){var Vt=V();return this._attachExtraTrace(Vt),this._reject(Vt)}this._setFulfilled(),this._rejectionHandler0=Ue,(65535&xt)>0&&(0!=(134217728&xt)?this._settlePromises():ce.settlePromises(this))}},je.prototype._reject=function(Ue){var xt=this._bitField;if(!((117506048&xt)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=Ue,this._isFinal())return ce.fatalError(Ue,Y.isNode);(65535&xt)>0?ce.settlePromises(this):this._ensurePossibleRejectionHandled()}},je.prototype._fulfillPromises=function(Ue,xt){for(var Vt=1;Vt<Ue;Vt++){var Qt=this._fulfillmentHandlerAt(Vt),rn=this._promiseAt(Vt),he=this._receiverAt(Vt);this._clearCallbackDataAtIndex(Vt),this._settlePromise(rn,Qt,he,xt)}},je.prototype._rejectPromises=function(Ue,xt){for(var Vt=1;Vt<Ue;Vt++){var Qt=this._rejectionHandlerAt(Vt),rn=this._promiseAt(Vt),he=this._receiverAt(Vt);this._clearCallbackDataAtIndex(Vt),this._settlePromise(rn,Qt,he,xt)}},je.prototype._settlePromises=function(){var Ue=this._bitField,xt=65535&Ue;if(xt>0){if(0!=(16842752&Ue)){var Vt=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,Vt,Ue),this._rejectPromises(xt,Vt)}else{var Qt=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,Qt,Ue),this._fulfillPromises(xt,Qt)}this._setLength(0)}this._clearCancellationData()},je.prototype._settledValue=function(){var Ue=this._bitField;return 0!=(33554432&Ue)?this._rejectionHandler0:0!=(16777216&Ue)?this._fulfillmentHandler0:void 0},je.defer=je.pending=function(){return Ye.deprecated("Promise.defer","new Promise"),{promise:new je(Ve),resolve:We,reject:tt}},Y.notEnumerableProp(je,"_makeSelfResolutionError",V),X("./method")(je,Ve,$e,ge,Ye),X("./bind")(je,Ve,$e,Ye),X("./cancel")(je,Ne,ge,Ye),X("./direct_resolve")(je),X("./synchronous_inspection")(je),X("./join")(je,Ne,$e,Ve,ce,J),je.Promise=je,je.version="3.5.1",X("./map.js")(je,Ne,ge,$e,Ve,Ye),X("./call_get.js")(je),X("./using.js")(je,ge,$e,qe,Ve,Ye),X("./timers.js")(je,Ve,Ye),X("./generators.js")(je,ge,Ve,$e,W,Ye),X("./nodeify.js")(je),X("./promisify.js")(je,Ve),X("./props.js")(je,Ne,$e,ge),X("./race.js")(je,Ve,$e,ge),X("./reduce.js")(je,Ne,ge,$e,Ve,Ye),X("./settle.js")(je,Ne,Ye),X("./some.js")(je,Ne,ge),X("./filter.js")(je,Ve),X("./each.js")(je,Ve),X("./any.js")(je),Y.toFastProperties(je),Y.toFastProperties(je.prototype),Pt({a:1}),Pt({b:2}),Pt({c:3}),Pt(1),Pt(function(){}),Pt(void 0),Pt(!1),Pt(new je(Ve)),Ye.setBounds(te.firstLineError,Y.lastLineError),je}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W,J){var H=X("./util");function Y(me){var te=this._promise=new V(ee);me instanceof V&&te._propagateFrom(me,3),te._setOnCancel(this),this._values=me,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return H.inherits(Y,J),Y.prototype.length=function(){return this._length},Y.prototype.promise=function(){return this._promise},Y.prototype._init=function me(te,ce){var xe=ge(this._values,this._promise);if(xe instanceof V){var Pe=(xe=xe._target())._bitField;if(this._values=xe,0==(50397184&Pe))return this._promise._setAsyncGuaranteed(),xe._then(me,this._reject,void 0,this,ce);if(0==(33554432&Pe))return 0!=(16777216&Pe)?this._reject(xe._reason()):this._cancel();xe=xe._value()}if(null!==(xe=H.asArray(xe)))0!==xe.length?this._iterate(xe):-5===ce?this._resolveEmptyArray():this._resolve(function(Ve){switch(ce){case-2:return[];case-3:return{};case-6:return new Map}}());else{var Ke=W("expecting an array or an iterable object but got "+H.classString(xe)).reason();this._promise._rejectCallback(Ke,!1)}},Y.prototype._iterate=function(me){var te=this.getActualLength(me.length);this._length=te,this._values=this.shouldCopyValues()?new Array(te):this._values;for(var ce=this._promise,xe=!1,Pe=null,Ke=0;Ke<te;++Ke){var Ve=ge(me[Ke],ce);Pe=Ve instanceof V?(Ve=Ve._target())._bitField:null,xe?null!==Pe&&Ve.suppressUnhandledRejections():null!==Pe?0==(50397184&Pe)?(Ve._proxy(this,Ke),this._values[Ke]=Ve):xe=0!=(33554432&Pe)?this._promiseFulfilled(Ve._value(),Ke):0!=(16777216&Pe)?this._promiseRejected(Ve._reason(),Ke):this._promiseCancelled(Ke):xe=this._promiseFulfilled(Ve,Ke)}xe||ce._setAsyncGuaranteed()},Y.prototype._isResolved=function(){return null===this._values},Y.prototype._resolve=function(me){this._values=null,this._promise._fulfill(me)},Y.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},Y.prototype._reject=function(me){this._values=null,this._promise._rejectCallback(me,!1)},Y.prototype._promiseFulfilled=function(me,te){return this._values[te]=me,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},Y.prototype._promiseCancelled=function(){return this._cancel(),!0},Y.prototype._promiseRejected=function(me){return this._totalResolved++,this._reject(me),!0},Y.prototype._resultCancelled=function(){if(!this._isResolved()){var me=this._values;if(this._cancel(),me instanceof V)me.cancel();else for(var te=0;te<me.length;++te)me[te]instanceof V&&me[te].cancel()}},Y.prototype.shouldCopyValues=function(){return!0},Y.prototype.getActualLength=function(me){return me},Y}},{"./util":36}],24:[function(X,se,be){"use strict";se.exports=function(V,ee){var ge={},W=X("./util"),J=X("./nodeback"),H=W.withAppended,Y=W.maybeWrapAsError,me=W.canEvaluate,te=X("./errors").TypeError,ce={__isPromisified__:!0},xe=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),Pe=function(qe){return W.isIdentifier(qe)&&"_"!==qe.charAt(0)&&"constructor"!==qe};function Ke(qe){return!xe.test(qe)}function Ve(qe){try{return!0===qe.__isPromisified__}catch(Ye){return!1}}function it(qe,Ye,at){var At=W.getDataPropertyOrDefault(qe,Ye+at,ce);return!!At&&Ve(At)}var Ne=me?void 0:function(qe,Ye,at,At,Ut,Mt){var sn=function(){return this}(),je=qe;function We(){var tt=Ye;Ye===ge&&(tt=this);var Pt=new V(ee);Pt._captureStackTrace();var Ue="string"==typeof je&&this!==sn?this[je]:qe,xt=J(Pt,Mt);try{Ue.apply(tt,H(arguments,xt))}catch(Vt){Pt._rejectCallback(Y(Vt),!0,!0)}return Pt._isFateSealed()||Pt._setAsyncGuaranteed(),Pt}return"string"==typeof je&&(qe=At),W.notEnumerableProp(We,"__isPromisified__",!0),We};function we(qe,Ye,at,At,Ut){for(var Mt=new RegExp(function(qe){return qe.replace(/([$])/,"\\$")}(Ye)+"$"),sn=function bt(qe,Ye,at,At){for(var Ut=W.inheritedDataKeys(qe),Mt=[],sn=0;sn<Ut.length;++sn){var je=Ut[sn],We=qe[je],tt=At===Pe||Pe(je);"function"!=typeof We||Ve(We)||it(qe,je,Ye)||!At(je,We,qe,tt)||Mt.push(je,We)}return function(Pt,Ue,xt){for(var Vt=0;Vt<Pt.length;Vt+=2){var Qt=Pt[Vt];if(xt.test(Qt))for(var rn=Qt.replace(xt,""),he=0;he<Pt.length;he+=2)if(Pt[he]===rn)throw new te("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",Ue))}}(Mt,Ye,at),Mt}(qe,Ye,Mt,at),je=0,We=sn.length;je<We;je+=2){var tt=sn[je],Pt=sn[je+1],Ue=tt+Ye;if(At===Ne)qe[Ue]=Ne(tt,ge,tt,Pt,Ye,Ut);else{var xt=At(Pt,function(){return Ne(tt,ge,tt,Pt,Ye,Ut)});W.notEnumerableProp(xt,"__isPromisified__",!0),qe[Ue]=xt}}return W.toFastProperties(qe),qe}V.promisify=function(qe,Ye){if("function"!=typeof qe)throw new te("expecting a function but got "+W.classString(qe));if(Ve(qe))return qe;var Mt,at=void 0===(Ye=Object(Ye)).context?ge:Ye.context,Ut=Ne(Mt=qe,at,void 0,Mt,null,!!Ye.multiArgs);return W.copyDescriptors(qe,Ut,Ke),Ut},V.promisifyAll=function(qe,Ye){if("function"!=typeof qe&&"object"!=typeof qe)throw new te("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var at=!!(Ye=Object(Ye)).multiArgs,At=Ye.suffix;"string"!=typeof At&&(At="Async");var Ut=Ye.filter;"function"!=typeof Ut&&(Ut=Pe);var Mt=Ye.promisifier;if("function"!=typeof Mt&&(Mt=Ne),!W.isIdentifier(At))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var sn=W.inheritedDataKeys(qe),je=0;je<sn.length;++je){var We=qe[sn[je]];"constructor"!==sn[je]&&W.isClass(We)&&(we(We.prototype,At,Ut,Mt,at),we(We,At,Ut,Mt,at))}return we(qe,At,Ut,Mt,at)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W){var J,H=X("./util"),Y=H.isObject,me=X("./es5");"function"==typeof Map&&(J=Map);var te=function(){var Pe=0,Ke=0;function Ve(it,bt){this[Pe]=it,this[Pe+Ke]=bt,Pe++}return function(it){Ke=it.size,Pe=0;var bt=new Array(2*it.size);return it.forEach(Ve,bt),bt}}();function ce(Pe){var Ke,Ve=!1;if(void 0!==J&&Pe instanceof J)Ke=te(Pe),Ve=!0;else{var it=me.keys(Pe),bt=it.length;Ke=new Array(2*bt);for(var $e=0;$e<bt;++$e){var Ne=it[$e];Ke[$e]=Pe[Ne],Ke[$e+bt]=Ne}}this.constructor$(Ke),this._isMap=Ve,this._init$(void 0,Ve?-6:-3)}function xe(Pe){var Ke,Ve=ge(Pe);return Y(Ve)?(Ke=Ve instanceof V?Ve._then(V.props,void 0,void 0,void 0,void 0):new ce(Ve).promise(),Ve instanceof V&&Ke._propagateFrom(Ve,2),Ke):W("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}H.inherits(ce,ee),ce.prototype._init=function(){},ce.prototype._promiseFulfilled=function(Pe,Ke){if(this._values[Ke]=Pe,++this._totalResolved>=this._length){var Ve;if(this._isMap)Ve=function(Ne){for(var we=new J,qe=Ne.length/2|0,Ye=0;Ye<qe;++Ye)we.set(Ne[qe+Ye],Ne[Ye]);return we}(this._values);else{Ve={};for(var it=this.length(),bt=0,$e=this.length();bt<$e;++bt)Ve[this._values[bt+it]]=this._values[bt]}return this._resolve(Ve),!0}return!1},ce.prototype.shouldCopyValues=function(){return!1},ce.prototype.getActualLength=function(Pe){return Pe>>1},V.prototype.props=function(){return xe(this)},V.props=function(Pe){return xe(Pe)}}},{"./es5":13,"./util":36}],26:[function(X,se,be){"use strict";function V(ee){this._capacity=ee,this._length=0,this._front=0}V.prototype._willBeOverCapacity=function(ee){return this._capacity<ee},V.prototype._pushOne=function(ee){var ge=this.length();this._checkCapacity(ge+1),this[this._front+ge&this._capacity-1]=ee,this._length=ge+1},V.prototype.push=function(ee,ge,W){var J=this.length()+3;if(this._willBeOverCapacity(J))return this._pushOne(ee),this._pushOne(ge),void this._pushOne(W);var H=this._front+J-3;this._checkCapacity(J);var Y=this._capacity-1;this[H+0&Y]=ee,this[H+1&Y]=ge,this[H+2&Y]=W,this._length=J},V.prototype.shift=function(){var ee=this._front,ge=this[ee];return this[ee]=void 0,this._front=ee+1&this._capacity-1,this._length--,ge},V.prototype.length=function(){return this._length},V.prototype._checkCapacity=function(ee){this._capacity<ee&&this._resizeTo(this._capacity<<1)},V.prototype._resizeTo=function(ee){var ge=this._capacity;this._capacity=ee,function(W,J,H,Y,me){for(var te=0;te<me;++te)H[te+Y]=W[te+0],W[te+0]=void 0}(this,0,this,ge,this._front+this._length&ge-1)},se.exports=V},{}],27:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W){var J=X("./util");function Y(me,te){var ce=ge(me);if(ce instanceof V)return function(me){return me.then(function(te){return Y(te,me)})}(ce);if(null===(me=J.asArray(me)))return W("expecting an array or an iterable object but got "+J.classString(me));var xe=new V(ee);void 0!==te&&xe._propagateFrom(te,3);for(var Pe=xe._fulfill,Ke=xe._reject,Ve=0,it=me.length;Ve<it;++Ve){var bt=me[Ve];(void 0!==bt||Ve in me)&&V.cast(bt)._then(Pe,Ke,void 0,xe,null)}return xe}V.race=function(me){return Y(me,void 0)},V.prototype.race=function(){return Y(this,void 0)}}},{"./util":36}],28:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W,J,H){var Y=V._getDomain,me=X("./util"),te=me.tryCatch;function ce(it,bt,$e,Ne){this.constructor$(it);var we=Y();this._fn=null===we?bt:me.domainBind(we,bt),void 0!==$e&&($e=V.resolve($e))._attachCancellationCallback(this),this._initialValue=$e,this._currentCancellable=null,this._eachValues=Ne===J?Array(this._length):0===Ne?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function xe(it,bt){this.isFulfilled()?bt._resolve(it):bt._reject(it)}function Pe(it,bt,$e,Ne){return"function"!=typeof bt?ge("expecting a function but got "+me.classString(bt)):new ce(it,bt,$e,Ne).promise()}function Ke(it){this.accum=it,this.array._gotAccum(it);var bt=W(this.value,this.array._promise);return bt instanceof V?(this.array._currentCancellable=bt,bt._then(Ve,void 0,void 0,this,void 0)):Ve.call(this,bt)}function Ve(it){var bt,$e=this.array,Ne=$e._promise,we=te($e._fn);Ne._pushContext(),(bt=void 0!==$e._eachValues?we.call(Ne._boundValue(),it,this.index,this.length):we.call(Ne._boundValue(),this.accum,it,this.index,this.length))instanceof V&&($e._currentCancellable=bt);var qe=Ne._popContext();return H.checkForgottenReturns(bt,qe,void 0!==$e._eachValues?"Promise.each":"Promise.reduce",Ne),bt}me.inherits(ce,ee),ce.prototype._gotAccum=function(it){null!=this._eachValues&&it!==J&&this._eachValues.push(it)},ce.prototype._eachComplete=function(it){return null!==this._eachValues&&this._eachValues.push(it),this._eachValues},ce.prototype._init=function(){},ce.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},ce.prototype.shouldCopyValues=function(){return!1},ce.prototype._resolve=function(it){this._promise._resolveCallback(it),this._values=null},ce.prototype._resultCancelled=function(it){if(it===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof V&&this._currentCancellable.cancel(),this._initialValue instanceof V&&this._initialValue.cancel())},ce.prototype._iterate=function(it){var bt,$e;this._values=it;var Ne=it.length;if(void 0!==this._initialValue?(bt=this._initialValue,$e=0):(bt=V.resolve(it[0]),$e=1),this._currentCancellable=bt,!bt.isRejected())for(;$e<Ne;++$e)bt=bt._then(Ke,void 0,void 0,{accum:null,value:it[$e],index:$e,length:Ne,array:this},void 0);void 0!==this._eachValues&&(bt=bt._then(this._eachComplete,void 0,void 0,this,void 0)),bt._then(xe,xe,void 0,bt,this)},V.prototype.reduce=function(it,bt){return Pe(this,it,bt,null)},V.reduce=function(it,bt,$e,Ne){return Pe(it,bt,$e,Ne)}}},{"./util":36}],29:[function(X,se,be){"use strict";var V,Y,me,te,ce,ee=X("./util"),ge=ee.getNativePromise();if(ee.isNode&&"undefined"==typeof MutationObserver){var W=ue.setImmediate,J=K.nextTick;V=ee.isRecentNode?function(Y){W.call(ue,Y)}:function(Y){J.call(K,Y)}}else if("function"==typeof ge&&"function"==typeof ge.resolve){var H=ge.resolve();V=function(Y){H.then(Y)}}else V="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?void 0!==re?function(Y){re(Y)}:"undefined"!=typeof setTimeout?function(Y){setTimeout(Y,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(Y=document.createElement("div"),me={attributes:!0},te=!1,ce=document.createElement("div"),new MutationObserver(function(){Y.classList.toggle("foo"),te=!1}).observe(ce,me),function(xe){var Pe=new MutationObserver(function(){Pe.disconnect(),xe()});Pe.observe(Y,me),te||(te=!0,ce.classList.toggle("foo"))});se.exports=V},{"./util":36}],30:[function(X,se,be){"use strict";se.exports=function(V,ee,ge){var W=V.PromiseInspection;function J(H){this.constructor$(H)}X("./util").inherits(J,ee),J.prototype._promiseResolved=function(H,Y){return this._values[H]=Y,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},J.prototype._promiseFulfilled=function(H,Y){var me=new W;return me._bitField=33554432,me._settledValueField=H,this._promiseResolved(Y,me)},J.prototype._promiseRejected=function(H,Y){var me=new W;return me._bitField=16777216,me._settledValueField=H,this._promiseResolved(Y,me)},V.settle=function(H){return ge.deprecated(".settle()",".reflect()"),new J(H).promise()},V.prototype.settle=function(){return V.settle(this)}}},{"./util":36}],31:[function(X,se,be){"use strict";se.exports=function(V,ee,ge){var W=X("./util"),J=X("./errors").RangeError,H=X("./errors").AggregateError,Y=W.isArray,me={};function te(xe){this.constructor$(xe),this._howMany=0,this._unwrap=!1,this._initialized=!1}function ce(xe,Pe){if((0|Pe)!==Pe||Pe<0)return ge("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var Ke=new te(xe),Ve=Ke.promise();return Ke.setHowMany(Pe),Ke.init(),Ve}W.inherits(te,ee),te.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var xe=Y(this._values);!this._isResolved()&&xe&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},te.prototype.init=function(){this._initialized=!0,this._init()},te.prototype.setUnwrap=function(){this._unwrap=!0},te.prototype.howMany=function(){return this._howMany},te.prototype.setHowMany=function(xe){this._howMany=xe},te.prototype._promiseFulfilled=function(xe){return this._addFulfilled(xe),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},te.prototype._promiseRejected=function(xe){return this._addRejected(xe),this._checkOutcome()},te.prototype._promiseCancelled=function(){return this._values instanceof V||null==this._values?this._cancel():(this._addRejected(me),this._checkOutcome())},te.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var xe=new H,Pe=this.length();Pe<this._values.length;++Pe)this._values[Pe]!==me&&xe.push(this._values[Pe]);return xe.length>0?this._reject(xe):this._cancel(),!0}return!1},te.prototype._fulfilled=function(){return this._totalResolved},te.prototype._rejected=function(){return this._values.length-this.length()},te.prototype._addRejected=function(xe){this._values.push(xe)},te.prototype._addFulfilled=function(xe){this._values[this._totalResolved++]=xe},te.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},te.prototype._getRangeError=function(xe){return new J("Input array must contain at least "+this._howMany+" items but contains only "+xe+" items")},te.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},V.some=function(xe,Pe){return ce(xe,Pe)},V.prototype.some=function(xe){return ce(this,xe)},V._SomePromiseArray=te}},{"./errors":12,"./util":36}],32:[function(X,se,be){"use strict";se.exports=function(V){function ee(te){void 0!==te?(te=te._target(),this._bitField=te._bitField,this._settledValueField=te._isFateSealed()?te._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}ee.prototype._settledValue=function(){return this._settledValueField};var ge=ee.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},W=ee.prototype.error=ee.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},J=ee.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},H=ee.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},Y=ee.prototype.isPending=function(){return 0==(50397184&this._bitField)},me=ee.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};ee.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},V.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},V.prototype._isCancelled=function(){return this._target().__isCancelled()},V.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},V.prototype.isPending=function(){return Y.call(this._target())},V.prototype.isRejected=function(){return H.call(this._target())},V.prototype.isFulfilled=function(){return J.call(this._target())},V.prototype.isResolved=function(){return me.call(this._target())},V.prototype.value=function(){return ge.call(this._target())},V.prototype.reason=function(){var te=this._target();return te._unsetRejectionIsUnhandled(),W.call(te)},V.prototype._value=function(){return this._settledValue()},V.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},V.PromiseInspection=ee}},{}],33:[function(X,se,be){"use strict";se.exports=function(V,ee){var ge=X("./util"),W=ge.errorObj,J=ge.isObject,H={}.hasOwnProperty;return function(Y,me){if(J(Y)){if(Y instanceof V)return Y;var te=function(xe){try{return(Pe=xe).then}catch(Pe){return W.e=Pe,W}var Pe}(Y);if(te===W){me&&me._pushContext();var ce=V.reject(te.e);return me&&me._popContext(),ce}if("function"==typeof te)return function(xe){try{return H.call(xe,"_promise0")}catch(Pe){return!1}}(Y)?(ce=new V(ee),Y._then(ce._fulfill,ce._reject,void 0,ce,null),ce):function(xe,Pe,Ke){var Ve=new V(ee),it=Ve;Ke&&Ke._pushContext(),Ve._captureStackTrace(),Ke&&Ke._popContext();var bt=!0,$e=ge.tryCatch(Pe).call(xe,function(Ne){Ve&&(Ve._resolveCallback(Ne),Ve=null)},function(Ne){Ve&&(Ve._rejectCallback(Ne,bt,!0),Ve=null)});return bt=!1,Ve&&$e===W&&(Ve._rejectCallback($e.e,!0,!0),Ve=null),it}(Y,te,me)}return Y}}},{"./util":36}],34:[function(X,se,be){"use strict";se.exports=function(V,ee,ge){var W=X("./util"),J=V.TimeoutError;function H(xe){this.handle=xe}H.prototype._resultCancelled=function(){clearTimeout(this.handle)};var Y=function(xe){return me(+this).thenReturn(xe)},me=V.delay=function(xe,Pe){var Ke,Ve;return void 0!==Pe?(Ke=V.resolve(Pe)._then(Y,null,null,xe,void 0),ge.cancellation()&&Pe instanceof V&&Ke._setOnCancel(Pe)):(Ke=new V(ee),Ve=setTimeout(function(){Ke._fulfill()},+xe),ge.cancellation()&&Ke._setOnCancel(new H(Ve)),Ke._captureStackTrace()),Ke._setAsyncGuaranteed(),Ke};function te(xe){return clearTimeout(this.handle),xe}function ce(xe){throw clearTimeout(this.handle),xe}V.prototype.delay=function(xe){return me(xe,this)},V.prototype.timeout=function(xe,Pe){var Ke,Ve;xe=+xe;var it=new H(setTimeout(function(){var bt,$e,Ne,we;Ke.isPending()&&(bt=Ke,Ne=Ve,we="string"!=typeof($e=Pe)?$e instanceof Error?$e:new J("operation timed out"):new J($e),W.markAsOriginatingFromRejection(we),bt._attachExtraTrace(we),bt._reject(we),null!=Ne&&Ne.cancel())},xe));return ge.cancellation()?(Ve=this.then(),(Ke=Ve._then(te,ce,void 0,it,void 0))._setOnCancel(it)):Ke=this._then(te,ce,void 0,it,void 0),Ke}}},{"./util":36}],35:[function(X,se,be){"use strict";se.exports=function(V,ee,ge,W,J,H){var Y=X("./util"),me=X("./errors").TypeError,te=X("./util").inherits,ce=Y.errorObj,xe=Y.tryCatch,Pe={};function Ke(we){setTimeout(function(){throw we},0)}function Ve(we,qe){var Ye=0,at=we.length,At=new V(J);return function Ut(){if(Ye>=at)return At._fulfill();var sn,je,Mt=(sn=we[Ye++],(je=ge(sn))!==sn&&"function"==typeof sn._isDisposable&&"function"==typeof sn._getDisposer&&sn._isDisposable()&&je._setDisposable(sn._getDisposer()),je);if(Mt instanceof V&&Mt._isDisposable()){try{Mt=ge(Mt._getDisposer().tryDispose(qe),we.promise)}catch(sn){return Ke(sn)}if(Mt instanceof V)return Mt._then(Ut,Ke,null,null,null)}Ut()}(),At}function it(we,qe,Ye){this._data=we,this._promise=qe,this._context=Ye}function bt(we,qe,Ye){this.constructor$(we,qe,Ye)}function $e(we){return it.isDisposer(we)?(this.resources[this.index]._setDisposable(we),we.promise()):we}function Ne(we){this.length=we,this.promise=null,this[we-1]=null}it.prototype.data=function(){return this._data},it.prototype.promise=function(){return this._promise},it.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():Pe},it.prototype.tryDispose=function(we){var qe=this.resource(),Ye=this._context;void 0!==Ye&&Ye._pushContext();var at=qe!==Pe?this.doDispose(qe,we):null;return void 0!==Ye&&Ye._popContext(),this._promise._unsetDisposable(),this._data=null,at},it.isDisposer=function(we){return null!=we&&"function"==typeof we.resource&&"function"==typeof we.tryDispose},te(bt,it),bt.prototype.doDispose=function(we,qe){return this.data().call(we,we,qe)},Ne.prototype._resultCancelled=function(){for(var we=this.length,qe=0;qe<we;++qe){var Ye=this[qe];Ye instanceof V&&Ye.cancel()}},V.using=function(){var we=arguments.length;if(we<2)return ee("you must pass at least 2 arguments to Promise.using");var qe,Ye=arguments[we-1];if("function"!=typeof Ye)return ee("expecting a function but got "+Y.classString(Ye));var at=!0;2===we&&Array.isArray(arguments[0])?(we=(qe=arguments[0]).length,at=!1):(qe=arguments,we--);for(var At=new Ne(we),Ut=0;Ut<we;++Ut){var Mt=qe[Ut];if(it.isDisposer(Mt)){var sn=Mt;(Mt=Mt.promise())._setDisposable(sn)}else{var je=ge(Mt);je instanceof V&&(Mt=je._then($e,null,null,{resources:At,index:Ut},void 0))}At[Ut]=Mt}var We=new Array(At.length);for(Ut=0;Ut<We.length;++Ut)We[Ut]=V.resolve(At[Ut]).reflect();var tt=V.all(We).then(function(Ue){for(var xt=0;xt<Ue.length;++xt){var Vt=Ue[xt];if(Vt.isRejected())return ce.e=Vt.error(),ce;if(!Vt.isFulfilled())return void tt.cancel();Ue[xt]=Vt.value()}Pt._pushContext(),Ye=xe(Ye);var Qt=at?Ye.apply(void 0,Ue):Ye(Ue),rn=Pt._popContext();return H.checkForgottenReturns(Qt,rn,"Promise.using",Pt),Qt}),Pt=tt.lastly(function(){var Ue=new V.PromiseInspection(tt);return Ve(At,Ue)});return At.promise=Pt,Pt._setOnCancel(At),Pt},V.prototype._setDisposable=function(we){this._bitField=131072|this._bitField,this._disposer=we},V.prototype._isDisposable=function(){return(131072&this._bitField)>0},V.prototype._getDisposer=function(){return this._disposer},V.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},V.prototype.disposer=function(we){if("function"==typeof we)return new bt(we,this,W());throw new me}}},{"./errors":12,"./util":36}],36:[function(X,se,be){"use strict";var V,ee=X("./es5"),ge="undefined"==typeof navigator,W={e:{}},J="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==ue?ue:void 0!==this?this:null;function H(){try{var at=V;return V=null,at.apply(this,arguments)}catch(At){return W.e=At,W}}function Y(at){return null==at||!0===at||!1===at||"string"==typeof at||"number"==typeof at}function me(at,At,Ut){return Y(at)||ee.defineProperty(at,At,{value:Ut,configurable:!0,enumerable:!1,writable:!0}),at}var te=function(){var at=[Array.prototype,Object.prototype,Function.prototype],At=function(sn){for(var je=0;je<at.length;++je)if(at[je]===sn)return!0;return!1};if(ee.isES5){var Ut=Object.getOwnPropertyNames;return function(sn){for(var je=[],We=Object.create(null);null!=sn&&!At(sn);){var tt;try{tt=Ut(sn)}catch(Vt){return je}for(var Pt=0;Pt<tt.length;++Pt){var Ue=tt[Pt];if(!We[Ue]){We[Ue]=!0;var xt=Object.getOwnPropertyDescriptor(sn,Ue);null!=xt&&null==xt.get&&null==xt.set&&je.push(Ue)}}sn=ee.getPrototypeOf(sn)}return je}}var Mt={}.hasOwnProperty;return function(sn){if(At(sn))return[];var je=[];e:for(var We in sn)if(Mt.call(sn,We))je.push(We);else{for(var tt=0;tt<at.length;++tt)if(Mt.call(at[tt],We))continue e;je.push(We)}return je}}(),ce=/this\s*\.\s*\S+\s*=/,xe=/^[a-z$_][a-z$_0-9]*$/i;function Pe(at){try{return at+""}catch(At){return"[no string representation]"}}function Ke(at){return at instanceof Error||null!==at&&"object"==typeof at&&"string"==typeof at.message&&"string"==typeof at.name}function Ve(at){return Ke(at)&&ee.propertyIsWritable(at,"stack")}var it="stack"in new Error?function(at){return Ve(at)?at:new Error(Pe(at))}:function(at){if(Ve(at))return at;try{throw new Error(Pe(at))}catch(At){return At}};function bt(at){return{}.toString.call(at)}var $e=function(at){return ee.isArray(at)?at:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var Ne="function"==typeof Array.from?function(at){return Array.from(at)}:function(at){for(var At,Ut=[],Mt=at[Symbol.iterator]();!(At=Mt.next()).done;)Ut.push(At.value);return Ut};$e=function(at){return ee.isArray(at)?at:null!=at&&"function"==typeof at[Symbol.iterator]?Ne(at):null}}var at,we=void 0!==K&&"[object process]"===bt(K).toLowerCase(),qe=void 0!==K&&void 0!==K.env,Ye={isClass:function(at){try{if("function"==typeof at){var At=ee.names(at.prototype),Ut=ee.isES5&&At.length>1,Mt=At.length>0&&!(1===At.length&&"constructor"===At[0]),sn=ce.test(at+"")&&ee.names(at).length>0;if(Ut||Mt||sn)return!0}return!1}catch(je){return!1}},isIdentifier:function(at){return xe.test(at)},inheritedDataKeys:te,getDataPropertyOrDefault:function(at,At,Ut){if(!ee.isES5)return{}.hasOwnProperty.call(at,At)?at[At]:void 0;var Mt=Object.getOwnPropertyDescriptor(at,At);return null!=Mt?null==Mt.get&&null==Mt.set?Mt.value:Ut:void 0},thrower:function(at){throw at},isArray:ee.isArray,asArray:$e,notEnumerableProp:me,isPrimitive:Y,isObject:function(at){return"function"==typeof at||"object"==typeof at&&null!==at},isError:Ke,canEvaluate:ge,errorObj:W,tryCatch:function(at){return V=at,H},inherits:function(at,At){var Ut={}.hasOwnProperty;function Mt(){for(var sn in this.constructor=at,this.constructor$=At,At.prototype)Ut.call(At.prototype,sn)&&"$"!==sn.charAt(sn.length-1)&&(this[sn+"$"]=At.prototype[sn])}return Mt.prototype=At.prototype,at.prototype=new Mt,at.prototype},withAppended:function(at,At){var Ut,Mt=at.length,sn=new Array(Mt+1);for(Ut=0;Ut<Mt;++Ut)sn[Ut]=at[Ut];return sn[Ut]=At,sn},maybeWrapAsError:function(at){return Y(at)?new Error(Pe(at)):at},toFastProperties:function(at){function At(){}At.prototype=at;for(var Ut=8;Ut--;)new At;return at},filledRange:function(at,At,Ut){for(var Mt=new Array(at),sn=0;sn<at;++sn)Mt[sn]=At+sn+Ut;return Mt},toString:Pe,canAttachTrace:Ve,ensureErrorObject:it,originatesFromRejection:function(at){return null!=at&&(at instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===at.isOperational)},markAsOriginatingFromRejection:function(at){try{me(at,"isOperational",!0)}catch(At){}},classString:bt,copyDescriptors:function(at,At,Ut){for(var Mt=ee.names(at),sn=0;sn<Mt.length;++sn){var je=Mt[sn];if(Ut(je))try{ee.defineProperty(At,je,ee.getDescriptor(at,je))}catch(We){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:we,hasEnvVariables:qe,env:function(at){return qe?K.env[at]:void 0},global:J,getNativePromise:function(){if("function"==typeof Promise)try{var at=new Promise(function(){});if("[object Promise]"==={}.toString.call(at))return Promise}catch(At){}},domainBind:function(at,At){return at.bind(At)}};Ye.isRecentNode=Ye.isNode&&(0===(at=K.versions.node.split(".").map(Number))[0]&&at[1]>10||at[0]>0),Ye.isNode&&Ye.toFastProperties(K);try{throw new Error}catch(at){Ye.lastLineError=at}se.exports=Ye},{"./es5":13}]},{},[4])(4),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,G(4),G(0),G(11).setImmediate)},function(Ae,z,G){"use strict";Object.defineProperty(z,"__esModule",{value:!0}),z.default=function(K,ue){if(!ue.eol&&K)for(var re=0,X=K.length;re<X;re++)if("\r"===K[re]){if("\n"===K[re+1]){ue.eol="\r\n";break}if(K[re+1]){ue.eol="\r";break}}else if("\n"===K[re]){ue.eol="\n";break}return ue.eol||"\n"}},function(Ae,z,G){var K=G(65),ue=G(73);Ae.exports=function(re,X){var se=ue(re,X);return K(se)?se:void 0}},function(Ae,z,G){var K=G(19).Symbol;Ae.exports=K},function(Ae,z,G){var K=G(67),ue="object"==typeof self&&self&&self.Object===Object&&self,re=K||ue||Function("return this")();Ae.exports=re},function(Ae,z){Ae.exports=function(G){var K=typeof G;return null!=G&&("object"==K||"function"==K)}},function(Ae,z){Ae.exports=Array.isArray},function(Ae,z,G){var K=G(30),ue=G(76);Ae.exports=function(re){return"symbol"==typeof re||ue(re)&&"[object Symbol]"==K(re)}},function(Ae,z,G){"use strict";(function(K,ue){var re=G(6);Ae.exports=Pe;var X,se=G(37);Pe.ReadableState=xe,G(12);var be=function(We,tt){return We.listeners(tt).length},V=G(24),ee=G(7).Buffer,ge=K.Uint8Array||function(){},W=G(5);W.inherits=G(2);var J=G(41),H=void 0;H=J&&J.debuglog?J.debuglog("stream"):function(){};var Y,me=G(42),te=G(25);W.inherits(Pe,V);var ce=["error","close","destroy","pause","resume"];function xe(We,tt){var Pt=tt instanceof(X=X||G(1));this.objectMode=!!(We=We||{}).objectMode,Pt&&(this.objectMode=this.objectMode||!!We.readableObjectMode);var Ue=We.highWaterMark,xt=We.readableHighWaterMark;this.highWaterMark=Ue||0===Ue?Ue:Pt&&(xt||0===xt)?xt:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new me,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=We.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,We.encoding&&(Y||(Y=G(26).StringDecoder),this.decoder=new Y(We.encoding),this.encoding=We.encoding)}function Pe(We){if(X=X||G(1),!(this instanceof Pe))return new Pe(We);this._readableState=new xe(We,this),this.readable=!0,We&&("function"==typeof We.read&&(this._read=We.read),"function"==typeof We.destroy&&(this._destroy=We.destroy)),V.call(this)}function Ke(We,tt,Pt,Ue,xt){var Vt,rn,he,_e,Fe,Qt=We._readableState;return null===tt?(Qt.reading=!1,function(rn,he){if(!he.ended){if(he.decoder){var _e=he.decoder.end();_e&&_e.length&&(he.buffer.push(_e),he.length+=he.objectMode?1:_e.length)}he.ended=!0,$e(rn)}}(We,Qt)):(xt||(rn=Qt,ee.isBuffer(Fe=he=tt)||Fe instanceof ge||"string"==typeof he||void 0===he||rn.objectMode||(_e=new TypeError("Invalid non-string/buffer chunk")),Vt=_e),Vt?We.emit("error",Vt):Qt.objectMode||tt&&tt.length>0?("string"==typeof tt||Qt.objectMode||Object.getPrototypeOf(tt)===ee.prototype||(tt=function(rn){return ee.from(rn)}(tt)),Ue?Qt.endEmitted?We.emit("error",new Error("stream.unshift() after end event")):Ve(We,Qt,tt,!0):Qt.ended?We.emit("error",new Error("stream.push() after EOF")):(Qt.reading=!1,Qt.decoder&&!Pt?(tt=Qt.decoder.write(tt),Qt.objectMode||0!==tt.length?Ve(We,Qt,tt,!1):we(We,Qt)):Ve(We,Qt,tt,!1))):Ue||(Qt.reading=!1)),function(rn){return!rn.ended&&(rn.needReadable||rn.length<rn.highWaterMark||0===rn.length)}(Qt)}function Ve(We,tt,Pt,Ue){tt.flowing&&0===tt.length&&!tt.sync?(We.emit("data",Pt),We.read(0)):(tt.length+=tt.objectMode?1:Pt.length,Ue?tt.buffer.unshift(Pt):tt.buffer.push(Pt),tt.needReadable&&$e(We)),we(We,tt)}function bt(We,tt){return We<=0||0===tt.length&&tt.ended?0:tt.objectMode?1:We!=We?tt.flowing&&tt.length?tt.buffer.head.data.length:tt.length:(We>tt.highWaterMark&&(tt.highWaterMark=((Pt=We)>=8388608?Pt=8388608:(Pt--,Pt|=Pt>>>1,Pt|=Pt>>>2,Pt|=Pt>>>4,Pt|=Pt>>>8,Pt|=Pt>>>16,Pt++),Pt)),We<=tt.length?We:tt.ended?tt.length:(tt.needReadable=!0,0));var Pt}function $e(We){var tt=We._readableState;tt.needReadable=!1,tt.emittedReadable||(H("emitReadable",tt.flowing),tt.emittedReadable=!0,tt.sync?re.nextTick(Ne,We):Ne(We))}function Ne(We){H("emit readable"),We.emit("readable"),At(We)}function we(We,tt){tt.readingMore||(tt.readingMore=!0,re.nextTick(qe,We,tt))}function qe(We,tt){for(var Pt=tt.length;!tt.reading&&!tt.flowing&&!tt.ended&&tt.length<tt.highWaterMark&&(H("maybeReadMore read 0"),We.read(0),Pt!==tt.length);)Pt=tt.length;tt.readingMore=!1}function Ye(We){H("readable nexttick read 0"),We.read(0)}function at(We,tt){tt.reading||(H("resume read 0"),We.read(0)),tt.resumeScheduled=!1,tt.awaitDrain=0,We.emit("resume"),At(We),tt.flowing&&!tt.reading&&We.read(0)}function At(We){var tt=We._readableState;for(H("flow",tt.flowing);tt.flowing&&null!==We.read(););}function Ut(We,tt){return 0===tt.length?null:(tt.objectMode?Pt=tt.buffer.shift():!We||We>=tt.length?(Pt=tt.decoder?tt.buffer.join(""):1===tt.buffer.length?tt.buffer.head.data:tt.buffer.concat(tt.length),tt.buffer.clear()):(Vt=tt.decoder,(Ue=We)<(xt=tt.buffer).head.data.length?(Qt=xt.head.data.slice(0,Ue),xt.head.data=xt.head.data.slice(Ue)):Qt=Ue===xt.head.data.length?xt.shift():Vt?function(rn,he){var _e=he.head,Fe=1,yt=_e.data;for(rn-=yt.length;_e=_e.next;){var _t=_e.data,pt=rn>_t.length?_t.length:rn;if(yt+=pt===_t.length?_t:_t.slice(0,rn),0==(rn-=pt)){pt===_t.length?(++Fe,he.head=_e.next?_e.next:he.tail=null):(he.head=_e,_e.data=_t.slice(pt));break}++Fe}return he.length-=Fe,yt}(Ue,xt):function(rn,he){var _e=ee.allocUnsafe(rn),Fe=he.head,yt=1;for(Fe.data.copy(_e),rn-=Fe.data.length;Fe=Fe.next;){var _t=Fe.data,pt=rn>_t.length?_t.length:rn;if(_t.copy(_e,_e.length-rn,0,pt),0==(rn-=pt)){pt===_t.length?(++yt,he.head=Fe.next?Fe.next:he.tail=null):(he.head=Fe,Fe.data=_t.slice(pt));break}++yt}return he.length-=yt,_e}(Ue,xt),Pt=Qt),Pt);var Ue,xt,Vt,Qt,Pt}function Mt(We){var tt=We._readableState;if(tt.length>0)throw new Error('"endReadable()" called on non-empty stream');tt.endEmitted||(tt.ended=!0,re.nextTick(sn,tt,We))}function sn(We,tt){We.endEmitted||0!==We.length||(We.endEmitted=!0,tt.readable=!1,tt.emit("end"))}function je(We,tt){for(var Pt=0,Ue=We.length;Pt<Ue;Pt++)if(We[Pt]===tt)return Pt;return-1}Object.defineProperty(Pe.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(We){this._readableState&&(this._readableState.destroyed=We)}}),Pe.prototype.destroy=te.destroy,Pe.prototype._undestroy=te.undestroy,Pe.prototype._destroy=function(We,tt){this.push(null),tt(We)},Pe.prototype.push=function(We,tt){var Pt,Ue=this._readableState;return Ue.objectMode?Pt=!0:"string"==typeof We&&((tt=tt||Ue.defaultEncoding)!==Ue.encoding&&(We=ee.from(We,tt),tt=""),Pt=!0),Ke(this,We,tt,!1,Pt)},Pe.prototype.unshift=function(We){return Ke(this,We,null,!0,!1)},Pe.prototype.isPaused=function(){return!1===this._readableState.flowing},Pe.prototype.setEncoding=function(We){return Y||(Y=G(26).StringDecoder),this._readableState.decoder=new Y(We),this._readableState.encoding=We,this},Pe.prototype.read=function(We){H("read",We),We=parseInt(We,10);var tt=this._readableState,Pt=We;if(0!==We&&(tt.emittedReadable=!1),0===We&&tt.needReadable&&(tt.length>=tt.highWaterMark||tt.ended))return H("read: emitReadable",tt.length,tt.ended),0===tt.length&&tt.ended?Mt(this):$e(this),null;if(0===(We=bt(We,tt))&&tt.ended)return 0===tt.length&&Mt(this),null;var Ue,xt=tt.needReadable;return H("need readable",xt),(0===tt.length||tt.length-We<tt.highWaterMark)&&H("length less than watermark",xt=!0),tt.ended||tt.reading?H("reading or ended",xt=!1):xt&&(H("do read"),tt.reading=!0,tt.sync=!0,0===tt.length&&(tt.needReadable=!0),this._read(tt.highWaterMark),tt.sync=!1,tt.reading||(We=bt(Pt,tt))),null===(Ue=We>0?Ut(We,tt):null)?(tt.needReadable=!0,We=0):tt.length-=We,0===tt.length&&(tt.ended||(tt.needReadable=!0),Pt!==We&&tt.ended&&Mt(this)),null!==Ue&&this.emit("data",Ue),Ue},Pe.prototype._read=function(We){this.emit("error",new Error("_read() is not implemented"))},Pe.prototype.pipe=function(We,tt){var Pt=this,Ue=this._readableState;switch(Ue.pipesCount){case 0:Ue.pipes=We;break;case 1:Ue.pipes=[Ue.pipes,We];break;default:Ue.pipes.push(We)}Ue.pipesCount+=1,H("pipe count=%d opts=%j",Ue.pipesCount,tt);var xt=tt&&!1===tt.end||We===ue.stdout||We===ue.stderr?pt:Vt;function Vt(){H("onend"),We.end()}Ue.endEmitted?re.nextTick(xt):Pt.once("end",xt),We.on("unpipe",function Sn(Gn,_r){H("onunpipe"),Gn===Pt&&_r&&!1===_r.hasUnpiped&&(_r.hasUnpiped=!0,H("cleanup"),We.removeListener("close",yt),We.removeListener("finish",_t),We.removeListener("drain",Qt),We.removeListener("error",Fe),We.removeListener("unpipe",Sn),Pt.removeListener("end",Vt),Pt.removeListener("end",pt),Pt.removeListener("data",_e),rn=!0,!Ue.awaitDrain||We._writableState&&!We._writableState.needDrain||Qt())});var Sn,Qt=(Sn=Pt,function(){var Gn=Sn._readableState;H("pipeOnDrain",Gn.awaitDrain),Gn.awaitDrain&&Gn.awaitDrain--,0===Gn.awaitDrain&&be(Sn,"data")&&(Gn.flowing=!0,At(Sn))});We.on("drain",Qt);var rn=!1,he=!1;function _e(Sn){H("ondata"),he=!1,!1!==We.write(Sn)||he||((1===Ue.pipesCount&&Ue.pipes===We||Ue.pipesCount>1&&-1!==je(Ue.pipes,We))&&!rn&&(H("false write response, pause",Pt._readableState.awaitDrain),Pt._readableState.awaitDrain++,he=!0),Pt.pause())}function Fe(Sn){H("onerror",Sn),pt(),We.removeListener("error",Fe),0===be(We,"error")&&We.emit("error",Sn)}function yt(){We.removeListener("finish",_t),pt()}function _t(){H("onfinish"),We.removeListener("close",yt),pt()}function pt(){H("unpipe"),Pt.unpipe(We)}return Pt.on("data",_e),function(Sn,Gn,_r){if("function"==typeof Sn.prependListener)return Sn.prependListener(Gn,_r);Sn._events&&Sn._events[Gn]?se(Sn._events[Gn])?Sn._events[Gn].unshift(_r):Sn._events[Gn]=[_r,Sn._events[Gn]]:Sn.on(Gn,_r)}(We,"error",Fe),We.once("close",yt),We.once("finish",_t),We.emit("pipe",Pt),Ue.flowing||(H("pipe resume"),Pt.resume()),We},Pe.prototype.unpipe=function(We){var tt=this._readableState,Pt={hasUnpiped:!1};if(0===tt.pipesCount)return this;if(1===tt.pipesCount)return We&&We!==tt.pipes||(We||(We=tt.pipes),tt.pipes=null,tt.pipesCount=0,tt.flowing=!1,We&&We.emit("unpipe",this,Pt)),this;if(!We){var Ue=tt.pipes,xt=tt.pipesCount;tt.pipes=null,tt.pipesCount=0,tt.flowing=!1;for(var Vt=0;Vt<xt;Vt++)Ue[Vt].emit("unpipe",this,Pt);return this}var Qt=je(tt.pipes,We);return-1===Qt||(tt.pipes.splice(Qt,1),tt.pipesCount-=1,1===tt.pipesCount&&(tt.pipes=tt.pipes[0]),We.emit("unpipe",this,Pt)),this},Pe.prototype.addListener=Pe.prototype.on=function(We,tt){var Pt=V.prototype.on.call(this,We,tt);if("data"===We)!1!==this._readableState.flowing&&this.resume();else if("readable"===We){var Ue=this._readableState;Ue.endEmitted||Ue.readableListening||(Ue.readableListening=Ue.needReadable=!0,Ue.emittedReadable=!1,Ue.reading?Ue.length&&$e(this):re.nextTick(Ye,this))}return Pt},Pe.prototype.resume=function(){var Pt,We=this._readableState;return We.flowing||(H("resume"),We.flowing=!0,this,(Pt=We).resumeScheduled||(Pt.resumeScheduled=!0,re.nextTick(at,this,Pt))),this},Pe.prototype.pause=function(){return H("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(H("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Pe.prototype.wrap=function(We){var tt=this,Pt=this._readableState,Ue=!1;for(var xt in We.on("end",function(){if(H("wrapped end"),Pt.decoder&&!Pt.ended){var Qt=Pt.decoder.end();Qt&&Qt.length&&tt.push(Qt)}tt.push(null)}),We.on("data",function(Qt){H("wrapped data"),Pt.decoder&&(Qt=Pt.decoder.write(Qt)),(!Pt.objectMode||null!=Qt)&&(Pt.objectMode||Qt&&Qt.length)&&(tt.push(Qt)||(Ue=!0,We.pause()))}),We)void 0===this[xt]&&"function"==typeof We[xt]&&(this[xt]=function(Qt){return function(){return We[Qt].apply(We,arguments)}}(xt));for(var Vt=0;Vt<ce.length;Vt++)We.on(ce[Vt],this.emit.bind(this,ce[Vt]));return this._read=function(Qt){H("wrapped _read",Qt),Ue&&(Ue=!1,We.resume())},this},Object.defineProperty(Pe.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Pe._fromList=Ut}).call(this,G(0),G(4))},function(Ae,z,G){Ae.exports=G(12).EventEmitter},function(Ae,z,G){"use strict";var K=G(6);function ue(re,X){re.emit("error",X)}Ae.exports={destroy:function(re,X){var se=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(X?X(re):!re||this._writableState&&this._writableState.errorEmitted||K.nextTick(ue,this,re),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(re||null,function(ee){!X&&ee?(K.nextTick(ue,se,ee),se._writableState&&(se._writableState.errorEmitted=!0)):X&&X(ee)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(Ae,z,G){"use strict";var K=G(7).Buffer,ue=K.isEncoding||function(H){switch((H=""+H)&&H.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function re(H){var Y;switch(this.encoding=function(me){var te=function(ce){if(!ce)return"utf8";for(var xe;;)switch(ce){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return ce;default:if(xe)return;ce=(""+ce).toLowerCase(),xe=!0}}(me);if("string"!=typeof te&&(K.isEncoding===ue||!ue(me)))throw new Error("Unknown encoding: "+me);return te||me}(H),this.encoding){case"utf16le":this.text=be,this.end=V,Y=4;break;case"utf8":this.fillLast=se,Y=4;break;case"base64":this.text=ee,this.end=ge,Y=3;break;default:return this.write=W,void(this.end=J)}this.lastNeed=0,this.lastTotal=0,this.lastChar=K.allocUnsafe(Y)}function X(H){return H<=127?0:H>>5==6?2:H>>4==14?3:H>>3==30?4:H>>6==2?-1:-2}function se(H){var Y=this.lastTotal-this.lastNeed,me=function(te,ce,xe){if(128!=(192&ce[0]))return te.lastNeed=0,"\ufffd";if(te.lastNeed>1&&ce.length>1){if(128!=(192&ce[1]))return te.lastNeed=1,"\ufffd";if(te.lastNeed>2&&ce.length>2&&128!=(192&ce[2]))return te.lastNeed=2,"\ufffd"}}(this,H);return void 0!==me?me:this.lastNeed<=H.length?(H.copy(this.lastChar,Y,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(H.copy(this.lastChar,Y,0,H.length),void(this.lastNeed-=H.length))}function be(H,Y){if((H.length-Y)%2==0){var me=H.toString("utf16le",Y);if(me){var te=me.charCodeAt(me.length-1);if(te>=55296&&te<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=H[H.length-2],this.lastChar[1]=H[H.length-1],me.slice(0,-1)}return me}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=H[H.length-1],H.toString("utf16le",Y,H.length-1)}function V(H){var Y=H&&H.length?this.write(H):"";return this.lastNeed?Y+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):Y}function ee(H,Y){var me=(H.length-Y)%3;return 0===me?H.toString("base64",Y):(this.lastNeed=3-me,this.lastTotal=3,1===me?this.lastChar[0]=H[H.length-1]:(this.lastChar[0]=H[H.length-2],this.lastChar[1]=H[H.length-1]),H.toString("base64",Y,H.length-me))}function ge(H){var Y=H&&H.length?this.write(H):"";return this.lastNeed?Y+this.lastChar.toString("base64",0,3-this.lastNeed):Y}function W(H){return H.toString(this.encoding)}function J(H){return H&&H.length?this.write(H):""}z.StringDecoder=re,re.prototype.write=function(H){if(0===H.length)return"";var Y,me;if(this.lastNeed){if(void 0===(Y=this.fillLast(H)))return"";me=this.lastNeed,this.lastNeed=0}else me=0;return me<H.length?Y?Y+this.text(H,me):this.text(H,me):Y||""},re.prototype.end=function(H){var Y=H&&H.length?this.write(H):"";return this.lastNeed?Y+"\ufffd":Y},re.prototype.text=function(H,Y){var me=function(ce,xe,Pe){var Ke=xe.length-1;if(Ke<Pe)return 0;var Ve=X(xe[Ke]);return Ve>=0?(Ve>0&&(ce.lastNeed=Ve-1),Ve):--Ke<Pe||-2===Ve?0:(Ve=X(xe[Ke]))>=0?(Ve>0&&(ce.lastNeed=Ve-2),Ve):--Ke<Pe||-2===Ve?0:(Ve=X(xe[Ke]))>=0?(Ve>0&&(2===Ve?Ve=0:ce.lastNeed=Ve-3),Ve):0}(this,H,Y);if(!this.lastNeed)return H.toString("utf8",Y);this.lastTotal=me;var te=H.length-(me-this.lastNeed);return H.copy(this.lastChar,0,te),H.toString("utf8",Y,te)},re.prototype.fillLast=function(H){if(this.lastNeed<=H.length)return H.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);H.copy(this.lastChar,this.lastTotal-this.lastNeed,0,H.length),this.lastNeed-=H.length}},function(Ae,z,G){"use strict";Ae.exports=re;var K=G(1),ue=G(5);function re(be){if(!(this instanceof re))return new re(be);K.call(this,be),this._transformState={afterTransform:function(V,ee){var ge=this._transformState;ge.transforming=!1;var W=ge.writecb;if(!W)return this.emit("error",new Error("write callback called multiple times"));ge.writechunk=null,ge.writecb=null,null!=ee&&this.push(ee),W(V);var J=this._readableState;J.reading=!1,(J.needReadable||J.length<J.highWaterMark)&&this._read(J.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,be&&("function"==typeof be.transform&&(this._transform=be.transform),"function"==typeof be.flush&&(this._flush=be.flush)),this.on("prefinish",X)}function X(){var be=this;"function"==typeof this._flush?this._flush(function(V,ee){se(be,V,ee)}):se(this,null,null)}function se(be,V,ee){if(V)return be.emit("error",V);if(null!=ee&&be.push(ee),be._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(be._transformState.transforming)throw new Error("Calling transform done when still transforming");return be.push(null)}ue.inherits=G(2),ue.inherits(re,K),re.prototype.push=function(be,V){return this._transformState.needTransform=!1,K.prototype.push.call(this,be,V)},re.prototype._transform=function(be,V,ee){throw new Error("_transform() is not implemented")},re.prototype._write=function(be,V,ee){var ge=this._transformState;if(ge.writecb=ee,ge.writechunk=be,ge.writeencoding=V,!ge.transforming){var W=this._readableState;(ge.needTransform||W.needReadable||W.length<W.highWaterMark)&&this._read(W.highWaterMark)}},re.prototype._read=function(be){var V=this._transformState;null!==V.writechunk&&V.writecb&&!V.transforming?(V.transforming=!0,this._transform(V.writechunk,V.writeencoding,V.afterTransform)):V.needTransform=!0},re.prototype._destroy=function(be,V){var ee=this;K.prototype._destroy.call(this,be,function(ge){V(ge),ee.emit("close")})}},function(Ae,z,G){"use strict";(function(K){Object.defineProperty(z,"__esModule",{value:!0}),z.bufFromString=function(ue){var re=K.byteLength(ue),X=K.allocUnsafe?K.allocUnsafe(re):new K(re);return X.write(ue),X},z.emptyBuffer=function(){return K.allocUnsafe?K.allocUnsafe(0):new K(0)},z.filterArray=function(ue,re){for(var X=[],se=0;se<ue.length;se++)re.indexOf(se)>-1&&X.push(ue[se]);return X},z.trimLeft=String.prototype.trimLeft?function(ue){return ue.trimLeft()}:function(ue){return ue.replace(/^\s+/,"")},z.trimRight=String.prototype.trimRight?function(ue){return ue.trimRight()}:function(ue){return ue.replace(/\s+$/,"")}}).call(this,G(3).Buffer)},function(Ae,z,G){"use strict";var re,K=this&&this.__extends||(re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,se){X.__proto__=se}||function(X,se){for(var be in se)se.hasOwnProperty(be)&&(X[be]=se[be])},function(X,se){function be(){this.constructor=X}re(X,se),X.prototype=null===se?Object.create(se):(be.prototype=se.prototype,new be)});Object.defineProperty(z,"__esModule",{value:!0});var ue=function(re){function X(se,be,V){var ee=re.call(this,"Error: "+se+". JSON Line number: "+be+(V?" near: "+V:""))||this;return ee.err=se,ee.line=be,ee.extra=V,ee.name="CSV Parse Error",ee}return K(X,re),X.column_mismatched=function(se,be){return new X("column_mismatched",se,be)},X.unclosed_quote=function(se,be){return new X("unclosed_quote",se,be)},X.fromJSON=function(se){return new X(se.err,se.line,se.extra)},X.prototype.toJSON=function(){return{err:this.err,line:this.line,extra:this.extra}},X}(Error);z.default=ue},function(Ae,z,G){var K=G(18),ue=G(68),re=G(69),X=K?K.toStringTag:void 0;Ae.exports=function(se){return null==se?void 0===se?"[object Undefined]":"[object Null]":X&&X in Object(se)?ue(se):re(se)}},function(Ae,z){Ae.exports=function(G,K){return G===K||G!=G&&K!=K}},function(Ae,z,G){Ae.exports=G(33)},function(Ae,z,G){"use strict";var K=G(34),ue=function(re,X){return new K.Converter(re,X)};ue.csv=ue,ue.Converter=K.Converter,Ae.exports=ue},function(Ae,z,G){"use strict";(function(K){var J,ue=this&&this.__extends||(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,Y){H.__proto__=Y}||function(H,Y){for(var me in Y)Y.hasOwnProperty(me)&&(H[me]=Y[me])},function(H,Y){function me(){this.constructor=H}J(H,Y),H.prototype=null===Y?Object.create(Y):(me.prototype=Y.prototype,new me)}),re=this&&this.__importDefault||function(J){return J&&J.__esModule?J:{default:J}};Object.defineProperty(z,"__esModule",{value:!0});var X=G(36),se=G(50),be=G(51),V=re(G(15)),ee=G(52),ge=G(105),W=function(J){function H(Y,me){void 0===me&&(me={});var te=J.call(this,me)||this;return te.options=me,te.params=se.mergeParams(Y),te.runtime=be.initParseRuntime(te),te.result=new ge.Result(te),te.processor=new ee.ProcessorLocal(te),te.once("error",function(ce){K(function(){te.result.processError(ce),te.emit("done",ce)})}),te.once("done",function(){te.processor.destroy()}),te}return ue(H,J),H.prototype.preRawData=function(Y){return this.runtime.preRawDataHook=Y,this},H.prototype.preFileLine=function(Y){return this.runtime.preFileLineHook=Y,this},H.prototype.subscribe=function(Y,me,te){return this.parseRuntime.subscribe={onNext:Y,onError:me,onCompleted:te},this},H.prototype.fromFile=function(Y,me){var te=this,ce=G(!function(){var xe=new Error("Cannot find module 'fs'");throw xe.code="MODULE_NOT_FOUND",xe}());return ce.exists(Y,function(xe){xe?ce.createReadStream(Y,me).pipe(te):te.emit("error",new Error("File does not exist. Check to make sure the file path to your csv is correct."))}),this},H.prototype.fromStream=function(Y){return Y.pipe(this),this},H.prototype.fromString=function(Y){Y.toString();var me=new X.Readable,te=0;return me._read=function(ce){if(te>=Y.length)this.push(null);else{var xe=Y.substr(te,ce);this.push(xe),te+=ce}},this.fromStream(me)},H.prototype.then=function(Y,me){var te=this;return new V.default(function(ce,xe){te.parseRuntime.then={onfulfilled:function(Pe){ce(Y?Y(Pe):Pe)},onrejected:function(Pe){me?ce(me(Pe)):xe(Pe)}}})},Object.defineProperty(H.prototype,"parseParam",{get:function(){return this.params},enumerable:!0,configurable:!0}),Object.defineProperty(H.prototype,"parseRuntime",{get:function(){return this.runtime},enumerable:!0,configurable:!0}),H.prototype._transform=function(Y,me,te){var ce=this;this.processor.process(Y).then(function(xe){if(xe.length>0)return ce.runtime.started=!0,ce.result.processResult(xe)}).then(function(){ce.emit("drained"),te()},function(xe){ce.runtime.hasError=!0,ce.runtime.error=xe,ce.emit("error",xe),te()})},H.prototype._flush=function(Y){var me=this;this.processor.flush().then(function(te){if(te.length>0)return me.result.processResult(te)}).then(function(){me.processEnd(Y)},function(te){me.emit("error",te),Y()})},H.prototype.processEnd=function(Y){this.result.endProcess(),this.emit("done"),Y()},Object.defineProperty(H.prototype,"parsedLineNumber",{get:function(){return this.runtime.parsedLineNumber},enumerable:!0,configurable:!0}),H}(X.Transform);z.Converter=W}).call(this,G(11).setImmediate)},function(Ae,z,G){(function(K,ue){!function(re,X){"use strict";if(!re.setImmediate){var se,be=1,V={},ee=!1,ge=re.document,W=Object.getPrototypeOf&&Object.getPrototypeOf(re);W=W&&W.setTimeout?W:re,"[object process]"==={}.toString.call(re.process)?se=function(Y){ue.nextTick(function(){H(Y)})}:function(){if(re.postMessage&&!re.importScripts){var Y=!0,me=re.onmessage;return re.onmessage=function(){Y=!1},re.postMessage("","*"),re.onmessage=me,Y}}()?(Y="setImmediate$"+Math.random()+"$",me=function(te){te.source===re&&"string"==typeof te.data&&0===te.data.indexOf(Y)&&H(+te.data.slice(Y.length))},re.addEventListener?re.addEventListener("message",me,!1):re.attachEvent("onmessage",me),se=function(te){re.postMessage(Y+te,"*")}):re.MessageChannel?function(){var Y=new MessageChannel;Y.port1.onmessage=function(me){H(me.data)},se=function(me){Y.port2.postMessage(me)}}():ge&&"onreadystatechange"in ge.createElement("script")?function(){var Y=ge.documentElement;se=function(me){var te=ge.createElement("script");te.onreadystatechange=function(){H(me),te.onreadystatechange=null,Y.removeChild(te),te=null},Y.appendChild(te)}}():se=function(Y){setTimeout(H,0,Y)},W.setImmediate=function(Y){"function"!=typeof Y&&(Y=new Function(""+Y));for(var me=new Array(arguments.length-1),te=0;te<me.length;te++)me[te]=arguments[te+1];var ce={callback:Y,args:me};return V[be]=ce,se(be),be++},W.clearImmediate=J}var Y,me;function J(Y){delete V[Y]}function H(Y){if(ee)setTimeout(H,0,Y);else{var me=V[Y];if(me){ee=!0;try{!function(te){var ce=te.callback,xe=te.args;switch(xe.length){case 0:ce();break;case 1:ce(xe[0]);break;case 2:ce(xe[0],xe[1]);break;case 3:ce(xe[0],xe[1],xe[2]);break;default:ce.apply(void 0,xe)}}(me)}finally{J(Y),ee=!1}}}}}("undefined"==typeof self?void 0===K?this:K:self)}).call(this,G(0),G(4))},function(Ae,z,G){Ae.exports=ue;var K=G(12).EventEmitter;function ue(){K.call(this)}G(2)(ue,K),ue.Readable=G(13),ue.Writable=G(46),ue.Duplex=G(47),ue.Transform=G(48),ue.PassThrough=G(49),ue.Stream=ue,ue.prototype.pipe=function(re,X){var se=this;function be(Y){re.writable&&!1===re.write(Y)&&se.pause&&se.pause()}function V(){se.readable&&se.resume&&se.resume()}se.on("data",be),re.on("drain",V),re._isStdio||X&&!1===X.end||(se.on("end",ge),se.on("close",W));var ee=!1;function ge(){ee||(ee=!0,re.end())}function W(){ee||(ee=!0,"function"==typeof re.destroy&&re.destroy())}function J(Y){if(H(),0===K.listenerCount(this,"error"))throw Y}function H(){se.removeListener("data",be),re.removeListener("drain",V),se.removeListener("end",ge),se.removeListener("close",W),se.removeListener("error",J),re.removeListener("error",J),se.removeListener("end",H),se.removeListener("close",H),re.removeListener("close",H)}return se.on("error",J),re.on("error",J),se.on("end",H),se.on("close",H),re.on("close",H),re.emit("pipe",se),re}},function(Ae,z){var G={}.toString;Ae.exports=Array.isArray||function(K){return"[object Array]"==G.call(K)}},function(Ae,z,G){"use strict";z.byteLength=function(W){var J=V(W),Y=J[1];return 3*(J[0]+Y)/4-Y},z.toByteArray=function(W){for(var J,H=V(W),Y=H[0],me=H[1],te=new re(3*(Y+me)/4-me),ce=0,xe=me>0?Y-4:Y,Pe=0;Pe<xe;Pe+=4)J=ue[W.charCodeAt(Pe)]<<18|ue[W.charCodeAt(Pe+1)]<<12|ue[W.charCodeAt(Pe+2)]<<6|ue[W.charCodeAt(Pe+3)],te[ce++]=J>>16&255,te[ce++]=J>>8&255,te[ce++]=255&J;return 2===me&&(J=ue[W.charCodeAt(Pe)]<<2|ue[W.charCodeAt(Pe+1)]>>4,te[ce++]=255&J),1===me&&(J=ue[W.charCodeAt(Pe)]<<10|ue[W.charCodeAt(Pe+1)]<<4|ue[W.charCodeAt(Pe+2)]>>2,te[ce++]=J>>8&255,te[ce++]=255&J),te},z.fromByteArray=function(W){for(var J,H=W.length,Y=H%3,me=[],te=0,ce=H-Y;te<ce;te+=16383)me.push(ge(W,te,te+16383>ce?ce:te+16383));return 1===Y?me.push(K[(J=W[H-1])>>2]+K[J<<4&63]+"=="):2===Y&&me.push(K[(J=(W[H-2]<<8)+W[H-1])>>10]+K[J>>4&63]+K[J<<2&63]+"="),me.join("")};for(var K=[],ue=[],re="undefined"!=typeof Uint8Array?Uint8Array:Array,X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",se=0,be=X.length;se<be;++se)K[se]=X[se],ue[X.charCodeAt(se)]=se;function V(W){var J=W.length;if(J%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var H=W.indexOf("=");return-1===H&&(H=J),[H,H===J?0:4-H%4]}function ee(W){return K[W>>18&63]+K[W>>12&63]+K[W>>6&63]+K[63&W]}function ge(W,J,H){for(var me=[],te=J;te<H;te+=3)me.push(ee((W[te]<<16&16711680)+(W[te+1]<<8&65280)+(255&W[te+2])));return me.join("")}ue["-".charCodeAt(0)]=62,ue["_".charCodeAt(0)]=63},function(Ae,z){z.read=function(G,K,ue,re,X){var se,be,V=8*X-re-1,ee=(1<<V)-1,ge=ee>>1,W=-7,J=ue?X-1:0,H=ue?-1:1,Y=G[K+J];for(J+=H,se=Y&(1<<-W)-1,Y>>=-W,W+=V;W>0;se=256*se+G[K+J],J+=H,W-=8);for(be=se&(1<<-W)-1,se>>=-W,W+=re;W>0;be=256*be+G[K+J],J+=H,W-=8);if(0===se)se=1-ge;else{if(se===ee)return be?NaN:1/0*(Y?-1:1);be+=Math.pow(2,re),se-=ge}return(Y?-1:1)*be*Math.pow(2,se-re)},z.write=function(G,K,ue,re,X,se){var be,V,ee,ge=8*se-X-1,W=(1<<ge)-1,J=W>>1,H=23===X?Math.pow(2,-24)-Math.pow(2,-77):0,Y=re?0:se-1,me=re?1:-1,te=K<0||0===K&&1/K<0?1:0;for(K=Math.abs(K),isNaN(K)||K===1/0?(V=isNaN(K)?1:0,be=W):(be=Math.floor(Math.log(K)/Math.LN2),K*(ee=Math.pow(2,-be))<1&&(be--,ee*=2),(K+=be+J>=1?H/ee:H*Math.pow(2,1-J))*ee>=2&&(be++,ee/=2),be+J>=W?(V=0,be=W):be+J>=1?(V=(K*ee-1)*Math.pow(2,X),be+=J):(V=K*Math.pow(2,J-1)*Math.pow(2,X),be=0));X>=8;G[ue+Y]=255&V,Y+=me,V/=256,X-=8);for(be=be<<X|V,ge+=X;ge>0;G[ue+Y]=255&be,Y+=me,be/=256,ge-=8);G[ue+Y-me]|=128*te}},function(Ae,z){var G={}.toString;Ae.exports=Array.isArray||function(K){return"[object Array]"==G.call(K)}},function(Ae,z){},function(Ae,z,G){"use strict";var K=G(7).Buffer,ue=G(43);function re(X,se,be){X.copy(se,be)}Ae.exports=function(){function X(){(function(se,be){if(!(se instanceof be))throw new TypeError("Cannot call a class as a function")})(this,X),this.head=null,this.tail=null,this.length=0}return X.prototype.push=function(se){var be={data:se,next:null};this.length>0?this.tail.next=be:this.head=be,this.tail=be,++this.length},X.prototype.unshift=function(se){var be={data:se,next:this.head};0===this.length&&(this.tail=be),this.head=be,++this.length},X.prototype.shift=function(){if(0!==this.length){var se=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,se}},X.prototype.clear=function(){this.head=this.tail=null,this.length=0},X.prototype.join=function(se){if(0===this.length)return"";for(var be=this.head,V=""+be.data;be=be.next;)V+=se+be.data;return V},X.prototype.concat=function(se){if(0===this.length)return K.alloc(0);if(1===this.length)return this.head.data;for(var be=K.allocUnsafe(se>>>0),V=this.head,ee=0;V;)re(V.data,be,ee),ee+=V.data.length,V=V.next;return be},X}(),ue&&ue.inspect&&ue.inspect.custom&&(Ae.exports.prototype[ue.inspect.custom]=function(){var X=ue.inspect({length:this.length});return this.constructor.name+" "+X})},function(Ae,z){},function(Ae,z,G){(function(K){function ue(re){try{if(!K.localStorage)return!1}catch(se){return!1}var X=K.localStorage[re];return null!=X&&"true"===String(X).toLowerCase()}Ae.exports=function(re,X){if(ue("noDeprecation"))return re;var se=!1;return function(){if(!se){if(ue("throwDeprecation"))throw new Error(X);ue("traceDeprecation")?console.trace(X):console.warn(X),se=!0}return re.apply(this,arguments)}}}).call(this,G(0))},function(Ae,z,G){"use strict";Ae.exports=re;var K=G(27),ue=G(5);function re(X){if(!(this instanceof re))return new re(X);K.call(this,X)}ue.inherits=G(2),ue.inherits(re,K),re.prototype._transform=function(X,se,be){be(null,X)}},function(Ae,z,G){Ae.exports=G(14)},function(Ae,z,G){Ae.exports=G(1)},function(Ae,z,G){Ae.exports=G(13).Transform},function(Ae,z,G){Ae.exports=G(13).PassThrough},function(Ae,z,G){"use strict";Object.defineProperty(z,"__esModule",{value:!0}),z.mergeParams=function(K){var ue={delimiter:",",ignoreColumns:void 0,includeColumns:void 0,quote:'"',trim:!0,checkType:!1,ignoreEmpty:!1,noheader:!1,headers:void 0,flatKeys:!1,maxRowLength:0,checkColumn:!1,escape:'"',colParser:{},eol:void 0,alwaysSplitAtEOL:!1,output:"json",nullObject:!1,downstreamFormat:"line",needEmitAll:!0};for(var re in K||(K={}),K)K.hasOwnProperty(re)&&(ue[re]=Array.isArray(K[re])?[].concat(K[re]):K[re]);return ue}},function(Ae,z,G){"use strict";Object.defineProperty(z,"__esModule",{value:!0}),z.initParseRuntime=function(K){var ue=K.parseParam,re={needProcessIgnoreColumn:!1,needProcessIncludeColumn:!1,selectedColumns:void 0,ended:!1,hasError:!1,error:void 0,delimiter:K.parseParam.delimiter,eol:K.parseParam.eol,columnConv:[],headerType:[],headerTitle:[],headerFlag:[],headers:void 0,started:!1,parsedLineNumber:0,columnValueSetter:[]};return ue.ignoreColumns&&(re.needProcessIgnoreColumn=!0),ue.includeColumns&&(re.needProcessIncludeColumn=!0),re}},function(Ae,z,G){"use strict";(function(K){var me,ue=this&&this.__extends||(me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,ce){te.__proto__=ce}||function(te,ce){for(var xe in ce)ce.hasOwnProperty(xe)&&(te[xe]=ce[xe])},function(te,ce){function xe(){this.constructor=te}me(te,ce),te.prototype=null===ce?Object.create(ce):(xe.prototype=ce.prototype,new xe)}),re=this&&this.__importDefault||function(me){return me&&me.__esModule?me:{default:me}};Object.defineProperty(z,"__esModule",{value:!0});var X=G(53),se=re(G(15)),be=G(54),V=re(G(16)),ee=G(57),ge=G(28),W=G(58),J=re(G(59)),H=re(G(29)),Y=function(me){function te(){var ce=null!==me&&me.apply(this,arguments)||this;return ce.rowSplit=new W.RowSplit(ce.converter),ce.eolEmitted=!1,ce._needEmitEol=void 0,ce.headEmitted=!1,ce._needEmitHead=void 0,ce}return ue(te,me),te.prototype.flush=function(){var ce=this;if(this.runtime.csvLineBuffer&&this.runtime.csvLineBuffer.length>0){var xe=this.runtime.csvLineBuffer;return this.runtime.csvLineBuffer=void 0,this.process(xe,!0).then(function(Pe){return ce.runtime.csvLineBuffer&&ce.runtime.csvLineBuffer.length>0?se.default.reject(H.default.unclosed_quote(ce.runtime.parsedLineNumber,ce.runtime.csvLineBuffer.toString())):se.default.resolve(Pe)})}return se.default.resolve([])},te.prototype.destroy=function(){return se.default.resolve()},Object.defineProperty(te.prototype,"needEmitEol",{get:function(){return void 0===this._needEmitEol&&(this._needEmitEol=this.converter.listeners("eol").length>0),this._needEmitEol},enumerable:!0,configurable:!0}),Object.defineProperty(te.prototype,"needEmitHead",{get:function(){return void 0===this._needEmitHead&&(this._needEmitHead=this.converter.listeners("header").length>0),this._needEmitHead},enumerable:!0,configurable:!0}),te.prototype.process=function(ce,xe){var Pe,Ke=this;return void 0===xe&&(xe=!1),Pe=xe?ce.toString():be.prepareData(ce,this.converter.parseRuntime),se.default.resolve().then(function(){return Ke.runtime.preRawDataHook?Ke.runtime.preRawDataHook(Pe):Pe}).then(function(Ve){return Ve&&Ve.length>0?Ke.processCSV(Ve,xe):se.default.resolve([])})},te.prototype.processCSV=function(ce,xe){var Pe=this,Ke=this.params,Ve=this.runtime;Ve.eol||V.default(ce,Ve),this.needEmitEol&&!this.eolEmitted&&Ve.eol&&(this.converter.emit("eol",Ve.eol),this.eolEmitted=!0),Ke.ignoreEmpty&&!Ve.started&&(ce=ge.trimLeft(ce));var it=ee.stringToLines(ce,Ve);return xe?(it.lines.push(it.partial),it.partial=""):this.prependLeftBuf(ge.bufFromString(it.partial)),it.lines.length>0?(Ve.preFileLineHook?this.runPreLineHook(it.lines):se.default.resolve(it.lines)).then(function(bt){return Ve.started||Pe.runtime.headers?Pe.processCSVBody(bt):Pe.processDataWithHead(bt)}):se.default.resolve([])},te.prototype.processDataWithHead=function(ce){if(this.params.noheader)this.runtime.headers=this.params.headers?this.params.headers:[];else{for(var xe="",Pe=[];ce.length;){var Ke=xe+ce.shift(),Ve=this.rowSplit.parse(Ke);if(Ve.closed){Pe=Ve.cells,xe="";break}xe=Ke+V.default(Ke,this.runtime)}if(this.prependLeftBuf(ge.bufFromString(xe)),0===Pe.length)return[];this.runtime.headers=this.params.headers?this.params.headers:Pe}return(this.runtime.needProcessIgnoreColumn||this.runtime.needProcessIncludeColumn)&&this.filterHeader(),this.needEmitHead&&!this.headEmitted&&(this.converter.emit("header",this.runtime.headers),this.headEmitted=!0),this.processCSVBody(ce)},te.prototype.filterHeader=function(){if(this.runtime.selectedColumns=[],this.runtime.headers){for(var ce=this.runtime.headers,xe=0;xe<ce.length;xe++)if(this.params.ignoreColumns)if(this.params.ignoreColumns.test(ce[xe])){if(!this.params.includeColumns||!this.params.includeColumns.test(ce[xe]))continue;this.runtime.selectedColumns.push(xe)}else this.runtime.selectedColumns.push(xe);else this.params.includeColumns?this.params.includeColumns.test(ce[xe])&&this.runtime.selectedColumns.push(xe):this.runtime.selectedColumns.push(xe);this.runtime.headers=ge.filterArray(this.runtime.headers,this.runtime.selectedColumns)}},te.prototype.processCSVBody=function(ce){if("line"===this.params.output)return ce;var xe=this.rowSplit.parseMultiLines(ce);return this.prependLeftBuf(ge.bufFromString(xe.partial)),"csv"===this.params.output?xe.rowsCells:J.default(xe.rowsCells,this.converter)},te.prototype.prependLeftBuf=function(ce){ce&&(this.runtime.csvLineBuffer=this.runtime.csvLineBuffer?K.concat([ce,this.runtime.csvLineBuffer]):ce)},te.prototype.runPreLineHook=function(ce){var xe=this;return new se.default(function(Pe,Ke){!function Ve(it,bt,$e,Ne){if($e>=it.length)Ne();else if(bt.preFileLineHook){var qe=bt.preFileLineHook(it[$e],bt.parsedLineNumber+$e);if($e++,qe&&qe.then)qe.then(function(Ye){it[$e-1]=Ye,Ve(it,bt,$e,Ne)});else{for(it[$e-1]=qe;$e<it.length;)it[$e]=bt.preFileLineHook(it[$e],bt.parsedLineNumber+$e),$e++;Ne()}}else Ne()}(ce,xe.runtime,0,function(Ve){Ve?Ke(Ve):Pe(ce)})})},te}(X.Processor);z.ProcessorLocal=Y}).call(this,G(3).Buffer)},function(Ae,z,G){"use strict";Object.defineProperty(z,"__esModule",{value:!0}),z.Processor=function(ue){this.converter=ue,this.params=ue.parseParam,this.runtime=ue.parseRuntime}},function(Ae,z,G){"use strict";(function(K){var ue=this&&this.__importDefault||function(X){return X&&X.__esModule?X:{default:X}};Object.defineProperty(z,"__esModule",{value:!0});var re=ue(G(55));z.prepareData=function(X,se){var ee,ge,be=(ee=X,(ge=se).csvLineBuffer&&ge.csvLineBuffer.length>0?K.concat([ge.csvLineBuffer,ee]):ee);se.csvLineBuffer=void 0;var V=function(ee,ge){var W=ee.length-1;if(0!=(128&ee[W])){for(;128==(192&ee[W]);)W--;W--}return W!=ee.length-1?(ge.csvLineBuffer=ee.slice(W+1),ee.slice(0,W+1)):ee}(be,se).toString("utf8");return!1===se.started?re.default(V):V}}).call(this,G(3).Buffer)},function(Ae,z,G){"use strict";(function(K){var ue=G(56);Ae.exports=function(re){return"string"==typeof re&&65279===re.charCodeAt(0)?re.slice(1):K.isBuffer(re)&&ue(re)&&239===re[0]&&187===re[1]&&191===re[2]?re.slice(3):re}}).call(this,G(3).Buffer)},function(Ae,z){Ae.exports=function(G){for(var K=0;K<G.length;)if(9==G[K]||10==G[K]||13==G[K]||32<=G[K]&&G[K]<=126)K+=1;else if(194<=G[K]&&G[K]<=223&&128<=G[K+1]&&G[K+1]<=191)K+=2;else if(224==G[K]&&160<=G[K+1]&&G[K+1]<=191&&128<=G[K+2]&&G[K+2]<=191||(225<=G[K]&&G[K]<=236||238==G[K]||239==G[K])&&128<=G[K+1]&&G[K+1]<=191&&128<=G[K+2]&&G[K+2]<=191||237==G[K]&&128<=G[K+1]&&G[K+1]<=159&&128<=G[K+2]&&G[K+2]<=191)K+=3;else{if(!(240==G[K]&&144<=G[K+1]&&G[K+1]<=191&&128<=G[K+2]&&G[K+2]<=191&&128<=G[K+3]&&G[K+3]<=191||241<=G[K]&&G[K]<=243&&128<=G[K+1]&&G[K+1]<=191&&128<=G[K+2]&&G[K+2]<=191&&128<=G[K+3]&&G[K+3]<=191||244==G[K]&&128<=G[K+1]&&G[K+1]<=143&&128<=G[K+2]&&G[K+2]<=191&&128<=G[K+3]&&G[K+3]<=191))return!1;K+=4}return!0}},function(Ae,z,G){"use strict";var K=this&&this.__importDefault||function(re){return re&&re.__esModule?re:{default:re}};Object.defineProperty(z,"__esModule",{value:!0});var ue=K(G(16));z.stringToLines=function(re,X){var se=ue.default(re,X),be=re.split(se);return{lines:be,partial:be.pop()||""}}},function(Ae,z,G){"use strict";var K=this&&this.__importDefault||function(be){return be&&be.__esModule?be:{default:be}};Object.defineProperty(z,"__esModule",{value:!0});var ue=K(G(16)),re=G(28),X=[",","|","\t",";",":"],se=function(){function be(V){this.conv=V,this.cachedRegExp={},this.delimiterEmitted=!1,this._needEmitDelimiter=void 0,this.quote=V.parseParam.quote,this.trim=V.parseParam.trim,this.escape=V.parseParam.escape}return Object.defineProperty(be.prototype,"needEmitDelimiter",{get:function(){return void 0===this._needEmitDelimiter&&(this._needEmitDelimiter=this.conv.listeners("delimiter").length>0),this._needEmitDelimiter},enumerable:!0,configurable:!0}),be.prototype.parse=function(V){if(0===V.length||this.conv.parseParam.ignoreEmpty&&0===V.trim().length)return{cells:[],closed:!0};var ee=this.quote,ge=this.trim;(this.conv.parseRuntime.delimiter instanceof Array||"auto"===this.conv.parseRuntime.delimiter.toLowerCase())&&(this.conv.parseRuntime.delimiter=this.getDelimiter(V)),this.needEmitDelimiter&&!this.delimiterEmitted&&(this.conv.emit("delimiter",this.conv.parseRuntime.delimiter),this.delimiterEmitted=!0);var W=this.conv.parseRuntime.delimiter,J=V.split(W);if("off"===ee){if(ge)for(var H=0;H<J.length;H++)J[H]=J[H].trim();return{cells:J,closed:!0}}return this.toCSVRow(J,ge,ee,W)},be.prototype.toCSVRow=function(V,ee,ge,W){for(var J=[],H=!1,Y="",me=0,te=V.length;me<te;me++){var ce=V[me];!H&&ee&&(ce=re.trimLeft(ce));var xe=ce.length;if(H)this.isQuoteClose(ce)?(H=!1,Y+=W+(ce=ce.substr(0,xe-1)),Y=this.escapeQuote(Y),ee&&(Y=re.trimRight(Y)),J.push(Y),Y=""):Y+=W+ce;else{if(2===xe&&ce===this.quote+this.quote){J.push("");continue}if(this.isQuoteOpen(ce)){if(ce=ce.substr(1),this.isQuoteClose(ce)){ce=ce.substring(0,ce.lastIndexOf(ge)),ce=this.escapeQuote(ce),J.push(ce);continue}if(-1!==ce.indexOf(ge)){for(var Pe=0,Ke="",Ve=0,it=ce;Ve<it.length;Ve++){var bt=it[Ve];bt===ge&&Ke!==this.escape?(Pe++,Ke=""):Ke=bt}if(Pe%2==1){ee&&(ce=re.trimRight(ce)),J.push(ge+ce);continue}H=!0,Y+=ce;continue}H=!0,Y+=ce;continue}ee&&(ce=re.trimRight(ce)),J.push(ce)}}return{cells:J,closed:!H}},be.prototype.getDelimiter=function(V){var ee;if("auto"===this.conv.parseParam.delimiter)ee=X;else{if(!(this.conv.parseParam.delimiter instanceof Array))return this.conv.parseParam.delimiter;ee=this.conv.parseParam.delimiter}var ge=0,W=",";return ee.forEach(function(J){var H=V.split(J).length;H>ge&&(W=J,ge=H)}),W},be.prototype.isQuoteOpen=function(V){var ee=this.quote;return V[0]===ee&&(V[1]!==ee||V[1]===this.escape&&(V[2]===ee||2===V.length))},be.prototype.isQuoteClose=function(V){var ee=this.quote,ge=this.escape;this.conv.parseParam.trim&&(V=re.trimRight(V));for(var W=0,J=V.length-1;V[J]===ee||V[J]===ge;)J--,W++;return W%2!=0},be.prototype.escapeQuote=function(V){var ee="es|"+this.quote+"|"+this.escape;return void 0===this.cachedRegExp[ee]&&(this.cachedRegExp[ee]=new RegExp("\\"+this.escape+"\\"+this.quote,"g")),V.replace(this.cachedRegExp[ee],this.quote)},be.prototype.parseMultiLines=function(V){for(var ee=[],ge="";V.length;){var W=ge+V.shift(),J=this.parse(W);0===J.cells.length&&this.conv.parseParam.ignoreEmpty||(J.closed||this.conv.parseParam.alwaysSplitAtEOL?(ee.push(this.conv.parseRuntime.selectedColumns?re.filterArray(J.cells,this.conv.parseRuntime.selectedColumns):J.cells),ge=""):ge=W+(ue.default(W,this.conv.parseRuntime)||"\n"))}return{rowsCells:ee,partial:ge}},be}();z.RowSplit=se},function(Ae,z,G){"use strict";var K=this&&this.__importDefault||function(te){return te&&te.__esModule?te:{default:te}};Object.defineProperty(z,"__esModule",{value:!0});var ue=K(G(29)),re=K(G(60)),X=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/;function se(te,ce,xe){if(ce.parseParam.checkColumn&&ce.parseRuntime.headers&&te.length!==ce.parseRuntime.headers.length)throw ue.default.column_mismatched(ce.parseRuntime.parsedLineNumber+xe);return function(Pe,Ke,Ve){for(var it=!1,bt={},$e=0,Ne=Pe.length;$e<Ne;$e++){var we=Pe[$e];if(!Ve.parseParam.ignoreEmpty||""!==we){it=!0;var qe=Ke[$e];qe&&""!==qe||(qe=Ke[$e]="field"+($e+1));var Ye=V(qe,$e,Ve);if(Ye){var at=Ye(we,qe,bt,Pe,$e);void 0!==at&&ee(bt,qe,at,Ve,$e)}else Ve.parseParam.checkType&&(we=J(0,qe,$e,Ve)(we)),void 0!==we&&ee(bt,qe,we,Ve,$e)}}return it?bt:null}(te,ce.parseRuntime.headers||[],ce)||null}z.default=function(te,ce){for(var xe=[],Pe=0,Ke=te.length;Pe<Ke;Pe++){var Ve=se(te[Pe],ce,Pe);Ve&&xe.push(Ve)}return xe};var be={string:Y,number:H,omit:function(){}};function V(te,ce,xe){if(void 0!==xe.parseRuntime.columnConv[ce])return xe.parseRuntime.columnConv[ce];var Pe=xe.parseParam.colParser[te];return void 0===Pe?xe.parseRuntime.columnConv[ce]=null:("object"==typeof Pe&&(Pe=Pe.cellParser||"string"),"string"==typeof Pe?(Pe=Pe.trim().toLowerCase(),xe.parseRuntime.columnConv[ce]=be[Pe]||null):xe.parseRuntime.columnConv[ce]="function"==typeof Pe?Pe:null)}function ee(te,ce,xe,Pe,Ke){if(!Pe.parseRuntime.columnValueSetter[Ke])if(Pe.parseParam.flatKeys)Pe.parseRuntime.columnValueSetter[Ke]=ge;else if(ce.indexOf(".")>-1){for(var Ve=ce.split("."),it=!0;Ve.length>0;)if(0===Ve.shift().length){it=!1;break}Pe.parseRuntime.columnValueSetter[Ke]=!it||Pe.parseParam.colParser[ce]&&Pe.parseParam.colParser[ce].flat?ge:W}else Pe.parseRuntime.columnValueSetter[Ke]=ge;!0===Pe.parseParam.nullObject&&"null"===xe&&(xe=null),Pe.parseRuntime.columnValueSetter[Ke](te,ce,xe)}function ge(te,ce,xe){te[ce]=xe}function W(te,ce,xe){re.default(te,ce,xe)}function J(te,ce,xe,Pe){return Pe.parseRuntime.headerType[xe]?Pe.parseRuntime.headerType[xe]:Pe.parseRuntime.headerType[xe]=ce.indexOf("number#!")>-1?H:ce.indexOf("string#!")>-1?Y:Pe.parseParam.checkType?me:Y}function H(te){var ce=parseFloat(te);return isNaN(ce)?te:ce}function Y(te){return te.toString()}function me(te){var Pe,ce=te.trim();return""===ce?Y(te):X.test(ce)?H(te):5===ce.length&&"false"===ce.toLowerCase()||4===ce.length&&"true"===ce.toLowerCase()?5!==(Pe=te.trim()).length||"false"!==Pe.toLowerCase():"{"===ce[0]&&"}"===ce[ce.length-1]||"["===ce[0]&&"]"===ce[ce.length-1]?function(xe){try{return JSON.parse(xe)}catch(Pe){return xe}}(te):Y(te)}},function(Ae,z,G){var K=G(61);Ae.exports=function(ue,re,X){return null==ue?ue:K(ue,re,X)}},function(Ae,z,G){var K=G(62),ue=G(74),re=G(103),X=G(20),se=G(104);Ae.exports=function(be,V,ee,ge){if(!X(be))return be;for(var W=-1,J=(V=ue(V,be)).length,H=J-1,Y=be;null!=Y&&++W<J;){var me=se(V[W]),te=ee;if(W!=H){var ce=Y[me];void 0===(te=ge?ge(ce,me,Y):void 0)&&(te=X(ce)?ce:re(V[W+1])?[]:{})}K(Y,me,te),Y=Y[me]}return be}},function(Ae,z,G){var K=G(63),ue=G(31),re=Object.prototype.hasOwnProperty;Ae.exports=function(X,se,be){var V=X[se];re.call(X,se)&&ue(V,be)&&(void 0!==be||se in X)||K(X,se,be)}},function(Ae,z,G){var K=G(64);Ae.exports=function(ue,re,X){"__proto__"==re&&K?K(ue,re,{configurable:!0,enumerable:!0,value:X,writable:!0}):ue[re]=X}},function(Ae,z,G){var K=G(17),ue=function(){try{var re=K(Object,"defineProperty");return re({},"",{}),re}catch(X){}}();Ae.exports=ue},function(Ae,z,G){var K=G(66),ue=G(70),re=G(20),X=G(72),se=/^\[object .+?Constructor\]$/,W=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");Ae.exports=function(J){return!(!re(J)||ue(J))&&(K(J)?W:se).test(X(J))}},function(Ae,z,G){var K=G(30),ue=G(20);Ae.exports=function(re){if(!ue(re))return!1;var X=K(re);return"[object Function]"==X||"[object GeneratorFunction]"==X||"[object AsyncFunction]"==X||"[object Proxy]"==X}},function(Ae,z,G){(function(K){Ae.exports="object"==typeof K&&K&&K.Object===Object&&K}).call(this,G(0))},function(Ae,z,G){var K=G(18),ue=Object.prototype,re=ue.hasOwnProperty,X=ue.toString,se=K?K.toStringTag:void 0;Ae.exports=function(be){var V=re.call(be,se),ee=be[se];try{be[se]=void 0;var ge=!0}catch(J){}var W=X.call(be);return ge&&(V?be[se]=ee:delete be[se]),W}},function(Ae,z){var G=Object.prototype.toString;Ae.exports=function(K){return G.call(K)}},function(Ae,z,G){var re,K=G(71),ue=(re=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+re:"";Ae.exports=function(re){return!!ue&&ue in re}},function(Ae,z,G){var K=G(19)["__core-js_shared__"];Ae.exports=K},function(Ae,z){var G=Function.prototype.toString;Ae.exports=function(K){if(null!=K){try{return G.call(K)}catch(ue){}try{return K+""}catch(ue){}}return""}},function(Ae,z){Ae.exports=function(G,K){return null==G?void 0:G[K]}},function(Ae,z,G){var K=G(21),ue=G(75),re=G(77),X=G(100);Ae.exports=function(se,be){return K(se)?se:ue(se,be)?[se]:re(X(se))}},function(Ae,z,G){var K=G(21),ue=G(22),re=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/;Ae.exports=function(se,be){if(K(se))return!1;var V=typeof se;return!("number"!=V&&"symbol"!=V&&"boolean"!=V&&null!=se&&!ue(se))||X.test(se)||!re.test(se)||null!=be&&se in Object(be)}},function(Ae,z){Ae.exports=function(G){return null!=G&&"object"==typeof G}},function(Ae,z,G){var K=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ue=/\\(\\)?/g,re=G(78)(function(X){var se=[];return 46===X.charCodeAt(0)&&se.push(""),X.replace(K,function(be,V,ee,ge){se.push(ee?ge.replace(ue,"$1"):V||be)}),se});Ae.exports=re},function(Ae,z,G){var K=G(79);Ae.exports=function(ue){var re=K(ue,function(se){return 500===X.size&&X.clear(),se}),X=re.cache;return re}},function(Ae,z,G){var K=G(80);function re(X,se){if("function"!=typeof X||null!=se&&"function"!=typeof se)throw new TypeError("Expected a function");var be=function(){var V=arguments,ee=se?se.apply(this,V):V[0],ge=be.cache;if(ge.has(ee))return ge.get(ee);var W=X.apply(this,V);return be.cache=ge.set(ee,W)||ge,W};return be.cache=new(re.Cache||K),be}re.Cache=K,Ae.exports=re},function(Ae,z,G){var K=G(81),ue=G(95),re=G(97),X=G(98),se=G(99);function be(V){var ee=-1,ge=null==V?0:V.length;for(this.clear();++ee<ge;){var W=V[ee];this.set(W[0],W[1])}}be.prototype.clear=K,be.prototype.delete=ue,be.prototype.get=re,be.prototype.has=X,be.prototype.set=se,Ae.exports=be},function(Ae,z,G){var K=G(82),ue=G(88),re=G(94);Ae.exports=function(){this.size=0,this.__data__={hash:new K,map:new(re||ue),string:new K}}},function(Ae,z,G){var K=G(83),ue=G(84),re=G(85),X=G(86),se=G(87);function be(V){var ee=-1,ge=null==V?0:V.length;for(this.clear();++ee<ge;){var W=V[ee];this.set(W[0],W[1])}}be.prototype.clear=K,be.prototype.delete=ue,be.prototype.get=re,be.prototype.has=X,be.prototype.set=se,Ae.exports=be},function(Ae,z,G){var K=G(8);Ae.exports=function(){this.__data__=K?K(null):{},this.size=0}},function(Ae,z){Ae.exports=function(G){var K=this.has(G)&&delete this.__data__[G];return this.size-=K?1:0,K}},function(Ae,z,G){var K=G(8),ue=Object.prototype.hasOwnProperty;Ae.exports=function(re){var X=this.__data__;if(K){var se=X[re];return"__lodash_hash_undefined__"===se?void 0:se}return ue.call(X,re)?X[re]:void 0}},function(Ae,z,G){var K=G(8),ue=Object.prototype.hasOwnProperty;Ae.exports=function(re){var X=this.__data__;return K?void 0!==X[re]:ue.call(X,re)}},function(Ae,z,G){var K=G(8);Ae.exports=function(ue,re){var X=this.__data__;return this.size+=this.has(ue)?0:1,X[ue]=K&&void 0===re?"__lodash_hash_undefined__":re,this}},function(Ae,z,G){var K=G(89),ue=G(90),re=G(91),X=G(92),se=G(93);function be(V){var ee=-1,ge=null==V?0:V.length;for(this.clear();++ee<ge;){var W=V[ee];this.set(W[0],W[1])}}be.prototype.clear=K,be.prototype.delete=ue,be.prototype.get=re,be.prototype.has=X,be.prototype.set=se,Ae.exports=be},function(Ae,z){Ae.exports=function(){this.__data__=[],this.size=0}},function(Ae,z,G){var K=G(9),ue=Array.prototype.splice;Ae.exports=function(re){var X=this.__data__,se=K(X,re);return!(se<0||(se==X.length-1?X.pop():ue.call(X,se,1),--this.size,0))}},function(Ae,z,G){var K=G(9);Ae.exports=function(ue){var re=this.__data__,X=K(re,ue);return X<0?void 0:re[X][1]}},function(Ae,z,G){var K=G(9);Ae.exports=function(ue){return K(this.__data__,ue)>-1}},function(Ae,z,G){var K=G(9);Ae.exports=function(ue,re){var X=this.__data__,se=K(X,ue);return se<0?(++this.size,X.push([ue,re])):X[se][1]=re,this}},function(Ae,z,G){var K=G(17)(G(19),"Map");Ae.exports=K},function(Ae,z,G){var K=G(10);Ae.exports=function(ue){var re=K(this,ue).delete(ue);return this.size-=re?1:0,re}},function(Ae,z){Ae.exports=function(G){var K=typeof G;return"string"==K||"number"==K||"symbol"==K||"boolean"==K?"__proto__"!==G:null===G}},function(Ae,z,G){var K=G(10);Ae.exports=function(ue){return K(this,ue).get(ue)}},function(Ae,z,G){var K=G(10);Ae.exports=function(ue){return K(this,ue).has(ue)}},function(Ae,z,G){var K=G(10);Ae.exports=function(ue,re){var X=K(this,ue),se=X.size;return X.set(ue,re),this.size+=X.size==se?0:1,this}},function(Ae,z,G){var K=G(101);Ae.exports=function(ue){return null==ue?"":K(ue)}},function(Ae,z,G){var K=G(18),ue=G(102),re=G(21),X=G(22),se=K?K.prototype:void 0,be=se?se.toString:void 0;Ae.exports=function V(ee){if("string"==typeof ee)return ee;if(re(ee))return ue(ee,V)+"";if(X(ee))return be?be.call(ee):"";var ge=ee+"";return"0"==ge&&1/ee==-1/0?"-0":ge}},function(Ae,z){Ae.exports=function(G,K){for(var ue=-1,re=null==G?0:G.length,X=Array(re);++ue<re;)X[ue]=K(G[ue],ue,G);return X}},function(Ae,z){var G=/^(?:0|[1-9]\d*)$/;Ae.exports=function(K,ue){var re=typeof K;return!!(ue=null==ue?9007199254740991:ue)&&("number"==re||"symbol"!=re&&G.test(K))&&K>-1&&K%1==0&&K<ue}},function(Ae,z,G){var K=G(22);Ae.exports=function(ue){if("string"==typeof ue||K(ue))return ue;var re=ue+"";return"0"==re&&1/ue==-1/0?"-0":re}},function(Ae,z,G){"use strict";var K=this&&this.__importDefault||function(be){return be&&be.__esModule?be:{default:be}};Object.defineProperty(z,"__esModule",{value:!0});var ue=K(G(15)),re=G(106),X=function(){function be(V){this.converter=V,this.finalResult=[]}return Object.defineProperty(be.prototype,"needEmitLine",{get:function(){return!!this.converter.parseRuntime.subscribe&&!!this.converter.parseRuntime.subscribe.onNext||this.needPushDownstream},enumerable:!0,configurable:!0}),Object.defineProperty(be.prototype,"needPushDownstream",{get:function(){return void 0===this._needPushDownstream&&(this._needPushDownstream=this.converter.listeners("data").length>0||this.converter.listeners("readable").length>0),this._needPushDownstream},enumerable:!0,configurable:!0}),Object.defineProperty(be.prototype,"needEmitAll",{get:function(){return!!this.converter.parseRuntime.then&&this.converter.parseParam.needEmitAll},enumerable:!0,configurable:!0}),be.prototype.processResult=function(V){var ee=this;return this.needPushDownstream&&"array"===this.converter.parseParam.downstreamFormat&&0===this.converter.parseRuntime.parsedLineNumber&&se(this.converter,"["+re.EOL),new ue.default(function(W,J){ee.needEmitLine?function H(Y,me,te,ce,xe){if(te>=Y.length)xe();else if(me.parseRuntime.subscribe&&me.parseRuntime.subscribe.onNext){var Pe=me.parseRuntime.subscribe.onNext,Ke=Y[te],Ve=Pe(Ke,me.parseRuntime.parsedLineNumber+te);if(te++,Ve&&Ve.then)Ve.then(function(){var bt,Ne,we,qe,Ye;bt=Y,Ne=me,we=te,Ye=xe,(qe=ce)&&se(Ne,Ke),H(bt,Ne,we,qe,Ye)},xe);else{for(ce&&se(me,Ke);te<Y.length;){var it=Y[te];Pe(it,me.parseRuntime.parsedLineNumber+te),te++,ce&&se(me,it)}xe()}}else{if(ce)for(;te<Y.length;)it=Y[te++],se(me,it);xe()}}(V,ee.converter,0,ee.needPushDownstream,function(H){H?J(H):(ee.appendFinalResult(V),W())}):(ee.appendFinalResult(V),W())})},be.prototype.appendFinalResult=function(V){this.needEmitAll&&(this.finalResult=this.finalResult.concat(V)),this.converter.parseRuntime.parsedLineNumber+=V.length},be.prototype.processError=function(V){this.converter.parseRuntime.subscribe&&this.converter.parseRuntime.subscribe.onError&&this.converter.parseRuntime.subscribe.onError(V),this.converter.parseRuntime.then&&this.converter.parseRuntime.then.onrejected&&this.converter.parseRuntime.then.onrejected(V)},be.prototype.endProcess=function(){this.converter.parseRuntime.then&&this.converter.parseRuntime.then.onfulfilled&&this.converter.parseRuntime.then.onfulfilled(this.needEmitAll?this.finalResult:[]),this.converter.parseRuntime.subscribe&&this.converter.parseRuntime.subscribe.onCompleted&&this.converter.parseRuntime.subscribe.onCompleted(),this.needPushDownstream&&"array"===this.converter.parseParam.downstreamFormat&&se(this.converter,"]"+re.EOL)},be}();function se(be,V){if("object"!=typeof V||be.options.objectMode)be.push(V);else{var ee=JSON.stringify(V);be.push(ee+("array"===be.parseParam.downstreamFormat?","+re.EOL:re.EOL),"utf8")}}z.Result=X},function(Ae,z){z.endianness=function(){return"LE"},z.hostname=function(){return"undefined"!=typeof location?location.hostname:""},z.loadavg=function(){return[]},z.uptime=function(){return 0},z.freemem=function(){return Number.MAX_VALUE},z.totalmem=function(){return Number.MAX_VALUE},z.cpus=function(){return[]},z.type=function(){return"Browser"},z.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},z.networkInterfaces=z.getNetworkInterfaces=function(){return{}},z.arch=function(){return"javascript"},z.platform=function(){return"browser"},z.tmpdir=z.tmpDir=function(){return"/tmp"},z.EOL="\n",z.homedir=function(){return"/"}}])},4613:function(rt,Ae){var G;!function(K){"use strict";var re={s:1,n:0,d:1};function X(Y,me){if(isNaN(Y=parseInt(Y,10)))throw H.InvalidParameter;return Y*me}function se(Y,me){if(0===me)throw H.DivisionByZero;var te=Object.create(H.prototype);te.s=Y<0?-1:1;var ce=J(Y=Y<0?-Y:Y,me);return te.n=Y/ce,te.d=me/ce,te}function be(Y){for(var me={},te=Y,ce=2,xe=4;xe<=te;){for(;te%ce==0;)te/=ce,me[ce]=(me[ce]||0)+1;xe+=1+2*ce++}return te!==Y?te>1&&(me[te]=(me[te]||0)+1):me[Y]=(me[Y]||0)+1,me}var V=function(Y,me){var at,te=0,ce=1,xe=1,Pe=0,Ke=0,Ve=0,it=1,bt=1,$e=0,Ne=1,we=1,qe=1,Ye=1e7;if(null!=Y)if(void 0!==me){if(xe=(te=Y)*(ce=me),te%1!=0||ce%1!=0)throw H.NonIntegerParameter}else switch(typeof Y){case"object":if("d"in Y&&"n"in Y)te=Y.n,ce=Y.d,"s"in Y&&(te*=Y.s);else{if(!(0 in Y))throw H.InvalidParameter;te=Y[0],1 in Y&&(ce=Y[1])}xe=te*ce;break;case"number":if(Y<0&&(xe=Y,Y=-Y),Y%1==0)te=Y;else if(Y>0){for(Y>=1&&(Y/=bt=Math.pow(10,Math.floor(1+Math.log(Y)/Math.LN10)));Ne<=Ye&&qe<=Ye;){if(Y===(at=($e+we)/(Ne+qe))){Ne+qe<=Ye?(te=$e+we,ce=Ne+qe):qe>Ne?(te=we,ce=qe):(te=$e,ce=Ne);break}Y>at?($e+=we,Ne+=qe):(we+=$e,qe+=Ne),Ne>Ye?(te=we,ce=qe):(te=$e,ce=Ne)}te*=bt}else(isNaN(Y)||isNaN(me))&&(ce=te=NaN);break;case"string":if(null===(Ne=Y.match(/\d+|./g)))throw H.InvalidParameter;if("-"===Ne[$e]?(xe=-1,$e++):"+"===Ne[$e]&&$e++,Ne.length===$e+1?Ke=X(Ne[$e++],xe):"."===Ne[$e+1]||"."===Ne[$e]?("."!==Ne[$e]&&(Pe=X(Ne[$e++],xe)),(1+ ++$e===Ne.length||"("===Ne[$e+1]&&")"===Ne[$e+3]||"'"===Ne[$e+1]&&"'"===Ne[$e+3])&&(Ke=X(Ne[$e],xe),it=Math.pow(10,Ne[$e].length),$e++),("("===Ne[$e]&&")"===Ne[$e+2]||"'"===Ne[$e]&&"'"===Ne[$e+2])&&(Ve=X(Ne[$e+1],xe),bt=Math.pow(10,Ne[$e+1].length)-1,$e+=3)):"/"===Ne[$e+1]||":"===Ne[$e+1]?(Ke=X(Ne[$e],xe),it=X(Ne[$e+2],1),$e+=3):"/"===Ne[$e+3]&&" "===Ne[$e+1]&&(Pe=X(Ne[$e],xe),Ke=X(Ne[$e+2],xe),it=X(Ne[$e+4],1),$e+=5),Ne.length<=$e){xe=te=Ve+(ce=it*bt)*Pe+bt*Ke;break}default:throw H.InvalidParameter}if(0===ce)throw H.DivisionByZero;re.s=xe<0?-1:1,re.n=Math.abs(te),re.d=Math.abs(ce)};function J(Y,me){if(!Y)return me;if(!me)return Y;for(;;){if(!(Y%=me))return me;if(!(me%=Y))return Y}}function H(Y,me){if(V(Y,me),!(this instanceof H))return se(re.s*re.n,re.d);Y=J(re.d,re.n),this.s=re.s,this.n=re.n/Y,this.d=re.d/Y}H.DivisionByZero=new Error("Division by Zero"),H.InvalidParameter=new Error("Invalid argument"),H.NonIntegerParameter=new Error("Parameters must be integer"),H.prototype={s:1,n:0,d:1,abs:function(){return se(this.n,this.d)},neg:function(){return se(-this.s*this.n,this.d)},add:function(Y,me){return V(Y,me),se(this.s*this.n*re.d+re.s*this.d*re.n,this.d*re.d)},sub:function(Y,me){return V(Y,me),se(this.s*this.n*re.d-re.s*this.d*re.n,this.d*re.d)},mul:function(Y,me){return V(Y,me),se(this.s*re.s*this.n*re.n,this.d*re.d)},div:function(Y,me){return V(Y,me),se(this.s*re.s*this.n*re.d,this.d*re.n)},clone:function(){return se(this.s*this.n,this.d)},mod:function(Y,me){if(isNaN(this.n)||isNaN(this.d))return new H(NaN);if(void 0===Y)return se(this.s*this.n%this.d,1);if(V(Y,me),0===re.n&&0===this.d)throw H.DivisionByZero;return se(this.s*(re.d*this.n)%(re.n*this.d),re.d*this.d)},gcd:function(Y,me){return V(Y,me),se(J(re.n,this.n)*J(re.d,this.d),re.d*this.d)},lcm:function(Y,me){return V(Y,me),0===re.n&&0===this.n?se(0,1):se(re.n*this.n,J(re.n,this.n)*J(re.d,this.d))},ceil:function(Y){return Y=Math.pow(10,Y||0),isNaN(this.n)||isNaN(this.d)?new H(NaN):se(Math.ceil(Y*this.s*this.n/this.d),Y)},floor:function(Y){return Y=Math.pow(10,Y||0),isNaN(this.n)||isNaN(this.d)?new H(NaN):se(Math.floor(Y*this.s*this.n/this.d),Y)},round:function(Y){return Y=Math.pow(10,Y||0),isNaN(this.n)||isNaN(this.d)?new H(NaN):se(Math.round(Y*this.s*this.n/this.d),Y)},inverse:function(){return se(this.s*this.d,this.n)},pow:function(Y,me){if(V(Y,me),1===re.d)return re.s<0?se(Math.pow(this.s*this.d,re.n),Math.pow(this.n,re.n)):se(Math.pow(this.s*this.n,re.n),Math.pow(this.d,re.n));if(this.s<0)return null;var te=be(this.n),ce=be(this.d),xe=1,Pe=1;for(var Ke in te)if("1"!==Ke){if("0"===Ke){xe=0;break}if(te[Ke]*=re.n,te[Ke]%re.d!=0)return null;te[Ke]/=re.d,xe*=Math.pow(Ke,te[Ke])}for(var Ke in ce)if("1"!==Ke){if(ce[Ke]*=re.n,ce[Ke]%re.d!=0)return null;ce[Ke]/=re.d,Pe*=Math.pow(Ke,ce[Ke])}return re.s<0?se(Pe,xe):se(xe,Pe)},equals:function(Y,me){return V(Y,me),this.s*this.n*re.d==re.s*re.n*this.d},compare:function(Y,me){V(Y,me);var te=this.s*this.n*re.d-re.s*re.n*this.d;return(0<te)-(te<0)},simplify:function(Y){if(isNaN(this.n)||isNaN(this.d))return this;Y=Y||.001;for(var me=this.abs(),te=me.toContinued(),ce=1;ce<te.length;ce++){for(var xe=se(te[ce-1],1),Pe=ce-2;Pe>=0;Pe--)xe=xe.inverse().add(te[Pe]);if(xe.sub(me).abs().valueOf()<Y)return xe.mul(this.s)}return this},divisible:function(Y,me){return V(Y,me),!(!(re.n*this.d)||this.n*re.d%(re.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(Y){var me,te="",ce=this.n,xe=this.d;return this.s<0&&(te+="-"),1===xe?te+=ce:(Y&&(me=Math.floor(ce/xe))>0&&(te+=me,te+=" ",ce%=xe),te+=ce,te+="/",te+=xe),te},toLatex:function(Y){var me,te="",ce=this.n,xe=this.d;return this.s<0&&(te+="-"),1===xe?te+=ce:(Y&&(me=Math.floor(ce/xe))>0&&(te+=me,ce%=xe),te+="\\frac{",te+=ce,te+="}{",te+=xe,te+="}"),te},toContinued:function(){var Y,me=this.n,te=this.d,ce=[];if(isNaN(me)||isNaN(te))return ce;do{ce.push(Math.floor(me/te)),Y=me%te,me=te,te=Y}while(1!==me);return ce},toString:function(Y){var me=this.n,te=this.d;if(isNaN(me)||isNaN(te))return"NaN";Y=Y||15;var ce=function ge(Y,me){for(;me%2==0;me/=2);for(;me%5==0;me/=5);if(1===me)return 0;for(var te=10%me,ce=1;1!==te;ce++)if(te=10*te%me,ce>2e3)return 0;return ce}(0,te),xe=function W(Y,me,te){for(var ce=1,xe=function ee(Y,me,te){for(var ce=1;me>0;Y=Y*Y%te,me>>=1)1&me&&(ce=ce*Y%te);return ce}(10,te,me),Pe=0;Pe<300;Pe++){if(ce===xe)return Pe;ce=10*ce%me,xe=10*xe%me}return 0}(0,te,ce),Pe=this.s<0?"-":"";if(Pe+=me/te|0,me%=te,(me*=10)&&(Pe+="."),ce){for(var Ke=xe;Ke--;)Pe+=me/te|0,me%=te,me*=10;for(Pe+="(",Ke=ce;Ke--;)Pe+=me/te|0,me%=te,me*=10;Pe+=")"}else for(Ke=Y;me&&Ke--;)Pe+=me/te|0,me%=te,me*=10;return Pe}},void 0!==(G=function(){return H}.apply(Ae,[]))&&(rt.exports=G)}()},9286:rt=>{rt.exports=function Ae(z,G){"use strict";var Y,me,K=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,ue=/(^[ ]*|[ ]*$)/g,re=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,X=/^0x[0-9a-f]+$/i,se=/^0/,be=function(xe){return Ae.insensitive&&(""+xe).toLowerCase()||""+xe},V=be(z).replace(ue,"")||"",ee=be(G).replace(ue,"")||"",ge=V.replace(K,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),W=ee.replace(K,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),J=parseInt(V.match(X),16)||1!==ge.length&&V.match(re)&&Date.parse(V),H=parseInt(ee.match(X),16)||J&&ee.match(re)&&Date.parse(ee)||null;if(H){if(J<H)return-1;if(J>H)return 1}for(var te=0,ce=Math.max(ge.length,W.length);te<ce;te++){if(Y=!(ge[te]||"").match(se)&&parseFloat(ge[te])||ge[te]||0,me=!(W[te]||"").match(se)&&parseFloat(W[te])||W[te]||0,isNaN(Y)!==isNaN(me))return isNaN(Y)?1:-1;if(typeof Y!=typeof me&&(Y+="",me+=""),Y<me)return-1;if(Y>me)return 1}return 0}},8407:function(rt,Ae){!function(z){"use strict";function K(g){var w,P,U,pe;for(P=1,U=arguments.length;P<U;P++)for(w in pe=arguments[P])g[w]=pe[w];return g}var ue=Object.create||function(){function g(){}return function(w){return g.prototype=w,new g}}();function re(g,w){var P=Array.prototype.slice;if(g.bind)return g.bind.apply(g,P.call(arguments,1));var U=P.call(arguments,2);return function(){return g.apply(w,U.length?U.concat(P.call(arguments)):arguments)}}var X=0;function se(g){return"_leaflet_id"in g||(g._leaflet_id=++X),g._leaflet_id}function be(g,w,P){var U,pe,Ie,Qe;return Qe=function(){U=!1,pe&&(Ie.apply(P,pe),pe=!1)},Ie=function(){U?pe=arguments:(g.apply(P,arguments),setTimeout(Qe,w),U=!0)},Ie}function V(g,w,P){var U=w[1],pe=w[0],Ie=U-pe;return g===U&&P?g:((g-pe)%Ie+Ie)%Ie+pe}function ee(){return!1}function ge(g,w){if(!1===w)return g;var P=Math.pow(10,void 0===w?6:w);return Math.round(g*P)/P}function W(g){return g.trim?g.trim():g.replace(/^\s+|\s+$/g,"")}function J(g){return W(g).split(/\s+/)}function H(g,w){for(var P in Object.prototype.hasOwnProperty.call(g,"options")||(g.options=g.options?ue(g.options):{}),w)g.options[P]=w[P];return g.options}function Y(g,w,P){var U=[];for(var pe in g)U.push(encodeURIComponent(P?pe.toUpperCase():pe)+"="+encodeURIComponent(g[pe]));return(w&&-1!==w.indexOf("?")?"&":"?")+U.join("&")}var me=/\{ *([\w_ -]+) *\}/g;function te(g,w){return g.replace(me,function(P,U){var pe=w[U];if(void 0===pe)throw new Error("No value provided for variable "+P);return"function"==typeof pe&&(pe=pe(w)),pe})}var ce=Array.isArray||function(g){return"[object Array]"===Object.prototype.toString.call(g)};function xe(g,w){for(var P=0;P<g.length;P++)if(g[P]===w)return P;return-1}var Pe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ke(g){return window["webkit"+g]||window["moz"+g]||window["ms"+g]}var Ve=0;function it(g){var w=+new Date,P=Math.max(0,16-(w-Ve));return Ve=w+P,window.setTimeout(g,P)}var bt=window.requestAnimationFrame||Ke("RequestAnimationFrame")||it,$e=window.cancelAnimationFrame||Ke("CancelAnimationFrame")||Ke("CancelRequestAnimationFrame")||function(g){window.clearTimeout(g)};function Ne(g,w,P){if(!P||bt!==it)return bt.call(window,re(g,w));g.call(w)}function we(g){g&&$e.call(window,g)}var qe={__proto__:null,extend:K,create:ue,bind:re,get lastId(){return X},stamp:se,throttle:be,wrapNum:V,falseFn:ee,formatNum:ge,trim:W,splitWords:J,setOptions:H,getParamString:Y,template:te,isArray:ce,indexOf:xe,emptyImageUrl:Pe,requestFn:bt,cancelFn:$e,requestAnimFrame:Ne,cancelAnimFrame:we};function Ye(){}Ye.extend=function(g){var w=function(){H(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},P=w.__super__=this.prototype,U=ue(P);for(var pe in U.constructor=w,w.prototype=U,this)Object.prototype.hasOwnProperty.call(this,pe)&&"prototype"!==pe&&"__super__"!==pe&&(w[pe]=this[pe]);return g.statics&&K(w,g.statics),g.includes&&(function at(g){if("undefined"!=typeof L&&L&&L.Mixin){g=ce(g)?g:[g];for(var w=0;w<g.length;w++)g[w]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(g.includes),K.apply(null,[U].concat(g.includes))),K(U,g),delete U.statics,delete U.includes,U.options&&(U.options=P.options?ue(P.options):{},K(U.options,g.options)),U._initHooks=[],U.callInitHooks=function(){if(!this._initHooksCalled){P.callInitHooks&&P.callInitHooks.call(this),this._initHooksCalled=!0;for(var Ie=0,Qe=U._initHooks.length;Ie<Qe;Ie++)U._initHooks[Ie].call(this)}},w},Ye.include=function(g){var w=this.prototype.options;return K(this.prototype,g),g.options&&(this.prototype.options=w,this.mergeOptions(g.options)),this},Ye.mergeOptions=function(g){return K(this.prototype.options,g),this},Ye.addInitHook=function(g){var w=Array.prototype.slice.call(arguments,1),P="function"==typeof g?g:function(){this[g].apply(this,w)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(P),this};var At={on:function(g,w,P){if("object"==typeof g)for(var U in g)this._on(U,g[U],w);else for(var pe=0,Ie=(g=J(g)).length;pe<Ie;pe++)this._on(g[pe],w,P);return this},off:function(g,w,P){if(arguments.length)if("object"==typeof g)for(var U in g)this._off(U,g[U],w);else{g=J(g);for(var pe=1===arguments.length,Ie=0,Qe=g.length;Ie<Qe;Ie++)pe?this._off(g[Ie]):this._off(g[Ie],w,P)}else delete this._events;return this},_on:function(g,w,P,U){if("function"==typeof w){if(!1===this._listens(g,w,P)){P===this&&(P=void 0);var pe={fn:w,ctx:P};U&&(pe.once=!0),this._events=this._events||{},this._events[g]=this._events[g]||[],this._events[g].push(pe)}}else console.warn("wrong listener type: "+typeof w)},_off:function(g,w,P){var U,pe,Ie;if(this._events&&(U=this._events[g])){if(1===arguments.length){if(this._firingCount)for(pe=0,Ie=U.length;pe<Ie;pe++)U[pe].fn=ee;return void delete this._events[g]}if("function"!=typeof w)return void console.warn("wrong listener type: "+typeof w);var Qe=this._listens(g,w,P);!1!==Qe&&(this._firingCount&&(U[Qe].fn=ee,this._events[g]=U=U.slice()),U.splice(Qe,1))}},fire:function(g,w,P){if(!this.listens(g,P))return this;var U=K({},w,{type:g,target:this,sourceTarget:w&&w.sourceTarget||this});if(this._events){var pe=this._events[g];if(pe){this._firingCount=this._firingCount+1||1;for(var Ie=0,Qe=pe.length;Ie<Qe;Ie++){var Bt=pe[Ie],Zt=Bt.fn;Bt.once&&this.off(g,Zt,Bt.ctx),Zt.call(Bt.ctx||this,U)}this._firingCount--}}return P&&this._propagateEvent(U),this},listens:function(g,w,P,U){"string"!=typeof g&&console.warn('"string" type argument expected');var pe=w;"function"!=typeof w&&(U=!!w,pe=void 0,P=void 0);var Ie=this._events&&this._events[g];if(Ie&&Ie.length&&!1!==this._listens(g,pe,P))return!0;if(U)for(var Qe in this._eventParents)if(this._eventParents[Qe].listens(g,w,P,U))return!0;return!1},_listens:function(g,w,P){if(!this._events)return!1;var U=this._events[g]||[];if(!w)return!!U.length;P===this&&(P=void 0);for(var pe=0,Ie=U.length;pe<Ie;pe++)if(U[pe].fn===w&&U[pe].ctx===P)return pe;return!1},once:function(g,w,P){if("object"==typeof g)for(var U in g)this._on(U,g[U],w,!0);else for(var pe=0,Ie=(g=J(g)).length;pe<Ie;pe++)this._on(g[pe],w,P,!0);return this},addEventParent:function(g){return this._eventParents=this._eventParents||{},this._eventParents[se(g)]=g,this},removeEventParent:function(g){return this._eventParents&&delete this._eventParents[se(g)],this},_propagateEvent:function(g){for(var w in this._eventParents)this._eventParents[w].fire(g.type,K({layer:g.target,propagatedFrom:g.target},g),!0)}};At.addEventListener=At.on,At.removeEventListener=At.clearAllEventListeners=At.off,At.addOneTimeEventListener=At.once,At.fireEvent=At.fire,At.hasEventListeners=At.listens;var Ut=Ye.extend(At);function Mt(g,w,P){this.x=P?Math.round(g):g,this.y=P?Math.round(w):w}var sn=Math.trunc||function(g){return g>0?Math.floor(g):Math.ceil(g)};function je(g,w,P){return g instanceof Mt?g:ce(g)?new Mt(g[0],g[1]):null==g?g:"object"==typeof g&&"x"in g&&"y"in g?new Mt(g.x,g.y):new Mt(g,w,P)}function We(g,w){if(g)for(var P=w?[g,w]:g,U=0,pe=P.length;U<pe;U++)this.extend(P[U])}function tt(g,w){return!g||g instanceof We?g:new We(g,w)}function Pt(g,w){if(g)for(var P=w?[g,w]:g,U=0,pe=P.length;U<pe;U++)this.extend(P[U])}function Ue(g,w){return g instanceof Pt?g:new Pt(g,w)}function xt(g,w,P){if(isNaN(g)||isNaN(w))throw new Error("Invalid LatLng object: ("+g+", "+w+")");this.lat=+g,this.lng=+w,void 0!==P&&(this.alt=+P)}function Vt(g,w,P){return g instanceof xt?g:ce(g)&&"object"!=typeof g[0]?3===g.length?new xt(g[0],g[1],g[2]):2===g.length?new xt(g[0],g[1]):null:null==g?g:"object"==typeof g&&"lat"in g?new xt(g.lat,"lng"in g?g.lng:g.lon,g.alt):void 0===w?null:new xt(g,w,P)}Mt.prototype={clone:function(){return new Mt(this.x,this.y)},add:function(g){return this.clone()._add(je(g))},_add:function(g){return this.x+=g.x,this.y+=g.y,this},subtract:function(g){return this.clone()._subtract(je(g))},_subtract:function(g){return this.x-=g.x,this.y-=g.y,this},divideBy:function(g){return this.clone()._divideBy(g)},_divideBy:function(g){return this.x/=g,this.y/=g,this},multiplyBy:function(g){return this.clone()._multiplyBy(g)},_multiplyBy:function(g){return this.x*=g,this.y*=g,this},scaleBy:function(g){return new Mt(this.x*g.x,this.y*g.y)},unscaleBy:function(g){return new Mt(this.x/g.x,this.y/g.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=sn(this.x),this.y=sn(this.y),this},distanceTo:function(g){var w=(g=je(g)).x-this.x,P=g.y-this.y;return Math.sqrt(w*w+P*P)},equals:function(g){return(g=je(g)).x===this.x&&g.y===this.y},contains:function(g){return g=je(g),Math.abs(g.x)<=Math.abs(this.x)&&Math.abs(g.y)<=Math.abs(this.y)},toString:function(){return"Point("+ge(this.x)+", "+ge(this.y)+")"}},We.prototype={extend:function(g){var w,P;if(!g)return this;if(g instanceof Mt||"number"==typeof g[0]||"x"in g)w=P=je(g);else if(P=(g=tt(g)).max,!(w=g.min)||!P)return this;return this.min||this.max?(this.min.x=Math.min(w.x,this.min.x),this.max.x=Math.max(P.x,this.max.x),this.min.y=Math.min(w.y,this.min.y),this.max.y=Math.max(P.y,this.max.y)):(this.min=w.clone(),this.max=P.clone()),this},getCenter:function(g){return je((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,g)},getBottomLeft:function(){return je(this.min.x,this.max.y)},getTopRight:function(){return je(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(g){var w,P;return(g="number"==typeof g[0]||g instanceof Mt?je(g):tt(g))instanceof We?(w=g.min,P=g.max):w=P=g,w.x>=this.min.x&&P.x<=this.max.x&&w.y>=this.min.y&&P.y<=this.max.y},intersects:function(g){g=tt(g);var w=this.min,P=this.max,U=g.min,pe=g.max;return pe.x>=w.x&&U.x<=P.x&&pe.y>=w.y&&U.y<=P.y},overlaps:function(g){g=tt(g);var w=this.min,P=this.max,U=g.min,pe=g.max;return pe.x>w.x&&U.x<P.x&&pe.y>w.y&&U.y<P.y},isValid:function(){return!(!this.min||!this.max)},pad:function(g){var w=this.min,P=this.max,U=Math.abs(w.x-P.x)*g,pe=Math.abs(w.y-P.y)*g;return tt(je(w.x-U,w.y-pe),je(P.x+U,P.y+pe))},equals:function(g){return!!g&&(g=tt(g),this.min.equals(g.getTopLeft())&&this.max.equals(g.getBottomRight()))}},Pt.prototype={extend:function(g){var U,pe,w=this._southWest,P=this._northEast;if(g instanceof xt)U=g,pe=g;else{if(!(g instanceof Pt))return g?this.extend(Vt(g)||Ue(g)):this;if(pe=g._northEast,!(U=g._southWest)||!pe)return this}return w||P?(w.lat=Math.min(U.lat,w.lat),w.lng=Math.min(U.lng,w.lng),P.lat=Math.max(pe.lat,P.lat),P.lng=Math.max(pe.lng,P.lng)):(this._southWest=new xt(U.lat,U.lng),this._northEast=new xt(pe.lat,pe.lng)),this},pad:function(g){var w=this._southWest,P=this._northEast,U=Math.abs(w.lat-P.lat)*g,pe=Math.abs(w.lng-P.lng)*g;return new Pt(new xt(w.lat-U,w.lng-pe),new xt(P.lat+U,P.lng+pe))},getCenter:function(){return new xt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new xt(this.getNorth(),this.getWest())},getSouthEast:function(){return new xt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(g){g="number"==typeof g[0]||g instanceof xt||"lat"in g?Vt(g):Ue(g);var U,pe,w=this._southWest,P=this._northEast;return g instanceof Pt?(U=g.getSouthWest(),pe=g.getNorthEast()):U=pe=g,U.lat>=w.lat&&pe.lat<=P.lat&&U.lng>=w.lng&&pe.lng<=P.lng},intersects:function(g){g=Ue(g);var w=this._southWest,P=this._northEast,U=g.getSouthWest(),pe=g.getNorthEast();return pe.lat>=w.lat&&U.lat<=P.lat&&pe.lng>=w.lng&&U.lng<=P.lng},overlaps:function(g){g=Ue(g);var w=this._southWest,P=this._northEast,U=g.getSouthWest(),pe=g.getNorthEast();return pe.lat>w.lat&&U.lat<P.lat&&pe.lng>w.lng&&U.lng<P.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(g,w){return!!g&&(g=Ue(g),this._southWest.equals(g.getSouthWest(),w)&&this._northEast.equals(g.getNorthEast(),w))},isValid:function(){return!(!this._southWest||!this._northEast)}},xt.prototype={equals:function(g,w){return!!g&&(g=Vt(g),Math.max(Math.abs(this.lat-g.lat),Math.abs(this.lng-g.lng))<=(void 0===w?1e-9:w))},toString:function(g){return"LatLng("+ge(this.lat,g)+", "+ge(this.lng,g)+")"},distanceTo:function(g){return rn.distance(this,Vt(g))},wrap:function(){return rn.wrapLatLng(this)},toBounds:function(g){var w=180*g/40075017,P=w/Math.cos(Math.PI/180*this.lat);return Ue([this.lat-w,this.lng-P],[this.lat+w,this.lng+P])},clone:function(){return new xt(this.lat,this.lng,this.alt)}};var g,Qt={latLngToPoint:function(g,w){var P=this.projection.project(g),U=this.scale(w);return this.transformation._transform(P,U)},pointToLatLng:function(g,w){var P=this.scale(w),U=this.transformation.untransform(g,P);return this.projection.unproject(U)},project:function(g){return this.projection.project(g)},unproject:function(g){return this.projection.unproject(g)},scale:function(g){return 256*Math.pow(2,g)},zoom:function(g){return Math.log(g/256)/Math.LN2},getProjectedBounds:function(g){if(this.infinite)return null;var w=this.projection.bounds,P=this.scale(g);return new We(this.transformation.transform(w.min,P),this.transformation.transform(w.max,P))},infinite:!1,wrapLatLng:function(g){var w=this.wrapLng?V(g.lng,this.wrapLng,!0):g.lng;return new xt(this.wrapLat?V(g.lat,this.wrapLat,!0):g.lat,w,g.alt)},wrapLatLngBounds:function(g){var w=g.getCenter(),P=this.wrapLatLng(w),U=w.lat-P.lat,pe=w.lng-P.lng;if(0===U&&0===pe)return g;var Ie=g.getSouthWest(),Qe=g.getNorthEast();return new Pt(new xt(Ie.lat-U,Ie.lng-pe),new xt(Qe.lat-U,Qe.lng-pe))}},rn=K({},Qt,{wrapLng:[-180,180],R:6371e3,distance:function(g,w){var P=Math.PI/180,U=g.lat*P,pe=w.lat*P,Ie=Math.sin((w.lat-g.lat)*P/2),Qe=Math.sin((w.lng-g.lng)*P/2),Bt=Ie*Ie+Math.cos(U)*Math.cos(pe)*Qe*Qe,Zt=2*Math.atan2(Math.sqrt(Bt),Math.sqrt(1-Bt));return this.R*Zt}}),_e={R:6378137,MAX_LATITUDE:85.0511287798,project:function(g){var w=Math.PI/180,P=this.MAX_LATITUDE,U=Math.max(Math.min(P,g.lat),-P),pe=Math.sin(U*w);return new Mt(this.R*g.lng*w,this.R*Math.log((1+pe)/(1-pe))/2)},unproject:function(g){var w=180/Math.PI;return new xt((2*Math.atan(Math.exp(g.y/this.R))-Math.PI/2)*w,g.x*w/this.R)},bounds:(g=6378137*Math.PI,new We([-g,-g],[g,g]))};function Fe(g,w,P,U){if(ce(g))return this._a=g[0],this._b=g[1],this._c=g[2],void(this._d=g[3]);this._a=g,this._b=w,this._c=P,this._d=U}function yt(g,w,P,U){return new Fe(g,w,P,U)}Fe.prototype={transform:function(g,w){return this._transform(g.clone(),w)},_transform:function(g,w){return g.x=(w=w||1)*(this._a*g.x+this._b),g.y=w*(this._c*g.y+this._d),g},untransform:function(g,w){return new Mt((g.x/(w=w||1)-this._b)/this._a,(g.y/w-this._d)/this._c)}};var _t=K({},rn,{code:"EPSG:3857",projection:_e,transformation:function(){var g=.5/(Math.PI*_e.R);return yt(g,.5,-g,.5)}()}),pt=K({},_t,{code:"EPSG:900913"});function Sn(g){return document.createElementNS("http://www.w3.org/2000/svg",g)}function Gn(g,w){var U,pe,Ie,Qe,Bt,Zt,P="";for(U=0,Ie=g.length;U<Ie;U++){for(pe=0,Qe=(Bt=g[U]).length;pe<Qe;pe++)P+=(pe?"L":"M")+(Zt=Bt[pe]).x+" "+Zt.y;P+=w?Bn.svg?"z":"x":""}return P||"M0 0"}var _r=document.documentElement.style,mr="ActiveXObject"in window,Br=mr&&!document.addEventListener,Ps="msLaunchUri"in navigator&&!("documentMode"in document),Yi=Pi("webkit"),xs=Pi("android"),ct=Pi("android 2")||Pi("android 3"),ze=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),et=xs&&Pi("Google")&&ze<537&&!("AudioNode"in window),ft=!!window.opera,Gt=!Ps&&Pi("chrome"),bn=Pi("gecko")&&!Yi&&!ft&&!mr,wn=!Gt&&Pi("safari"),on=Pi("phantom"),En="OTransition"in _r,Zn=0===navigator.platform.indexOf("Win"),Nr=mr&&"transition"in _r,ji="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ct,bi="MozPerspective"in _r,js=!window.L_DISABLE_3D&&(Nr||ji||bi)&&!En&&!on,bo="undefined"!=typeof orientation||Pi("mobile"),Ml=bo&&Yi,ym=bo&&ji,kl=!window.PointerEvent&&window.MSPointerEvent,_d=!(!window.PointerEvent&&!kl),Ls="ontouchstart"in window||!!window.TouchEvent,ko=!window.L_NO_TOUCH&&(Ls||_d),yb=bo&&ft,oh=bo&&bn,$i=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Qu=function(){var g=!1;try{var w=Object.defineProperty({},"passive",{get:function(){g=!0}});window.addEventListener("testPassiveEventSupport",ee,w),window.removeEventListener("testPassiveEventSupport",ee,w)}catch(P){}return g}(),yc=!!document.createElement("canvas").getContext,Qh=!(!document.createElementNS||!Sn("svg").createSVGRect),_m=!!Qh&&function(){var g=document.createElement("div");return g.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(g.firstChild&&g.firstChild.namespaceURI)}(),Qi=!Qh&&function(){try{var g=document.createElement("div");g.innerHTML='<v:shape adj="1"/>';var w=g.firstChild;return w.style.behavior="url(#default#VML)",w&&"object"==typeof w.adj}catch(P){return!1}}();function Pi(g){return navigator.userAgent.toLowerCase().indexOf(g)>=0}var Bn={ie:mr,ielt9:Br,edge:Ps,webkit:Yi,android:xs,android23:ct,androidStock:et,opera:ft,chrome:Gt,gecko:bn,safari:wn,phantom:on,opera12:En,win:Zn,ie3d:Nr,webkit3d:ji,gecko3d:bi,any3d:js,mobile:bo,mobileWebkit:Ml,mobileWebkit3d:ym,msPointer:kl,pointer:_d,touch:ko,touchNative:Ls,mobileOpera:yb,mobileGecko:oh,retina:$i,passiveEvents:Qu,canvas:yc,svg:Qh,vml:Qi,inlineSvg:_m,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},Cu=Bn.msPointer?"MSPointerDown":"pointerdown",qs=Bn.msPointer?"MSPointerMove":"pointermove",Rl=Bn.msPointer?"MSPointerUp":"pointerup",Jh=Bn.msPointer?"MSPointerCancel":"pointercancel",ef={touchstart:Cu,touchmove:qs,touchend:Rl,touchcancel:Jh},bm={touchstart:function Su(g,w){w.MSPOINTER_TYPE_TOUCH&&w.pointerType===w.MSPOINTER_TYPE_TOUCH&&Zs(w),Cd(g,w)},touchmove:Cd,touchend:Cd,touchcancel:Cd},Ol={},cn=!1;function mi(g,w,P){return"touchstart"===w&&function xm(){cn||(document.addEventListener(Cu,pa,!0),document.addEventListener(qs,wm,!0),document.addEventListener(Rl,xd,!0),document.addEventListener(Jh,xd,!0),cn=!0)}(),bm[w]?(P=bm[w].bind(this,P),g.addEventListener(ef[w],P,!1),P):(console.warn("wrong event specified:",w),ee)}function pa(g){Ol[g.pointerId]=g}function wm(g){Ol[g.pointerId]&&(Ol[g.pointerId]=g)}function xd(g){delete Ol[g.pointerId]}function Cd(g,w){if(w.pointerType!==(w.MSPOINTER_TYPE_MOUSE||"mouse")){for(var P in w.touches=[],Ol)w.touches.push(Ol[P]);w.changedTouches=[w],g(w)}}var Oo,Ju,ro,sf,af,Cm=Pl(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),nf=Pl(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ns="webkitTransition"===nf||"OTransition"===nf?nf+"End":"transitionend";function Cs(g){return"string"==typeof g?document.getElementById(g):g}function Sd(g,w){var P=g.style[w]||g.currentStyle&&g.currentStyle[w];if((!P||"auto"===P)&&document.defaultView){var U=document.defaultView.getComputedStyle(g,null);P=U?U[w]:null}return"auto"===P?null:P}function li(g,w,P){var U=document.createElement(g);return U.className=w||"",P&&P.appendChild(U),U}function cs(g){var w=g.parentNode;w&&w.removeChild(g)}function rf(g){for(;g.firstChild;)g.removeChild(g.firstChild)}function Ro(g){var w=g.parentNode;w&&w.lastChild!==g&&w.appendChild(g)}function or(g){var w=g.parentNode;w&&w.firstChild!==g&&w.insertBefore(g,w.firstChild)}function $v(g,w){if(void 0!==g.classList)return g.classList.contains(w);var P=ms(g);return P.length>0&&new RegExp("(^|\\s)"+w+"(\\s|$)").test(P)}function Hr(g,w){if(void 0!==g.classList)for(var P=J(w),U=0,pe=P.length;U<pe;U++)g.classList.add(P[U]);else if(!$v(g,w)){var Ie=ms(g);pn(g,(Ie?Ie+" ":"")+w)}}function hs(g,w){void 0!==g.classList?g.classList.remove(w):pn(g,W((" "+ms(g)+" ").replace(" "+w+" "," ")))}function pn(g,w){void 0===g.className.baseVal?g.className=w:g.className.baseVal=w}function ms(g){return g.correspondingElement&&(g=g.correspondingElement),void 0===g.className.baseVal?g.className:g.className.baseVal}function Bi(g,w){"opacity"in g.style?g.style.opacity=w:"filter"in g.style&&function ah(g,w){var P=!1,U="DXImageTransform.Microsoft.Alpha";try{P=g.filters.item(U)}catch(pe){if(1===w)return}w=Math.round(100*w),P?(P.Enabled=100!==w,P.Opacity=w):g.style.filter+=" progid:"+U+"(opacity="+w+")"}(g,w)}function Pl(g){for(var w=document.documentElement.style,P=0;P<g.length;P++)if(g[P]in w)return g[P];return!1}function _c(g,w,P){var U=w||new Mt(0,0);g.style[Cm]=(Bn.ie3d?"translate("+U.x+"px,"+U.y+"px)":"translate3d("+U.x+"px,"+U.y+"px,0)")+(P?" scale("+P+")":"")}function vr(g,w){g._leaflet_pos=w,Bn.any3d?_c(g,w):(g.style.left=w.x+"px",g.style.top=w.y+"px")}function Xn(g){return g._leaflet_pos||new Mt(0,0)}if("onselectstart"in document)Oo=function(){Dr(window,"selectstart",Zs)},Ju=function(){wi(window,"selectstart",Zs)};else{var Fo=Pl(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Oo=function(){if(Fo){var g=document.documentElement.style;ro=g[Fo],g[Fo]="none"}},Ju=function(){Fo&&(document.documentElement.style[Fo]=ro,ro=void 0)}}function Ed(){Dr(window,"dragstart",Zs)}function Eu(){wi(window,"dragstart",Zs)}function Nd(g){for(;-1===g.tabIndex;)g=g.parentNode;!g.style||(uh(),sf=g,af=g.style.outline,g.style.outline="none",Dr(window,"keydown",uh))}function uh(){!sf||(sf.style.outline=af,sf=void 0,af=void 0,wi(window,"keydown",uh))}function io(g){do{g=g.parentNode}while(!(g.offsetWidth&&g.offsetHeight||g===document.body));return g}function Td(g){var w=g.getBoundingClientRect();return{x:w.width/g.offsetWidth||1,y:w.height/g.offsetHeight||1,boundingClientRect:w}}var bc={__proto__:null,TRANSFORM:Cm,TRANSITION:nf,TRANSITION_END:ns,get:Cs,getStyle:Sd,create:li,remove:cs,empty:rf,toFront:Ro,toBack:or,hasClass:$v,addClass:Hr,removeClass:hs,setClass:pn,getClass:ms,setOpacity:Bi,testProp:Pl,setTransform:_c,setPosition:vr,getPosition:Xn,get disableTextSelection(){return Oo},get enableTextSelection(){return Ju},disableImageDrag:Ed,enableImageDrag:Eu,preventOutline:Nd,restoreOutline:uh,getSizedParentNode:io,getScale:Td};function Dr(g,w,P,U){if(w&&"object"==typeof w)for(var pe in w)wc(g,pe,w[pe],P);else for(var Ie=0,Qe=(w=J(w)).length;Ie<Qe;Ie++)wc(g,w[Ie],P,U);return this}var ma="_leaflet_events";function wi(g,w,P,U){if(1===arguments.length)uf(g),delete g[ma];else if(w&&"object"==typeof w)for(var pe in w)cf(g,pe,w[pe],P);else if(w=J(w),2===arguments.length)uf(g,function(Bt){return-1!==xe(w,Bt)});else for(var Ie=0,Qe=w.length;Ie<Qe;Ie++)cf(g,w[Ie],P,U);return this}function uf(g,w){for(var P in g[ma]){var U=P.split(/\d/)[0];(!w||w(U))&&cf(g,U,null,null,P)}}var lf={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function wc(g,w,P,U){var pe=w+se(P)+(U?"_"+se(U):"");if(g[ma]&&g[ma][pe])return this;var Ie=function(Bt){return P.call(U||g,Bt||window.event)},Qe=Ie;!Bn.touchNative&&Bn.pointer&&0===w.indexOf("touch")?Ie=mi(g,w,Ie):Bn.touch&&"dblclick"===w?Ie=function Fl(g,w){g.addEventListener("dblclick",w);var U,P=0;function pe(Ie){if(1===Ie.detail){if("mouse"!==Ie.pointerType&&(!Ie.sourceCapabilities||Ie.sourceCapabilities.firesTouchEvents)){var Qe=Bv(Ie);if(!Qe.some(function(Zt){return Zt instanceof HTMLLabelElement&&Zt.attributes.for})||Qe.some(function(Zt){return Zt instanceof HTMLInputElement||Zt instanceof HTMLSelectElement})){var Bt=Date.now();Bt-P<=200?2==++U&&w(function Sr(g){var P,U,w={};for(U in g)w[U]=(P=g[U])&&P.bind?P.bind(g):P;return g=w,w.type="dblclick",w.detail=2,w.isTrusted=!1,w._simulated=!0,w}(Ie)):U=1,P=Bt}}}else U=Ie.detail}return g.addEventListener("click",pe),{dblclick:w,simDblclick:pe}}(g,Ie):"addEventListener"in g?"touchstart"===w||"touchmove"===w||"wheel"===w||"mousewheel"===w?g.addEventListener(lf[w]||w,Ie,!!Bn.passiveEvents&&{passive:!1}):"mouseenter"===w||"mouseleave"===w?g.addEventListener(lf[w],Ie=function(Bt){Bt=Bt||window.event,Nm(g,Bt)&&Qe(Bt)},!1):g.addEventListener(w,Qe,!1):g.attachEvent("on"+w,Ie),g[ma]=g[ma]||{},g[ma][pe]=Ie}function cf(g,w,P,U,pe){pe=pe||w+se(P)+(U?"_"+se(U):"");var Ie=g[ma]&&g[ma][pe];if(!Ie)return this;!Bn.touchNative&&Bn.pointer&&0===w.indexOf("touch")?function Ji(g,w,P){ef[w]?g.removeEventListener(ef[w],P,!1):console.warn("wrong event specified:",w)}(g,w,Ie):Bn.touch&&"dblclick"===w?function _b(g,w){g.removeEventListener("dblclick",w.dblclick),g.removeEventListener("click",w.simDblclick)}(g,Ie):"removeEventListener"in g?g.removeEventListener(lf[w]||w,Ie,!1):g.detachEvent("on"+w,Ie),g[ma][pe]=null}function eu(g){return g.stopPropagation?g.stopPropagation():g.originalEvent?g.originalEvent._stopped=!0:g.cancelBubble=!0,this}function Sm(g){return wc(g,"wheel",eu),this}function lh(g){return Dr(g,"mousedown touchstart dblclick contextmenu",eu),g._leaflet_disable_click=!0,this}function Zs(g){return g.preventDefault?g.preventDefault():g.returnValue=!1,this}function xc(g){return Zs(g),eu(g),this}function Bv(g){if(g.composedPath)return g.composedPath();for(var w=[],P=g.target;P;)w.push(P),P=P.parentNode;return w}function Vv(g,w){if(!w)return new Mt(g.clientX,g.clientY);var P=Td(w),U=P.boundingClientRect;return new Mt((g.clientX-U.left)/P.x-w.clientLeft,(g.clientY-U.top)/P.y-w.clientTop)}var bb=Bn.linux&&Bn.chrome?window.devicePixelRatio:Bn.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Em(g){return Bn.edge?g.wheelDeltaY/2:g.deltaY&&0===g.deltaMode?-g.deltaY/bb:g.deltaY&&1===g.deltaMode?20*-g.deltaY:g.deltaY&&2===g.deltaMode?60*-g.deltaY:g.deltaX||g.deltaZ?0:g.wheelDelta?(g.wheelDeltaY||g.wheelDelta)/2:g.detail&&Math.abs(g.detail)<32765?20*-g.detail:g.detail?g.detail/-32765*60:0}function Nm(g,w){var P=w.relatedTarget;if(!P)return!0;try{for(;P&&P!==g;)P=P.parentNode}catch(U){return!1}return P!==g}var wb={__proto__:null,on:Dr,off:wi,stopPropagation:eu,disableScrollPropagation:Sm,disableClickPropagation:lh,preventDefault:Zs,stop:xc,getPropagationPath:Bv,getMousePosition:Vv,getWheelDelta:Em,isExternalTarget:Nm,addListener:Dr,removeListener:wi},Cc=Ut.extend({run:function(g,w,P,U){this.stop(),this._el=g,this._inProgress=!0,this._duration=P||.25,this._easeOutPower=1/Math.max(U||.5,.2),this._startPos=Xn(g),this._offset=w.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=Ne(this._animate,this),this._step()},_step:function(g){var w=+new Date-this._startTime,P=1e3*this._duration;w<P?this._runFrame(this._easeOut(w/P),g):(this._runFrame(1),this._complete())},_runFrame:function(g,w){var P=this._startPos.add(this._offset.multiplyBy(g));w&&P._round(),vr(this._el,P),this.fire("step")},_complete:function(){we(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(g){return 1-Math.pow(1-g,this._easeOutPower)}}),ei=Ut.extend({options:{crs:_t,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(g,w){w=H(this,w),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(g),this._initLayout(),this._onResize=re(this._onResize,this),this._initEvents(),w.maxBounds&&this.setMaxBounds(w.maxBounds),void 0!==w.zoom&&(this._zoom=this._limitZoom(w.zoom)),w.center&&void 0!==w.zoom&&this.setView(Vt(w.center),w.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=nf&&Bn.any3d&&!Bn.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Dr(this._proxy,ns,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(g,w,P){return w=void 0===w?this._zoom:this._limitZoom(w),g=this._limitCenter(Vt(g),w,this.options.maxBounds),P=P||{},this._stop(),this._loaded&&!P.reset&&!0!==P&&(void 0!==P.animate&&(P.zoom=K({animate:P.animate},P.zoom),P.pan=K({animate:P.animate,duration:P.duration},P.pan)),this._zoom!==w?this._tryAnimatedZoom&&this._tryAnimatedZoom(g,w,P.zoom):this._tryAnimatedPan(g,P.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(g,w,P.pan&&P.pan.noMoveStart),this)},setZoom:function(g,w){return this._loaded?this.setView(this.getCenter(),g,{zoom:w}):(this._zoom=g,this)},zoomIn:function(g,w){return this.setZoom(this._zoom+(g=g||(Bn.any3d?this.options.zoomDelta:1)),w)},zoomOut:function(g,w){return this.setZoom(this._zoom-(g=g||(Bn.any3d?this.options.zoomDelta:1)),w)},setZoomAround:function(g,w,P){var U=this.getZoomScale(w),pe=this.getSize().divideBy(2),Qe=(g instanceof Mt?g:this.latLngToContainerPoint(g)).subtract(pe).multiplyBy(1-1/U),Bt=this.containerPointToLatLng(pe.add(Qe));return this.setView(Bt,w,{zoom:P})},_getBoundsCenterZoom:function(g,w){w=w||{},g=g.getBounds?g.getBounds():Ue(g);var P=je(w.paddingTopLeft||w.padding||[0,0]),U=je(w.paddingBottomRight||w.padding||[0,0]),pe=this.getBoundsZoom(g,!1,P.add(U));if((pe="number"==typeof w.maxZoom?Math.min(w.maxZoom,pe):pe)===1/0)return{center:g.getCenter(),zoom:pe};var Ie=U.subtract(P).divideBy(2),Qe=this.project(g.getSouthWest(),pe),Bt=this.project(g.getNorthEast(),pe);return{center:this.unproject(Qe.add(Bt).divideBy(2).add(Ie),pe),zoom:pe}},fitBounds:function(g,w){if(!(g=Ue(g)).isValid())throw new Error("Bounds are not valid.");var P=this._getBoundsCenterZoom(g,w);return this.setView(P.center,P.zoom,w)},fitWorld:function(g){return this.fitBounds([[-90,-180],[90,180]],g)},panTo:function(g,w){return this.setView(g,this._zoom,{pan:w})},panBy:function(g,w){if(w=w||{},!(g=je(g).round()).x&&!g.y)return this.fire("moveend");if(!0!==w.animate&&!this.getSize().contains(g))return this._resetView(this.unproject(this.project(this.getCenter()).add(g)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Cc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),w.noMoveStart||this.fire("movestart"),!1!==w.animate){Hr(this._mapPane,"leaflet-pan-anim");var P=this._getMapPanePos().subtract(g).round();this._panAnim.run(this._mapPane,P,w.duration||.25,w.easeLinearity)}else this._rawPanBy(g),this.fire("move").fire("moveend");return this},flyTo:function(g,w,P){if(!1===(P=P||{}).animate||!Bn.any3d)return this.setView(g,w,P);this._stop();var U=this.project(this.getCenter()),pe=this.project(g),Ie=this.getSize(),Qe=this._zoom;g=Vt(g),w=void 0===w?Qe:w;var Bt=Math.max(Ie.x,Ie.y),Zt=Bt*this.getZoomScale(Qe,w),hn=pe.distanceTo(U)||1,Rn=1.42,fr=Rn*Rn;function Wr(Bs){var Xv=(Zt*Zt-Bt*Bt+(Bs?-1:1)*fr*fr*hn*hn)/(2*(Bs?Zt:Bt)*fr*hn),Fb=Math.sqrt(Xv*Xv+1)-Xv;return Fb<1e-9?-18:Math.log(Fb)}function $o(Bs){return(Math.exp(Bs)-Math.exp(-Bs))/2}function so(Bs){return(Math.exp(Bs)+Math.exp(-Bs))/2}var Nc=Wr(0);function yf(Bs){return Bt*(so(Nc)*function Fd(Bs){return $o(Bs)/so(Bs)}(Nc+Rn*Bs)-$o(Nc))/fr}var Kv=Date.now(),Ob=(Wr(1)-Nc)/Rn,JE=P.duration?1e3*P.duration:1e3*Ob*.8;return this._moveStart(!0,P.noMoveStart),function Om(){var Bs=(Date.now()-Kv)/JE,ph=function HF(Bs){return 1-Math.pow(1-Bs,1.5)}(Bs)*Ob;Bs<=1?(this._flyToFrame=Ne(Om,this),this._move(this.unproject(U.add(pe.subtract(U).multiplyBy(yf(ph)/hn)),Qe),this.getScaleZoom(Bt/function Rm(Bs){return Bt*(so(Nc)/so(Nc+Rn*Bs))}(ph),Qe),{flyTo:!0})):this._move(g,w)._moveEnd(!0)}.call(this),this},flyToBounds:function(g,w){var P=this._getBoundsCenterZoom(g,w);return this.flyTo(P.center,P.zoom,w)},setMaxBounds:function(g){return g=Ue(g),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),g.isValid()?(this.options.maxBounds=g,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(g){var w=this.options.minZoom;return this.options.minZoom=g,this._loaded&&w!==g&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(g):this},setMaxZoom:function(g){var w=this.options.maxZoom;return this.options.maxZoom=g,this._loaded&&w!==g&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(g):this},panInsideBounds:function(g,w){this._enforcingBounds=!0;var P=this.getCenter(),U=this._limitCenter(P,this._zoom,Ue(g));return P.equals(U)||this.panTo(U,w),this._enforcingBounds=!1,this},panInside:function(g,w){var P=je((w=w||{}).paddingTopLeft||w.padding||[0,0]),U=je(w.paddingBottomRight||w.padding||[0,0]),pe=this.project(this.getCenter()),Ie=this.project(g),Qe=this.getPixelBounds(),Bt=tt([Qe.min.add(P),Qe.max.subtract(U)]),Zt=Bt.getSize();if(!Bt.contains(Ie)){this._enforcingBounds=!0;var hn=Ie.subtract(Bt.getCenter()),Rn=Bt.extend(Ie).getSize().subtract(Zt);pe.x+=hn.x<0?-Rn.x:Rn.x,pe.y+=hn.y<0?-Rn.y:Rn.y,this.panTo(this.unproject(pe),w),this._enforcingBounds=!1}return this},invalidateSize:function(g){if(!this._loaded)return this;g=K({animate:!1,pan:!0},!0===g?{animate:!0}:g);var w=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var P=this.getSize(),U=w.divideBy(2).round(),pe=P.divideBy(2).round(),Ie=U.subtract(pe);return Ie.x||Ie.y?(g.animate&&g.pan?this.panBy(Ie):(g.pan&&this._rawPanBy(Ie),this.fire("move"),g.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(re(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:w,newSize:P})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(g){if(g=this._locateOptions=K({timeout:1e4,watch:!1},g),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var w=re(this._handleGeolocationResponse,this),P=re(this._handleGeolocationError,this);return g.watch?this._locationWatchId=navigator.geolocation.watchPosition(w,P,g):navigator.geolocation.getCurrentPosition(w,P,g),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(g){if(this._container._leaflet_id){var w=g.code,P=g.message||(1===w?"permission denied":2===w?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:w,message:"Geolocation error: "+P+"."})}},_handleGeolocationResponse:function(g){if(this._container._leaflet_id){var U=new xt(g.coords.latitude,g.coords.longitude),pe=U.toBounds(2*g.coords.accuracy),Ie=this._locateOptions;if(Ie.setView){var Qe=this.getBoundsZoom(pe);this.setView(U,Ie.maxZoom?Math.min(Qe,Ie.maxZoom):Qe)}var Bt={latlng:U,bounds:pe,timestamp:g.timestamp};for(var Zt in g.coords)"number"==typeof g.coords[Zt]&&(Bt[Zt]=g.coords[Zt]);this.fire("locationfound",Bt)}},addHandler:function(g,w){if(!w)return this;var P=this[g]=new w(this);return this._handlers.push(P),this.options[g]&&P.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(w){this._container._leaflet_id=void 0,this._containerId=void 0}var g;for(g in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),cs(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(we(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[g].remove();for(g in this._panes)cs(this._panes[g]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(g,w){var U=li("div","leaflet-pane"+(g?" leaflet-"+g.replace("Pane","")+"-pane":""),w||this._mapPane);return g&&(this._panes[g]=U),U},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var g=this.getPixelBounds();return new Pt(this.unproject(g.getBottomLeft()),this.unproject(g.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(g,w,P){g=Ue(g),P=je(P||[0,0]);var U=this.getZoom()||0,pe=this.getMinZoom(),Ie=this.getMaxZoom(),Qe=g.getNorthWest(),Bt=g.getSouthEast(),Zt=this.getSize().subtract(P),hn=tt(this.project(Bt,U),this.project(Qe,U)).getSize(),Rn=Bn.any3d?this.options.zoomSnap:1,fr=Zt.x/hn.x,Wr=Zt.y/hn.y,$o=w?Math.max(fr,Wr):Math.min(fr,Wr);return U=this.getScaleZoom($o,U),Rn&&(U=Math.round(U/(Rn/100))*(Rn/100),U=w?Math.ceil(U/Rn)*Rn:Math.floor(U/Rn)*Rn),Math.max(pe,Math.min(Ie,U))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Mt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(g,w){var P=this._getTopLeftPoint(g,w);return new We(P,P.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(g){return this.options.crs.getProjectedBounds(void 0===g?this.getZoom():g)},getPane:function(g){return"string"==typeof g?this._panes[g]:g},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(g,w){var P=this.options.crs;return w=void 0===w?this._zoom:w,P.scale(g)/P.scale(w)},getScaleZoom:function(g,w){var P=this.options.crs,U=P.zoom(g*P.scale(w=void 0===w?this._zoom:w));return isNaN(U)?1/0:U},project:function(g,w){return w=void 0===w?this._zoom:w,this.options.crs.latLngToPoint(Vt(g),w)},unproject:function(g,w){return w=void 0===w?this._zoom:w,this.options.crs.pointToLatLng(je(g),w)},layerPointToLatLng:function(g){var w=je(g).add(this.getPixelOrigin());return this.unproject(w)},latLngToLayerPoint:function(g){return this.project(Vt(g))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(g){return this.options.crs.wrapLatLng(Vt(g))},wrapLatLngBounds:function(g){return this.options.crs.wrapLatLngBounds(Ue(g))},distance:function(g,w){return this.options.crs.distance(Vt(g),Vt(w))},containerPointToLayerPoint:function(g){return je(g).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(g){return je(g).add(this._getMapPanePos())},containerPointToLatLng:function(g){var w=this.containerPointToLayerPoint(je(g));return this.layerPointToLatLng(w)},latLngToContainerPoint:function(g){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Vt(g)))},mouseEventToContainerPoint:function(g){return Vv(g,this._container)},mouseEventToLayerPoint:function(g){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(g))},mouseEventToLatLng:function(g){return this.layerPointToLatLng(this.mouseEventToLayerPoint(g))},_initContainer:function(g){var w=this._container=Cs(g);if(!w)throw new Error("Map container not found.");if(w._leaflet_id)throw new Error("Map container is already initialized.");Dr(w,"scroll",this._onScroll,this),this._containerId=se(w)},_initLayout:function(){var g=this._container;this._fadeAnimated=this.options.fadeAnimation&&Bn.any3d,Hr(g,"leaflet-container"+(Bn.touch?" leaflet-touch":"")+(Bn.retina?" leaflet-retina":"")+(Bn.ielt9?" leaflet-oldie":"")+(Bn.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var w=Sd(g,"position");"absolute"!==w&&"relative"!==w&&"fixed"!==w&&"sticky"!==w&&(g.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var g=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),vr(this._mapPane,new Mt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Hr(g.markerPane,"leaflet-zoom-hide"),Hr(g.shadowPane,"leaflet-zoom-hide"))},_resetView:function(g,w,P){vr(this._mapPane,new Mt(0,0));var U=!this._loaded;this._loaded=!0,w=this._limitZoom(w),this.fire("viewprereset");var pe=this._zoom!==w;this._moveStart(pe,P)._move(g,w)._moveEnd(pe),this.fire("viewreset"),U&&this.fire("load")},_moveStart:function(g,w){return g&&this.fire("zoomstart"),w||this.fire("movestart"),this},_move:function(g,w,P,U){void 0===w&&(w=this._zoom);var pe=this._zoom!==w;return this._zoom=w,this._lastCenter=g,this._pixelOrigin=this._getNewPixelOrigin(g),U?P&&P.pinch&&this.fire("zoom",P):((pe||P&&P.pinch)&&this.fire("zoom",P),this.fire("move",P)),this},_moveEnd:function(g){return g&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return we(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(g){vr(this._mapPane,this._getMapPanePos().subtract(g))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(g){this._targets={},this._targets[se(this._container)]=this;var w=g?wi:Dr;w(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&w(window,"resize",this._onResize,this),Bn.any3d&&this.options.transform3DLimit&&(g?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){we(this._resizeRequest),this._resizeRequest=Ne(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var g=this._getMapPanePos();Math.max(Math.abs(g.x),Math.abs(g.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(g,w){for(var U,P=[],pe="mouseout"===w||"mouseover"===w,Ie=g.target||g.srcElement,Qe=!1;Ie;){if((U=this._targets[se(Ie)])&&("click"===w||"preclick"===w)&&this._draggableMoved(U)){Qe=!0;break}if(U&&U.listens(w,!0)&&(pe&&!Nm(Ie,g)||(P.push(U),pe))||Ie===this._container)break;Ie=Ie.parentNode}return!P.length&&!Qe&&!pe&&this.listens(w,!0)&&(P=[this]),P},_isClickDisabled:function(g){for(;g&&g!==this._container;){if(g._leaflet_disable_click)return!0;g=g.parentNode}},_handleDOMEvent:function(g){var w=g.target||g.srcElement;if(!(!this._loaded||w._leaflet_disable_events||"click"===g.type&&this._isClickDisabled(w))){var P=g.type;"mousedown"===P&&Nd(w),this._fireDOMEvent(g,P)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(g,w,P){if("click"===g.type){var U=K({},g);U.type="preclick",this._fireDOMEvent(U,U.type,P)}var pe=this._findEventTargets(g,w);if(P){for(var Ie=[],Qe=0;Qe<P.length;Qe++)P[Qe].listens(w,!0)&&Ie.push(P[Qe]);pe=Ie.concat(pe)}if(pe.length){"contextmenu"===w&&Zs(g);var Bt=pe[0],Zt={originalEvent:g};if("keypress"!==g.type&&"keydown"!==g.type&&"keyup"!==g.type){var hn=Bt.getLatLng&&(!Bt._radius||Bt._radius<=10);Zt.containerPoint=hn?this.latLngToContainerPoint(Bt.getLatLng()):this.mouseEventToContainerPoint(g),Zt.layerPoint=this.containerPointToLayerPoint(Zt.containerPoint),Zt.latlng=hn?Bt.getLatLng():this.layerPointToLatLng(Zt.layerPoint)}for(Qe=0;Qe<pe.length;Qe++)if(pe[Qe].fire(w,Zt,!0),Zt.originalEvent._stopped||!1===pe[Qe].options.bubblingMouseEvents&&-1!==xe(this._mouseEvents,w))return}},_draggableMoved:function(g){return(g=g.dragging&&g.dragging.enabled()?g:this).dragging&&g.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var g=0,w=this._handlers.length;g<w;g++)this._handlers[g].disable()},whenReady:function(g,w){return this._loaded?g.call(w||this,{target:this}):this.on("load",g,w),this},_getMapPanePos:function(){return Xn(this._mapPane)||new Mt(0,0)},_moved:function(){var g=this._getMapPanePos();return g&&!g.equals([0,0])},_getTopLeftPoint:function(g,w){return(g&&void 0!==w?this._getNewPixelOrigin(g,w):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(g,w){var P=this.getSize()._divideBy(2);return this.project(g,w)._subtract(P)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(g,w,P){var U=this._getNewPixelOrigin(P,w);return this.project(g,w)._subtract(U)},_latLngBoundsToNewLayerBounds:function(g,w,P){var U=this._getNewPixelOrigin(P,w);return tt([this.project(g.getSouthWest(),w)._subtract(U),this.project(g.getNorthWest(),w)._subtract(U),this.project(g.getSouthEast(),w)._subtract(U),this.project(g.getNorthEast(),w)._subtract(U)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(g){return this.latLngToLayerPoint(g).subtract(this._getCenterLayerPoint())},_limitCenter:function(g,w,P){if(!P)return g;var U=this.project(g,w),pe=this.getSize().divideBy(2),Ie=new We(U.subtract(pe),U.add(pe)),Qe=this._getBoundsOffset(Ie,P,w);return Math.abs(Qe.x)<=1&&Math.abs(Qe.y)<=1?g:this.unproject(U.add(Qe),w)},_limitOffset:function(g,w){if(!w)return g;var P=this.getPixelBounds(),U=new We(P.min.add(g),P.max.add(g));return g.add(this._getBoundsOffset(U,w))},_getBoundsOffset:function(g,w,P){var U=tt(this.project(w.getNorthEast(),P),this.project(w.getSouthWest(),P)),pe=U.min.subtract(g.min),Ie=U.max.subtract(g.max);return new Mt(this._rebound(pe.x,-Ie.x),this._rebound(pe.y,-Ie.y))},_rebound:function(g,w){return g+w>0?Math.round(g-w)/2:Math.max(0,Math.ceil(g))-Math.max(0,Math.floor(w))},_limitZoom:function(g){var w=this.getMinZoom(),P=this.getMaxZoom(),U=Bn.any3d?this.options.zoomSnap:1;return U&&(g=Math.round(g/U)*U),Math.max(w,Math.min(P,g))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){hs(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(g,w){var P=this._getCenterOffset(g)._trunc();return!(!0!==(w&&w.animate)&&!this.getSize().contains(P)||(this.panBy(P,w),0))},_createAnimProxy:function(){var g=this._proxy=li("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(g),this.on("zoomanim",function(w){var P=Cm,U=this._proxy.style[P];_c(this._proxy,this.project(w.center,w.zoom),this.getZoomScale(w.zoom,1)),U===this._proxy.style[P]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){cs(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var g=this.getCenter(),w=this.getZoom();_c(this._proxy,this.project(g,w),this.getZoomScale(w,1))},_catchTransitionEnd:function(g){this._animatingZoom&&g.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(g,w,P){if(this._animatingZoom)return!0;if(P=P||{},!this._zoomAnimated||!1===P.animate||this._nothingToAnimate()||Math.abs(w-this._zoom)>this.options.zoomAnimationThreshold)return!1;var U=this.getZoomScale(w),pe=this._getCenterOffset(g)._divideBy(1-1/U);return!(!0!==P.animate&&!this.getSize().contains(pe)||(Ne(function(){this._moveStart(!0,!1)._animateZoom(g,w,!0)},this),0))},_animateZoom:function(g,w,P,U){!this._mapPane||(P&&(this._animatingZoom=!0,this._animateToCenter=g,this._animateToZoom=w,Hr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:g,zoom:w,noUpdate:U}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(re(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&hs(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});var ga=Ye.extend({options:{position:"topright"},initialize:function(g){H(this,g)},getPosition:function(){return this.options.position},setPosition:function(g){var w=this._map;return w&&w.removeControl(this),this.options.position=g,w&&w.addControl(this),this},getContainer:function(){return this._container},addTo:function(g){this.remove(),this._map=g;var w=this._container=this.onAdd(g),P=this.getPosition(),U=g._controlCorners[P];return Hr(w,"leaflet-control"),-1!==P.indexOf("bottom")?U.insertBefore(w,U.firstChild):U.appendChild(w),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(cs(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(g){this._map&&g&&g.screenX>0&&g.screenY>0&&this._map.getContainer().focus()}}),ci=function(g){return new ga(g)};ei.include({addControl:function(g){return g.addTo(this),this},removeControl:function(g){return g.remove(),this},_initControlPos:function(){var g=this._controlCorners={},w="leaflet-",P=this._controlContainer=li("div",w+"control-container",this._container);function U(pe,Ie){g[pe+Ie]=li("div",w+pe+" "+w+Ie,P)}U("top","left"),U("top","right"),U("bottom","left"),U("bottom","right")},_clearControlPos:function(){for(var g in this._controlCorners)cs(this._controlCorners[g]);cs(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ad=ga.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(g,w,P,U){return P<U?-1:U<P?1:0}},initialize:function(g,w,P){for(var U in H(this,P),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,g)this._addLayer(g[U],U);for(U in w)this._addLayer(w[U],U,!0)},onAdd:function(g){this._initLayout(),this._update(),this._map=g,g.on("zoomend",this._checkDisabledLayers,this);for(var w=0;w<this._layers.length;w++)this._layers[w].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(g){return ga.prototype.addTo.call(this,g),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var g=0;g<this._layers.length;g++)this._layers[g].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(g,w){return this._addLayer(g,w),this._map?this._update():this},addOverlay:function(g,w){return this._addLayer(g,w,!0),this._map?this._update():this},removeLayer:function(g){g.off("add remove",this._onLayerChange,this);var w=this._getLayer(se(g));return w&&this._layers.splice(this._layers.indexOf(w),1),this._map?this._update():this},expand:function(){Hr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var g=this._map.getSize().y-(this._container.offsetTop+50);return g<this._section.clientHeight?(Hr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=g+"px"):hs(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return hs(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var g="leaflet-control-layers",w=this._container=li("div",g),P=this.options.collapsed;w.setAttribute("aria-haspopup",!0),lh(w),Sm(w);var U=this._section=li("section",g+"-list");P&&(this._map.on("click",this.collapse,this),Dr(w,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var pe=this._layersLink=li("a",g+"-toggle",w);pe.href="#",pe.title="Layers",pe.setAttribute("role","button"),Dr(pe,{keydown:function(Ie){13===Ie.keyCode&&this._expandSafely()},click:function(Ie){Zs(Ie),this._expandSafely()}},this),P||this.expand(),this._baseLayersList=li("div",g+"-base",U),this._separator=li("div",g+"-separator",U),this._overlaysList=li("div",g+"-overlays",U),w.appendChild(U)},_getLayer:function(g){for(var w=0;w<this._layers.length;w++)if(this._layers[w]&&se(this._layers[w].layer)===g)return this._layers[w]},_addLayer:function(g,w,P){this._map&&g.on("add remove",this._onLayerChange,this),this._layers.push({layer:g,name:w,overlay:P}),this.options.sortLayers&&this._layers.sort(re(function(U,pe){return this.options.sortFunction(U.layer,pe.layer,U.name,pe.name)},this)),this.options.autoZIndex&&g.setZIndex&&(this._lastZIndex++,g.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;rf(this._baseLayersList),rf(this._overlaysList),this._layerControlInputs=[];var g,w,P,U,pe=0;for(P=0;P<this._layers.length;P++)this._addItem(U=this._layers[P]),w=w||U.overlay,g=g||!U.overlay,pe+=U.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(g=g&&pe>1)?"":"none"),this._separator.style.display=w&&g?"":"none",this},_onLayerChange:function(g){this._handlingClick||this._update();var w=this._getLayer(se(g.target)),P=w.overlay?"add"===g.type?"overlayadd":"overlayremove":"add"===g.type?"baselayerchange":null;P&&this._map.fire(P,w)},_createRadioElement:function(g,w){var P='<input type="radio" class="leaflet-control-layers-selector" name="'+g+'"'+(w?' checked="checked"':"")+"/>",U=document.createElement("div");return U.innerHTML=P,U.firstChild},_addItem:function(g){var U,w=document.createElement("label"),P=this._map.hasLayer(g.layer);g.overlay?((U=document.createElement("input")).type="checkbox",U.className="leaflet-control-layers-selector",U.defaultChecked=P):U=this._createRadioElement("leaflet-base-layers_"+se(this),P),this._layerControlInputs.push(U),U.layerId=se(g.layer),Dr(U,"click",this._onInputClick,this);var pe=document.createElement("span");pe.innerHTML=" "+g.name;var Ie=document.createElement("span");return w.appendChild(Ie),Ie.appendChild(U),Ie.appendChild(pe),(g.overlay?this._overlaysList:this._baseLayersList).appendChild(w),this._checkDisabledLayers(),w},_onInputClick:function(){var w,P,g=this._layerControlInputs,U=[],pe=[];this._handlingClick=!0;for(var Ie=g.length-1;Ie>=0;Ie--)P=this._getLayer((w=g[Ie]).layerId).layer,w.checked?U.push(P):w.checked||pe.push(P);for(Ie=0;Ie<pe.length;Ie++)this._map.hasLayer(pe[Ie])&&this._map.removeLayer(pe[Ie]);for(Ie=0;Ie<U.length;Ie++)this._map.hasLayer(U[Ie])||this._map.addLayer(U[Ie]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var w,P,g=this._layerControlInputs,U=this._map.getZoom(),pe=g.length-1;pe>=0;pe--)P=this._getLayer((w=g[pe]).layerId).layer,w.disabled=void 0!==P.options.minZoom&&U<P.options.minZoom||void 0!==P.options.maxZoom&&U>P.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var g=this._section;Dr(g,"click",Zs),this.expand(),setTimeout(function(){wi(g,"click",Zs)})}}),hf=ga.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(g){var w="leaflet-control-zoom",P=li("div",w+" leaflet-bar"),U=this.options;return this._zoomInButton=this._createButton(U.zoomInText,U.zoomInTitle,w+"-in",P,this._zoomIn),this._zoomOutButton=this._createButton(U.zoomOutText,U.zoomOutTitle,w+"-out",P,this._zoomOut),this._updateDisabled(),g.on("zoomend zoomlevelschange",this._updateDisabled,this),P},onRemove:function(g){g.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(g){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(g.shiftKey?3:1))},_zoomOut:function(g){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(g.shiftKey?3:1))},_createButton:function(g,w,P,U,pe){var Ie=li("a",P,U);return Ie.innerHTML=g,Ie.href="#",Ie.title=w,Ie.setAttribute("role","button"),Ie.setAttribute("aria-label",w),lh(Ie),Dr(Ie,"click",xc),Dr(Ie,"click",pe,this),Dr(Ie,"click",this._refocusOnMap,this),Ie},_updateDisabled:function(){var g=this._map,w="leaflet-disabled";hs(this._zoomInButton,w),hs(this._zoomOutButton,w),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||g._zoom===g.getMinZoom())&&(Hr(this._zoomOutButton,w),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||g._zoom===g.getMaxZoom())&&(Hr(this._zoomInButton,w),this._zoomInButton.setAttribute("aria-disabled","true"))}});ei.mergeOptions({zoomControl:!0}),ei.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new hf,this.addControl(this.zoomControl))});var Di=ga.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(g){var w="leaflet-control-scale",P=li("div",w),U=this.options;return this._addScales(U,w+"-line",P),g.on(U.updateWhenIdle?"moveend":"move",this._update,this),g.whenReady(this._update,this),P},onRemove:function(g){g.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(g,w,P){g.metric&&(this._mScale=li("div",w,P)),g.imperial&&(this._iScale=li("div",w,P))},_update:function(){var g=this._map,w=g.getSize().y/2,P=g.distance(g.containerPointToLatLng([0,w]),g.containerPointToLatLng([this.options.maxWidth,w]));this._updateScales(P)},_updateScales:function(g){this.options.metric&&g&&this._updateMetric(g),this.options.imperial&&g&&this._updateImperial(g)},_updateMetric:function(g){var w=this._getRoundNum(g);this._updateScale(this._mScale,w<1e3?w+" m":w/1e3+" km",w/g)},_updateImperial:function(g){var P,U,pe,w=3.2808399*g;w>5280?(U=this._getRoundNum(P=w/5280),this._updateScale(this._iScale,U+" mi",U/P)):(pe=this._getRoundNum(w),this._updateScale(this._iScale,pe+" ft",pe/w))},_updateScale:function(g,w,P){g.style.width=Math.round(this.options.maxWidth*P)+"px",g.innerHTML=w},_getRoundNum:function(g){var w=Math.pow(10,(Math.floor(g)+"").length-1),P=g/w;return w*(P>=10?10:P>=5?5:P>=3?3:P>=2?2:1)}}),Hv=ga.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Bn.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(g){H(this,g),this._attributions={}},onAdd:function(g){for(var w in g.attributionControl=this,this._container=li("div","leaflet-control-attribution"),lh(this._container),g._layers)g._layers[w].getAttribution&&this.addAttribution(g._layers[w].getAttribution());return this._update(),g.on("layeradd",this._addAttribution,this),this._container},onRemove:function(g){g.off("layeradd",this._addAttribution,this)},_addAttribution:function(g){g.layer.getAttribution&&(this.addAttribution(g.layer.getAttribution()),g.layer.once("remove",function(){this.removeAttribution(g.layer.getAttribution())},this))},setPrefix:function(g){return this.options.prefix=g,this._update(),this},addAttribution:function(g){return g?(this._attributions[g]||(this._attributions[g]=0),this._attributions[g]++,this._update(),this):this},removeAttribution:function(g){return g?(this._attributions[g]&&(this._attributions[g]--,this._update()),this):this},_update:function(){if(this._map){var g=[];for(var w in this._attributions)this._attributions[w]&&g.push(w);var P=[];this.options.prefix&&P.push(this.options.prefix),g.length&&P.push(g.join(", ")),this._container.innerHTML=P.join(' <span aria-hidden="true">|</span> ')}}});ei.mergeOptions({attributionControl:!0}),ei.addInitHook(function(){this.options.attributionControl&&(new Hv).addTo(this)});ga.Layers=Ad,ga.Zoom=hf,ga.Scale=Di,ga.Attribution=Hv,ci.layers=function(g,w,P){return new Ad(g,w,P)},ci.zoom=function(g){return new hf(g)},ci.scale=function(g){return new Di(g)},ci.attribution=function(g){return new Hv(g)};var Pa=Ye.extend({initialize:function(g){this._map=g},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Pa.addTo=function(g,w){return g.addHandler(w,this),this};var Nb,Tr={Events:At},wo=Bn.touch?"touchstart mousedown":"mousedown",Ll=Ut.extend({options:{clickTolerance:3},initialize:function(g,w,P,U){H(this,U),this._element=g,this._dragStartTarget=w||g,this._preventOutline=P},enable:function(){this._enabled||(Dr(this._dragStartTarget,wo,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(Ll._dragging===this&&this.finishDrag(!0),wi(this._dragStartTarget,wo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(g){if(this._enabled&&(this._moved=!1,!$v(this._element,"leaflet-zoom-anim"))){if(g.touches&&1!==g.touches.length)return void(Ll._dragging===this&&this.finishDrag());if(!(Ll._dragging||g.shiftKey||1!==g.which&&1!==g.button&&!g.touches||(Ll._dragging=this,this._preventOutline&&Nd(this._element),Ed(),Oo(),this._moving))){this.fire("down");var w=g.touches?g.touches[0]:g,P=io(this._element);this._startPoint=new Mt(w.clientX,w.clientY),this._startPos=Xn(this._element),this._parentScale=Td(P);var U="mousedown"===g.type;Dr(document,U?"mousemove":"touchmove",this._onMove,this),Dr(document,U?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(g){if(this._enabled){if(g.touches&&g.touches.length>1)return void(this._moved=!0);var w=g.touches&&1===g.touches.length?g.touches[0]:g,P=new Mt(w.clientX,w.clientY)._subtract(this._startPoint);!P.x&&!P.y||Math.abs(P.x)+Math.abs(P.y)<this.options.clickTolerance||(P.x/=this._parentScale.x,P.y/=this._parentScale.y,Zs(g),this._moved||(this.fire("dragstart"),this._moved=!0,Hr(document.body,"leaflet-dragging"),this._lastTarget=g.target||g.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Hr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(P),this._moving=!0,this._lastEvent=g,this._updatePosition())}},_updatePosition:function(){var g={originalEvent:this._lastEvent};this.fire("predrag",g),vr(this._element,this._newPos),this.fire("drag",g)},_onUp:function(){!this._enabled||this.finishDrag()},finishDrag:function(g){hs(document.body,"leaflet-dragging"),this._lastTarget&&(hs(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),wi(document,"mousemove touchmove",this._onMove,this),wi(document,"mouseup touchend touchcancel",this._onUp,this),Eu(),Ju(),this._moved&&this._moving&&this.fire("dragend",{noInertia:g,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,Ll._dragging=!1}});function Cb(g,w){if(!w||!g.length)return g.slice();var P=w*w;return function va(g,w){var P=g.length,pe=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(P);pe[0]=pe[P-1]=1,Wv(g,pe,w,0,P-1);var Ie,Qe=[];for(Ie=0;Ie<P;Ie++)pe[Ie]&&Qe.push(g[Ie]);return Qe}(g=function Eb(g,w){for(var P=[g[0]],U=1,pe=0,Ie=g.length;U<Ie;U++)XE(g[U],g[pe])>w&&(P.push(g[U]),pe=U);return pe<Ie-1&&P.push(g[Ie-1]),P}(g,P),P)}function Sb(g,w,P){return Math.sqrt(Dd(g,w,P,!0))}function Wv(g,w,P,U,pe){var Qe,Bt,Zt,Ie=0;for(Bt=U+1;Bt<=pe-1;Bt++)(Zt=Dd(g[Bt],g[U],g[pe],!0))>Ie&&(Qe=Bt,Ie=Zt);Ie>P&&(w[Qe]=1,Wv(g,w,P,U,Qe),Wv(g,w,P,Qe,pe))}function Nu(g,w,P,U,pe){var Bt,Zt,hn,Ie=U?Nb:ch(g,P),Qe=ch(w,P);for(Nb=Qe;;){if(!(Ie|Qe))return[g,w];if(Ie&Qe)return!1;hn=ch(Zt=Tm(g,w,Bt=Ie||Qe,P,pe),P),Bt===Ie?(g=Zt,Ie=hn):(w=Zt,Qe=hn)}}function Tm(g,w,P,U,pe){var hn,Rn,Ie=w.x-g.x,Qe=w.y-g.y,Bt=U.min,Zt=U.max;return 8&P?(hn=g.x+Ie*(Zt.y-g.y)/Qe,Rn=Zt.y):4&P?(hn=g.x+Ie*(Bt.y-g.y)/Qe,Rn=Bt.y):2&P?(hn=Zt.x,Rn=g.y+Qe*(Zt.x-g.x)/Ie):1&P&&(hn=Bt.x,Rn=g.y+Qe*(Bt.x-g.x)/Ie),new Mt(hn,Rn,pe)}function ch(g,w){var P=0;return g.x<w.min.x?P|=1:g.x>w.max.x&&(P|=2),g.y<w.min.y?P|=4:g.y>w.max.y&&(P|=8),P}function XE(g,w){var P=w.x-g.x,U=w.y-g.y;return P*P+U*U}function Dd(g,w,P,U){var hn,pe=w.x,Ie=w.y,Qe=P.x-pe,Bt=P.y-Ie,Zt=Qe*Qe+Bt*Bt;return Zt>0&&((hn=((g.x-pe)*Qe+(g.y-Ie)*Bt)/Zt)>1?(pe=P.x,Ie=P.y):hn>0&&(pe+=Qe*hn,Ie+=Bt*hn)),Qe=g.x-pe,Bt=g.y-Ie,U?Qe*Qe+Bt*Bt:new Mt(pe,Ie)}function xo(g){return!ce(g[0])||"object"!=typeof g[0][0]&&void 0!==g[0][0]}function Md(g){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),xo(g)}function gi(g,w){var P,U,pe,Ie,Qe,Bt,Zt,hn;if(!g||0===g.length)throw new Error("latlngs not passed");xo(g)||(console.warn("latlngs are not flat! Only the first ring will be used"),g=g[0]);var Rn=[];for(var fr in g)Rn.push(w.project(Vt(g[fr])));var Wr=Rn.length;for(P=0,U=0;P<Wr-1;P++)U+=Rn[P].distanceTo(Rn[P+1])/2;if(0===U)hn=Rn[0];else for(P=0,Ie=0;P<Wr-1;P++)if((Ie+=pe=(Qe=Rn[P]).distanceTo(Bt=Rn[P+1]))>U){hn=[Bt.x-(Zt=(Ie-U)/pe)*(Bt.x-Qe.x),Bt.y-Zt*(Bt.y-Qe.y)];break}return w.unproject(je(hn))}var hi={__proto__:null,simplify:Cb,pointToSegmentDistance:Sb,closestPointOnSegment:function Id(g,w,P){return Dd(g,w,P)},clipSegment:Nu,_getEdgeIntersection:Tm,_getBitCode:ch,_sqClosestPointOnSegment:Dd,isFlat:xo,_flat:Md,polylineCenter:gi};function gs(g,w,P){var U,Ie,Qe,Bt,Zt,hn,Rn,fr,Wr,pe=[1,4,2,8];for(Ie=0,Rn=g.length;Ie<Rn;Ie++)g[Ie]._code=ch(g[Ie],w);for(Bt=0;Bt<4;Bt++){for(fr=pe[Bt],U=[],Ie=0,Qe=(Rn=g.length)-1;Ie<Rn;Qe=Ie++)hn=g[Qe],(Zt=g[Ie])._code&fr?hn._code&fr||((Wr=Tm(hn,Zt,fr,w,P))._code=ch(Wr,w),U.push(Wr)):(hn._code&fr&&((Wr=Tm(hn,Zt,fr,w,P))._code=ch(Wr,w),U.push(Wr)),U.push(Zt));g=U}return g}function xi(g,w){var P,U,pe,Ie,Qe,Bt,Zt,hn;if(!g||0===g.length)throw new Error("latlngs not passed");xo(g)||(console.warn("latlngs are not flat! Only the first ring will be used"),g=g[0]);var fr=[];for(var Wr in g)fr.push(w.project(Vt(g[Wr])));var $o=fr.length;for(Bt=Zt=hn=0,P=0,U=$o-1;P<$o;U=P++)Zt+=((pe=fr[P]).x+(Ie=fr[U]).x)*(Qe=pe.y*Ie.x-Ie.y*pe.x),hn+=(pe.y+Ie.y)*Qe,Bt+=3*Qe;return w.unproject(je(0===Bt?fr[0]:[Zt/Bt,hn/Bt]))}var Am={__proto__:null,clipPolygon:gs,polygonCenter:xi},ea={project:function(g){return new Mt(g.lng,g.lat)},unproject:function(g){return new xt(g.y,g.x)},bounds:new We([-180,-90],[180,90])},Ti={R:6378137,R_MINOR:6356752.314245179,bounds:new We([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(g){var w=Math.PI/180,P=this.R,U=g.lat*w,pe=this.R_MINOR/P,Ie=Math.sqrt(1-pe*pe),Qe=Ie*Math.sin(U),Bt=Math.tan(Math.PI/4-U/2)/Math.pow((1-Qe)/(1+Qe),Ie/2);return U=-P*Math.log(Math.max(Bt,1e-10)),new Mt(g.lng*w*P,U)},unproject:function(g){for(var hn,w=180/Math.PI,P=this.R,U=this.R_MINOR/P,pe=Math.sqrt(1-U*U),Ie=Math.exp(-g.y/P),Qe=Math.PI/2-2*Math.atan(Ie),Bt=0,Zt=.1;Bt<15&&Math.abs(Zt)>1e-7;Bt++)hn=pe*Math.sin(Qe),hn=Math.pow((1-hn)/(1+hn),pe/2),Qe+=Zt=Math.PI/2-2*Math.atan(Ie*hn)-Qe;return new xt(Qe*w,g.x*w/P)}},yn={__proto__:null,LonLat:ea,Mercator:Ti,SphericalMercator:_e},Im=K({},rn,{code:"EPSG:3395",projection:Ti,transformation:function(){var g=.5/(Math.PI*Ti.R);return yt(g,.5,-g,.5)}()}),Ci=K({},rn,{code:"EPSG:4326",projection:ea,transformation:yt(1/180,1,-1/180,.5)}),el=K({},Qt,{projection:ea,transformation:yt(1,0,-1,0),scale:function(g){return Math.pow(2,g)},zoom:function(g){return Math.log(g)/Math.LN2},distance:function(g,w){var P=w.lng-g.lng,U=w.lat-g.lat;return Math.sqrt(P*P+U*U)},infinite:!0});Qt.Earth=rn,Qt.EPSG3395=Im,Qt.EPSG3857=_t,Qt.EPSG900913=pt,Qt.EPSG4326=Ci,Qt.Simple=el;var ta=Ut.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(g){return g.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(g){return g&&g.removeLayer(this),this},getPane:function(g){return this._map.getPane(g?this.options[g]||g:this.options.pane)},addInteractiveTarget:function(g){return this._map._targets[se(g)]=this,this},removeInteractiveTarget:function(g){return delete this._map._targets[se(g)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(g){var w=g.target;if(w.hasLayer(this)){if(this._map=w,this._zoomAnimated=w._zoomAnimated,this.getEvents){var P=this.getEvents();w.on(P,this),this.once("remove",function(){w.off(P,this)},this)}this.onAdd(w),this.fire("add"),w.fire("layeradd",{layer:this})}}});ei.include({addLayer:function(g){if(!g._layerAdd)throw new Error("The provided object is not a Layer.");var w=se(g);return this._layers[w]||(this._layers[w]=g,g._mapToAdd=this,g.beforeAdd&&g.beforeAdd(this),this.whenReady(g._layerAdd,g)),this},removeLayer:function(g){var w=se(g);return this._layers[w]?(this._loaded&&g.onRemove(this),delete this._layers[w],this._loaded&&(this.fire("layerremove",{layer:g}),g.fire("remove")),g._map=g._mapToAdd=null,this):this},hasLayer:function(g){return se(g)in this._layers},eachLayer:function(g,w){for(var P in this._layers)g.call(w,this._layers[P]);return this},_addLayers:function(g){for(var w=0,P=(g=g?ce(g)?g:[g]:[]).length;w<P;w++)this.addLayer(g[w])},_addZoomLimit:function(g){(!isNaN(g.options.maxZoom)||!isNaN(g.options.minZoom))&&(this._zoomBoundLayers[se(g)]=g,this._updateZoomLevels())},_removeZoomLimit:function(g){var w=se(g);this._zoomBoundLayers[w]&&(delete this._zoomBoundLayers[w],this._updateZoomLevels())},_updateZoomLevels:function(){var g=1/0,w=-1/0,P=this._getZoomSpan();for(var U in this._zoomBoundLayers){var pe=this._zoomBoundLayers[U].options;g=void 0===pe.minZoom?g:Math.min(g,pe.minZoom),w=void 0===pe.maxZoom?w:Math.max(w,pe.maxZoom)}this._layersMaxZoom=w===-1/0?void 0:w,this._layersMinZoom=g===1/0?void 0:g,P!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Tu=ta.extend({initialize:function(g,w){var P,U;if(H(this,w),this._layers={},g)for(P=0,U=g.length;P<U;P++)this.addLayer(g[P])},addLayer:function(g){var w=this.getLayerId(g);return this._layers[w]=g,this._map&&this._map.addLayer(g),this},removeLayer:function(g){var w=g in this._layers?g:this.getLayerId(g);return this._map&&this._layers[w]&&this._map.removeLayer(this._layers[w]),delete this._layers[w],this},hasLayer:function(g){return("number"==typeof g?g:this.getLayerId(g))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(g){var P,U,w=Array.prototype.slice.call(arguments,1);for(P in this._layers)(U=this._layers[P])[g]&&U[g].apply(U,w);return this},onAdd:function(g){this.eachLayer(g.addLayer,g)},onRemove:function(g){this.eachLayer(g.removeLayer,g)},eachLayer:function(g,w){for(var P in this._layers)g.call(w,this._layers[P]);return this},getLayer:function(g){return this._layers[g]},getLayers:function(){var g=[];return this.eachLayer(g.push,g),g},setZIndex:function(g){return this.invoke("setZIndex",g)},getLayerId:function(g){return se(g)}}),tu=Tu.extend({addLayer:function(g){return this.hasLayer(g)?this:(g.addEventParent(this),Tu.prototype.addLayer.call(this,g),this.fire("layeradd",{layer:g}))},removeLayer:function(g){return this.hasLayer(g)?(g in this._layers&&(g=this._layers[g]),g.removeEventParent(this),Tu.prototype.removeLayer.call(this,g),this.fire("layerremove",{layer:g})):this},setStyle:function(g){return this.invoke("setStyle",g)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var g=new Pt;for(var w in this._layers){var P=this._layers[w];g.extend(P.getBounds?P.getBounds():P.getLatLng())}return g}}),$l=Ye.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(g){H(this,g)},createIcon:function(g){return this._createIcon("icon",g)},createShadow:function(g){return this._createIcon("shadow",g)},_createIcon:function(g,w){var P=this._getIconUrl(g);if(!P){if("icon"===g)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var U=this._createImg(P,w&&"IMG"===w.tagName?w:null);return this._setIconStyles(U,g),(this.options.crossOrigin||""===this.options.crossOrigin)&&(U.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),U},_setIconStyles:function(g,w){var P=this.options,U=P[w+"Size"];"number"==typeof U&&(U=[U,U]);var pe=je(U),Ie=je("shadow"===w&&P.shadowAnchor||P.iconAnchor||pe&&pe.divideBy(2,!0));g.className="leaflet-marker-"+w+" "+(P.className||""),Ie&&(g.style.marginLeft=-Ie.x+"px",g.style.marginTop=-Ie.y+"px"),pe&&(g.style.width=pe.x+"px",g.style.height=pe.y+"px")},_createImg:function(g,w){return(w=w||document.createElement("img")).src=g,w},_getIconUrl:function(g){return Bn.retina&&this.options[g+"RetinaUrl"]||this.options[g+"Url"]}});var df=$l.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(g){return"string"!=typeof df.imagePath&&(df.imagePath=this._detectIconPath()),(this.options.imagePath||df.imagePath)+$l.prototype._getIconUrl.call(this,g)},_stripUrl:function(g){var w=function(P,U,pe){var Ie=U.exec(P);return Ie&&Ie[pe]};return(g=w(g,/^url\((['"])?(.+)\1\)$/,2))&&w(g,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var g=li("div","leaflet-default-icon-path",document.body),w=Sd(g,"background-image")||Sd(g,"backgroundImage");if(document.body.removeChild(g),w=this._stripUrl(w))return w;var P=document.querySelector('link[href$="leaflet.css"]');return P?P.href.substring(0,P.href.length-11-1):""}}),Ar=Pa.extend({initialize:function(g){this._marker=g},addHooks:function(){var g=this._marker._icon;this._draggable||(this._draggable=new Ll(g,g,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Hr(g,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&hs(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(g){var w=this._marker,P=w._map,U=this._marker.options.autoPanSpeed,pe=this._marker.options.autoPanPadding,Ie=Xn(w._icon),Qe=P.getPixelBounds(),Bt=P.getPixelOrigin(),Zt=tt(Qe.min._subtract(Bt).add(pe),Qe.max._subtract(Bt).subtract(pe));if(!Zt.contains(Ie)){var hn=je((Math.max(Zt.max.x,Ie.x)-Zt.max.x)/(Qe.max.x-Zt.max.x)-(Math.min(Zt.min.x,Ie.x)-Zt.min.x)/(Qe.min.x-Zt.min.x),(Math.max(Zt.max.y,Ie.y)-Zt.max.y)/(Qe.max.y-Zt.max.y)-(Math.min(Zt.min.y,Ie.y)-Zt.min.y)/(Qe.min.y-Zt.min.y)).multiplyBy(U);P.panBy(hn,{animate:!1}),this._draggable._newPos._add(hn),this._draggable._startPos._add(hn),vr(w._icon,this._draggable._newPos),this._onDrag(g),this._panRequest=Ne(this._adjustPan.bind(this,g))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(g){this._marker.options.autoPan&&(we(this._panRequest),this._panRequest=Ne(this._adjustPan.bind(this,g)))},_onDrag:function(g){var w=this._marker,P=w._shadow,U=Xn(w._icon),pe=w._map.layerPointToLatLng(U);P&&vr(P,U),w._latlng=pe,g.latlng=pe,g.oldLatLng=this._oldLatLng,w.fire("move",g).fire("drag",g)},_onDragEnd:function(g){we(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",g)}}),hh=ta.extend({options:{icon:new df,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(g,w){H(this,w),this._latlng=Vt(g)},onAdd:function(g){this._zoomAnimated=this._zoomAnimated&&g.options.markerZoomAnimation,this._zoomAnimated&&g.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(g){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&g.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(g){var w=this._latlng;return this._latlng=Vt(g),this.update(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},setZIndexOffset:function(g){return this.options.zIndexOffset=g,this.update()},getIcon:function(){return this.options.icon},setIcon:function(g){return this.options.icon=g,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var g=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(g)}return this},_initIcon:function(){var g=this.options,w="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),P=g.icon.createIcon(this._icon),U=!1;P!==this._icon&&(this._icon&&this._removeIcon(),U=!0,g.title&&(P.title=g.title),"IMG"===P.tagName&&(P.alt=g.alt||"")),Hr(P,w),g.keyboard&&(P.tabIndex="0",P.setAttribute("role","button")),this._icon=P,g.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Dr(P,"focus",this._panOnFocus,this);var pe=g.icon.createShadow(this._shadow),Ie=!1;pe!==this._shadow&&(this._removeShadow(),Ie=!0),pe&&(Hr(pe,w),pe.alt=""),this._shadow=pe,g.opacity<1&&this._updateOpacity(),U&&this.getPane().appendChild(this._icon),this._initInteraction(),pe&&Ie&&this.getPane(g.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&wi(this._icon,"focus",this._panOnFocus,this),cs(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&cs(this._shadow),this._shadow=null},_setPos:function(g){this._icon&&vr(this._icon,g),this._shadow&&vr(this._shadow,g),this._zIndex=g.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(g){this._icon&&(this._icon.style.zIndex=this._zIndex+g)},_animateZoom:function(g){var w=this._map._latLngToNewLayerPoint(this._latlng,g.zoom,g.center).round();this._setPos(w)},_initInteraction:function(){if(this.options.interactive&&(Hr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ar)){var g=this.options.draggable;this.dragging&&(g=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ar(this),g&&this.dragging.enable()}},setOpacity:function(g){return this.options.opacity=g,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var g=this.options.opacity;this._icon&&Bi(this._icon,g),this._shadow&&Bi(this._shadow,g)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var g=this._map;if(g){var w=this.options.icon.options,P=w.iconSize?je(w.iconSize):je(0,0),U=w.iconAnchor?je(w.iconAnchor):je(0,0);g.panInside(this._latlng,{paddingTopLeft:U,paddingBottomRight:P.subtract(U)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Po=ta.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(g){this._renderer=g.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(g){return H(this,g),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&g&&Object.prototype.hasOwnProperty.call(g,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),pf=Po.extend({options:{fill:!0,radius:10},initialize:function(g,w){H(this,w),this._latlng=Vt(g),this._radius=this.options.radius},setLatLng:function(g){var w=this._latlng;return this._latlng=Vt(g),this.redraw(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(g){return this.options.radius=this._radius=g,this.redraw()},getRadius:function(){return this._radius},setStyle:function(g){var w=g&&g.radius||this._radius;return Po.prototype.setStyle.call(this,g),this.setRadius(w),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var g=this._radius,w=this._radiusY||g,P=this._clickTolerance(),U=[g+P,w+P];this._pxBounds=new We(this._point.subtract(U),this._point.add(U))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(g){return g.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var Au=pf.extend({initialize:function(g,w,P){if("number"==typeof w&&(w=K({},P,{radius:w})),H(this,w),this._latlng=Vt(g),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(g){return this._mRadius=g,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var g=[this._radius,this._radiusY||this._radius];return new Pt(this._map.layerPointToLatLng(this._point.subtract(g)),this._map.layerPointToLatLng(this._point.add(g)))},setStyle:Po.prototype.setStyle,_project:function(){var g=this._latlng.lng,w=this._latlng.lat,P=this._map,U=P.options.crs;if(U.distance===rn.distance){var pe=Math.PI/180,Ie=this._mRadius/rn.R/pe,Qe=P.project([w+Ie,g]),Bt=P.project([w-Ie,g]),Zt=Qe.add(Bt).divideBy(2),hn=P.unproject(Zt).lat,Rn=Math.acos((Math.cos(Ie*pe)-Math.sin(w*pe)*Math.sin(hn*pe))/(Math.cos(w*pe)*Math.cos(hn*pe)))/pe;(isNaN(Rn)||0===Rn)&&(Rn=Ie/Math.cos(Math.PI/180*w)),this._point=Zt.subtract(P.getPixelOrigin()),this._radius=isNaN(Rn)?0:Zt.x-P.project([hn,g-Rn]).x,this._radiusY=Zt.y-Qe.y}else{var fr=U.unproject(U.project(this._latlng).subtract([this._mRadius,0]));this._point=P.latLngToLayerPoint(this._latlng),this._radius=this._point.x-P.latLngToLayerPoint(fr).x}this._updateBounds()}});var Bl=Po.extend({options:{smoothFactor:1,noClip:!1},initialize:function(g,w){H(this,w),this._setLatLngs(g)},getLatLngs:function(){return this._latlngs},setLatLngs:function(g){return this._setLatLngs(g),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(g){for(var pe,Ie,w=1/0,P=null,U=Dd,Qe=0,Bt=this._parts.length;Qe<Bt;Qe++)for(var Zt=this._parts[Qe],hn=1,Rn=Zt.length;hn<Rn;hn++){var fr=U(g,pe=Zt[hn-1],Ie=Zt[hn],!0);fr<w&&(w=fr,P=U(g,pe,Ie))}return P&&(P.distance=Math.sqrt(w)),P},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(g,w){return w=w||this._defaultShape(),g=Vt(g),w.push(g),this._bounds.extend(g),this.redraw()},_setLatLngs:function(g){this._bounds=new Pt,this._latlngs=this._convertLatLngs(g)},_defaultShape:function(){return xo(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(g){for(var w=[],P=xo(g),U=0,pe=g.length;U<pe;U++)P?(w[U]=Vt(g[U]),this._bounds.extend(w[U])):w[U]=this._convertLatLngs(g[U]);return w},_project:function(){var g=new We;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,g),this._bounds.isValid()&&g.isValid()&&(this._rawPxBounds=g,this._updateBounds())},_updateBounds:function(){var g=this._clickTolerance(),w=new Mt(g,g);!this._rawPxBounds||(this._pxBounds=new We([this._rawPxBounds.min.subtract(w),this._rawPxBounds.max.add(w)]))},_projectLatlngs:function(g,w,P){var Ie,Qe,pe=g.length;if(g[0]instanceof xt){for(Qe=[],Ie=0;Ie<pe;Ie++)Qe[Ie]=this._map.latLngToLayerPoint(g[Ie]),P.extend(Qe[Ie]);w.push(Qe)}else for(Ie=0;Ie<pe;Ie++)this._projectLatlngs(g[Ie],w,P)},_clipPoints:function(){var g=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(g)){if(this.options.noClip)return void(this._parts=this._rings);var P,U,pe,Ie,Qe,Bt,Zt,w=this._parts;for(P=0,pe=0,Ie=this._rings.length;P<Ie;P++)for(U=0,Qe=(Zt=this._rings[P]).length;U<Qe-1;U++)(Bt=Nu(Zt[U],Zt[U+1],g,U,!0))&&(w[pe]=w[pe]||[],w[pe].push(Bt[0]),(Bt[1]!==Zt[U+1]||U===Qe-2)&&(w[pe].push(Bt[1]),pe++))}},_simplifyPoints:function(){for(var g=this._parts,w=this.options.smoothFactor,P=0,U=g.length;P<U;P++)g[P]=Cb(g[P],w)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(g,w){var P,U,pe,Ie,Qe,Bt,Zt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(g))return!1;for(P=0,Ie=this._parts.length;P<Ie;P++)for(U=0,pe=(Qe=(Bt=this._parts[P]).length)-1;U<Qe;pe=U++)if((w||0!==U)&&Sb(g,Bt[pe],Bt[U])<=Zt)return!0;return!1}});Bl._flat=Md;var Co=Bl.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xi(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(g){var w=Bl.prototype._convertLatLngs.call(this,g),P=w.length;return P>=2&&w[0]instanceof xt&&w[0].equals(w[P-1])&&w.pop(),w},_setLatLngs:function(g){Bl.prototype._setLatLngs.call(this,g),xo(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return xo(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var g=this._renderer._bounds,w=this.options.weight,P=new Mt(w,w);if(g=new We(g.min.subtract(P),g.max.add(P)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(g)){if(this.options.noClip)return void(this._parts=this._rings);for(var Ie,U=0,pe=this._rings.length;U<pe;U++)(Ie=gs(this._rings[U],g,!0)).length&&this._parts.push(Ie)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(g){var P,U,pe,Ie,Qe,Bt,Zt,hn,w=!1;if(!this._pxBounds||!this._pxBounds.contains(g))return!1;for(Ie=0,Zt=this._parts.length;Ie<Zt;Ie++)for(Qe=0,Bt=(hn=(P=this._parts[Ie]).length)-1;Qe<hn;Bt=Qe++)(U=P[Qe]).y>g.y!=(pe=P[Bt]).y>g.y&&g.x<(pe.x-U.x)*(g.y-U.y)/(pe.y-U.y)+U.x&&(w=!w);return w||Bl.prototype._containsPoint.call(this,g,!0)}});var Iu=tu.extend({initialize:function(g,w){H(this,w),this._layers={},g&&this.addData(g)},addData:function(g){var P,U,pe,w=ce(g)?g:g.features;if(w){for(P=0,U=w.length;P<U;P++)((pe=w[P]).geometries||pe.geometry||pe.features||pe.coordinates)&&this.addData(pe);return this}var Ie=this.options;if(Ie.filter&&!Ie.filter(g))return this;var Qe=kd(g,Ie);return Qe?(Qe.feature=tr(g),Qe.defaultOptions=Qe.options,this.resetStyle(Qe),Ie.onEachFeature&&Ie.onEachFeature(g,Qe),this.addLayer(Qe)):this},resetStyle:function(g){return void 0===g?this.eachLayer(this.resetStyle,this):(g.options=K({},g.defaultOptions),this._setLayerStyle(g,this.options.style),this)},setStyle:function(g){return this.eachLayer(function(w){this._setLayerStyle(w,g)},this)},_setLayerStyle:function(g,w){g.setStyle&&("function"==typeof w&&(w=w(g.feature)),g.setStyle(w))}});function kd(g,w){var Bt,Zt,hn,Rn,P="Feature"===g.type?g.geometry:g,U=P?P.coordinates:null,pe=[],Ie=w&&w.pointToLayer,Qe=w&&w.coordsToLatLng||Si;if(!U&&!P)return null;switch(P.type){case"Point":return Db(Ie,g,Bt=Qe(U),w);case"MultiPoint":for(hn=0,Rn=U.length;hn<Rn;hn++)Bt=Qe(U[hn]),pe.push(Db(Ie,g,Bt,w));return new tu(pe);case"LineString":case"MultiLineString":return Zt=Dm(U,"LineString"===P.type?0:1,Qe),new Bl(Zt,w);case"Polygon":case"MultiPolygon":return Zt=Dm(U,"Polygon"===P.type?1:2,Qe),new Co(Zt,w);case"GeometryCollection":for(hn=0,Rn=P.geometries.length;hn<Rn;hn++){var fr=kd({geometry:P.geometries[hn],type:"Feature",properties:g.properties},w);fr&&pe.push(fr)}return new tu(pe);case"FeatureCollection":for(hn=0,Rn=P.features.length;hn<Rn;hn++){var Wr=kd(P.features[hn],w);Wr&&pe.push(Wr)}return new tu(pe);default:throw new Error("Invalid GeoJSON object.")}}function Db(g,w,P,U){return g?g(w,P):new hh(P,U&&U.markersInheritOptions&&U)}function Si(g){return new xt(g[1],g[0],g[2])}function Dm(g,w,P){for(var Qe,U=[],pe=0,Ie=g.length;pe<Ie;pe++)Qe=w?Dm(g[pe],w-1,P):(P||Si)(g[pe]),U.push(Qe);return U}function jv(g,w){return void 0!==(g=Vt(g)).alt?[ge(g.lng,w),ge(g.lat,w),ge(g.alt,w)]:[ge(g.lng,w),ge(g.lat,w)]}function Du(g,w,P,U){for(var pe=[],Ie=0,Qe=g.length;Ie<Qe;Ie++)pe.push(w?Du(g[Ie],xo(g[Ie])?0:w-1,P,U):jv(g[Ie],U));return!w&&P&&pe.push(pe[0].slice()),pe}function cr(g,w){return g.feature?K({},g.feature,{geometry:w}):tr(w)}function tr(g){return"Feature"===g.type||"FeatureCollection"===g.type?g:{type:"Feature",properties:{},geometry:g}}var mf={toGeoJSON:function(g){return cr(this,{type:"Point",coordinates:jv(this.getLatLng(),g)})}};function fh(g,w){return new Iu(g,w)}hh.include(mf),Au.include(mf),pf.include(mf),Bl.include({toGeoJSON:function(g){var w=!xo(this._latlngs);return cr(this,{type:(w?"Multi":"")+"LineString",coordinates:Du(this._latlngs,w?1:0,!1,g)})}}),Co.include({toGeoJSON:function(g){var w=!xo(this._latlngs),P=w&&!xo(this._latlngs[0]),U=Du(this._latlngs,P?2:w?1:0,!0,g);return w||(U=[U]),cr(this,{type:(P?"Multi":"")+"Polygon",coordinates:U})}}),Tu.include({toMultiPoint:function(g){var w=[];return this.eachLayer(function(P){w.push(P.toGeoJSON(g).geometry.coordinates)}),cr(this,{type:"MultiPoint",coordinates:w})},toGeoJSON:function(g){var w=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===w)return this.toMultiPoint(g);var P="GeometryCollection"===w,U=[];return this.eachLayer(function(pe){if(pe.toGeoJSON){var Ie=pe.toGeoJSON(g);if(P)U.push(Ie.geometry);else{var Qe=tr(Ie);"FeatureCollection"===Qe.type?U.push.apply(U,Qe.features):U.push(Qe)}}}),P?cr(this,{geometries:U,type:"GeometryCollection"}):{type:"FeatureCollection",features:U}}});var qv=fh,Lo=ta.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(g,w,P){this._url=g,this._bounds=Ue(w),H(this,P)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Hr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){cs(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(g){return this.options.opacity=g,this._image&&this._updateOpacity(),this},setStyle:function(g){return g.opacity&&this.setOpacity(g.opacity),this},bringToFront:function(){return this._map&&Ro(this._image),this},bringToBack:function(){return this._map&&or(this._image),this},setUrl:function(g){return this._url=g,this._image&&(this._image.src=g),this},setBounds:function(g){return this._bounds=Ue(g),this._map&&this._reset(),this},getEvents:function(){var g={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(g.zoomanim=this._animateZoom),g},setZIndex:function(g){return this.options.zIndex=g,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var g="IMG"===this._url.tagName,w=this._image=g?this._url:li("img");Hr(w,"leaflet-image-layer"),this._zoomAnimated&&Hr(w,"leaflet-zoom-animated"),this.options.className&&Hr(w,this.options.className),w.onselectstart=ee,w.onmousemove=ee,w.onload=re(this.fire,this,"load"),w.onerror=re(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(w.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),g?this._url=w.src:(w.src=this._url,w.alt=this.options.alt)},_animateZoom:function(g){var w=this._map.getZoomScale(g.zoom),P=this._map._latLngBoundsToNewLayerBounds(this._bounds,g.zoom,g.center).min;_c(this._image,P,w)},_reset:function(){var g=this._image,w=new We(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),P=w.getSize();vr(g,w.min),g.style.width=P.x+"px",g.style.height=P.y+"px"},_updateOpacity:function(){Bi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var g=this.options.errorOverlayUrl;g&&this._url!==g&&(this._url=g,this._image.src=g)},getCenter:function(){return this._bounds.getCenter()}}),Mm=Lo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var g="VIDEO"===this._url.tagName,w=this._image=g?this._url:li("video");if(Hr(w,"leaflet-image-layer"),this._zoomAnimated&&Hr(w,"leaflet-zoom-animated"),this.options.className&&Hr(w,this.options.className),w.onselectstart=ee,w.onmousemove=ee,w.onloadeddata=re(this.fire,this,"load"),g){for(var P=w.getElementsByTagName("source"),U=[],pe=0;pe<P.length;pe++)U.push(P[pe].src);this._url=P.length>0?U:[w.src]}else{ce(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(w.style,"objectFit")&&(w.style.objectFit="fill"),w.autoplay=!!this.options.autoplay,w.loop=!!this.options.loop,w.muted=!!this.options.muted,w.playsInline=!!this.options.playsInline;for(var Ie=0;Ie<this._url.length;Ie++){var Qe=li("source");Qe.src=this._url[Ie],w.appendChild(Qe)}}}});var Mb=Lo.extend({_initImage:function(){var g=this._image=this._url;Hr(g,"leaflet-image-layer"),this._zoomAnimated&&Hr(g,"leaflet-zoom-animated"),this.options.className&&Hr(g,this.options.className),g.onselectstart=ee,g.onmousemove=ee}});var Vr=ta.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(g,w){g&&(g instanceof xt||ce(g))?(this._latlng=Vt(g),H(this,w)):(H(this,g),this._source=w),this.options.content&&(this._content=this.options.content)},openOn:function(g){return(g=arguments.length?g:this._source._map).hasLayer(this)||g.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(g){return this._map?this.close():(arguments.length?this._source=g:g=this._source,this._prepareOpen(),this.openOn(g._map)),this},onAdd:function(g){this._zoomAnimated=g._zoomAnimated,this._container||this._initLayout(),g._fadeAnimated&&Bi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),g._fadeAnimated&&Bi(this._container,1),this.bringToFront(),this.options.interactive&&(Hr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(g){g._fadeAnimated?(Bi(this._container,0),this._removeTimeout=setTimeout(re(cs,void 0,this._container),200)):cs(this._container),this.options.interactive&&(hs(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(g){return this._latlng=Vt(g),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(g){return this._content=g,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var g={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(g.zoomanim=this._animateZoom),g},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ro(this._container),this},bringToBack:function(){return this._map&&or(this._container),this},_prepareOpen:function(g){var w=this._source;if(!w._map)return!1;if(w instanceof tu){w=null;var P=this._source._layers;for(var U in P)if(P[U]._map){w=P[U];break}if(!w)return!1;this._source=w}if(!g)if(w.getCenter)g=w.getCenter();else if(w.getLatLng)g=w.getLatLng();else{if(!w.getBounds)throw new Error("Unable to get source layer LatLng.");g=w.getBounds().getCenter()}return this.setLatLng(g),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var g=this._contentNode,w="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof w)g.innerHTML=w;else{for(;g.hasChildNodes();)g.removeChild(g.firstChild);g.appendChild(w)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var g=this._map.latLngToLayerPoint(this._latlng),w=je(this.options.offset),P=this._getAnchor();this._zoomAnimated?vr(this._container,g.add(P)):w=w.add(g).add(P);var U=this._containerBottom=-w.y,pe=this._containerLeft=-Math.round(this._containerWidth/2)+w.x;this._container.style.bottom=U+"px",this._container.style.left=pe+"px"}},_getAnchor:function(){return[0,0]}});ei.include({_initOverlay:function(g,w,P,U){var pe=w;return pe instanceof g||(pe=new g(U).setContent(w)),P&&pe.setLatLng(P),pe}}),ta.include({_initOverlay:function(g,w,P,U){var pe=P;return pe instanceof g?(H(pe,U),pe._source=this):(pe=w&&!U?w:new g(U,this)).setContent(P),pe}});var Od=Vr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(g){return!(g=arguments.length?g:this._source._map).hasLayer(this)&&g._popup&&g._popup.options.autoClose&&g.removeLayer(g._popup),g._popup=this,Vr.prototype.openOn.call(this,g)},onAdd:function(g){Vr.prototype.onAdd.call(this,g),g.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Po||this._source.on("preclick",eu))},onRemove:function(g){Vr.prototype.onRemove.call(this,g),g.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Po||this._source.off("preclick",eu))},getEvents:function(){var g=Vr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(g.preclick=this.close),this.options.keepInView&&(g.moveend=this._adjustPan),g},_initLayout:function(){var g="leaflet-popup",w=this._container=li("div",g+" "+(this.options.className||"")+" leaflet-zoom-animated"),P=this._wrapper=li("div",g+"-content-wrapper",w);if(this._contentNode=li("div",g+"-content",P),lh(w),Sm(this._contentNode),Dr(w,"contextmenu",eu),this._tipContainer=li("div",g+"-tip-container",w),this._tip=li("div",g+"-tip",this._tipContainer),this.options.closeButton){var U=this._closeButton=li("a",g+"-close-button",w);U.setAttribute("role","button"),U.setAttribute("aria-label","Close popup"),U.href="#close",U.innerHTML='<span aria-hidden="true">&#215;</span>',Dr(U,"click",function(pe){Zs(pe),this.close()},this)}},_updateLayout:function(){var g=this._contentNode,w=g.style;w.width="",w.whiteSpace="nowrap";var P=g.offsetWidth;P=Math.min(P,this.options.maxWidth),P=Math.max(P,this.options.minWidth),w.width=P+1+"px",w.whiteSpace="",w.height="";var pe=this.options.maxHeight,Ie="leaflet-popup-scrolled";pe&&g.offsetHeight>pe?(w.height=pe+"px",Hr(g,Ie)):hs(g,Ie),this._containerWidth=this._container.offsetWidth},_animateZoom:function(g){var w=this._map._latLngToNewLayerPoint(this._latlng,g.zoom,g.center),P=this._getAnchor();vr(this._container,w.add(P))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)return void(this._autopanning=!1);var g=this._map,w=parseInt(Sd(this._container,"marginBottom"),10)||0,P=this._container.offsetHeight+w,U=this._containerWidth,pe=new Mt(this._containerLeft,-P-this._containerBottom);pe._add(Xn(this._container));var Ie=g.layerPointToContainerPoint(pe),Qe=je(this.options.autoPanPadding),Bt=je(this.options.autoPanPaddingTopLeft||Qe),Zt=je(this.options.autoPanPaddingBottomRight||Qe),hn=g.getSize(),Rn=0,fr=0;Ie.x+U+Zt.x>hn.x&&(Rn=Ie.x+U-hn.x+Zt.x),Ie.x-Rn-Bt.x<0&&(Rn=Ie.x-Bt.x),Ie.y+P+Zt.y>hn.y&&(fr=Ie.y+P-hn.y+Zt.y),Ie.y-fr-Bt.y<0&&(fr=Ie.y-Bt.y),(Rn||fr)&&(this.options.keepInView&&(this._autopanning=!0),g.fire("autopanstart").panBy([Rn,fr]))}},_getAnchor:function(){return je(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});ei.mergeOptions({closePopupOnClick:!0}),ei.include({openPopup:function(g,w,P){return this._initOverlay(Od,g,w,P).openOn(this),this},closePopup:function(g){return(g=arguments.length?g:this._popup)&&g.close(),this}}),ta.include({bindPopup:function(g,w){return this._popup=this._initOverlay(Od,this._popup,g,w),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(g){return this._popup&&(this instanceof tu||(this._popup._source=this),this._popup._prepareOpen(g||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(g){return this._popup&&this._popup.setContent(g),this},getPopup:function(){return this._popup},_openPopup:function(g){if(this._popup&&this._map){xc(g);var w=g.layer||g.target;if(this._popup._source===w&&!(w instanceof Po))return void(this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(g.latlng));this._popup._source=w,this.openPopup(g.latlng)}},_movePopup:function(g){this._popup.setLatLng(g.latlng)},_onKeyPress:function(g){13===g.originalEvent.keyCode&&this._openPopup(g)}});var gf=Vr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(g){Vr.prototype.onAdd.call(this,g),this.setOpacity(this.options.opacity),g.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(g){Vr.prototype.onRemove.call(this,g),g.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var g=Vr.prototype.getEvents.call(this);return this.options.permanent||(g.preclick=this.close),g},_initLayout:function(){this._contentNode=this._container=li("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide")),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+se(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(g){var w,P,U=this._map,pe=this._container,Ie=U.latLngToContainerPoint(U.getCenter()),Qe=U.layerPointToContainerPoint(g),Bt=this.options.direction,Zt=pe.offsetWidth,hn=pe.offsetHeight,Rn=je(this.options.offset),fr=this._getAnchor();"top"===Bt?(w=Zt/2,P=hn):"bottom"===Bt?(w=Zt/2,P=0):"center"===Bt?(w=Zt/2,P=hn/2):"right"===Bt?(w=0,P=hn/2):"left"===Bt?(w=Zt,P=hn/2):Qe.x<Ie.x?(Bt="right",w=0,P=hn/2):(Bt="left",w=Zt+2*(Rn.x+fr.x),P=hn/2),g=g.subtract(je(w,P,!0)).add(Rn).add(fr),hs(pe,"leaflet-tooltip-right"),hs(pe,"leaflet-tooltip-left"),hs(pe,"leaflet-tooltip-top"),hs(pe,"leaflet-tooltip-bottom"),Hr(pe,"leaflet-tooltip-"+Bt),vr(pe,g)},_updatePosition:function(){var g=this._map.latLngToLayerPoint(this._latlng);this._setPosition(g)},setOpacity:function(g){this.options.opacity=g,this._container&&Bi(this._container,g)},_animateZoom:function(g){var w=this._map._latLngToNewLayerPoint(this._latlng,g.zoom,g.center);this._setPosition(w)},_getAnchor:function(){return je(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});ei.include({openTooltip:function(g,w,P){return this._initOverlay(gf,g,w,P).openOn(this),this},closeTooltip:function(g){return g.close(),this}}),ta.include({bindTooltip:function(g,w){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(gf,this._tooltip,g,w),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(g){if(g||!this._tooltipHandlersAdded){var w=g?"off":"on",P={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?P.add=this._openTooltip:(P.mouseover=this._openTooltip,P.mouseout=this.closeTooltip,P.click=this._openTooltip,this._map?this._addFocusListeners():P.add=this._addFocusListeners),this._tooltip.options.sticky&&(P.mousemove=this._moveTooltip),this[w](P),this._tooltipHandlersAdded=!g}},openTooltip:function(g){return this._tooltip&&(this instanceof tu||(this._tooltip._source=this),this._tooltip._prepareOpen(g)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(g){return this._tooltip&&this._tooltip.setContent(g),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(g){var w=g.getElement();w&&(Dr(w,"focus",function(){this._tooltip._source=g,this.openTooltip()},this),Dr(w,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(g){var w=g.getElement();w&&w.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(g){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=g.layer||g.target,this.openTooltip(this._tooltip.options.sticky?g.latlng:void 0))},_moveTooltip:function(g){var P,U,w=g.latlng;this._tooltip.options.sticky&&g.originalEvent&&(P=this._map.mouseEventToContainerPoint(g.originalEvent),U=this._map.containerPointToLayerPoint(P),w=this._map.layerPointToLatLng(U)),this._tooltip.setLatLng(w)}});var sr=$l.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(g){var w=g&&"DIV"===g.tagName?g:document.createElement("div"),P=this.options;if(P.html instanceof Element?(rf(w),w.appendChild(P.html)):w.innerHTML=!1!==P.html?P.html:"",P.bgPos){var U=je(P.bgPos);w.style.backgroundPosition=-U.x+"px "+-U.y+"px"}return this._setIconStyles(w,"icon"),w},createShadow:function(){return null}});$l.Default=df;var vs=ta.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Bn.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(g){H(this,g)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(g){g._addZoomLimit(this)},onRemove:function(g){this._removeAllTiles(),cs(this._container),g._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ro(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(or(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(g){return this.options.opacity=g,this._updateOpacity(),this},setZIndex:function(g){return this.options.zIndex=g,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var g=this._clampZoom(this._map.getZoom());g!==this._tileZoom&&(this._tileZoom=g,this._updateLevels()),this._update()}return this},getEvents:function(){var g={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=be(this._onMoveEnd,this.options.updateInterval,this)),g.move=this._onMove),this._zoomAnimated&&(g.zoomanim=this._animateZoom),g},createTile:function(){return document.createElement("div")},getTileSize:function(){var g=this.options.tileSize;return g instanceof Mt?g:new Mt(g,g)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(g){for(var Ie,w=this.getPane().children,P=-g(-1/0,1/0),U=0,pe=w.length;U<pe;U++)Ie=w[U].style.zIndex,w[U]!==this._container&&Ie&&(P=g(P,+Ie));isFinite(P)&&(this.options.zIndex=P+g(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Bn.ielt9){Bi(this._container,this.options.opacity);var g=+new Date,w=!1,P=!1;for(var U in this._tiles){var pe=this._tiles[U];if(pe.current&&pe.loaded){var Ie=Math.min(1,(g-pe.loaded)/200);Bi(pe.el,Ie),Ie<1?w=!0:(pe.active?P=!0:this._onOpaqueTile(pe),pe.active=!0)}}P&&!this._noPrune&&this._pruneTiles(),w&&(we(this._fadeFrame),this._fadeFrame=Ne(this._updateOpacity,this))}},_onOpaqueTile:ee,_initContainer:function(){this._container||(this._container=li("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var g=this._tileZoom,w=this.options.maxZoom;if(void 0!==g){for(var P in this._levels)P=Number(P),this._levels[P].el.children.length||P===g?(this._levels[P].el.style.zIndex=w-Math.abs(g-P),this._onUpdateLevel(P)):(cs(this._levels[P].el),this._removeTilesAtZoom(P),this._onRemoveLevel(P),delete this._levels[P]);var U=this._levels[g],pe=this._map;return U||((U=this._levels[g]={}).el=li("div","leaflet-tile-container leaflet-zoom-animated",this._container),U.el.style.zIndex=w,U.origin=pe.project(pe.unproject(pe.getPixelOrigin()),g).round(),U.zoom=g,this._setZoomTransform(U,pe.getCenter(),pe.getZoom()),this._onCreateLevel(U)),this._level=U,U}},_onUpdateLevel:ee,_onRemoveLevel:ee,_onCreateLevel:ee,_pruneTiles:function(){if(this._map){var g,w,P=this._map.getZoom();if(P>this.options.maxZoom||P<this.options.minZoom)return void this._removeAllTiles();for(g in this._tiles)(w=this._tiles[g]).retain=w.current;for(g in this._tiles)if((w=this._tiles[g]).current&&!w.active){var U=w.coords;this._retainParent(U.x,U.y,U.z,U.z-5)||this._retainChildren(U.x,U.y,U.z,U.z+2)}for(g in this._tiles)this._tiles[g].retain||this._removeTile(g)}},_removeTilesAtZoom:function(g){for(var w in this._tiles)this._tiles[w].coords.z===g&&this._removeTile(w)},_removeAllTiles:function(){for(var g in this._tiles)this._removeTile(g)},_invalidateAll:function(){for(var g in this._levels)cs(this._levels[g].el),this._onRemoveLevel(Number(g)),delete this._levels[g];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(g,w,P,U){var pe=Math.floor(g/2),Ie=Math.floor(w/2),Qe=P-1,Bt=new Mt(+pe,+Ie);Bt.z=+Qe;var Zt=this._tileCoordsToKey(Bt),hn=this._tiles[Zt];return hn&&hn.active?(hn.retain=!0,!0):(hn&&hn.loaded&&(hn.retain=!0),Qe>U&&this._retainParent(pe,Ie,Qe,U))},_retainChildren:function(g,w,P,U){for(var pe=2*g;pe<2*g+2;pe++)for(var Ie=2*w;Ie<2*w+2;Ie++){var Qe=new Mt(pe,Ie);Qe.z=P+1;var Bt=this._tileCoordsToKey(Qe),Zt=this._tiles[Bt];Zt&&Zt.active?Zt.retain=!0:(Zt&&Zt.loaded&&(Zt.retain=!0),P+1<U&&this._retainChildren(pe,Ie,P+1,U))}},_resetView:function(g){var w=g&&(g.pinch||g.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),w,w)},_animateZoom:function(g){this._setView(g.center,g.zoom,!0,g.noUpdate)},_clampZoom:function(g){var w=this.options;return void 0!==w.minNativeZoom&&g<w.minNativeZoom?w.minNativeZoom:void 0!==w.maxNativeZoom&&w.maxNativeZoom<g?w.maxNativeZoom:g},_setView:function(g,w,P,U){var pe=Math.round(w);pe=void 0!==this.options.maxZoom&&pe>this.options.maxZoom||void 0!==this.options.minZoom&&pe<this.options.minZoom?void 0:this._clampZoom(pe),(!U||this.options.updateWhenZooming&&pe!==this._tileZoom)&&(this._tileZoom=pe,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==pe&&this._update(g),P||this._pruneTiles(),this._noPrune=!!P),this._setZoomTransforms(g,w)},_setZoomTransforms:function(g,w){for(var P in this._levels)this._setZoomTransform(this._levels[P],g,w)},_setZoomTransform:function(g,w,P){var U=this._map.getZoomScale(P,g.zoom),pe=g.origin.multiplyBy(U).subtract(this._map._getNewPixelOrigin(w,P)).round();Bn.any3d?_c(g.el,pe,U):vr(g.el,pe)},_resetGrid:function(){var g=this._map,w=g.options.crs,P=this._tileSize=this.getTileSize(),U=this._tileZoom,pe=this._map.getPixelWorldBounds(this._tileZoom);pe&&(this._globalTileRange=this._pxBoundsToTileRange(pe)),this._wrapX=w.wrapLng&&!this.options.noWrap&&[Math.floor(g.project([0,w.wrapLng[0]],U).x/P.x),Math.ceil(g.project([0,w.wrapLng[1]],U).x/P.y)],this._wrapY=w.wrapLat&&!this.options.noWrap&&[Math.floor(g.project([w.wrapLat[0],0],U).y/P.x),Math.ceil(g.project([w.wrapLat[1],0],U).y/P.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(g){var w=this._map,P=w._animatingZoom?Math.max(w._animateToZoom,w.getZoom()):w.getZoom(),U=w.getZoomScale(P,this._tileZoom),pe=w.project(g,this._tileZoom).floor(),Ie=w.getSize().divideBy(2*U);return new We(pe.subtract(Ie),pe.add(Ie))},_update:function(g){var w=this._map;if(w){var P=this._clampZoom(w.getZoom());if(void 0===g&&(g=w.getCenter()),void 0!==this._tileZoom){var U=this._getTiledPixelBounds(g),pe=this._pxBoundsToTileRange(U),Ie=pe.getCenter(),Qe=[],Bt=this.options.keepBuffer,Zt=new We(pe.getBottomLeft().subtract([Bt,-Bt]),pe.getTopRight().add([Bt,-Bt]));if(!(isFinite(pe.min.x)&&isFinite(pe.min.y)&&isFinite(pe.max.x)&&isFinite(pe.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var hn in this._tiles){var Rn=this._tiles[hn].coords;(Rn.z!==this._tileZoom||!Zt.contains(new Mt(Rn.x,Rn.y)))&&(this._tiles[hn].current=!1)}if(Math.abs(P-this._tileZoom)>1)return void this._setView(g,P);for(var fr=pe.min.y;fr<=pe.max.y;fr++)for(var Wr=pe.min.x;Wr<=pe.max.x;Wr++){var $o=new Mt(Wr,fr);if($o.z=this._tileZoom,this._isValidTile($o)){var so=this._tiles[this._tileCoordsToKey($o)];so?so.current=!0:Qe.push($o)}}if(Qe.sort(function(Nc,Rm){return Nc.distanceTo(Ie)-Rm.distanceTo(Ie)}),0!==Qe.length){this._loading||(this._loading=!0,this.fire("loading"));var Fd=document.createDocumentFragment();for(Wr=0;Wr<Qe.length;Wr++)this._addTile(Qe[Wr],Fd);this._level.el.appendChild(Fd)}}}},_isValidTile:function(g){var w=this._map.options.crs;if(!w.infinite){var P=this._globalTileRange;if(!w.wrapLng&&(g.x<P.min.x||g.x>P.max.x)||!w.wrapLat&&(g.y<P.min.y||g.y>P.max.y))return!1}if(!this.options.bounds)return!0;var U=this._tileCoordsToBounds(g);return Ue(this.options.bounds).overlaps(U)},_keyToBounds:function(g){return this._tileCoordsToBounds(this._keyToTileCoords(g))},_tileCoordsToNwSe:function(g){var w=this._map,P=this.getTileSize(),U=g.scaleBy(P),pe=U.add(P);return[w.unproject(U,g.z),w.unproject(pe,g.z)]},_tileCoordsToBounds:function(g){var w=this._tileCoordsToNwSe(g),P=new Pt(w[0],w[1]);return this.options.noWrap||(P=this._map.wrapLatLngBounds(P)),P},_tileCoordsToKey:function(g){return g.x+":"+g.y+":"+g.z},_keyToTileCoords:function(g){var w=g.split(":"),P=new Mt(+w[0],+w[1]);return P.z=+w[2],P},_removeTile:function(g){var w=this._tiles[g];!w||(cs(w.el),delete this._tiles[g],this.fire("tileunload",{tile:w.el,coords:this._keyToTileCoords(g)}))},_initTile:function(g){Hr(g,"leaflet-tile");var w=this.getTileSize();g.style.width=w.x+"px",g.style.height=w.y+"px",g.onselectstart=ee,g.onmousemove=ee,Bn.ielt9&&this.options.opacity<1&&Bi(g,this.options.opacity)},_addTile:function(g,w){var P=this._getTilePos(g),U=this._tileCoordsToKey(g),pe=this.createTile(this._wrapCoords(g),re(this._tileReady,this,g));this._initTile(pe),this.createTile.length<2&&Ne(re(this._tileReady,this,g,null,pe)),vr(pe,P),this._tiles[U]={el:pe,coords:g,current:!0},w.appendChild(pe),this.fire("tileloadstart",{tile:pe,coords:g})},_tileReady:function(g,w,P){w&&this.fire("tileerror",{error:w,tile:P,coords:g});var U=this._tileCoordsToKey(g);(P=this._tiles[U])&&(P.loaded=+new Date,this._map._fadeAnimated?(Bi(P.el,0),we(this._fadeFrame),this._fadeFrame=Ne(this._updateOpacity,this)):(P.active=!0,this._pruneTiles()),w||(Hr(P.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:P.el,coords:g})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Bn.ielt9||!this._map._fadeAnimated?Ne(this._pruneTiles,this):setTimeout(re(this._pruneTiles,this),250)))},_getTilePos:function(g){return g.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(g){var w=new Mt(this._wrapX?V(g.x,this._wrapX):g.x,this._wrapY?V(g.y,this._wrapY):g.y);return w.z=g.z,w},_pxBoundsToTileRange:function(g){var w=this.getTileSize();return new We(g.min.unscaleBy(w).floor(),g.max.unscaleBy(w).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var g in this._tiles)if(!this._tiles[g].loaded)return!1;return!0}});var La=vs.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(g,w){this._url=g,(w=H(this,w)).detectRetina&&Bn.retina&&w.maxZoom>0?(w.tileSize=Math.floor(w.tileSize/2),w.zoomReverse?(w.zoomOffset--,w.minZoom=Math.min(w.maxZoom,w.minZoom+1)):(w.zoomOffset++,w.maxZoom=Math.max(w.minZoom,w.maxZoom-1)),w.minZoom=Math.max(0,w.minZoom)):w.zoomReverse?w.minZoom=Math.min(w.maxZoom,w.minZoom):w.maxZoom=Math.max(w.minZoom,w.maxZoom),"string"==typeof w.subdomains&&(w.subdomains=w.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(g,w){return this._url===g&&void 0===w&&(w=!0),this._url=g,w||this.redraw(),this},createTile:function(g,w){var P=document.createElement("img");return Dr(P,"load",re(this._tileOnLoad,this,w,P)),Dr(P,"error",re(this._tileOnError,this,w,P)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(P.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(P.referrerPolicy=this.options.referrerPolicy),P.alt="",P.src=this.getTileUrl(g),P},getTileUrl:function(g){var w={r:Bn.retina?"@2x":"",s:this._getSubdomain(g),x:g.x,y:g.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var P=this._globalTileRange.max.y-g.y;this.options.tms&&(w.y=P),w["-y"]=P}return te(this._url,K(w,this.options))},_tileOnLoad:function(g,w){Bn.ielt9?setTimeout(re(g,this,null,w),0):g(null,w)},_tileOnError:function(g,w,P){var U=this.options.errorTileUrl;U&&w.getAttribute("src")!==U&&(w.src=U),g(P,w)},_onTileRemove:function(g){g.tile.onload=null},_getZoomForUrl:function(){var g=this._tileZoom;return this.options.zoomReverse&&(g=this.options.maxZoom-g),g+this.options.zoomOffset},_getSubdomain:function(g){var w=Math.abs(g.x+g.y)%this.options.subdomains.length;return this.options.subdomains[w]},_abortLoading:function(){var g,w;for(g in this._tiles)if(this._tiles[g].coords.z!==this._tileZoom&&((w=this._tiles[g].el).onload=ee,w.onerror=ee,!w.complete)){w.src=Pe;var P=this._tiles[g].coords;cs(w),delete this._tiles[g],this.fire("tileabort",{tile:w,coords:P})}},_removeTile:function(g){var w=this._tiles[g];if(w)return w.el.setAttribute("src",Pe),vs.prototype._removeTile.call(this,g)},_tileReady:function(g,w,P){if(this._map&&(!P||P.getAttribute("src")!==Pe))return vs.prototype._tileReady.call(this,g,w,P)}});function $a(g,w){return new La(g,w)}var Sc=La.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(g,w){this._url=g;var P=K({},this.defaultWmsParams);for(var U in w)U in this.options||(P[U]=w[U]);var pe=(w=H(this,w)).detectRetina&&Bn.retina?2:1,Ie=this.getTileSize();P.width=Ie.x*pe,P.height=Ie.y*pe,this.wmsParams=P},onAdd:function(g){this._crs=this.options.crs||g.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,La.prototype.onAdd.call(this,g)},getTileUrl:function(g){var w=this._tileCoordsToNwSe(g),P=this._crs,U=tt(P.project(w[0]),P.project(w[1])),pe=U.min,Ie=U.max,Qe=(this._wmsVersion>=1.3&&this._crs===Ci?[pe.y,pe.x,Ie.y,Ie.x]:[pe.x,pe.y,Ie.x,Ie.y]).join(","),Bt=La.prototype.getTileUrl.call(this,g);return Bt+Y(this.wmsParams,Bt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Qe},setParams:function(g,w){return K(this.wmsParams,g),w||this.redraw(),this}});La.WMS=Sc,$a.wms=function km(g,w){return new Sc(g,w)};var _a=ta.extend({options:{padding:.1},initialize:function(g){H(this,g),se(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Hr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var g={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(g.zoomanim=this._onAnimZoom),g},_onAnimZoom:function(g){this._updateTransform(g.center,g.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(g,w){var P=this._map.getZoomScale(w,this._zoom),U=this._map.getSize().multiplyBy(.5+this.options.padding),pe=this._map.project(this._center,w),Ie=U.multiplyBy(-P).add(pe).subtract(this._map._getNewPixelOrigin(g,w));Bn.any3d?_c(this._container,Ie,P):vr(this._container,Ie)},_reset:function(){for(var g in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[g]._reset()},_onZoomEnd:function(){for(var g in this._layers)this._layers[g]._project()},_updatePaths:function(){for(var g in this._layers)this._layers[g]._update()},_update:function(){var g=this.options.padding,w=this._map.getSize(),P=this._map.containerPointToLayerPoint(w.multiplyBy(-g)).round();this._bounds=new We(P,P.add(w.multiplyBy(1+2*g)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),vf=_a.extend({options:{tolerance:0},getEvents:function(){var g=_a.prototype.getEvents.call(this);return g.viewprereset=this._onViewPreReset,g},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){_a.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var g=this._container=document.createElement("canvas");Dr(g,"mousemove",this._onMouseMove,this),Dr(g,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Dr(g,"mouseout",this._handleMouseOut,this),g._leaflet_disable_events=!0,this._ctx=g.getContext("2d")},_destroyContainer:function(){we(this._redrawRequest),delete this._ctx,cs(this._container),wi(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var w in this._redrawBounds=null,this._layers)this._layers[w]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){_a.prototype._update.call(this);var g=this._bounds,w=this._container,P=g.getSize(),U=Bn.retina?2:1;vr(w,g.min),w.width=U*P.x,w.height=U*P.y,w.style.width=P.x+"px",w.style.height=P.y+"px",Bn.retina&&this._ctx.scale(2,2),this._ctx.translate(-g.min.x,-g.min.y),this.fire("update")}},_reset:function(){_a.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(g){this._updateDashArray(g),this._layers[se(g)]=g;var w=g._order={layer:g,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=w),this._drawLast=w,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(g){this._requestRedraw(g)},_removePath:function(g){var w=g._order,P=w.next,U=w.prev;P?P.prev=U:this._drawLast=U,U?U.next=P:this._drawFirst=P,delete g._order,delete this._layers[se(g)],this._requestRedraw(g)},_updatePath:function(g){this._extendRedrawBounds(g),g._project(),g._update(),this._requestRedraw(g)},_updateStyle:function(g){this._updateDashArray(g),this._requestRedraw(g)},_updateDashArray:function(g){if("string"==typeof g.options.dashArray){var U,pe,w=g.options.dashArray.split(/[, ]+/),P=[];for(pe=0;pe<w.length;pe++){if(U=Number(w[pe]),isNaN(U))return;P.push(U)}g.options._dashArray=P}else g.options._dashArray=g.options.dashArray},_requestRedraw:function(g){!this._map||(this._extendRedrawBounds(g),this._redrawRequest=this._redrawRequest||Ne(this._redraw,this))},_extendRedrawBounds:function(g){if(g._pxBounds){var w=(g.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new We,this._redrawBounds.extend(g._pxBounds.min.subtract([w,w])),this._redrawBounds.extend(g._pxBounds.max.add([w,w]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var g=this._redrawBounds;if(g){var w=g.getSize();this._ctx.clearRect(g.min.x,g.min.y,w.x,w.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var g,w=this._redrawBounds;if(this._ctx.save(),w){var P=w.getSize();this._ctx.beginPath(),this._ctx.rect(w.min.x,w.min.y,P.x,P.y),this._ctx.clip()}this._drawing=!0;for(var U=this._drawFirst;U;U=U.next)g=U.layer,(!w||g._pxBounds&&g._pxBounds.intersects(w))&&g._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(g,w){if(this._drawing){var P,U,pe,Ie,Qe=g._parts,Bt=Qe.length,Zt=this._ctx;if(Bt){for(Zt.beginPath(),P=0;P<Bt;P++){for(U=0,pe=Qe[P].length;U<pe;U++)Zt[U?"lineTo":"moveTo"]((Ie=Qe[P][U]).x,Ie.y);w&&Zt.closePath()}this._fillStroke(Zt,g)}}},_updateCircle:function(g){if(this._drawing&&!g._empty()){var w=g._point,P=this._ctx,U=Math.max(Math.round(g._radius),1),pe=(Math.max(Math.round(g._radiusY),1)||U)/U;1!==pe&&(P.save(),P.scale(1,pe)),P.beginPath(),P.arc(w.x,w.y/pe,U,0,2*Math.PI,!1),1!==pe&&P.restore(),this._fillStroke(P,g)}},_fillStroke:function(g,w){var P=w.options;P.fill&&(g.globalAlpha=P.fillOpacity,g.fillStyle=P.fillColor||P.color,g.fill(P.fillRule||"evenodd")),P.stroke&&0!==P.weight&&(g.setLineDash&&g.setLineDash(w.options&&w.options._dashArray||[]),g.globalAlpha=P.opacity,g.lineWidth=P.weight,g.strokeStyle=P.color,g.lineCap=P.lineCap,g.lineJoin=P.lineJoin,g.stroke())},_onClick:function(g){for(var P,U,w=this._map.mouseEventToLayerPoint(g),pe=this._drawFirst;pe;pe=pe.next)(P=pe.layer).options.interactive&&P._containsPoint(w)&&("click"!==g.type&&"preclick"!==g.type||!this._map._draggableMoved(P))&&(U=P);this._fireEvent(!!U&&[U],g)},_onMouseMove:function(g){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var w=this._map.mouseEventToLayerPoint(g);this._handleMouseHover(g,w)}},_handleMouseOut:function(g){var w=this._hoveredLayer;w&&(hs(this._container,"leaflet-interactive"),this._fireEvent([w],g,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(g,w){if(!this._mouseHoverThrottled){for(var P,U,pe=this._drawFirst;pe;pe=pe.next)(P=pe.layer).options.interactive&&P._containsPoint(w)&&(U=P);U!==this._hoveredLayer&&(this._handleMouseOut(g),U&&(Hr(this._container,"leaflet-interactive"),this._fireEvent([U],g,"mouseover"),this._hoveredLayer=U)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],g),this._mouseHoverThrottled=!0,setTimeout(re(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(g,w,P){this._map._fireDOMEvent(w,P||w.type,g)},_bringToFront:function(g){var w=g._order;if(w){var P=w.next,U=w.prev;if(!P)return;P.prev=U,U?U.next=P:P&&(this._drawFirst=P),w.prev=this._drawLast,this._drawLast.next=w,w.next=null,this._drawLast=w,this._requestRedraw(g)}},_bringToBack:function(g){var w=g._order;if(w){var P=w.next,U=w.prev;if(!U)return;U.next=P,P?P.prev=U:U&&(this._drawLast=U),w.prev=null,w.next=this._drawFirst,this._drawFirst.prev=w,this._drawFirst=w,this._requestRedraw(g)}}});function zl(g){return Bn.canvas?new vf(g):null}var Ss=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(g){return document.createElement("<lvml:"+g+' class="lvml">')}}catch(g){}return function(g){return document.createElement("<"+g+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Rb={_initContainer:function(){this._container=li("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(_a.prototype._update.call(this),this.fire("update"))},_initPath:function(g){var w=g._container=Ss("shape");Hr(w,"leaflet-vml-shape "+(this.options.className||"")),w.coordsize="1 1",g._path=Ss("path"),w.appendChild(g._path),this._updateStyle(g),this._layers[se(g)]=g},_addPath:function(g){var w=g._container;this._container.appendChild(w),g.options.interactive&&g.addInteractiveTarget(w)},_removePath:function(g){var w=g._container;cs(w),g.removeInteractiveTarget(w),delete this._layers[se(g)]},_updateStyle:function(g){var w=g._stroke,P=g._fill,U=g.options,pe=g._container;pe.stroked=!!U.stroke,pe.filled=!!U.fill,U.stroke?(w||(w=g._stroke=Ss("stroke")),pe.appendChild(w),w.weight=U.weight+"px",w.color=U.color,w.opacity=U.opacity,w.dashStyle=U.dashArray?ce(U.dashArray)?U.dashArray.join(" "):U.dashArray.replace(/( *, *)/g," "):"",w.endcap=U.lineCap.replace("butt","flat"),w.joinstyle=U.lineJoin):w&&(pe.removeChild(w),g._stroke=null),U.fill?(P||(P=g._fill=Ss("fill")),pe.appendChild(P),P.color=U.fillColor||U.color,P.opacity=U.fillOpacity):P&&(pe.removeChild(P),g._fill=null)},_updateCircle:function(g){var w=g._point.round(),P=Math.round(g._radius),U=Math.round(g._radiusY||P);this._setPath(g,g._empty()?"M0 0":"AL "+w.x+","+w.y+" "+P+","+U+" 0,23592600")},_setPath:function(g,w){g._path.v=w},_bringToFront:function(g){Ro(g._container)},_bringToBack:function(g){or(g._container)}},Mi=Bn.vml?Ss:Sn,Jt=_a.extend({_initContainer:function(){this._container=Mi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Mi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){cs(this._container),wi(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){_a.prototype._update.call(this);var g=this._bounds,w=g.getSize(),P=this._container;(!this._svgSize||!this._svgSize.equals(w))&&(this._svgSize=w,P.setAttribute("width",w.x),P.setAttribute("height",w.y)),vr(P,g.min),P.setAttribute("viewBox",[g.min.x,g.min.y,w.x,w.y].join(" ")),this.fire("update")}},_initPath:function(g){var w=g._path=Mi("path");g.options.className&&Hr(w,g.options.className),g.options.interactive&&Hr(w,"leaflet-interactive"),this._updateStyle(g),this._layers[se(g)]=g},_addPath:function(g){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(g._path),g.addInteractiveTarget(g._path)},_removePath:function(g){cs(g._path),g.removeInteractiveTarget(g._path),delete this._layers[se(g)]},_updatePath:function(g){g._project(),g._update()},_updateStyle:function(g){var w=g._path,P=g.options;!w||(P.stroke?(w.setAttribute("stroke",P.color),w.setAttribute("stroke-opacity",P.opacity),w.setAttribute("stroke-width",P.weight),w.setAttribute("stroke-linecap",P.lineCap),w.setAttribute("stroke-linejoin",P.lineJoin),P.dashArray?w.setAttribute("stroke-dasharray",P.dashArray):w.removeAttribute("stroke-dasharray"),P.dashOffset?w.setAttribute("stroke-dashoffset",P.dashOffset):w.removeAttribute("stroke-dashoffset")):w.setAttribute("stroke","none"),P.fill?(w.setAttribute("fill",P.fillColor||P.color),w.setAttribute("fill-opacity",P.fillOpacity),w.setAttribute("fill-rule",P.fillRule||"evenodd")):w.setAttribute("fill","none"))},_updatePoly:function(g,w){this._setPath(g,Gn(g._parts,w))},_updateCircle:function(g){var w=g._point,P=Math.max(Math.round(g._radius),1),pe="a"+P+","+(Math.max(Math.round(g._radiusY),1)||P)+" 0 1,0 ",Ie=g._empty()?"M0 0":"M"+(w.x-P)+","+w.y+pe+2*P+",0 "+pe+2*-P+",0 ";this._setPath(g,Ie)},_setPath:function(g,w){g._path.setAttribute("d",w)},_bringToFront:function(g){Ro(g._path)},_bringToBack:function(g){or(g._path)}});function br(g){return Bn.svg||Bn.vml?new Jt(g):null}Bn.vml&&Jt.include(Rb),ei.include({getRenderer:function(g){var w=g.options.renderer||this._getPaneRenderer(g.options.pane)||this.options.renderer||this._renderer;return w||(w=this._renderer=this._createRenderer()),this.hasLayer(w)||this.addLayer(w),w},_getPaneRenderer:function(g){if("overlayPane"===g||void 0===g)return!1;var w=this._paneRenderers[g];return void 0===w&&(w=this._createRenderer({pane:g}),this._paneRenderers[g]=w),w},_createRenderer:function(g){return this.options.preferCanvas&&zl(g)||br(g)}});var qi=Co.extend({initialize:function(g,w){Co.prototype.initialize.call(this,this._boundsToLatLngs(g),w)},setBounds:function(g){return this.setLatLngs(this._boundsToLatLngs(g))},_boundsToLatLngs:function(g){return[(g=Ue(g)).getSouthWest(),g.getNorthWest(),g.getNorthEast(),g.getSouthEast()]}});Jt.create=Mi,Jt.pointsToPath=Gn,Iu.geometryToLayer=kd,Iu.coordsToLatLng=Si,Iu.coordsToLatLngs=Dm,Iu.latLngToCoords=jv,Iu.latLngsToCoords=Du,Iu.getFeature=cr,Iu.asFeature=tr,ei.mergeOptions({boxZoom:!0});var tl=Pa.extend({initialize:function(g){this._map=g,this._container=g._container,this._pane=g._panes.overlayPane,this._resetStateTimeout=0,g.on("unload",this._destroy,this)},addHooks:function(){Dr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){wi(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){cs(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(g){if(!g.shiftKey||1!==g.which&&1!==g.button)return!1;this._clearDeferredResetState(),this._resetState(),Oo(),Ed(),this._startPoint=this._map.mouseEventToContainerPoint(g),Dr(document,{contextmenu:xc,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(g){this._moved||(this._moved=!0,this._box=li("div","leaflet-zoom-box",this._container),Hr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(g);var w=new We(this._point,this._startPoint),P=w.getSize();vr(this._box,w.min),this._box.style.width=P.x+"px",this._box.style.height=P.y+"px"},_finish:function(){this._moved&&(cs(this._box),hs(this._container,"leaflet-crosshair")),Ju(),Eu(),wi(document,{contextmenu:xc,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(g){if((1===g.which||1===g.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(re(this._resetState,this),0);var w=new Pt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(w).fire("boxzoomend",{boxZoomBounds:w})}},_onKeyDown:function(g){27===g.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ei.addInitHook("addHandler","boxZoom",tl),ei.mergeOptions({doubleClickZoom:!0});var $s=Pa.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(g){var w=this._map,P=w.getZoom(),U=w.options.zoomDelta,pe=g.originalEvent.shiftKey?P-U:P+U;"center"===w.options.doubleClickZoom?w.setZoom(pe):w.setZoomAround(g.containerPoint,pe)}});ei.addInitHook("addHandler","doubleClickZoom",$s),ei.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ul=Pa.extend({addHooks:function(){if(!this._draggable){var g=this._map;this._draggable=new Ll(g._mapPane,g._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),g.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),g.on("zoomend",this._onZoomEnd,this),g.whenReady(this._onZoomEnd,this))}Hr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){hs(this._map._container,"leaflet-grab"),hs(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var g=this._map;if(g._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var w=Ue(this._map.options.maxBounds);this._offsetLimit=tt(this._map.latLngToContainerPoint(w.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(w.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;g.fire("movestart").fire("dragstart"),g.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(g){if(this._map.options.inertia){var w=this._lastTime=+new Date,P=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(P),this._times.push(w),this._prunePositions(w)}this._map.fire("move",g).fire("drag",g)},_prunePositions:function(g){for(;this._positions.length>1&&g-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var g=this._map.getSize().divideBy(2),w=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=w.subtract(g).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(g,w){return g-(g-w)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var g=this._draggable._newPos.subtract(this._draggable._startPos),w=this._offsetLimit;g.x<w.min.x&&(g.x=this._viscousLimit(g.x,w.min.x)),g.y<w.min.y&&(g.y=this._viscousLimit(g.y,w.min.y)),g.x>w.max.x&&(g.x=this._viscousLimit(g.x,w.max.x)),g.y>w.max.y&&(g.y=this._viscousLimit(g.y,w.max.y)),this._draggable._newPos=this._draggable._startPos.add(g)}},_onPreDragWrap:function(){var g=this._worldWidth,w=Math.round(g/2),P=this._initialWorldOffset,U=this._draggable._newPos.x,pe=(U-w+P)%g+w-P,Ie=(U+w+P)%g-w-P,Qe=Math.abs(pe+P)<Math.abs(Ie+P)?pe:Ie;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Qe},_onDragEnd:function(g){var w=this._map,P=w.options,U=!P.inertia||g.noInertia||this._times.length<2;if(w.fire("dragend",g),U)w.fire("moveend");else{this._prunePositions(+new Date);var pe=this._lastPos.subtract(this._positions[0]),Qe=P.easeLinearity,Bt=pe.multiplyBy(Qe/((this._lastTime-this._times[0])/1e3)),Zt=Bt.distanceTo([0,0]),hn=Math.min(P.inertiaMaxSpeed,Zt),Rn=Bt.multiplyBy(hn/Zt),fr=hn/(P.inertiaDeceleration*Qe),Wr=Rn.multiplyBy(-fr/2).round();Wr.x||Wr.y?(Wr=w._limitOffset(Wr,w.options.maxBounds),Ne(function(){w.panBy(Wr,{duration:fr,easeLinearity:Qe,noMoveStart:!0,animate:!0})})):w.fire("moveend")}}});ei.addInitHook("addHandler","dragging",Ul),ei.mergeOptions({keyboard:!0,keyboardPanDelta:80});var es=Pa.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(g){this._map=g,this._setPanDelta(g.options.keyboardPanDelta),this._setZoomDelta(g.options.zoomDelta)},addHooks:function(){var g=this._map._container;g.tabIndex<=0&&(g.tabIndex="0"),Dr(g,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),wi(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var g=document.body,w=document.documentElement,P=g.scrollTop||w.scrollTop,U=g.scrollLeft||w.scrollLeft;this._map._container.focus(),window.scrollTo(U,P)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(g){var U,pe,w=this._panKeys={},P=this.keyCodes;for(U=0,pe=P.left.length;U<pe;U++)w[P.left[U]]=[-1*g,0];for(U=0,pe=P.right.length;U<pe;U++)w[P.right[U]]=[g,0];for(U=0,pe=P.down.length;U<pe;U++)w[P.down[U]]=[0,g];for(U=0,pe=P.up.length;U<pe;U++)w[P.up[U]]=[0,-1*g]},_setZoomDelta:function(g){var U,pe,w=this._zoomKeys={},P=this.keyCodes;for(U=0,pe=P.zoomIn.length;U<pe;U++)w[P.zoomIn[U]]=g;for(U=0,pe=P.zoomOut.length;U<pe;U++)w[P.zoomOut[U]]=-g},_addHooks:function(){Dr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){wi(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(g){if(!(g.altKey||g.ctrlKey||g.metaKey)){var U,w=g.keyCode,P=this._map;if(w in this._panKeys){if(!P._panAnim||!P._panAnim._inProgress)if(U=this._panKeys[w],g.shiftKey&&(U=je(U).multiplyBy(3)),P.options.maxBounds&&(U=P._limitOffset(je(U),P.options.maxBounds)),P.options.worldCopyJump){var pe=P.wrapLatLng(P.unproject(P.project(P.getCenter()).add(U)));P.panTo(pe)}else P.panBy(U)}else if(w in this._zoomKeys)P.setZoom(P.getZoom()+(g.shiftKey?3:1)*this._zoomKeys[w]);else{if(27!==w||!P._popup||!P._popup.options.closeOnEscapeKey)return;P.closePopup()}xc(g)}}});ei.addInitHook("addHandler","keyboard",es),ei.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ba=Pa.extend({addHooks:function(){Dr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){wi(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(g){var w=Em(g),P=this._map.options.wheelDebounceTime;this._delta+=w,this._lastMousePos=this._map.mouseEventToContainerPoint(g),this._startTime||(this._startTime=+new Date);var U=Math.max(P-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(re(this._performZoom,this),U),xc(g)},_performZoom:function(){var g=this._map,w=g.getZoom(),P=this._map.options.zoomSnap||0;g._stop();var pe=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,Ie=P?Math.ceil(pe/P)*P:pe,Qe=g._limitZoom(w+(this._delta>0?Ie:-Ie))-w;this._delta=0,this._startTime=null,Qe&&("center"===g.options.scrollWheelZoom?g.setZoom(w+Qe):g.setZoomAround(this._lastMousePos,w+Qe))}});ei.addInitHook("addHandler","scrollWheelZoom",Ba);ei.mergeOptions({tapHold:Bn.touchNative&&Bn.safari&&Bn.mobile,tapTolerance:15});var kr=Pa.extend({addHooks:function(){Dr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){wi(this._map._container,"touchstart",this._onDown,this)},_onDown:function(g){if(clearTimeout(this._holdTimeout),1===g.touches.length){var w=g.touches[0];this._startPos=this._newPos=new Mt(w.clientX,w.clientY),this._holdTimeout=setTimeout(re(function(){this._cancel(),this._isTapValid()&&(Dr(document,"touchend",Zs),Dr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",w))},this),600),Dr(document,"touchend touchcancel contextmenu",this._cancel,this),Dr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function g(){wi(document,"touchend",Zs),wi(document,"touchend touchcancel",g)},_cancel:function(){clearTimeout(this._holdTimeout),wi(document,"touchend touchcancel contextmenu",this._cancel,this),wi(document,"touchmove",this._onMove,this)},_onMove:function(g){var w=g.touches[0];this._newPos=new Mt(w.clientX,w.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(g,w){var P=new MouseEvent(g,{bubbles:!0,cancelable:!0,view:window,screenX:w.screenX,screenY:w.screenY,clientX:w.clientX,clientY:w.clientY});P._simulated=!0,w.target.dispatchEvent(P)}});ei.addInitHook("addHandler","tapHold",kr),ei.mergeOptions({touchZoom:Bn.touch,bounceAtZoomLimits:!0});var dh=Pa.extend({addHooks:function(){Hr(this._map._container,"leaflet-touch-zoom"),Dr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){hs(this._map._container,"leaflet-touch-zoom"),wi(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(g){var w=this._map;if(g.touches&&2===g.touches.length&&!w._animatingZoom&&!this._zooming){var P=w.mouseEventToContainerPoint(g.touches[0]),U=w.mouseEventToContainerPoint(g.touches[1]);this._centerPoint=w.getSize()._divideBy(2),this._startLatLng=w.containerPointToLatLng(this._centerPoint),"center"!==w.options.touchZoom&&(this._pinchStartLatLng=w.containerPointToLatLng(P.add(U)._divideBy(2))),this._startDist=P.distanceTo(U),this._startZoom=w.getZoom(),this._moved=!1,this._zooming=!0,w._stop(),Dr(document,"touchmove",this._onTouchMove,this),Dr(document,"touchend touchcancel",this._onTouchEnd,this),Zs(g)}},_onTouchMove:function(g){if(g.touches&&2===g.touches.length&&this._zooming){var w=this._map,P=w.mouseEventToContainerPoint(g.touches[0]),U=w.mouseEventToContainerPoint(g.touches[1]),pe=P.distanceTo(U)/this._startDist;if(this._zoom=w.getScaleZoom(pe,this._startZoom),!w.options.bounceAtZoomLimits&&(this._zoom<w.getMinZoom()&&pe<1||this._zoom>w.getMaxZoom()&&pe>1)&&(this._zoom=w._limitZoom(this._zoom)),"center"===w.options.touchZoom){if(this._center=this._startLatLng,1===pe)return}else{var Ie=P._add(U)._divideBy(2)._subtract(this._centerPoint);if(1===pe&&0===Ie.x&&0===Ie.y)return;this._center=w.unproject(w.project(this._pinchStartLatLng,this._zoom).subtract(Ie),this._zoom)}this._moved||(w._moveStart(!0,!1),this._moved=!0),we(this._animRequest);var Qe=re(w._move,w,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Ne(Qe,this,!0),Zs(g)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,we(this._animRequest),wi(document,"touchmove",this._onTouchMove,this),wi(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});ei.addInitHook("addHandler","touchZoom",dh),ei.BoxZoom=tl,ei.DoubleClickZoom=$s,ei.Drag=Ul,ei.Keyboard=es,ei.ScrollWheelZoom=Ba,ei.TapHold=kr,ei.TouchZoom=dh,z.Bounds=We,z.Browser=Bn,z.CRS=Qt,z.Canvas=vf,z.Circle=Au,z.CircleMarker=pf,z.Class=Ye,z.Control=ga,z.DivIcon=sr,z.DivOverlay=Vr,z.DomEvent=wb,z.DomUtil=bc,z.Draggable=Ll,z.Evented=Ut,z.FeatureGroup=tu,z.GeoJSON=Iu,z.GridLayer=vs,z.Handler=Pa,z.Icon=$l,z.ImageOverlay=Lo,z.LatLng=xt,z.LatLngBounds=Pt,z.Layer=ta,z.LayerGroup=Tu,z.LineUtil=hi,z.Map=ei,z.Marker=hh,z.Mixin=Tr,z.Path=Po,z.Point=Mt,z.PolyUtil=Am,z.Polygon=Co,z.Polyline=Bl,z.Popup=Od,z.PosAnimation=Cc,z.Projection=yn,z.Rectangle=qi,z.Renderer=_a,z.SVG=Jt,z.SVGOverlay=Mb,z.TileLayer=La,z.Tooltip=gf,z.Transformation=Fe,z.Util=qe,z.VideoOverlay=Mm,z.bind=re,z.bounds=tt,z.canvas=zl,z.circle=function nu(g,w,P){return new Au(g,w,P)},z.circleMarker=function YE(g,w){return new pf(g,w)},z.control=ci,z.divIcon=function ya(g){return new sr(g)},z.extend=K,z.featureGroup=function(g,w){return new tu(g,w)},z.geoJSON=fh,z.geoJson=qv,z.gridLayer=function Xe(g){return new vs(g)},z.icon=function Gv(g){return new $l(g)},z.imageOverlay=function(g,w,P){return new Lo(g,w,P)},z.latLng=Vt,z.latLngBounds=Ue,z.layerGroup=function(g,w){return new Tu(g,w)},z.map=function zv(g,w){return new ei(g,w)},z.marker=function Ab(g,w){return new hh(g,w)},z.point=je,z.polygon=function Ib(g,w){return new Co(g,w)},z.polyline=function QE(g,w){return new Bl(g,w)},z.popup=function(g,w){return new Od(g,w)},z.rectangle=function ba(g,w){return new qi(g,w)},z.setOptions=H,z.stamp=se,z.svg=br,z.svgOverlay=function Zv(g,w,P){return new Mb(g,w,P)},z.tileLayer=$a,z.tooltip=function(g,w){return new gf(g,w)},z.transformation=yt,z.version="1.9.3",z.videoOverlay=function Vl(g,w,P){return new Mm(g,w,P)};var Ec=window.L;z.noConflict=function(){return window.L=Ec,this},window.L=z}(Ae)},4994:(rt,Ae,z)=>{var G=z(4312),K=z(6421),ue=z(5764),re=z(8685),X=z(6676);function se(be){var V=-1,ee=null==be?0:be.length;for(this.clear();++V<ee;){var ge=be[V];this.set(ge[0],ge[1])}}se.prototype.clear=G,se.prototype.delete=K,se.prototype.get=ue,se.prototype.has=re,se.prototype.set=X,rt.exports=se},9215:(rt,Ae,z)=>{var G=z(1840),K=z(4378),ue=z(4981),re=z(7343),X=z(8895);function se(be){var V=-1,ee=null==be?0:be.length;for(this.clear();++V<ee;){var ge=be[V];this.set(ge[0],ge[1])}}se.prototype.clear=G,se.prototype.delete=K,se.prototype.get=ue,se.prototype.has=re,se.prototype.set=X,rt.exports=se},1501:(rt,Ae,z)=>{var ue=z(3436)(z(2119),"Map");rt.exports=ue},9850:(rt,Ae,z)=>{var G=z(638),K=z(1184),ue=z(866),re=z(3771),X=z(1772);function se(be){var V=-1,ee=null==be?0:be.length;for(this.clear();++V<ee;){var ge=be[V];this.set(ge[0],ge[1])}}se.prototype.clear=G,se.prototype.delete=K,se.prototype.get=ue,se.prototype.has=re,se.prototype.set=X,rt.exports=se},6323:(rt,Ae,z)=>{var ue=z(3436)(z(2119),"Set");rt.exports=ue},8849:(rt,Ae,z)=>{var G=z(9850),K=z(4600),ue=z(1387);function re(X){var se=-1,be=null==X?0:X.length;for(this.__data__=new G;++se<be;)this.add(X[se])}re.prototype.add=re.prototype.push=K,re.prototype.has=ue,rt.exports=re},443:(rt,Ae,z)=>{var G=z(2119);rt.exports=G.Symbol},1253:(rt,Ae,z)=>{var G=z(4164);rt.exports=function K(ue,re){return!(null==ue||!ue.length)&&G(ue,re,0)>-1}},7609:rt=>{rt.exports=function Ae(z,G,K){for(var ue=-1,re=null==z?0:z.length;++ue<re;)if(K(G,z[ue]))return!0;return!1}},2271:(rt,Ae,z)=>{var G=z(5334),K=z(7151),ue=z(1503),re=z(891),X=z(8442),se=z(8159),V=Object.prototype.hasOwnProperty;rt.exports=function ee(ge,W){var J=ue(ge),H=!J&&K(ge),Y=!J&&!H&&re(ge),me=!J&&!H&&!Y&&se(ge),te=J||H||Y||me,ce=te?G(ge.length,String):[],xe=ce.length;for(var Pe in ge)(W||V.call(ge,Pe))&&(!te||!("length"==Pe||Y&&("offset"==Pe||"parent"==Pe)||me&&("buffer"==Pe||"byteLength"==Pe||"byteOffset"==Pe)||X(Pe,xe)))&&ce.push(Pe);return ce}},4633:rt=>{rt.exports=function Ae(z,G){for(var K=-1,ue=null==z?0:z.length,re=Array(ue);++K<ue;)re[K]=G(z[K],K,z);return re}},4125:(rt,Ae,z)=>{var G=z(8826);rt.exports=function K(ue){var re=ue.length;return re?ue[G(0,re-1)]:void 0}},8906:(rt,Ae,z)=>{var G=z(9454),K=z(9905);rt.exports=function ue(re){return K(G(re))}},3503:(rt,Ae,z)=>{var G=z(217);rt.exports=function K(ue,re){for(var X=ue.length;X--;)if(G(ue[X][0],re))return X;return-1}},5317:rt=>{rt.exports=function Ae(z,G,K,ue){for(var re=z.length,X=K+(ue?1:-1);ue?X--:++X<re;)if(G(z[X],X,z))return X;return-1}},3337:(rt,Ae,z)=>{var G=z(443),K=z(1318),ue=z(2902),se=G?G.toStringTag:void 0;rt.exports=function be(V){return null==V?void 0===V?"[object Undefined]":"[object Null]":se&&se in Object(V)?K(V):ue(V)}},4164:(rt,Ae,z)=>{var G=z(5317),K=z(968),ue=z(4977);rt.exports=function re(X,se,be){return se==se?ue(X,se,be):G(X,K,be)}},186:(rt,Ae,z)=>{var G=z(3337),K=z(2671);rt.exports=function re(X){return K(X)&&"[object Arguments]"==G(X)}},968:rt=>{rt.exports=function Ae(z){return z!=z}},7304:(rt,Ae,z)=>{var G=z(5946),K=z(1943),ue=z(5940),re=z(2827),se=/^\[object .+?Constructor\]$/,W=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");rt.exports=function J(H){return!(!ue(H)||K(H))&&(G(H)?W:se).test(re(H))}},1083:(rt,Ae,z)=>{var G=z(3337),K=z(6231),ue=z(2671),Ye={};Ye["[object Float32Array]"]=Ye["[object Float64Array]"]=Ye["[object Int8Array]"]=Ye["[object Int16Array]"]=Ye["[object Int32Array]"]=Ye["[object Uint8Array]"]=Ye["[object Uint8ClampedArray]"]=Ye["[object Uint16Array]"]=Ye["[object Uint32Array]"]=!0,Ye["[object Arguments]"]=Ye["[object Array]"]=Ye["[object ArrayBuffer]"]=Ye["[object Boolean]"]=Ye["[object DataView]"]=Ye["[object Date]"]=Ye["[object Error]"]=Ye["[object Function]"]=Ye["[object Map]"]=Ye["[object Number]"]=Ye["[object Object]"]=Ye["[object RegExp]"]=Ye["[object Set]"]=Ye["[object String]"]=Ye["[object WeakMap]"]=!1,rt.exports=function at(At){return ue(At)&&K(At.length)&&!!Ye[G(At)]}},1172:(rt,Ae,z)=>{var G=z(5488),K=z(5491),re=Object.prototype.hasOwnProperty;rt.exports=function X(se){if(!G(se))return K(se);var be=[];for(var V in Object(se))re.call(se,V)&&"constructor"!=V&&be.push(V);return be}},8826:rt=>{var Ae=Math.floor,z=Math.random;rt.exports=function G(K,ue){return K+Ae(z()*(ue-K+1))}},1435:(rt,Ae,z)=>{var G=z(4125),K=z(377);rt.exports=function ue(re){return G(K(re))}},7522:(rt,Ae,z)=>{var G=z(9905),K=z(377);rt.exports=function ue(re){return G(K(re))}},5334:rt=>{rt.exports=function Ae(z,G){for(var K=-1,ue=Array(z);++K<z;)ue[K]=G(K);return ue}},5647:rt=>{rt.exports=function Ae(z){return function(G){return z(G)}}},707:(rt,Ae,z)=>{var G=z(8849),K=z(1253),ue=z(7609),re=z(5972),X=z(4575),se=z(4174);rt.exports=function V(ee,ge,W){var J=-1,H=K,Y=ee.length,me=!0,te=[],ce=te;if(W)me=!1,H=ue;else if(Y>=200){var xe=ge?null:X(ee);if(xe)return se(xe);me=!1,H=re,ce=new G}else ce=ge?[]:te;e:for(;++J<Y;){var Pe=ee[J],Ke=ge?ge(Pe):Pe;if(Pe=W||0!==Pe?Pe:0,me&&Ke==Ke){for(var Ve=ce.length;Ve--;)if(ce[Ve]===Ke)continue e;ge&&ce.push(Ke),te.push(Pe)}else H(ce,Ke,W)||(ce!==te&&ce.push(Ke),te.push(Pe))}return te}},9179:(rt,Ae,z)=>{var G=z(4633);rt.exports=function K(ue,re){return G(re,function(X){return ue[X]})}},5972:rt=>{rt.exports=function Ae(z,G){return z.has(G)}},9454:rt=>{rt.exports=function Ae(z,G){var K=-1,ue=z.length;for(G||(G=Array(ue));++K<ue;)G[K]=z[K];return G}},4610:(rt,Ae,z)=>{var G=z(2119);rt.exports=G["__core-js_shared__"]},4575:(rt,Ae,z)=>{var G=z(6323),K=z(2552),ue=z(4174),X=G&&1/ue(new G([,-0]))[1]==1/0?function(se){return new G(se)}:K;rt.exports=X},9122:rt=>{var Ae="object"==typeof global&&global&&global.Object===Object&&global;rt.exports=Ae},4537:(rt,Ae,z)=>{var G=z(3819);rt.exports=function K(ue,re){var X=ue.__data__;return G(re)?X["string"==typeof re?"string":"hash"]:X.map}},3436:(rt,Ae,z)=>{var G=z(7304),K=z(1990);rt.exports=function ue(re,X){var se=K(re,X);return G(se)?se:void 0}},1318:(rt,Ae,z)=>{var G=z(443),K=Object.prototype,ue=K.hasOwnProperty,re=K.toString,X=G?G.toStringTag:void 0;rt.exports=function se(be){var V=ue.call(be,X),ee=be[X];try{be[X]=void 0;var ge=!0}catch(J){}var W=re.call(be);return ge&&(V?be[X]=ee:delete be[X]),W}},1990:rt=>{rt.exports=function Ae(z,G){return null==z?void 0:z[G]}},4312:(rt,Ae,z)=>{var G=z(862);rt.exports=function K(){this.__data__=G?G(null):{},this.size=0}},6421:rt=>{rt.exports=function Ae(z){var G=this.has(z)&&delete this.__data__[z];return this.size-=G?1:0,G}},5764:(rt,Ae,z)=>{var G=z(862),re=Object.prototype.hasOwnProperty;rt.exports=function X(se){var be=this.__data__;if(G){var V=be[se];return"__lodash_hash_undefined__"===V?void 0:V}return re.call(be,se)?be[se]:void 0}},8685:(rt,Ae,z)=>{var G=z(862),ue=Object.prototype.hasOwnProperty;rt.exports=function re(X){var se=this.__data__;return G?void 0!==se[X]:ue.call(se,X)}},6676:(rt,Ae,z)=>{var G=z(862);rt.exports=function ue(re,X){var se=this.__data__;return this.size+=this.has(re)?0:1,se[re]=G&&void 0===X?"__lodash_hash_undefined__":X,this}},8442:rt=>{var z=/^(?:0|[1-9]\d*)$/;rt.exports=function G(K,ue){var re=typeof K;return!!(ue=null==ue?9007199254740991:ue)&&("number"==re||"symbol"!=re&&z.test(K))&&K>-1&&K%1==0&&K<ue}},3819:rt=>{rt.exports=function Ae(z){var G=typeof z;return"string"==G||"number"==G||"symbol"==G||"boolean"==G?"__proto__"!==z:null===z}},1943:(rt,Ae,z)=>{var re,G=z(4610),K=(re=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+re:"";rt.exports=function ue(re){return!!K&&K in re}},5488:rt=>{var Ae=Object.prototype;rt.exports=function z(G){var K=G&&G.constructor;return G===("function"==typeof K&&K.prototype||Ae)}},1840:rt=>{rt.exports=function Ae(){this.__data__=[],this.size=0}},4378:(rt,Ae,z)=>{var G=z(3503),ue=Array.prototype.splice;rt.exports=function re(X){var se=this.__data__,be=G(se,X);return!(be<0||(be==se.length-1?se.pop():ue.call(se,be,1),--this.size,0))}},4981:(rt,Ae,z)=>{var G=z(3503);rt.exports=function K(ue){var re=this.__data__,X=G(re,ue);return X<0?void 0:re[X][1]}},7343:(rt,Ae,z)=>{var G=z(3503);rt.exports=function K(ue){return G(this.__data__,ue)>-1}},8895:(rt,Ae,z)=>{var G=z(3503);rt.exports=function K(ue,re){var X=this.__data__,se=G(X,ue);return se<0?(++this.size,X.push([ue,re])):X[se][1]=re,this}},638:(rt,Ae,z)=>{var G=z(4994),K=z(9215),ue=z(1501);rt.exports=function re(){this.size=0,this.__data__={hash:new G,map:new(ue||K),string:new G}}},1184:(rt,Ae,z)=>{var G=z(4537);rt.exports=function K(ue){var re=G(this,ue).delete(ue);return this.size-=re?1:0,re}},866:(rt,Ae,z)=>{var G=z(4537);rt.exports=function K(ue){return G(this,ue).get(ue)}},3771:(rt,Ae,z)=>{var G=z(4537);rt.exports=function K(ue){return G(this,ue).has(ue)}},1772:(rt,Ae,z)=>{var G=z(4537);rt.exports=function K(ue,re){var X=G(this,ue),se=X.size;return X.set(ue,re),this.size+=X.size==se?0:1,this}},862:(rt,Ae,z)=>{var K=z(3436)(Object,"create");rt.exports=K},5491:(rt,Ae,z)=>{var K=z(9385)(Object.keys,Object);rt.exports=K},3597:(rt,Ae,z)=>{rt=z.nmd(rt);var G=z(9122),K=Ae&&!Ae.nodeType&&Ae,ue=K&&rt&&!rt.nodeType&&rt,X=ue&&ue.exports===K&&G.process,se=function(){try{return ue&&ue.require&&ue.require("util").types||X&&X.binding&&X.binding("util")}catch(V){}}();rt.exports=se},2902:rt=>{var z=Object.prototype.toString;rt.exports=function G(K){return z.call(K)}},9385:rt=>{rt.exports=function Ae(z,G){return function(K){return z(G(K))}}},2119:(rt,Ae,z)=>{var G=z(9122),K="object"==typeof self&&self&&self.Object===Object&&self,ue=G||K||Function("return this")();rt.exports=ue},4600:rt=>{rt.exports=function z(G){return this.__data__.set(G,"__lodash_hash_undefined__"),this}},1387:rt=>{rt.exports=function Ae(z){return this.__data__.has(z)}},4174:rt=>{rt.exports=function Ae(z){var G=-1,K=Array(z.size);return z.forEach(function(ue){K[++G]=ue}),K}},9905:(rt,Ae,z)=>{var G=z(8826);rt.exports=function K(ue,re){var X=-1,se=ue.length,be=se-1;for(re=void 0===re?se:re;++X<re;){var V=G(X,be),ee=ue[V];ue[V]=ue[X],ue[X]=ee}return ue.length=re,ue}},4977:rt=>{rt.exports=function Ae(z,G,K){for(var ue=K-1,re=z.length;++ue<re;)if(z[ue]===G)return ue;return-1}},2827:rt=>{var z=Function.prototype.toString;rt.exports=function G(K){if(null!=K){try{return z.call(K)}catch(ue){}try{return K+""}catch(ue){}}return""}},217:rt=>{rt.exports=function Ae(z,G){return z===G||z!=z&&G!=G}},7151:(rt,Ae,z)=>{var G=z(186),K=z(2671),ue=Object.prototype,re=ue.hasOwnProperty,X=ue.propertyIsEnumerable,se=G(function(){return arguments}())?G:function(be){return K(be)&&re.call(be,"callee")&&!X.call(be,"callee")};rt.exports=se},1503:rt=>{rt.exports=Array.isArray},6507:(rt,Ae,z)=>{var G=z(5946),K=z(6231);rt.exports=function ue(re){return null!=re&&K(re.length)&&!G(re)}},891:(rt,Ae,z)=>{rt=z.nmd(rt);var G=z(2119),K=z(3580),ue=Ae&&!Ae.nodeType&&Ae,re=ue&&rt&&!rt.nodeType&&rt,se=re&&re.exports===ue?G.Buffer:void 0;rt.exports=(se?se.isBuffer:void 0)||K},5946:(rt,Ae,z)=>{var G=z(3337),K=z(5940);rt.exports=function be(V){if(!K(V))return!1;var ee=G(V);return"[object Function]"==ee||"[object GeneratorFunction]"==ee||"[object AsyncFunction]"==ee||"[object Proxy]"==ee}},6231:rt=>{rt.exports=function z(G){return"number"==typeof G&&G>-1&&G%1==0&&G<=9007199254740991}},5940:rt=>{rt.exports=function Ae(z){var G=typeof z;return null!=z&&("object"==G||"function"==G)}},2671:rt=>{rt.exports=function Ae(z){return null!=z&&"object"==typeof z}},8159:(rt,Ae,z)=>{var G=z(1083),K=z(5647),ue=z(3597),re=ue&&ue.isTypedArray,X=re?K(re):G;rt.exports=X},118:(rt,Ae,z)=>{var G=z(2271),K=z(1172),ue=z(6507);rt.exports=function re(X){return ue(X)?G(X):K(X)}},2552:rt=>{rt.exports=function Ae(){}},8799:(rt,Ae,z)=>{var G=z(4125),K=z(1435),ue=z(1503);rt.exports=function re(X){return(ue(X)?G:K)(X)}},9336:(rt,Ae,z)=>{var G=z(8906),K=z(7522),ue=z(1503);rt.exports=function re(X){return(ue(X)?G:K)(X)}},3580:rt=>{rt.exports=function Ae(){return!1}},836:(rt,Ae,z)=>{var G=z(707);rt.exports=function K(ue){return ue&&ue.length?G(ue):[]}},377:(rt,Ae,z)=>{var G=z(9179),K=z(118);rt.exports=function ue(re){return null==re?[]:G(re,K(re))}},7658:rt=>{rt.exports=z;var Ae=null;try{Ae=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(Ne){}function z(Ne,we,qe){this.low=0|Ne,this.high=0|we,this.unsigned=!!qe}function G(Ne){return!0===(Ne&&Ne.__isLong__)}Object.defineProperty(z.prototype,"__isLong__",{value:!0}),z.isLong=G;var K={},ue={};function re(Ne,we){var qe,Ye,at;return we?(at=0<=(Ne>>>=0)&&Ne<256)&&(Ye=ue[Ne])?Ye:(qe=se(Ne,(0|Ne)<0?-1:0,!0),at&&(ue[Ne]=qe),qe):(at=-128<=(Ne|=0)&&Ne<128)&&(Ye=K[Ne])?Ye:(qe=se(Ne,Ne<0?-1:0,!1),at&&(K[Ne]=qe),qe)}function X(Ne,we){if(isNaN(Ne))return we?ce:te;if(we){if(Ne<0)return ce;if(Ne>=H)return it}else{if(Ne<=-Y)return bt;if(Ne+1>=Y)return Ve}return Ne<0?X(-Ne,we).neg():se(Ne%J|0,Ne/J|0,we)}function se(Ne,we,qe){return new z(Ne,we,qe)}z.fromInt=re,z.fromNumber=X,z.fromBits=se;var be=Math.pow;function V(Ne,we,qe){if(0===Ne.length)throw Error("empty string");if("NaN"===Ne||"Infinity"===Ne||"+Infinity"===Ne||"-Infinity"===Ne)return te;if("number"==typeof we?(qe=we,we=!1):we=!!we,(qe=qe||10)<2||36<qe)throw RangeError("radix");var Ye;if((Ye=Ne.indexOf("-"))>0)throw Error("interior hyphen");if(0===Ye)return V(Ne.substring(1),we,qe).neg();for(var at=X(be(qe,8)),At=te,Ut=0;Ut<Ne.length;Ut+=8){var Mt=Math.min(8,Ne.length-Ut),sn=parseInt(Ne.substring(Ut,Ut+Mt),qe);if(Mt<8){var je=X(be(qe,Mt));At=At.mul(je).add(X(sn))}else At=(At=At.mul(at)).add(X(sn))}return At.unsigned=we,At}function ee(Ne,we){return"number"==typeof Ne?X(Ne,we):"string"==typeof Ne?V(Ne,we):se(Ne.low,Ne.high,"boolean"==typeof we?we:Ne.unsigned)}z.fromString=V,z.fromValue=ee;var J=4294967296,H=J*J,Y=H/2,me=re(1<<24),te=re(0);z.ZERO=te;var ce=re(0,!0);z.UZERO=ce;var xe=re(1);z.ONE=xe;var Pe=re(1,!0);z.UONE=Pe;var Ke=re(-1);z.NEG_ONE=Ke;var Ve=se(-1,2147483647,!1);z.MAX_VALUE=Ve;var it=se(-1,-1,!0);z.MAX_UNSIGNED_VALUE=it;var bt=se(0,-2147483648,!1);z.MIN_VALUE=bt;var $e=z.prototype;$e.toInt=function(){return this.unsigned?this.low>>>0:this.low},$e.toNumber=function(){return this.unsigned?(this.high>>>0)*J+(this.low>>>0):this.high*J+(this.low>>>0)},$e.toString=function(we){if((we=we||10)<2||36<we)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(bt)){var qe=X(we),Ye=this.div(qe),at=Ye.mul(qe).sub(this);return Ye.toString(we)+at.toInt().toString(we)}return"-"+this.neg().toString(we)}for(var At=X(be(we,6),this.unsigned),Ut=this,Mt="";;){var sn=Ut.div(At),We=(Ut.sub(sn.mul(At)).toInt()>>>0).toString(we);if((Ut=sn).isZero())return We+Mt;for(;We.length<6;)We="0"+We;Mt=""+We+Mt}},$e.getHighBits=function(){return this.high},$e.getHighBitsUnsigned=function(){return this.high>>>0},$e.getLowBits=function(){return this.low},$e.getLowBitsUnsigned=function(){return this.low>>>0},$e.getNumBitsAbs=function(){if(this.isNegative())return this.eq(bt)?64:this.neg().getNumBitsAbs();for(var we=0!=this.high?this.high:this.low,qe=31;qe>0&&0==(we&1<<qe);qe--);return 0!=this.high?qe+33:qe+1},$e.isZero=function(){return 0===this.high&&0===this.low},$e.eqz=$e.isZero,$e.isNegative=function(){return!this.unsigned&&this.high<0},$e.isPositive=function(){return this.unsigned||this.high>=0},$e.isOdd=function(){return 1==(1&this.low)},$e.isEven=function(){return 0==(1&this.low)},$e.equals=function(we){return G(we)||(we=ee(we)),(this.unsigned===we.unsigned||this.high>>>31!=1||we.high>>>31!=1)&&this.high===we.high&&this.low===we.low},$e.eq=$e.equals,$e.notEquals=function(we){return!this.eq(we)},$e.neq=$e.notEquals,$e.ne=$e.notEquals,$e.lessThan=function(we){return this.comp(we)<0},$e.lt=$e.lessThan,$e.lessThanOrEqual=function(we){return this.comp(we)<=0},$e.lte=$e.lessThanOrEqual,$e.le=$e.lessThanOrEqual,$e.greaterThan=function(we){return this.comp(we)>0},$e.gt=$e.greaterThan,$e.greaterThanOrEqual=function(we){return this.comp(we)>=0},$e.gte=$e.greaterThanOrEqual,$e.ge=$e.greaterThanOrEqual,$e.compare=function(we){if(G(we)||(we=ee(we)),this.eq(we))return 0;var qe=this.isNegative(),Ye=we.isNegative();return qe&&!Ye?-1:!qe&&Ye?1:this.unsigned?we.high>>>0>this.high>>>0||we.high===this.high&&we.low>>>0>this.low>>>0?-1:1:this.sub(we).isNegative()?-1:1},$e.comp=$e.compare,$e.negate=function(){return!this.unsigned&&this.eq(bt)?bt:this.not().add(xe)},$e.neg=$e.negate,$e.add=function(we){G(we)||(we=ee(we));var We=0,tt=0,Pt=0,Ue=0;return Pt+=(Ue+=(65535&this.low)+(65535&we.low))>>>16,tt+=(Pt+=(this.low>>>16)+(we.low>>>16))>>>16,We+=(tt+=(65535&this.high)+(65535&we.high))>>>16,We+=(this.high>>>16)+(we.high>>>16),se((Pt&=65535)<<16|(Ue&=65535),(We&=65535)<<16|(tt&=65535),this.unsigned)},$e.subtract=function(we){return G(we)||(we=ee(we)),this.add(we.neg())},$e.sub=$e.subtract,$e.multiply=function(we){if(this.isZero())return te;if(G(we)||(we=ee(we)),Ae)return se(Ae.mul(this.low,this.high,we.low,we.high),Ae.get_high(),this.unsigned);if(we.isZero())return te;if(this.eq(bt))return we.isOdd()?bt:te;if(we.eq(bt))return this.isOdd()?bt:te;if(this.isNegative())return we.isNegative()?this.neg().mul(we.neg()):this.neg().mul(we).neg();if(we.isNegative())return this.mul(we.neg()).neg();if(this.lt(me)&&we.lt(me))return X(this.toNumber()*we.toNumber(),this.unsigned);var at=65535&this.high,At=this.low>>>16,Ut=65535&this.low,sn=65535&we.high,je=we.low>>>16,We=65535&we.low,tt=0,Pt=0,Ue=0,xt=0;return Ue+=(xt+=Ut*We)>>>16,Pt+=(Ue+=At*We)>>>16,Ue&=65535,Pt+=(Ue+=Ut*je)>>>16,tt+=(Pt+=at*We)>>>16,Pt&=65535,tt+=(Pt+=At*je)>>>16,Pt&=65535,tt+=(Pt+=Ut*sn)>>>16,tt+=(this.high>>>16)*We+at*je+At*sn+Ut*(we.high>>>16),se((Ue&=65535)<<16|(xt&=65535),(tt&=65535)<<16|(Pt&=65535),this.unsigned)},$e.mul=$e.multiply,$e.divide=function(we){if(G(we)||(we=ee(we)),we.isZero())throw Error("division by zero");var Ye,at,At;if(Ae)return this.unsigned||-2147483648!==this.high||-1!==we.low||-1!==we.high?se((this.unsigned?Ae.div_u:Ae.div_s)(this.low,this.high,we.low,we.high),Ae.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?ce:te;if(this.unsigned){if(we.unsigned||(we=we.toUnsigned()),we.gt(this))return ce;if(we.gt(this.shru(1)))return Pe;At=ce}else{if(this.eq(bt))return we.eq(xe)||we.eq(Ke)?bt:we.eq(bt)?xe:(Ye=this.shr(1).div(we).shl(1)).eq(te)?we.isNegative()?xe:Ke:(at=this.sub(we.mul(Ye)),At=Ye.add(at.div(we)));if(we.eq(bt))return this.unsigned?ce:te;if(this.isNegative())return we.isNegative()?this.neg().div(we.neg()):this.neg().div(we).neg();if(we.isNegative())return this.div(we.neg()).neg();At=te}for(at=this;at.gte(we);){Ye=Math.max(1,Math.floor(at.toNumber()/we.toNumber()));for(var Mt=Math.ceil(Math.log(Ye)/Math.LN2),sn=Mt<=48?1:be(2,Mt-48),je=X(Ye),We=je.mul(we);We.isNegative()||We.gt(at);)We=(je=X(Ye-=sn,this.unsigned)).mul(we);je.isZero()&&(je=xe),At=At.add(je),at=at.sub(We)}return At},$e.div=$e.divide,$e.modulo=function(we){return G(we)||(we=ee(we)),Ae?se((this.unsigned?Ae.rem_u:Ae.rem_s)(this.low,this.high,we.low,we.high),Ae.get_high(),this.unsigned):this.sub(this.div(we).mul(we))},$e.mod=$e.modulo,$e.rem=$e.modulo,$e.not=function(){return se(~this.low,~this.high,this.unsigned)},$e.and=function(we){return G(we)||(we=ee(we)),se(this.low&we.low,this.high&we.high,this.unsigned)},$e.or=function(we){return G(we)||(we=ee(we)),se(this.low|we.low,this.high|we.high,this.unsigned)},$e.xor=function(we){return G(we)||(we=ee(we)),se(this.low^we.low,this.high^we.high,this.unsigned)},$e.shiftLeft=function(we){return G(we)&&(we=we.toInt()),0==(we&=63)?this:we<32?se(this.low<<we,this.high<<we|this.low>>>32-we,this.unsigned):se(0,this.low<<we-32,this.unsigned)},$e.shl=$e.shiftLeft,$e.shiftRight=function(we){return G(we)&&(we=we.toInt()),0==(we&=63)?this:we<32?se(this.low>>>we|this.high<<32-we,this.high>>we,this.unsigned):se(this.high>>we-32,this.high>=0?0:-1,this.unsigned)},$e.shr=$e.shiftRight,$e.shiftRightUnsigned=function(we){if(G(we)&&(we=we.toInt()),0==(we&=63))return this;var qe=this.high;return we<32?se(this.low>>>we|qe<<32-we,qe>>>we,this.unsigned):se(32===we?qe:qe>>>we-32,0,this.unsigned)},$e.shru=$e.shiftRightUnsigned,$e.shr_u=$e.shiftRightUnsigned,$e.toSigned=function(){return this.unsigned?se(this.low,this.high,!1):this},$e.toUnsigned=function(){return this.unsigned?this:se(this.low,this.high,!0)},$e.toBytes=function(we){return we?this.toBytesLE():this.toBytesBE()},$e.toBytesLE=function(){var we=this.high,qe=this.low;return[255&qe,qe>>>8&255,qe>>>16&255,qe>>>24,255&we,we>>>8&255,we>>>16&255,we>>>24]},$e.toBytesBE=function(){var we=this.high,qe=this.low;return[we>>>24,we>>>16&255,we>>>8&255,255&we,qe>>>24,qe>>>16&255,qe>>>8&255,255&qe]},z.fromBytes=function(we,qe,Ye){return Ye?z.fromBytesLE(we,qe):z.fromBytesBE(we,qe)},z.fromBytesLE=function(we,qe){return new z(we[0]|we[1]<<8|we[2]<<16|we[3]<<24,we[4]|we[5]<<8|we[6]<<16|we[7]<<24,qe)},z.fromBytesBE=function(we,qe){return new z(we[4]<<24|we[5]<<16|we[6]<<8|we[7],we[0]<<24|we[1]<<16|we[2]<<8|we[3],qe)}},56:(rt,Ae,z)=>{"use strict";z.r(Ae),z.d(Ae,{ClassificationCriterion:()=>fC,ColumnTransformer:()=>F9,DecisionTree:()=>n4,DecisionTreeBase:()=>gk,DecisionTreeClassifier:()=>K9,DecisionTreeRegressor:()=>X9,DummyClassifier:()=>Pz,DummyRegressor:()=>sz,ElasticNet:()=>bd,GaussianNB:()=>Yz,KFold:()=>i4,KMeans:()=>ik,KNeighborsClassifier:()=>U9,KNeighborsRegressor:()=>hC,LabelEncoder:()=>rk,LassoRegression:()=>_m,LinearRegression:()=>Qh,LinearSVC:()=>H9,LinearSVR:()=>W9,LogisticRegression:()=>Bn,MaxAbsScaler:()=>M9,MinMaxScaler:()=>D9,Normalizer:()=>R9,OneHotEncoder:()=>wd,OrdinalEncoder:()=>Hz,Pipeline:()=>Wz,RegressionCriterion:()=>dC,RidgeRegression:()=>Qi,RobustScaler:()=>jz,Serialize:()=>Ls,SimpleImputer:()=>k9,Splitter:()=>t4,StandardScaler:()=>Vz,VotingClassifier:()=>ok,VotingRegressor:()=>sk,crossValScore:()=>eq,dataUrls:()=>L9,fromJSON:()=>ym,fromObject:()=>bo,getBackend:()=>X,makeLowRankMatrix:()=>r4,makePipeline:()=>O9,makeRegression:()=>Y9,makeVotingClassifier:()=>Zz,makeVotingRegressor:()=>qz,metrics:()=>G,setBackend:()=>re,trainTestSplit:()=>J9});var G={};z.r(G),z.d(G,{accuracyScore:()=>Fe,confusionMatrix:()=>xs,hingeLoss:()=>mr,huberLoss:()=>Br,logLoss:()=>Ps,meanAbsoluteError:()=>Sn,meanSquaredError:()=>Gn,meanSquaredLogError:()=>_r,precisionScore:()=>yt,r2Score:()=>pt,recallScore:()=>_t,rocAucScore:()=>ct,zeroOneLoss:()=>Yi});var K=z(5861);let ue=null;function re(l){ue=l}function X(){if(null===ue)throw Error("\n============================\nHowdy \u{1f44b}\u{1f44b}. Looks like you are running scikit but you haven't set a Tensorflow backend. \nTo do so, simply import (or require) your tensorflow library, and call setBackend like so,\n\nimport * as tf from '@tensorflow/tfjs'\nimport * as sk from 'scikitjs'\nsk.setBackend(tf)\n\nThat will let scikit know you wish to use a tensorflow library to perform your calculations.\n============================\n    ");return ue}function ee(l,c){if(!l)throw new Error(c)}function ge(l,c){let h=l;if(H(l))return"string"===c?[]:[l.length];if(!Array.isArray(l))return[];const f=[];for(;Array.isArray(h)||H(h)&&"string"!==c;)f.push(h.length),h=h[0];return Array.isArray(l)&&W(l,f,[]),f}function W(l,c,h){if(h=h||[],!Array.isArray(l)&&!H(l))return void ee(0===c.length,`Element arr[${h.join("][")}] is a primitive, but should be an array/TypedArray of ${c[0]} elements`);ee(c.length>0,`Element arr[${h.join("][")}] should be a primitive, but is an array of ${l.length} elements`),ee(l.length===c[0],`Element arr[${h.join("][")}] should have ${c[0]} elements, but has ${l.length} elements`);const f=c.slice(1);for(let p=0;p<l.length;++p)W(l[p],f,h.concat(p))}function J(l){return Array.isArray(l)?J(l[0]):l instanceof Float32Array?"float32":l instanceof Int32Array||l instanceof Uint8Array?"int32":function V(l){return"number"==typeof l}(l)?"float32":function se(l){return"string"==typeof l||l instanceof String}(l)?"string":function be(l){return"boolean"==typeof l}(l)?"bool":null}function H(l){return l instanceof Float32Array||l instanceof Int32Array||l instanceof Uint8Array}function te(l){return l instanceof X().Tensor}function ce(l){return"object"==typeof l&&!(!l||!l.iloc||l.applyMap)}function xe(l){return"object"==typeof l&&!!(l&&l.iloc&&l.applyMap)}function Pe(l){return!!ce(l)||(te(l)?1===l.rank:function Y(l){const c=ge(l),h=J(l);return 1===c.length&&null!==h}(l))}function Ke(l){return!!xe(l)||(te(l)?2===l.rank:function me(l){const c=ge(l),h=J(l);return 2===c.length&&null!==h}(l))}function $e(l,c){let h=X();if(ce(l))return c?l.tensor.asType(c):l.tensor;if(te(l)){if(1===l.shape.length)return c&&l.dtype!=c?l.asType(c):l;throw new Error("ParamError: if data is a Tensor it must be a Tensor1D. If you really meant to reshape this tensor than use tf.reshape")}return c?h.tensor1d(l,c):h.tensor1d(l)}function Ne(l,c){const h=$e(l,c);if("string"===h.dtype)throw new Error("ParamError: data has string dtype, can't convert to numeric Tensor");return h}function we(l,c){let h=X();if(xe(l))return c?l.tensor.asType(c):l.tensor;if(te(l)){if(2===l.shape.length)return c&&l.dtype!=c?l.asType(c):l;throw new Error("ParamError: if data is a Tensor it must be a Tensor2D. If you really meant to reshape this tensor than use tf.reshape")}if(Array.isArray(l)&&H(l[0])){const f=ge(l),p=l.map(v=>Array.from(v));return c?h.tensor2d(p,f,c):h.tensor2d(p,f)}return c?h.tensor2d(l,void 0,c):h.tensor2d(l,void 0)}function Ye(l,c){const h=we(l,c);if("string"===h.dtype)throw new Error("ParamError: data has string dtype, can't convert to numeric Tensor");return h}function at(l,c){const h=function qe(l,c){try{return $e(l,c)}catch(h){try{return we(l,c)}catch(f){throw new Error('ParamError: Can"t convert data into 1D or 2D tensor')}}}(l,c);if("string"===h.dtype)throw new Error("ParamError: data has string dtype, can't convert to numeric Tensor");return h}function je(l){return xe(l)?l.values:te(l)?l.arraySync():l}function We(l){return ce(l)?l.values:te(l)?l.arraySync():l}function Pt(l){return ee(function Ve(l){return Pe(l)||Ke(l)}(l),"X isn't a Scikit2D or Scikit1D object"),te(l)?l.shape[0]:xe(l)||ce(l)?l.size:l.length}function Ue(l,c,h){let f=X(),p=new Map,v=[],x=f.randomUniform([c],0,l,"float32",h).dataSync();for(let S=0;S<x.length;S++){x[S]=x[S]*(l-S)/l;let N=Math.floor(x[S]),T=l-S-1;void 0===p.get(N)&&p.set(N,N),void 0===p.get(T)&&p.set(T,T);let C=p.get(T);p.set(T,p.get(N)),p.set(N,C),v.push(p.get(T))}return v}var rn=z(836),he=z.n(rn);function _e(l,c){ee(Pe(l),"Labels can't be converted to a 1D Tensor"),ee(Pe(c),"Predictions can't be converted to a 1D Tensor");let h=Ne(l),f=Ne(c);return ee(h.size>0,"Must have 1 label or more"),ee(f.size>0,"Must have 1 prediction or more"),ee(h.size===f.size,"Not the same size arrays"),{labelsT:h,predictionsT:f}}function Fe(l,c){const{labelsT:h,predictionsT:f}=_e(l,c);return h.equal(f).sum().div(h.size).dataSync()[0]}function yt(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.metrics.precision(f,p).dataSync()[0]}function _t(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.metrics.recall(f,p).dataSync()[0]}function pt(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c),v=h.metrics.meanSquaredError(f,p),x=h.metrics.meanSquaredError(f,f.mean());return h.sub(1,v.div(x)).dataSync()[0]}function Sn(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.metrics.meanAbsoluteError(f,p).dataSync()[0]}function Gn(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.metrics.meanSquaredError(f,p).dataSync()[0]}function _r(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.square(f.log1p().sub(p.log1p())).sum().div(f.size).dataSync()[0]}function mr(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.losses.hingeLoss(f,p).dataSync()[0]}function Br(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.losses.huberLoss(f,p).dataSync()[0]}function Ps(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.losses.logLoss(f,p).dataSync()[0]}function Yi(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c);return h.sub(1,Fe(f,p)).dataSync()[0]}function xs(l,c){let h=X();const{labelsT:f,predictionsT:p}=_e(l,c),v=he()(f.dataSync());return h.math.confusionMatrix(f,p,v.length).arraySync()}function ct(l,c){const{labelsT:h,predictionsT:f}=_e(l,c);let p=h.arraySync(),v=f.arraySync();p.push(1),v.push(1);let x=0;for(let S=0;S<p.length-1;S++)x+=p[S]*v[S+1]-p[S+1]*v[S];return x-=1,Math.abs(x)/2}for(var ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",et="undefined"==typeof Uint8Array?[]:new Uint8Array(256),ft=0;ft<ze.length;ft++)et[ze.charCodeAt(ft)]=ft;const wn=["KNeighborsRegressor","LinearRegression","LassoRegression","RidgeRegression","ElasticNet","LogisticRegression","DummyRegressor","DummyClassifier","MinMaxScaler","StandardScaler","MaxAbsScaler","SimpleImputer","OneHotEncoder","LabelEncoder","OrdinalEncoder","Normalizer","Pipeline","ColumnTransformer","RobustScaler","KMeans","VotingRegressor","VotingClassifier","LinearSVC","LinearSVR","GaussianNB","DecisionTreeClassifier","DecisionTreeRegressor","ClassificationCriterion","RegressionCriterion","Splitter","DecisionTreeBase","DecisionTree"];let on="abcdefghijklmnopqrstuvwxy";function En(l){let c="";for(let h=0;h<l;h++){let f=Math.floor(Math.random()*on.length);c+=on[f]}return c}class Zn{constructor(c){gt(this,"savedArtifacts"),this.savedArtifacts=c||null}save(c){var h=this;return(0,K.Z)(function*(){c.weightData=function(l){var h,c=new Uint8Array(l),f=c.length,p="";for(h=0;h<f;h+=3)p+=ze[c[h]>>2],p+=ze[(3&c[h])<<4|c[h+1]>>4],p+=ze[(15&c[h+1])<<2|c[h+2]>>6],p+=ze[63&c[h+2]];return f%3==2?p=p.substring(0,p.length-1)+"=":f%3==1&&(p=p.substring(0,p.length-2)+"=="),p}(c.weightData);let f={};for(let p=0;p<c.modelTopology.config.layers.length;p++){let v=c.modelTopology.config.layers[p],x=En(6);f[v.config.name]=x,v.config.name=x}for(let p=0;p<c.weightSpecs.length;p++){let v=c.weightSpecs[p];Object.keys(f).forEach(S=>{v.name.includes(S)&&(v.name=v.name.replace(S,f[S]))})}return h.savedArtifacts=c,{modelArtifactsInfo:{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:JSON.stringify(c.modelTopology).length,weightSpecsBytes:JSON.stringify(c.weightSpecs).length,weightDataBytes:c.weightData.byteLength}}})()}load(){var c=this;return(0,K.Z)(function*(){return c.savedArtifacts.weightData=function(l){var f,v,x,S,N,c=.75*l.length,h=l.length,p=0;"="===l[l.length-1]&&(c--,"="===l[l.length-2]&&c--);var T=new ArrayBuffer(c),C=new Uint8Array(T);for(f=0;f<h;f+=4)v=et[l.charCodeAt(f)],x=et[l.charCodeAt(f+1)],S=et[l.charCodeAt(f+2)],N=et[l.charCodeAt(f+3)],C[p++]=v<<2|x>>4,C[p++]=(15&x)<<4|S>>2,C[p++]=(3&S)<<6|63&N;return T}(c.savedArtifacts.weightData),c.savedArtifacts})()}}function Nr(l){return ji.apply(this,arguments)}function ji(){return ji=(0,K.Z)(function*(l,c=[]){let h=X();if(["number","string","undefined","boolean"].includes(typeof l))return l;if("function"==typeof l&&(console.warn(`warning: Serializing function ${l}. Not going to be able to deserialize this later.`),l.name))return l.name;if("object"==typeof l){if(null===l)return null;if(Array.isArray(l))return yield Promise.all(l.map(function(){var p=(0,K.Z)(function*(v){return yield Nr(v,c)});return function(v){return p.apply(this,arguments)}}()));if(l instanceof h.Tensor)return{name:"Tensor",value:l.arraySync()};if(l instanceof Int32Array)return{name:"Int32Array",value:Array.from(l)};if(l instanceof Float32Array)return{name:"Float32Array",value:Array.from(l)};if(l instanceof h.Sequential){let p=new Zn;return yield l.save(p),{name:"Sequential",artifacts:p.savedArtifacts}}if(l.ENV&&l.AdadeltaOptimizer&&l.version)return{name:"TF",version:l.version.tfjs};let f={};for(let p of Object.keys(l))c.includes(p)||(f[p]=yield Nr(l[p],c));return f}}),ji.apply(this,arguments)}function bi(l){return js.apply(this,arguments)}function js(){return js=(0,K.Z)(function*(l){let c=X();if("object"!=typeof l)return l;if(null===l)return null;if("Tensor"===l.name)return c.tensor(l.value);if("Sequential"===l.name){let h=new Zn(l.artifacts);return yield c.loadLayersModel(h)}if("Int32Array"===l.name)return new Int32Array(l.value);if("Float32Array"===l.name)return new Float32Array(l.value);if("TF"===l.name)return c;if(Array.isArray(l))return yield Promise.all(l.map(function(){var h=(0,K.Z)(function*(f){return yield bi(f)});return function(f){return h.apply(this,arguments)}}()));for(let h of Object.keys(l))l[h]=yield bi(l[h]);if(wn.includes(l.name)){let p=new(0,(yield Promise.resolve().then(z.bind(z,56)))[l.name])(l);for(let v of Object.keys(l))p[v]=l[v];return p}return l}),js.apply(this,arguments)}function bo(l){return Ml.apply(this,arguments)}function Ml(){return(Ml=(0,K.Z)(function*(l){try{return yield bi(l)}catch(c){console.error(c)}})).apply(this,arguments)}function ym(l){return kl.apply(this,arguments)}function kl(){return(kl=(0,K.Z)(function*(l){return yield bo(JSON.parse(l))})).apply(this,arguments)}let _d=["modelCompileArgs","modelFitArgs","denseLayerArgs"];class Ls{toObject(){var c=this;return(0,K.Z)(function*(){return yield Nr(c,_d)})()}toJSON(){var c=this;return(0,K.Z)(function*(){return JSON.stringify(yield c.toObject())})()}}class ko extends Ls{fitTransform(c){return this.fit(c).transform(c)}}class oh extends Ls{constructor(){super(...arguments),gt(this,"EstimatorType","regressor")}score(c,h){return pt(h,this.predict(c))}}class $i extends Ls{constructor(){super(...arguments),gt(this,"EstimatorType","classifier")}score(c,h){const f=this.predict(c),p=at(h);return ee(f.shape.length===p.shape.length,"The shape of the model output doesn't match the shape of the actual y values"),Ke(h)?Fe(p.argMax(1),f.argMax(1)):Fe(h,f)}}class yc extends oh{constructor({modelFitArgs:c,modelCompileArgs:h,denseLayerArgs:f,optimizerType:p,lossType:v}){super(),gt(this,"model"),gt(this,"modelFitArgs"),gt(this,"modelCompileArgs"),gt(this,"denseLayerArgs"),gt(this,"isMultiOutput"),gt(this,"optimizerType"),gt(this,"lossType"),this.tf=X(),this.model=this.tf.sequential(),this.modelFitArgs=c,this.modelCompileArgs=h,this.denseLayerArgs=f,this.isMultiOutput=!1,this.optimizerType=p,this.lossType=v}initializeModel(c,h,f=[]){this.denseLayerArgs.units=1===h.shape.length?1:h.shape[1];const p=this.tf.sequential();p.add(this.tf.layers.dense(Lv({inputShape:[c.shape[1]]},this.denseLayerArgs))),p.compile(this.modelCompileArgs),(null==f?void 0:f.length)&&p.setWeights(f),this.model=p}fit(c,h){var f=this;return(0,K.Z)(function*(){let p=Ye(c),v=at(h);return v.shape.length>1&&(f.isMultiOutput=!0),0===f.model.layers.length&&f.initializeModel(p,v),yield f.model.fit(p,v,Lv({},f.modelFitArgs)),f})()}importModel(c){let h=this.tf.tensor2d(c.coef,[c.coef.length,1],"float32"),f=this.tf.tensor1d([c.intercept],"float32");return this.initializeModel(h,f,[h,f]),this}getParams(){return{modelFitArgs:this.modelFitArgs,modelCompileArgs:this.modelCompileArgs,denseLayerArgs:this.denseLayerArgs,optimizerType:this.optimizerType,lossType:this.lossType}}setParams(c){return this.modelCompileArgs=c.modelCompileArgs,this.modelFitArgs=c.modelFitArgs,this.denseLayerArgs=c.denseLayerArgs,this}predict(c){let h=Ye(c);if(0===this.model.layers.length)throw new RangeError('Need to call "fit" before "predict"');const f=this.model.predict(h);return this.isMultiOutput?f:f.reshape([-1])}get coef(){const c=this.model.getWeights();if(0===c.length)return this.tf.tensor2d([]);let h=c[0];return 1===h.shape[1]?h.reshape([h.shape[0]]):h}get intercept(){const c=this.model.getWeights();if(c.length<2)return 0;let h=c[1];return 1===h.size?h.arraySync()[0]:h}}class Qh extends yc{constructor({fitIntercept:c=!0,modelFitOptions:h}={}){let f=X();super({modelCompileArgs:{optimizer:f.train.adam(.1),loss:f.losses.meanSquaredError,metrics:["mse"]},modelFitArgs:Lv({batchSize:32,epochs:1e3,verbose:0,callbacks:[f.callbacks.earlyStopping({monitor:"mse",patience:30})]},h),denseLayerArgs:{units:1,useBias:Boolean(c)},optimizerType:"adam",lossType:"meanSquaredError"}),this.name="LinearRegression"}}class _m extends yc{constructor({fitIntercept:c=!0,alpha:h=1}={}){let f=X();super({modelCompileArgs:{optimizer:f.train.adam(.1),loss:f.losses.meanSquaredError,metrics:["mse"]},modelFitArgs:{batchSize:32,epochs:1e3,verbose:0,callbacks:[f.callbacks.earlyStopping({monitor:"mse",patience:50})]},denseLayerArgs:{units:1,kernelRegularizer:f.regularizers.l1({l1:h}),useBias:Boolean(c)},optimizerType:"adam",lossType:"meanSquaredError"}),this.name="LassoRegression"}}class Qi extends yc{constructor({fitIntercept:c=!0,alpha:h=.01}={}){let f=X();super({modelCompileArgs:{optimizer:f.train.adam(.1),loss:f.losses.meanSquaredError,metrics:["mse"]},modelFitArgs:{batchSize:32,epochs:1e3,verbose:0,callbacks:[f.callbacks.earlyStopping({monitor:"mse",patience:50})]},denseLayerArgs:{units:1,kernelRegularizer:f.regularizers.l2({l2:h}),useBias:Boolean(c)},optimizerType:"adam",lossType:"meanSquaredError"}),this.name="RidgeRegression"}}class bd extends yc{constructor({alpha:c=1,l1Ratio:h=.5,fitIntercept:f=!0}={}){let p=X();super({modelCompileArgs:{optimizer:p.train.adam(.1),loss:p.losses.meanSquaredError,metrics:["mse"]},modelFitArgs:{batchSize:32,epochs:1e3,verbose:0,callbacks:[p.callbacks.earlyStopping({monitor:"mse",patience:50})]},denseLayerArgs:{units:1,kernelRegularizer:p.regularizers.l1l2({l1:c*h,l2:.5*c*(1-h)}),useBias:Boolean(f)},optimizerType:"adam",lossType:"meanSquaredError"}),this.name="ElasticNet"}}class wd extends ko{constructor({categories:c="auto",handleUnknown:h="error",drop:f}={}){super(),gt(this,"categories"),gt(this,"handleUnknown"),gt(this,"categoriesParam"),gt(this,"drop"),gt(this,"nFeaturesIn"),gt(this,"featureNamesIn"),gt(this,"name","OneHotEncoder"),this.tf=X(),this.categoriesParam=c,this.categories=[],this.handleUnknown=h,this.nFeaturesIn=0,this.featureNamesIn=[],this.drop=f}classesToMapping(c){const h=new Map;return c.forEach((f,p)=>{h.set(f,p)}),h}loopOver2DArrayToSetLabels(c){for(let h=0;h<c[0].length;h++){let f=new Set;for(let v=0;v<c.length;v++)f.add(c[v][h]);let p=Array.from(f);this.categories.push(p)}}fit(c,h){const f=je(c);return"auto"===this.categoriesParam?(this.loopOver2DArrayToSetLabels(f),this):(this.categories=this.categoriesParam,this.nFeaturesIn=0===f.length?0:f[0].length||0,xe(c)&&(this.featureNamesIn=[...c.columns]),this)}loopOver2DArrayToUseLabels(c){let h=this.categories.map(p=>this.classesToMapping(p)),f=[];for(let p=0;p<c.length;p++){let v=[];for(let x=0;x<c[0].length;x++){let S=c[p][x],N=h[x].get(S);if(void 0===N){if("error"===this.handleUnknown)throw new Error(`Unknown value ${S} encountered while transforming. Not encountered in training data`);N=-1}"first"===this.drop&&(N-=1),v.push(N)}f.push(v)}return f}convertToOneHot(c,h){return h>=2?this.tf.oneHot(c,h):1===h?(c=this.tf.where(c.equal(0),this.tf.ones(c.shape,"int32"),this.tf.zeros(c.shape,"int32"))).reshape([-1,1]):this.tf.tensor2d([])}transform(c,h){const f=je(c),p=this.loopOver2DArrayToUseLabels(f),v=this.tf.tensor2d(p,void 0,"int32");return this.tf.concat(v.unstack(1).map((x,S)=>{let N=this.categories[S].length;return this.convertToOneHot(x,"first"===this.drop?N-1:N)}),1)}inverseTransform(c){let h=this.classesToMapping(this.categories[0]);const f=c.argMax(1),p=new Map(Array.from(h,x=>x.reverse()));return f.arraySync().map(x=>void 0===p.get(x)?null:p.get(x))}}class Pi extends $i{constructor({modelFitArgs:c,modelCompileArgs:h,denseLayerArgs:f,optimizerType:p,lossType:v}){super(),gt(this,"model"),gt(this,"modelFitArgs"),gt(this,"modelCompileArgs"),gt(this,"denseLayerArgs"),gt(this,"optimizerType"),gt(this,"lossType"),gt(this,"oneHot"),gt(this,"tf"),gt(this,"isMultiOutput"),this.tf=X(),this.model=this.tf.sequential(),this.modelFitArgs=c,this.modelCompileArgs=h,this.denseLayerArgs=f,this.optimizerType=p,this.lossType=v,this.isMultiOutput=!1,this.oneHot=new wd}initializeModelForClassification(c){let h=c.toInt();if(2===h.shape.length)return this.modelCompileArgs.loss=this.tf.losses.softmaxCrossEntropy,h;{const f=c.reshape([-1,1]),p=this.oneHot.fitTransform(f);return this.modelCompileArgs.loss=this.oneHot.categories[0].length>2?this.tf.losses.softmaxCrossEntropy:this.tf.losses.sigmoidCrossEntropy,p}}initializeModel(c,h,f=[]){this.denseLayerArgs.units=1===h.shape.length?1:h.shape[1];const p=this.tf.sequential();p.add(this.tf.layers.dense(Lv({inputShape:[c.shape[1]]},this.denseLayerArgs))),p.compile(this.modelCompileArgs),(null==f?void 0:f.length)&&p.setWeights(f),this.model=p}fit(c,h){var f=this;return(0,K.Z)(function*(){let p=Ye(c),v=at(h);const x=f.initializeModelForClassification(v);return v.shape.length>1&&(f.isMultiOutput=!0),0===f.model.layers.length&&f.initializeModel(p,x),yield f.model.fit(p,x,Lv({},f.modelFitArgs)),f})()}importModel(c){let h=this.tf.tensor2d(c.coef,[c.coef.length,1],"float32"),f=this.tf.tensor1d([c.intercept],"float32");return this.initializeModel(h,f,[h,f]),this}getParams(){return{modelFitArgs:this.modelFitArgs,modelCompileArgs:this.modelCompileArgs,denseLayerArgs:this.denseLayerArgs,optimizerType:this.optimizerType,lossType:this.lossType}}setParams(c){return this.modelCompileArgs=c.modelCompileArgs,this.modelFitArgs=c.modelFitArgs,this.denseLayerArgs=c.denseLayerArgs,this}predictProba(c){ee(this.model.layers.length>0,'Need to call "fit" before "predict"');let h=Ye(c);return this.model.predict(h)}predict(c){ee(this.model.layers.length>0,'Need to call "fit" before "predict"');const h=this.predictProba(c);return this.isMultiOutput?this.tf.oneHot(h.argMax(1),h.shape[1]):this.tf.tensor1d(this.oneHot.inverseTransform(h))}get coef(){const c=this.model.getWeights();if(0===c.length)return this.tf.tensor2d([]);let h=c[0];return 1===h.shape[1]?h.reshape([h.shape[0]]):h}get intercept(){const c=this.model.getWeights();if(c.length<2)return 0;let h=c[1];return 1===h.size?h.arraySync()[0]:h}}class Bn extends Pi{constructor({penalty:c="l2",C:h=1,fitIntercept:f=!0,modelFitOptions:p}={}){let v=X();super({modelCompileArgs:{optimizer:v.train.adam(.1),loss:v.losses.softmaxCrossEntropy,metrics:["accuracy"]},modelFitArgs:Lv({batchSize:32,epochs:1e3,verbose:0,callbacks:[v.callbacks.earlyStopping({monitor:"loss",patience:50})]},p),denseLayerArgs:{units:1,useBias:Boolean(f),activation:"softmax",kernelInitializer:v.initializers.zeros(),biasInitializer:v.initializers.zeros(),kernelRegularizer:"l2"===c?v.regularizers.l2({l2:h}):"l1"===c?v.regularizers.l1({l1:h}):void 0},isClassification:!0,optimizerType:"adam",lossType:"softmaxCrossEntropy"}),this.name="LogisticRegression"}}function Cu(){return Cu=Object.assign?Object.assign.bind():function(l){for(var c=1;c<arguments.length;c++){var h=arguments[c];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(l[f]=h[f])}return l},Cu.apply(this,arguments)}var qs={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null},cn=function(c){if(c)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(qs)};Cu(cn,qs,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]});var Cd,Su,mi=9e15,Ji=1e9,pa="0123456789abcdef",wm="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",xd="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",xm={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-mi,maxE:mi,crypto:!1},Sr=!0,tf="[DecimalError] ",Fl=tf+"Invalid argument: ",_b=tf+"Precision limit exceeded",Cm=tf+"crypto unavailable",nf="[object Decimal]",ns=Math.floor,Cs=Math.pow,Sd=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,li=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,cs=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,rf=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ro=1e7,Hr=wm.length-1,hs=xd.length-1,pn={toStringTag:nf};function ms(l){var c,h,f,p=l.length-1,v="",x=l[0];if(p>0){for(v+=x,c=1;c<p;c++)(h=7-(f=l[c]+"").length)&&(v+=Eu(h)),v+=f;(h=7-(f=(x=l[c])+"").length)&&(v+=Eu(h))}else if(0===x)return"0";for(;x%10==0;)x/=10;return v+x}function Bi(l,c,h){if(l!==~~l||l<c||l>h)throw Error(Fl+l)}function ah(l,c,h,f){var p,v,x,S;for(v=l[0];v>=10;v/=10)--c;return--c<0?(c+=7,p=0):(p=Math.ceil((c+1)/7),c%=7),v=Cs(10,7-c),S=l[p]%v|0,null==f?c<3?(0==c?S=S/100|0:1==c&&(S=S/10|0),x=h<4&&99999==S||h>3&&49999==S||5e4==S||0==S):x=(h<4&&S+1==v||h>3&&S+1==v/2)&&(l[p+1]/v/100|0)==Cs(10,c-2)-1||(S==v/2||0==S)&&0==(l[p+1]/v/100|0):c<4?(0==c?S=S/1e3|0:1==c?S=S/100|0:2==c&&(S=S/10|0),x=(f||h<4)&&9999==S||!f&&h>3&&4999==S):x=((f||h<4)&&S+1==v||!f&&h>3&&S+1==v/2)&&(l[p+1]/v/1e3|0)==Cs(10,c-3)-1,x}function Pl(l,c,h){for(var f,v,p=[0],x=0,S=l.length;x<S;){for(v=p.length;v--;)p[v]*=c;for(p[0]+=pa.indexOf(l.charAt(x++)),f=0;f<p.length;f++)p[f]>h-1&&(void 0===p[f+1]&&(p[f+1]=0),p[f+1]+=p[f]/h|0,p[f]%=h)}return p.reverse()}pn.absoluteValue=pn.abs=function(){var l=new this.constructor(this);return l.s<0&&(l.s=1),Xn(l)},pn.ceil=function(){return Xn(new this.constructor(this),this.e+1,2)},pn.clampedTo=pn.clamp=function(l,c){var f=this,p=f.constructor;if(l=new p(l),c=new p(c),!l.s||!c.s)return new p(NaN);if(l.gt(c))throw Error(Fl+c);return f.cmp(l)<0?l:f.cmp(c)>0?c:new p(f)},pn.comparedTo=pn.cmp=function(l){var c,h,f,p,v=this,x=v.d,S=(l=new v.constructor(l)).d,N=v.s,T=l.s;if(!x||!S)return N&&T?N!==T?N:x===S?0:!x^N<0?1:-1:NaN;if(!x[0]||!S[0])return x[0]?N:S[0]?-T:0;if(N!==T)return N;if(v.e!==l.e)return v.e>l.e^N<0?1:-1;for(c=0,h=(f=x.length)<(p=S.length)?f:p;c<h;++c)if(x[c]!==S[c])return x[c]>S[c]^N<0?1:-1;return f===p?0:f>p^N<0?1:-1},pn.cosine=pn.cos=function(){var l,c,h=this,f=h.constructor;return h.d?h.d[0]?(c=f.rounding,f.precision=(l=f.precision)+Math.max(h.e,h.sd())+7,f.rounding=1,h=function _c(l,c){var h,f,p;if(c.isZero())return c;(f=c.d.length)<32?p=(1/uf(4,h=Math.ceil(f/3))).toString():(h=16,p="2.3283064365386962890625e-10"),l.precision+=h,c=wi(l,1,c.times(p),new l(1));for(var v=h;v--;){var x=c.times(c);c=x.times(x).minus(x).times(8).plus(1)}return l.precision-=h,c}(f,lf(f,h)),f.precision=l,f.rounding=c,Xn(2==Su||3==Su?h.neg():h,l,c,!0)):new f(1):new f(NaN)},pn.cubeRoot=pn.cbrt=function(){var l,c,h,f,p,v,x,S,N,T,C=this,b=C.constructor;if(!C.isFinite()||C.isZero())return new b(C);for(Sr=!1,(v=C.s*Cs(C.s*C,1/3))&&Math.abs(v)!=1/0?f=new b(v.toString()):(h=ms(C.d),(v=((l=C.e)-h.length+1)%3)&&(h+=1==v||-2==v?"0":"00"),v=Cs(h,1/3),l=ns((l+1)/3)-(l%3==(l<0?-1:2)),(f=new b(h=v==1/0?"5e"+l:(h=v.toExponential()).slice(0,h.indexOf("e")+1)+l)).s=C.s),x=(l=b.precision)+3;;)if(T=(N=(S=f).times(S).times(S)).plus(C),f=vr(T.plus(C).times(S),T.plus(N),x+2,1),ms(S.d).slice(0,x)===(h=ms(f.d)).slice(0,x)){if("9999"!=(h=h.slice(x-3,x+1))&&(p||"4999"!=h)){(!+h||!+h.slice(1)&&"5"==h.charAt(0))&&(Xn(f,l+1,1),c=!f.times(f).times(f).eq(C));break}if(!p&&(Xn(S,l+1,0),S.times(S).times(S).eq(C))){f=S;break}x+=4,p=1}return Sr=!0,Xn(f,l,b.rounding,c)},pn.decimalPlaces=pn.dp=function(){var l,c=this.d,h=NaN;if(c){if(h=7*((l=c.length-1)-ns(this.e/7)),l=c[l])for(;l%10==0;l/=10)h--;h<0&&(h=0)}return h},pn.dividedBy=pn.div=function(l){return vr(this,new this.constructor(l))},pn.dividedToIntegerBy=pn.divToInt=function(l){var h=this.constructor;return Xn(vr(this,new h(l),0,1,1),h.precision,h.rounding)},pn.equals=pn.eq=function(l){return 0===this.cmp(l)},pn.floor=function(){return Xn(new this.constructor(this),this.e+1,3)},pn.greaterThan=pn.gt=function(l){return this.cmp(l)>0},pn.greaterThanOrEqualTo=pn.gte=function(l){var c=this.cmp(l);return 1==c||0===c},pn.hyperbolicCosine=pn.cosh=function(){var l,c,h,f,p,v=this,x=v.constructor,S=new x(1);if(!v.isFinite())return new x(v.s?1/0:NaN);if(v.isZero())return S;f=x.rounding,x.precision=(h=x.precision)+Math.max(v.e,v.sd())+4,x.rounding=1,(p=v.d.length)<32?c=(1/uf(4,l=Math.ceil(p/3))).toString():(l=16,c="2.3283064365386962890625e-10"),v=wi(x,1,v.times(c),new x(1),!0);for(var N,T=l,C=new x(8);T--;)N=v.times(v),v=S.minus(N.times(C.minus(N.times(C))));return Xn(v,x.precision=h,x.rounding=f,!0)},pn.hyperbolicSine=pn.sinh=function(){var l,c,h,f,p=this,v=p.constructor;if(!p.isFinite()||p.isZero())return new v(p);if(h=v.rounding,v.precision=(c=v.precision)+Math.max(p.e,p.sd())+4,v.rounding=1,(f=p.d.length)<3)p=wi(v,2,p,p,!0);else{l=1.4*Math.sqrt(f),p=wi(v,2,p=p.times(1/uf(5,l=l>16?16:0|l)),p,!0);for(var x,S=new v(5),N=new v(16),T=new v(20);l--;)x=p.times(p),p=p.times(S.plus(x.times(N.times(x).plus(T))))}return v.precision=c,v.rounding=h,Xn(p,c,h,!0)},pn.hyperbolicTangent=pn.tanh=function(){var l,c,h=this,f=h.constructor;return h.isFinite()?h.isZero()?new f(h):(c=f.rounding,f.precision=(l=f.precision)+7,f.rounding=1,vr(h.sinh(),h.cosh(),f.precision=l,f.rounding=c)):new f(h.s)},pn.inverseCosine=pn.acos=function(){var l,c=this,h=c.constructor,f=c.abs().cmp(1),p=h.precision,v=h.rounding;return-1!==f?0===f?c.isNeg()?Fo(h,p,v):new h(0):new h(NaN):c.isZero()?Fo(h,p+4,v).times(.5):(h.precision=p+6,h.rounding=1,c=c.asin(),l=Fo(h,p+4,v).times(.5),h.precision=p,h.rounding=v,l.minus(c))},pn.inverseHyperbolicCosine=pn.acosh=function(){var l,c,h=this,f=h.constructor;return h.lte(1)?new f(h.eq(1)?0:NaN):h.isFinite()?(c=f.rounding,f.precision=(l=f.precision)+Math.max(Math.abs(h.e),h.sd())+4,f.rounding=1,Sr=!1,h=h.times(h).minus(1).sqrt().plus(h),Sr=!0,f.precision=l,f.rounding=c,h.ln()):new f(h)},pn.inverseHyperbolicSine=pn.asinh=function(){var l,c,h=this,f=h.constructor;return!h.isFinite()||h.isZero()?new f(h):(c=f.rounding,f.precision=(l=f.precision)+2*Math.max(Math.abs(h.e),h.sd())+6,f.rounding=1,Sr=!1,h=h.times(h).plus(1).sqrt().plus(h),Sr=!0,f.precision=l,f.rounding=c,h.ln())},pn.inverseHyperbolicTangent=pn.atanh=function(){var l,c,h,f,p=this,v=p.constructor;return p.isFinite()?p.e>=0?new v(p.abs().eq(1)?p.s/0:p.isZero()?p:NaN):(l=v.precision,c=v.rounding,f=p.sd(),Math.max(f,l)<2*-p.e-1?Xn(new v(p),l,c,!0):(v.precision=h=f-p.e,p=vr(p.plus(1),new v(1).minus(p),h+l,1),v.precision=l+4,v.rounding=1,p=p.ln(),v.precision=l,v.rounding=c,p.times(.5))):new v(NaN)},pn.inverseSine=pn.asin=function(){var l,c,h,f,p=this,v=p.constructor;return p.isZero()?new v(p):(c=p.abs().cmp(1),h=v.precision,f=v.rounding,-1!==c?0===c?((l=Fo(v,h+4,f).times(.5)).s=p.s,l):new v(NaN):(v.precision=h+6,v.rounding=1,p=p.div(new v(1).minus(p.times(p)).sqrt().plus(1)).atan(),v.precision=h,v.rounding=f,p.times(2)))},pn.inverseTangent=pn.atan=function(){var l,c,h,f,p,v,x,S,N,T=this,C=T.constructor,b=C.precision,I=C.rounding;if(T.isFinite()){if(T.isZero())return new C(T);if(T.abs().eq(1)&&b+4<=hs)return(x=Fo(C,b+4,I).times(.25)).s=T.s,x}else{if(!T.s)return new C(NaN);if(b+4<=hs)return(x=Fo(C,b+4,I).times(.5)).s=T.s,x}for(C.precision=S=b+10,C.rounding=1,l=h=Math.min(28,S/7+2|0);l;--l)T=T.div(T.times(T).plus(1).sqrt().plus(1));for(Sr=!1,c=Math.ceil(S/7),f=1,N=T.times(T),x=new C(T),p=T;-1!==l;)if(p=p.times(N),v=x.minus(p.div(f+=2)),p=p.times(N),void 0!==(x=v.plus(p.div(f+=2))).d[c])for(l=c;x.d[l]===v.d[l]&&l--;);return h&&(x=x.times(2<<h-1)),Sr=!0,Xn(x,C.precision=b,C.rounding=I,!0)},pn.isFinite=function(){return!!this.d},pn.isInteger=pn.isInt=function(){return!!this.d&&ns(this.e/7)>this.d.length-2},pn.isNaN=function(){return!this.s},pn.isNegative=pn.isNeg=function(){return this.s<0},pn.isPositive=pn.isPos=function(){return this.s>0},pn.isZero=function(){return!!this.d&&0===this.d[0]},pn.lessThan=pn.lt=function(l){return this.cmp(l)<0},pn.lessThanOrEqualTo=pn.lte=function(l){return this.cmp(l)<1},pn.logarithm=pn.log=function(l){var c,h,f,p,v,x,S,N,T=this,C=T.constructor,b=C.precision,I=C.rounding;if(null==l)l=new C(10),c=!0;else{if(h=(l=new C(l)).d,l.s<0||!h||!h[0]||l.eq(1))return new C(NaN);c=l.eq(10)}if(h=T.d,T.s<0||!h||!h[0]||T.eq(1))return new C(h&&!h[0]?-1/0:1!=T.s?NaN:h?0:1/0);if(c)if(h.length>1)v=!0;else{for(p=h[0];p%10==0;)p/=10;v=1!==p}if(Sr=!1,x=io(T,S=b+5),f=c?ro(C,S+10):io(l,S),ah((N=vr(x,f,S,1)).d,p=b,I))do{if(x=io(T,S+=10),f=c?ro(C,S+10):io(l,S),N=vr(x,f,S,1),!v){+ms(N.d).slice(p+1,p+15)+1==1e14&&(N=Xn(N,b+1,0));break}}while(ah(N.d,p+=10,I));return Sr=!0,Xn(N,b,I)},pn.minus=pn.sub=function(l){var c,h,f,p,v,x,S,N,T,C,b,I,M=this,k=M.constructor;if(l=new k(l),!M.d||!l.d)return M.s&&l.s?M.d?l.s=-l.s:l=new k(l.d||M.s!==l.s?M:NaN):l=new k(NaN),l;if(M.s!=l.s)return l.s=-l.s,M.plus(l);if(I=l.d,S=k.precision,N=k.rounding,!(T=M.d)[0]||!I[0]){if(I[0])l.s=-l.s;else{if(!T[0])return new k(3===N?-0:0);l=new k(M)}return Sr?Xn(l,S,N):l}if(h=ns(l.e/7),C=ns(M.e/7),T=T.slice(),v=C-h){for((b=v<0)?(c=T,v=-v,x=I.length):(c=I,h=C,x=T.length),v>(f=Math.max(Math.ceil(S/7),x)+2)&&(v=f,c.length=1),c.reverse(),f=v;f--;)c.push(0);c.reverse()}else{for((b=(f=T.length)<(x=I.length))&&(x=f),f=0;f<x;f++)if(T[f]!=I[f]){b=T[f]<I[f];break}v=0}for(b&&(c=T,T=I,I=c,l.s=-l.s),f=I.length-(x=T.length);f>0;--f)T[x++]=0;for(f=I.length;f>v;){if(T[--f]<I[f]){for(p=f;p&&0===T[--p];)T[p]=Ro-1;--T[p],T[f]+=Ro}T[f]-=I[f]}for(;0===T[--x];)T.pop();for(;0===T[0];T.shift())--h;return T[0]?(l.d=T,l.e=Ju(T,h),Sr?Xn(l,S,N):l):new k(3===N?-0:0)},pn.modulo=pn.mod=function(l){var c,h=this,f=h.constructor;return l=new f(l),!h.d||!l.s||l.d&&!l.d[0]?new f(NaN):!l.d||h.d&&!h.d[0]?Xn(new f(h),f.precision,f.rounding):(Sr=!1,9==f.modulo?(c=vr(h,l.abs(),0,3,1)).s*=l.s:c=vr(h,l,0,f.modulo,1),c=c.times(l),Sr=!0,h.minus(c))},pn.naturalExponential=pn.exp=function(){return uh(this)},pn.naturalLogarithm=pn.ln=function(){return io(this)},pn.negated=pn.neg=function(){var l=new this.constructor(this);return l.s=-l.s,Xn(l)},pn.plus=pn.add=function(l){var c,h,f,p,v,x,S,N,T,C,b=this,I=b.constructor;if(l=new I(l),!b.d||!l.d)return b.s&&l.s?b.d||(l=new I(l.d||b.s===l.s?b:NaN)):l=new I(NaN),l;if(b.s!=l.s)return l.s=-l.s,b.minus(l);if(C=l.d,S=I.precision,N=I.rounding,!(T=b.d)[0]||!C[0])return C[0]||(l=new I(b)),Sr?Xn(l,S,N):l;if(v=ns(b.e/7),f=ns(l.e/7),T=T.slice(),p=v-f){for(p<0?(h=T,p=-p,x=C.length):(h=C,f=v,x=T.length),p>(x=(v=Math.ceil(S/7))>x?v+1:x+1)&&(p=x,h.length=1),h.reverse();p--;)h.push(0);h.reverse()}for((x=T.length)-(p=C.length)<0&&(p=x,h=C,C=T,T=h),c=0;p;)c=(T[--p]=T[p]+C[p]+c)/Ro|0,T[p]%=Ro;for(c&&(T.unshift(c),++f),x=T.length;0==T[--x];)T.pop();return l.d=T,l.e=Ju(T,f),Sr?Xn(l,S,N):l},pn.precision=pn.sd=function(l){var c,h=this;if(void 0!==l&&l!==!!l&&1!==l&&0!==l)throw Error(Fl+l);return h.d?(c=Ed(h.d),l&&h.e+1>c&&(c=h.e+1)):c=NaN,c},pn.round=function(){var l=this,c=l.constructor;return Xn(new c(l),l.e+1,c.rounding)},pn.sine=pn.sin=function(){var l,c,h=this,f=h.constructor;return h.isFinite()?h.isZero()?new f(h):(c=f.rounding,f.precision=(l=f.precision)+Math.max(h.e,h.sd())+7,f.rounding=1,h=function ma(l,c){var h,f=c.d.length;if(f<3)return c.isZero()?c:wi(l,2,c,c);h=1.4*Math.sqrt(f),c=wi(l,2,c=c.times(1/uf(5,h=h>16?16:0|h)),c);for(var p,v=new l(5),x=new l(16),S=new l(20);h--;)p=c.times(c),c=c.times(v.plus(p.times(x.times(p).minus(S))));return c}(f,lf(f,h)),f.precision=l,f.rounding=c,Xn(Su>2?h.neg():h,l,c,!0)):new f(NaN)},pn.squareRoot=pn.sqrt=function(){var l,c,h,f,p,v,x=this,S=x.d,N=x.e,T=x.s,C=x.constructor;if(1!==T||!S||!S[0])return new C(!T||T<0&&(!S||S[0])?NaN:S?x:1/0);for(Sr=!1,0==(T=Math.sqrt(+x))||T==1/0?(((c=ms(S)).length+N)%2==0&&(c+="0"),T=Math.sqrt(c),N=ns((N+1)/2)-(N<0||N%2),f=new C(c=T==1/0?"5e"+N:(c=T.toExponential()).slice(0,c.indexOf("e")+1)+N)):f=new C(T.toString()),h=(N=C.precision)+3;;)if(f=(v=f).plus(vr(x,v,h+2,1)).times(.5),ms(v.d).slice(0,h)===(c=ms(f.d)).slice(0,h)){if("9999"!=(c=c.slice(h-3,h+1))&&(p||"4999"!=c)){(!+c||!+c.slice(1)&&"5"==c.charAt(0))&&(Xn(f,N+1,1),l=!f.times(f).eq(x));break}if(!p&&(Xn(v,N+1,0),v.times(v).eq(x))){f=v;break}h+=4,p=1}return Sr=!0,Xn(f,N,C.rounding,l)},pn.tangent=pn.tan=function(){var l,c,h=this,f=h.constructor;return h.isFinite()?h.isZero()?new f(h):(c=f.rounding,f.precision=(l=f.precision)+10,f.rounding=1,(h=h.sin()).s=1,h=vr(h,new f(1).minus(h.times(h)).sqrt(),l+10,0),f.precision=l,f.rounding=c,Xn(2==Su||4==Su?h.neg():h,l,c,!0)):new f(NaN)},pn.times=pn.mul=function(l){var c,h,f,p,v,x,S,N,T,C=this,b=C.constructor,I=C.d,M=(l=new b(l)).d;if(l.s*=C.s,!(I&&I[0]&&M&&M[0]))return new b(!l.s||I&&!I[0]&&!M||M&&!M[0]&&!I?NaN:I&&M?0*l.s:l.s/0);for(h=ns(C.e/7)+ns(l.e/7),(N=I.length)<(T=M.length)&&(v=I,I=M,M=v,x=N,N=T,T=x),v=[],f=x=N+T;f--;)v.push(0);for(f=T;--f>=0;){for(c=0,p=N+f;p>f;)S=v[p]+M[f]*I[p-f-1]+c,v[p--]=S%Ro|0,c=S/Ro|0;v[p]=(v[p]+c)%Ro|0}for(;!v[--x];)v.pop();return c?++h:v.shift(),l.d=v,l.e=Ju(v,h),Sr?Xn(l,b.precision,b.rounding):l},pn.toBinary=function(l,c){return wc(this,2,l,c)},pn.toDecimalPlaces=pn.toDP=function(l,c){var h=this,f=h.constructor;return h=new f(h),void 0===l?h:(Bi(l,0,Ji),void 0===c?c=f.rounding:Bi(c,0,8),Xn(h,l+h.e+1,c))},pn.toExponential=function(l,c){var h,f=this,p=f.constructor;return void 0===l?h=Oo(f,!0):(Bi(l,0,Ji),void 0===c?c=p.rounding:Bi(c,0,8),h=Oo(f=Xn(new p(f),l+1,c),!0,l+1)),f.isNeg()&&!f.isZero()?"-"+h:h},pn.toFixed=function(l,c){var h,f,p=this,v=p.constructor;return void 0===l?h=Oo(p):(Bi(l,0,Ji),void 0===c?c=v.rounding:Bi(c,0,8),h=Oo(f=Xn(new v(p),l+p.e+1,c),!1,l+f.e+1)),p.isNeg()&&!p.isZero()?"-"+h:h},pn.toFraction=function(l){var c,h,f,p,v,x,S,N,T,C,b,I,M=this,k=M.d,F=M.constructor;if(!k)return new F(M);if(T=h=new F(1),f=N=new F(0),v=(c=new F(f)).e=Ed(k)-M.e-1,c.d[0]=Cs(10,(x=v%7)<0?7+x:x),null==l)l=v>0?c:T;else{if(!(S=new F(l)).isInt()||S.lt(T))throw Error(Fl+S);l=S.gt(c)?v>0?c:T:S}for(Sr=!1,S=new F(ms(k)),C=F.precision,F.precision=v=7*k.length*2;b=vr(S,c,0,1,1),1!=(p=h.plus(b.times(f))).cmp(l);)h=f,f=p,T=N.plus(b.times(p=T)),N=p,c=S.minus(b.times(p=c)),S=p;return p=vr(l.minus(h),f,0,1,1),N=N.plus(p.times(T)),h=h.plus(p.times(f)),N.s=T.s=M.s,I=vr(T,f,v,1).minus(M).abs().cmp(vr(N,h,v,1).minus(M).abs())<1?[T,f]:[N,h],F.precision=C,Sr=!0,I},pn.toHexadecimal=pn.toHex=function(l,c){return wc(this,16,l,c)},pn.toNearest=function(l,c){var h=this,f=h.constructor;if(h=new f(h),null==l){if(!h.d)return h;l=new f(1),c=f.rounding}else{if(l=new f(l),void 0===c?c=f.rounding:Bi(c,0,8),!h.d)return l.s?h:l;if(!l.d)return l.s&&(l.s=h.s),l}return l.d[0]?(Sr=!1,h=vr(h,l,0,c,1).times(l),Sr=!0,Xn(h)):(l.s=h.s,h=l),h},pn.toNumber=function(){return+this},pn.toOctal=function(l,c){return wc(this,8,l,c)},pn.toPower=pn.pow=function(l){var c,h,f,p,v,x,S=this,N=S.constructor,T=+(l=new N(l));if(!(S.d&&l.d&&S.d[0]&&l.d[0]))return new N(Cs(+S,T));if((S=new N(S)).eq(1))return S;if(f=N.precision,v=N.rounding,l.eq(1))return Xn(S,f,v);if((c=ns(l.e/7))>=l.d.length-1&&(h=T<0?-T:T)<=9007199254740991)return p=sf(N,S,h,f),l.s<0?new N(1).div(p):Xn(p,f,v);if((x=S.s)<0){if(c<l.d.length-1)return new N(NaN);if(0==(1&l.d[c])&&(x=1),0==S.e&&1==S.d[0]&&1==S.d.length)return S.s=x,S}return(c=0!=(h=Cs(+S,T))&&isFinite(h)?new N(h+"").e:ns(T*(Math.log("0."+ms(S.d))/Math.LN10+S.e+1)))>N.maxE+1||c<N.minE-1?new N(c>0?x/0:0):(Sr=!1,N.rounding=S.s=1,h=Math.min(12,(c+"").length),(p=uh(l.times(io(S,f+h)),f)).d&&ah((p=Xn(p,f+5,1)).d,f,v)&&+ms((p=Xn(uh(l.times(io(S,(c=f+10)+h)),c),c+5,1)).d).slice(f+1,f+15)+1==1e14&&(p=Xn(p,f+1,0)),p.s=x,Sr=!0,N.rounding=v,Xn(p,f,v))},pn.toPrecision=function(l,c){var h,f=this,p=f.constructor;return void 0===l?h=Oo(f,f.e<=p.toExpNeg||f.e>=p.toExpPos):(Bi(l,1,Ji),void 0===c?c=p.rounding:Bi(c,0,8),h=Oo(f=Xn(new p(f),l,c),l<=f.e||f.e<=p.toExpNeg,l)),f.isNeg()&&!f.isZero()?"-"+h:h},pn.toSignificantDigits=pn.toSD=function(l,c){var f=this.constructor;return void 0===l?(l=f.precision,c=f.rounding):(Bi(l,1,Ji),void 0===c?c=f.rounding:Bi(c,0,8)),Xn(new f(this),l,c)},pn.toString=function(){var l=this,c=l.constructor,h=Oo(l,l.e<=c.toExpNeg||l.e>=c.toExpPos);return l.isNeg()&&!l.isZero()?"-"+h:h},pn.truncated=pn.trunc=function(){return Xn(new this.constructor(this),this.e+1,1)},pn.valueOf=pn.toJSON=function(){var l=this,c=l.constructor,h=Oo(l,l.e<=c.toExpNeg||l.e>=c.toExpPos);return l.isNeg()?"-"+h:h};var vr=function(){function l(f,p,v){var x,S=0,N=f.length;for(f=f.slice();N--;)f[N]=(x=f[N]*p+S)%v|0,S=x/v|0;return S&&f.unshift(S),f}function c(f,p,v,x){var S,N;if(v!=x)N=v>x?1:-1;else for(S=N=0;S<v;S++)if(f[S]!=p[S]){N=f[S]>p[S]?1:-1;break}return N}function h(f,p,v,x){for(var S=0;v--;)f[v]-=S,f[v]=(S=f[v]<p[v]?1:0)*x+f[v]-p[v];for(;!f[0]&&f.length>1;)f.shift()}return function(f,p,v,x,S,N){var T,C,b,I,M,k,F,oe,ne,de,j,ae,le,q,Ce,Se,Ee,ve,ke,Oe,Ze=f.constructor,nt=f.s==p.s?1:-1,ht=f.d,Je=p.d;if(!(ht&&ht[0]&&Je&&Je[0]))return new Ze(f.s&&p.s&&(ht?!Je||ht[0]!=Je[0]:Je)?ht&&0==ht[0]||!Je?0*nt:nt/0:NaN);for(N?(M=1,C=f.e-p.e):(N=Ro,C=ns(f.e/(M=7))-ns(p.e/M)),ke=Je.length,Ee=ht.length,de=(ne=new Ze(nt)).d=[],b=0;Je[b]==(ht[b]||0);b++);if(Je[b]>(ht[b]||0)&&C--,null==v?(q=v=Ze.precision,x=Ze.rounding):q=S?v+(f.e-p.e)+1:v,q<0)de.push(1),k=!0;else{if(q=q/M+2|0,b=0,1==ke){for(I=0,Je=Je[0],q++;(b<Ee||I)&&q--;b++)de[b]=(Ce=I*N+(ht[b]||0))/Je|0,I=Ce%Je|0;k=I||b<Ee}else{for((I=N/(Je[0]+1)|0)>1&&(Je=l(Je,I,N),ht=l(ht,I,N),ke=Je.length,Ee=ht.length),Se=ke,ae=(j=ht.slice(0,ke)).length;ae<ke;)j[ae++]=0;(Oe=Je.slice()).unshift(0),ve=Je[0],Je[1]>=N/2&&++ve;do{I=0,(T=c(Je,j,ke,ae))<0?(le=j[0],ke!=ae&&(le=le*N+(j[1]||0)),(I=le/ve|0)>1?(I>=N&&(I=N-1),1==(T=c(F=l(Je,I,N),j,oe=F.length,ae=j.length))&&(I--,h(F,ke<oe?Oe:Je,oe,N))):(0==I&&(T=I=1),F=Je.slice()),(oe=F.length)<ae&&F.unshift(0),h(j,F,ae,N),-1==T&&(T=c(Je,j,ke,ae=j.length))<1&&(I++,h(j,ke<ae?Oe:Je,ae,N)),ae=j.length):0===T&&(I++,j=[0]),de[b++]=I,T&&j[0]?j[ae++]=ht[Se]||0:(j=[ht[Se]],ae=1)}while((Se++<Ee||void 0!==j[0])&&q--);k=void 0!==j[0]}de[0]||de.shift()}if(1==M)ne.e=C,Cd=k;else{for(b=1,I=de[0];I>=10;I/=10)b++;ne.e=b+C*M-1,Xn(ne,S?v+ne.e+1:v,x,k)}return ne}}();function Xn(l,c,h,f){var p,v,x,S,N,T,C,b,I,M=l.constructor;e:if(null!=c){if(!(b=l.d))return l;for(p=1,S=b[0];S>=10;S/=10)p++;if((v=c-p)<0)v+=7,N=(C=b[I=0])/Cs(10,p-(x=c)-1)%10|0;else if((I=Math.ceil((v+1)/7))>=(S=b.length)){if(!f)break e;for(;S++<=I;)b.push(0);C=N=0,p=1,x=(v%=7)-7+1}else{for(C=S=b[I],p=1;S>=10;S/=10)p++;N=(x=(v%=7)-7+p)<0?0:C/Cs(10,p-x-1)%10|0}if(f=f||c<0||void 0!==b[I+1]||(x<0?C:C%Cs(10,p-x-1)),T=h<4?(N||f)&&(0==h||h==(l.s<0?3:2)):N>5||5==N&&(4==h||f||6==h&&(v>0?x>0?C/Cs(10,p-x):0:b[I-1])%10&1||h==(l.s<0?8:7)),c<1||!b[0])return b.length=0,T?(b[0]=Cs(10,(7-(c-=l.e+1)%7)%7),l.e=-c||0):b[0]=l.e=0,l;if(0==v?(b.length=I,S=1,I--):(b.length=I+1,S=Cs(10,7-v),b[I]=x>0?(C/Cs(10,p-x)%Cs(10,x)|0)*S:0),T)for(;;){if(0==I){for(v=1,x=b[0];x>=10;x/=10)v++;for(x=b[0]+=S,S=1;x>=10;x/=10)S++;v!=S&&(l.e++,b[0]==Ro&&(b[0]=1));break}if(b[I]+=S,b[I]!=Ro)break;b[I--]=0,S=1}for(v=b.length;0===b[--v];)b.pop()}return Sr&&(l.e>M.maxE?(l.d=null,l.e=NaN):l.e<M.minE&&(l.e=0,l.d=[0])),l}function Oo(l,c,h){if(!l.isFinite())return Td(l);var f,p=l.e,v=ms(l.d),x=v.length;return c?(h&&(f=h-x)>0?v=v.charAt(0)+"."+v.slice(1)+Eu(f):x>1&&(v=v.charAt(0)+"."+v.slice(1)),v=v+(l.e<0?"e":"e+")+l.e):p<0?(v="0."+Eu(-p-1)+v,h&&(f=h-x)>0&&(v+=Eu(f))):p>=x?(v+=Eu(p+1-x),h&&(f=h-p-1)>0&&(v=v+"."+Eu(f))):((f=p+1)<x&&(v=v.slice(0,f)+"."+v.slice(f)),h&&(f=h-x)>0&&(p+1===x&&(v+="."),v+=Eu(f))),v}function Ju(l,c){var h=l[0];for(c*=7;h>=10;h/=10)c++;return c}function ro(l,c,h){if(c>Hr)throw Sr=!0,h&&(l.precision=h),Error(_b);return Xn(new l(wm),c,1,!0)}function Fo(l,c,h){if(c>hs)throw Error(_b);return Xn(new l(xd),c,h,!0)}function Ed(l){var c=l.length-1,h=7*c+1;if(c=l[c]){for(;c%10==0;c/=10)h--;for(c=l[0];c>=10;c/=10)h++}return h}function Eu(l){for(var c="";l--;)c+="0";return c}function sf(l,c,h,f){var p,v=new l(1),x=Math.ceil(f/7+4);for(Sr=!1;;){if(h%2&&cf((v=v.times(c)).d,x)&&(p=!0),0===(h=ns(h/2))){h=v.d.length-1,p&&0===v.d[h]&&++v.d[h];break}cf((c=c.times(c)).d,x)}return Sr=!0,v}function af(l){return 1&l.d[l.d.length-1]}function Nd(l,c,h){for(var f,p=new l(c[0]),v=0;++v<c.length;){if(!(f=new l(c[v])).s){p=f;break}p[h](f)&&(p=f)}return p}function uh(l,c){var h,f,p,v,x,S,N,T=0,C=0,b=0,I=l.constructor,M=I.rounding,k=I.precision;if(!l.d||!l.d[0]||l.e>17)return new I(l.d?l.d[0]?l.s<0?0:1/0:1:l.s?l.s<0?0:l:NaN);for(null==c?(Sr=!1,N=k):N=c,S=new I(.03125);l.e>-2;)l=l.times(S),b+=5;for(N+=f=Math.log(Cs(2,b))/Math.LN10*2+5|0,h=v=x=new I(1),I.precision=N;;){if(v=Xn(v.times(l),N,1),h=h.times(++C),ms((S=x.plus(vr(v,h,N,1))).d).slice(0,N)===ms(x.d).slice(0,N)){for(p=b;p--;)x=Xn(x.times(x),N,1);if(null!=c)return I.precision=k,x;if(!(T<3&&ah(x.d,N-f,M,T)))return Xn(x,I.precision=k,M,Sr=!0);I.precision=N+=10,h=v=S=new I(1),C=0,T++}x=S}}function io(l,c){var h,f,p,v,x,S,N,T,C,b,I,M=1,F=l,oe=F.d,ne=F.constructor,de=ne.rounding,j=ne.precision;if(F.s<0||!oe||!oe[0]||!F.e&&1==oe[0]&&1==oe.length)return new ne(oe&&!oe[0]?-1/0:1!=F.s?NaN:oe?0:F);if(null==c?(Sr=!1,C=j):C=c,ne.precision=C+=10,f=(h=ms(oe)).charAt(0),!(Math.abs(v=F.e)<15e14))return T=ro(ne,C+2,j).times(v+""),F=io(new ne(f+"."+h.slice(1)),C-10).plus(T),ne.precision=j,null==c?Xn(F,j,de,Sr=!0):F;for(;f<7&&1!=f||1==f&&h.charAt(1)>3;)f=(h=ms((F=F.times(l)).d)).charAt(0),M++;for(v=F.e,f>1?(F=new ne("0."+h),v++):F=new ne(f+"."+h.slice(1)),b=F,N=x=F=vr(F.minus(1),F.plus(1),C,1),I=Xn(F.times(F),C,1),p=3;;){if(x=Xn(x.times(I),C,1),ms((T=N.plus(vr(x,new ne(p),C,1))).d).slice(0,C)===ms(N.d).slice(0,C)){if(N=N.times(2),0!==v&&(N=N.plus(ro(ne,C+2,j).times(v+""))),N=vr(N,new ne(M),C,1),null!=c)return ne.precision=j,N;if(!ah(N.d,C-10,de,S))return Xn(N,ne.precision=j,de,Sr=!0);ne.precision=C+=10,T=x=F=vr(b.minus(1),b.plus(1),C,1),I=Xn(F.times(F),C,1),p=S=1}N=T,p+=2}}function Td(l){return String(l.s*l.s/0)}function bc(l,c){var h,f,p;for((h=c.indexOf("."))>-1&&(c=c.replace(".","")),(f=c.search(/e/i))>0?(h<0&&(h=f),h+=+c.slice(f+1),c=c.substring(0,f)):h<0&&(h=c.length),f=0;48===c.charCodeAt(f);f++);for(p=c.length;48===c.charCodeAt(p-1);--p);if(c=c.slice(f,p)){if(p-=f,l.e=h=h-f-1,l.d=[],f=(h+1)%7,h<0&&(f+=7),f<p){for(f&&l.d.push(+c.slice(0,f)),p-=7;f<p;)l.d.push(+c.slice(f,f+=7));f=7-(c=c.slice(f)).length}else f-=p;for(;f--;)c+="0";l.d.push(+c),Sr&&(l.e>l.constructor.maxE?(l.d=null,l.e=NaN):l.e<l.constructor.minE&&(l.e=0,l.d=[0]))}else l.e=0,l.d=[0];return l}function wi(l,c,h,f,p){var v,x,S,N,C=l.precision,b=Math.ceil(C/7);for(Sr=!1,N=h.times(h),S=new l(f);;){if(x=vr(S.times(N),new l(c++*c++),C,1),S=p?f.plus(x):f.minus(x),f=vr(x.times(N),new l(c++*c++),C,1),void 0!==(x=S.plus(f)).d[b]){for(v=b;x.d[v]===S.d[v]&&v--;);if(-1==v)break}v=S,S=f,f=x,x=v}return Sr=!0,x.d.length=b+1,x}function uf(l,c){for(var h=l;--c;)h*=l;return h}function lf(l,c){var h,f=c.s<0,p=Fo(l,l.precision,1),v=p.times(.5);if((c=c.abs()).lte(v))return Su=f?4:1,c;if((h=c.divToInt(p)).isZero())Su=f?3:2;else{if((c=c.minus(h.times(p))).lte(v))return Su=af(h)?f?2:3:f?4:1,c;Su=af(h)?f?1:4:f?3:2}return c.minus(p).abs()}function wc(l,c,h,f){var p,v,x,S,N,T,C,b,I,M=l.constructor,k=void 0!==h;if(k?(Bi(h,1,Ji),void 0===f?f=M.rounding:Bi(f,0,8)):(h=M.precision,f=M.rounding),l.isFinite()){for(k?(p=2,16==c?h=4*h-3:8==c&&(h=3*h-2)):p=c,(x=(C=Oo(l)).indexOf("."))>=0&&(C=C.replace(".",""),(I=new M(1)).e=C.length-x,I.d=Pl(Oo(I),10,p),I.e=I.d.length),v=N=(b=Pl(C,10,p)).length;0==b[--N];)b.pop();if(b[0]){if(x<0?v--:((l=new M(l)).d=b,l.e=v,b=(l=vr(l,I,h,f,0,p)).d,v=l.e,T=Cd),x=b[h],S=p/2,T=T||void 0!==b[h+1],T=f<4?(void 0!==x||T)&&(0===f||f===(l.s<0?3:2)):x>S||x===S&&(4===f||T||6===f&&1&b[h-1]||f===(l.s<0?8:7)),b.length=h,T)for(;++b[--h]>p-1;)b[h]=0,h||(++v,b.unshift(1));for(N=b.length;!b[N-1];--N);for(x=0,C="";x<N;x++)C+=pa.charAt(b[x]);if(k){if(N>1)if(16==c||8==c){for(x=16==c?4:3,--N;N%x;N++)C+="0";for(N=(b=Pl(C,p,c)).length;!b[N-1];--N);for(x=1,C="1.";x<N;x++)C+=pa.charAt(b[x])}else C=C.charAt(0)+"."+C.slice(1);C=C+(v<0?"p":"p+")+v}else if(v<0){for(;++v;)C="0"+C;C="0."+C}else if(++v>N)for(v-=N;v--;)C+="0";else v<N&&(C=C.slice(0,v)+"."+C.slice(v))}else C=k?"0p+0":"0";C=(16==c?"0x":2==c?"0b":8==c?"0o":"")+C}else C=Td(l);return l.s<0?"-"+C:C}function cf(l,c){if(l.length>c)return l.length=c,!0}function eu(l){return new this(l).abs()}function Sm(l){return new this(l).acos()}function lh(l){return new this(l).acosh()}function Zs(l,c){return new this(l).plus(c)}function xc(l){return new this(l).asin()}function Bv(l){return new this(l).asinh()}function Vv(l){return new this(l).atan()}function bb(l){return new this(l).atanh()}function Em(l,c){l=new this(l),c=new this(c);var h,f=this.precision,p=this.rounding,v=f+4;return l.s&&c.s?l.d||c.d?!c.d||l.isZero()?(h=c.s<0?Fo(this,f,p):new this(0)).s=l.s:!l.d||c.isZero()?(h=Fo(this,v,1).times(.5)).s=l.s:c.s<0?(this.precision=v,this.rounding=1,h=this.atan(vr(l,c,v,1)),c=Fo(this,v,1),this.precision=f,this.rounding=p,h=l.s<0?h.minus(c):h.plus(c)):h=this.atan(vr(l,c,v,1)):(h=Fo(this,v,1).times(c.s>0?.25:.75)).s=l.s:h=new this(NaN),h}function Nm(l){return new this(l).cbrt()}function wb(l){return Xn(l=new this(l),l.e+1,2)}function Cc(l,c,h){return new this(l).clamp(c,h)}function ei(l){if(!l||"object"!=typeof l)throw Error(tf+"Object expected");var c,h,f,p=!0===l.defaults,v=["precision",1,Ji,"rounding",0,8,"toExpNeg",-mi,0,"toExpPos",0,mi,"maxE",0,mi,"minE",-mi,0,"modulo",0,9];for(c=0;c<v.length;c+=3)if(h=v[c],p&&(this[h]=xm[h]),void 0!==(f=l[h])){if(!(ns(f)===f&&f>=v[c+1]&&f<=v[c+2]))throw Error(Fl+h+": "+f);this[h]=f}if(h="crypto",p&&(this[h]=xm[h]),void 0!==(f=l[h])){if(!0!==f&&!1!==f&&0!==f&&1!==f)throw Error(Fl+h+": "+f);if(f){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(Cm);this[h]=!0}else this[h]=!1}return this}function zv(l){return new this(l).cos()}function ga(l){return new this(l).cosh()}function Ad(l,c){return new this(l).div(c)}function Ni(l){return new this(l).exp()}function hf(l){return Xn(l=new this(l),l.e+1,3)}function xb(){var l,c,h=new this(0);for(Sr=!1,l=0;l<arguments.length;)if((c=new this(arguments[l++])).d)h.d&&(h=h.plus(c.times(c)));else{if(c.s)return Sr=!0,new this(1/0);h=c}return Sr=!0,h.sqrt()}function Di(l){return l instanceof xo||l&&l.toStringTag===nf||!1}function Pr(l){return new this(l).ln()}function Uv(l,c){return new this(l).log(c)}function Hv(l){return new this(l).log(2)}function jn(l){return new this(l).log(10)}function Pa(){return Nd(this,arguments,"lt")}function Tr(){return Nd(this,arguments,"gt")}function wo(l,c){return new this(l).mod(c)}function Ll(l,c){return new this(l).mul(c)}function Cb(l,c){return new this(l).pow(c)}function Sb(l){var c,h,f,p,v=0,x=new this(1),S=[];if(void 0===l?l=this.precision:Bi(l,1,Ji),f=Math.ceil(l/7),this.crypto)if(crypto.getRandomValues)for(c=crypto.getRandomValues(new Uint32Array(f));v<f;)(p=c[v])>=429e7?c[v]=crypto.getRandomValues(new Uint32Array(1))[0]:S[v++]=p%1e7;else{if(!crypto.randomBytes)throw Error(Cm);for(c=crypto.randomBytes(f*=4);v<f;)(p=c[v]+(c[v+1]<<8)+(c[v+2]<<16)+((127&c[v+3])<<24))>=214e7?crypto.randomBytes(4).copy(c,v):(S.push(p%1e7),v+=4);v=f/4}else for(;v<f;)S[v++]=1e7*Math.random()|0;for(l%=7,(f=S[--v])&&l&&(p=Cs(10,7-l),S[v]=(f/p|0)*p);0===S[v];v--)S.pop();if(v<0)h=0,S=[0];else{for(h=-1;0===S[0];h-=7)S.shift();for(f=1,p=S[0];p>=10;p/=10)f++;f<7&&(h-=7-f)}return x.e=h,x.d=S,x}function Id(l){return Xn(l=new this(l),l.e+1,this.rounding)}function va(l){return(l=new this(l)).d?l.d[0]?l.s:0*l.s:l.s||NaN}function Wv(l){return new this(l).sin()}function Eb(l){return new this(l).sinh()}function Nb(l){return new this(l).sqrt()}function Nu(l,c){return new this(l).sub(c)}function Tm(){var l=0,c=arguments,h=new this(c[l]);for(Sr=!1;h.s&&++l<c.length;)h=h.plus(c[l]);return Sr=!0,Xn(h,this.precision,this.rounding)}function ch(l){return new this(l).tan()}function XE(l){return new this(l).tanh()}function Dd(l){return Xn(l=new this(l),l.e+1,1)}pn[Symbol.for("nodejs.util.inspect.custom")]=pn.toString,pn[Symbol.toStringTag]="Decimal";var xo=pn.constructor=function ci(l){var c,h,f;function p(v){var x,S,N,T=this;if(!(T instanceof p))return new p(v);if(T.constructor=p,Di(v))return T.s=v.s,void(Sr?!v.d||v.e>p.maxE?(T.e=NaN,T.d=null):v.e<p.minE?(T.e=0,T.d=[0]):(T.e=v.e,T.d=v.d.slice()):(T.e=v.e,T.d=v.d?v.d.slice():v.d));if("number"==(N=typeof v)){if(0===v)return T.s=1/v<0?-1:1,T.e=0,void(T.d=[0]);if(v<0?(v=-v,T.s=-1):T.s=1,v===~~v&&v<1e7){for(x=0,S=v;S>=10;S/=10)x++;return void(Sr?x>p.maxE?(T.e=NaN,T.d=null):x<p.minE?(T.e=0,T.d=[0]):(T.e=x,T.d=[v]):(T.e=x,T.d=[v]))}return 0*v!=0?(v||(T.s=NaN),T.e=NaN,void(T.d=null)):bc(T,v.toString())}if("string"!==N)throw Error(Fl+v);return 45===(S=v.charCodeAt(0))?(v=v.slice(1),T.s=-1):(43===S&&(v=v.slice(1)),T.s=1),rf.test(v)?bc(T,v):function Dr(l,c){var h,f,p,v,x,S,N,T,C;if(c.indexOf("_")>-1){if(c=c.replace(/(\d)_(?=\d)/g,"$1"),rf.test(c))return bc(l,c)}else if("Infinity"===c||"NaN"===c)return+c||(l.s=NaN),l.e=NaN,l.d=null,l;if(li.test(c))h=16,c=c.toLowerCase();else if(Sd.test(c))h=2;else{if(!cs.test(c))throw Error(Fl+c);h=8}for((v=c.search(/p/i))>0?(N=+c.slice(v+1),c=c.substring(2,v)):c=c.slice(2),v=c.indexOf("."),f=l.constructor,(x=v>=0)&&(v=(S=(c=c.replace(".","")).length)-v,p=sf(f,new f(h),v,2*v)),v=C=(T=Pl(c,h,Ro)).length-1;0===T[v];--v)T.pop();return v<0?new f(0*l.s):(l.e=Ju(T,C),l.d=T,Sr=!1,x&&(l=vr(l,p,4*S)),N&&(l=l.times(Math.abs(N)<54?Cs(2,N):xo.pow(2,N))),Sr=!0,l)}(T,v)}if(p.prototype=pn,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=ei,p.clone=ci,p.isDecimal=Di,p.abs=eu,p.acos=Sm,p.acosh=lh,p.add=Zs,p.asin=xc,p.asinh=Bv,p.atan=Vv,p.atanh=bb,p.atan2=Em,p.cbrt=Nm,p.ceil=wb,p.clamp=Cc,p.cos=zv,p.cosh=ga,p.div=Ad,p.exp=Ni,p.floor=hf,p.hypot=xb,p.ln=Pr,p.log=Uv,p.log10=jn,p.log2=Hv,p.max=Pa,p.min=Tr,p.mod=wo,p.mul=Ll,p.pow=Cb,p.random=Sb,p.round=Id,p.sign=va,p.sin=Wv,p.sinh=Eb,p.sqrt=Nb,p.sub=Nu,p.sum=Tm,p.tan=ch,p.tanh=XE,p.trunc=Dd,void 0===l&&(l={}),l&&!0!==l.defaults)for(f=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],c=0;c<f.length;)l.hasOwnProperty(h=f[c++])||(l[h]=this[h]);return p.config(l),p}(xm);wm=new xo(wm),xd=new xo(xd);const Md=xo;function gi(l){return"number"==typeof l}function hi(l){return!(!l||"object"!=typeof l||"function"!=typeof l.constructor)&&(!0===l.isBigNumber&&"object"==typeof l.constructor.prototype&&!0===l.constructor.prototype.isBigNumber||"function"==typeof l.constructor.isDecimal&&!0===l.constructor.isDecimal(l))}function gs(l){return l&&"object"==typeof l&&!0===Object.getPrototypeOf(l).isComplex||!1}function xi(l){return l&&"object"==typeof l&&!0===Object.getPrototypeOf(l).isFraction||!1}function Am(l){return l&&!0===l.constructor.prototype.isUnit||!1}function ea(l){return"string"==typeof l}var Ti=Array.isArray;function yn(l){return l&&!0===l.constructor.prototype.isMatrix||!1}function Im(l){return Array.isArray(l)||yn(l)}function Ci(l){return l&&l.isDenseMatrix&&!0===l.constructor.prototype.isMatrix||!1}function el(l){return l&&l.isSparseMatrix&&!0===l.constructor.prototype.isMatrix||!1}function ta(l){return l&&!0===l.constructor.prototype.isRange||!1}function Tu(l){return l&&!0===l.constructor.prototype.isIndex||!1}function Tb(l){return"boolean"==typeof l}function tu(l){return l&&!0===l.constructor.prototype.isResultSet||!1}function ff(l){return l&&!0===l.constructor.prototype.isHelp||!1}function $l(l){return"function"==typeof l}function Gv(l){return l instanceof Date}function df(l){return l instanceof RegExp}function Ar(l){return!(!l||"object"!=typeof l||l.constructor!==Object||gs(l)||xi(l))}function hh(l){return null===l}function Ab(l){return void 0===l}function Po(l){return l&&!0===l.isAccessorNode&&!0===l.constructor.prototype.isNode||!1}function pf(l){return l&&!0===l.isArrayNode&&!0===l.constructor.prototype.isNode||!1}function YE(l){return l&&!0===l.isAssignmentNode&&!0===l.constructor.prototype.isNode||!1}function Au(l){return l&&!0===l.isBlockNode&&!0===l.constructor.prototype.isNode||!1}function nu(l){return l&&!0===l.isConditionalNode&&!0===l.constructor.prototype.isNode||!1}function Bl(l){return l&&!0===l.isConstantNode&&!0===l.constructor.prototype.isNode||!1}function QE(l){return l&&!0===l.isFunctionAssignmentNode&&!0===l.constructor.prototype.isNode||!1}function Co(l){return l&&!0===l.isFunctionNode&&!0===l.constructor.prototype.isNode||!1}function Ib(l){return l&&!0===l.isIndexNode&&!0===l.constructor.prototype.isNode||!1}function Iu(l){return l&&!0===l.isNode&&!0===l.constructor.prototype.isNode||!1}function kd(l){return l&&!0===l.isObjectNode&&!0===l.constructor.prototype.isNode||!1}function Db(l){return l&&!0===l.isOperatorNode&&!0===l.constructor.prototype.isNode||!1}function Si(l){return l&&!0===l.isParenthesisNode&&!0===l.constructor.prototype.isNode||!1}function Dm(l){return l&&!0===l.isRangeNode&&!0===l.constructor.prototype.isNode||!1}function jv(l){return l&&!0===l.isSymbolNode&&!0===l.constructor.prototype.isNode||!1}function Du(l){return l&&!0===l.constructor.prototype.isChain||!1}function cr(l){var c=typeof l;return"object"===c?null===l?"null":Array.isArray(l)?"Array":l instanceof Date?"Date":l instanceof RegExp?"RegExp":hi(l)?"BigNumber":gs(l)?"Complex":xi(l)?"Fraction":yn(l)?"Matrix":Am(l)?"Unit":Tu(l)?"Index":ta(l)?"Range":tu(l)?"ResultSet":Iu(l)?l.type:Du(l)?"Chain":ff(l)?"Help":"Object":"function"===c?"Function":c}function tr(l){var c=typeof l;if("number"===c||"string"===c||"boolean"===c||null==l)return l;if("function"==typeof l.clone)return l.clone();if(Array.isArray(l))return l.map(function(h){return tr(h)});if(l instanceof Date)return new Date(l.valueOf());if(hi(l))return l;if(l instanceof RegExp)throw new TypeError("Cannot clone "+l);return function mf(l,c){var h={};for(var f in l)Vr(l,f)&&(h[f]=c(l[f]));return h}(l,tr)}function fh(l,c){for(var h in c)Vr(c,h)&&(l[h]=c[h]);return l}function Lo(l,c){var h,f,p;if(Array.isArray(l)){if(!Array.isArray(c)||l.length!==c.length)return!1;for(f=0,p=l.length;f<p;f++)if(!Lo(l[f],c[f]))return!1;return!0}if("function"==typeof l)return l===c;if(l instanceof Object){if(Array.isArray(c)||!(c instanceof Object))return!1;for(h in l)if(!(h in c)||!Lo(l[h],c[h]))return!1;for(h in c)if(!(h in l))return!1;return!0}return l===c}function Vr(l,c){return l&&Object.hasOwnProperty.call(l,c)}function Xe(l,c,h,f){function p(v){var x=function sr(l,c){for(var h={},f=0;f<c.length;f++){var p=c[f],v=l[p];void 0!==v&&(h[p]=v)}return h}(v,c.map(vf));return function km(l,c,h){var f=c.filter(v=>!function _a(l){return l&&"?"===l[0]}(v)).every(v=>void 0!==h[v]);if(!f){var p=c.filter(v=>void 0===h[v]);throw new Error('Cannot create function "'.concat(l,'", ')+"some dependencies are missing: ".concat(p.map(v=>'"'.concat(v,'"')).join(", "),"."))}}(l,c,v),h(x)}return p.isFactory=!0,p.fn=l,p.dependencies=c.slice().sort(),f&&(p.meta=f),p}function vf(l){return l&&"?"===l[0]?l.slice(1):l}var Rb=Xe("BigNumber",["?on","config"],l=>{var{on:c,config:h}=l,f=Md.clone({precision:h.precision,modulo:Md.EUCLID});return f.prototype=Object.create(f.prototype),f.prototype.type="BigNumber",f.prototype.isBigNumber=!0,f.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},f.fromJSON=function(p){return new f(p.value)},c&&c("config",function(p,v){p.precision!==v.precision&&f.config({precision:p.precision})}),f},{isClass:!0}),Mi=z(1006);function Jt(l){return"boolean"==typeof l||!!isFinite(l)&&l===Math.round(l)}Math,Math,Math,Math,Math,Math;function es(l,c,h){var p={2:"0b",8:"0o",16:"0x"}[c],v="";if(h){if(h<1)throw new Error("size must be in greater than 0");if(!Jt(h))throw new Error("size must be an integer");if(l>2**(h-1)-1||l<-(2**(h-1)))throw new Error("Value must be in range [-2^".concat(h-1,", 2^").concat(h-1,"-1]"));if(!Jt(l))throw new Error("Value must be an integer");l<0&&(l+=2**h),v="i".concat(h)}var x="";return l<0&&(l=-l,x="-"),"".concat(x).concat(p).concat(l.toString(c)).concat(v)}function Ba(l,c){if("function"==typeof c)return c(l);if(l===1/0)return"Infinity";if(l===-1/0)return"-Infinity";if(isNaN(l))return"NaN";var f,p,h="auto";if(c&&(c.notation&&(h=c.notation),gi(c)?f=c:gi(c.precision)&&(f=c.precision),c.wordSize&&"number"!=typeof(p=c.wordSize)))throw new Error('Option "wordSize" must be a number');switch(h){case"fixed":return function dh(l,c){if(isNaN(l)||!isFinite(l))return String(l);var h=nl(l),f="number"==typeof c?w(h,h.exponent+1+c):h,p=f.coefficients,v=f.exponent+1,x=v+(c||0);return p.length<x&&(p=p.concat(P(x-p.length))),v<0&&(p=P(1-v).concat(p),v=1),v<p.length&&p.splice(v,0,0===v?"0.":"."),f.sign+p.join("")}(l,f);case"exponential":return Ec(l,f);case"engineering":return function kr(l,c){if(isNaN(l)||!isFinite(l))return String(l);var f=w(nl(l),c),p=f.exponent,v=f.coefficients,x=p%3==0?p:p<0?p-3-p%3:p-p%3;if(gi(c))for(;c>v.length||p-x+1>v.length;)v.push(0);else for(var S=Math.abs(p-x)-(v.length-1),N=0;N<S;N++)v.push(0);for(var T=Math.abs(p-x),C=1;T>0;)C++,T--;var b=v.slice(C).join(""),I=gi(c)&&b.length||b.match(/[1-9]/)?"."+b:"",M=v.slice(0,C).join("")+I+"e"+(p>=0?"+":"")+x.toString();return f.sign+M}(l,f);case"bin":return es(l,2,p);case"oct":return es(l,8,p);case"hex":return es(l,16,p);case"auto":return function g(l,c,h){if(isNaN(l)||!isFinite(l))return String(l);var f=h&&void 0!==h.lowerExp?h.lowerExp:-3,p=h&&void 0!==h.upperExp?h.upperExp:5,v=nl(l),x=c?w(v,c):v;if(x.exponent<f||x.exponent>=p)return Ec(l,c);var S=x.coefficients,N=x.exponent;S.length<c&&(S=S.concat(P(c-S.length))),S=S.concat(P(N-S.length+1+(S.length<c?c-S.length:0)));var T=N>0?N:0;return T<(S=P(-N).concat(S)).length-1&&S.splice(T+1,0,"."),x.sign+S.join("")}(l,f,c&&c).replace(/((\.\d*?)(0+))($|e)/,function(){var v=arguments[2],x=arguments[4];return"."!==v?v+x:x});default:throw new Error('Unknown notation "'+h+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function nl(l){var c=String(l).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!c)throw new SyntaxError("Invalid number "+l);var h=c[1],f=c[2],p=parseFloat(c[4]||"0"),v=f.indexOf(".");p+=-1!==v?v-1:f.length-1;var x=f.replace(".","").replace(/^0*/,function(S){return p-=S.length,""}).replace(/0*$/,"").split("").map(function(S){return parseInt(S)});return 0===x.length&&(x.push(0),p++),{sign:h,coefficients:x,exponent:p}}function Ec(l,c){if(isNaN(l)||!isFinite(l))return String(l);var h=nl(l),f=c?w(h,c):h,p=f.coefficients,v=f.exponent;p.length<c&&(p=p.concat(P(c-p.length)));var x=p.shift();return f.sign+x+(p.length>0?"."+p.join(""):"")+"e"+(v>=0?"+":"")+v}function w(l,c){for(var h={sign:l.sign,coefficients:l.coefficients,exponent:l.exponent},f=h.coefficients;c<=0;)f.unshift(0),h.exponent++,c++;if(f.length>c&&f.splice(c,f.length-c)[0]>=5){var v=c-1;for(f[v]++;10===f[v];)f.pop(),0===v&&(f.unshift(0),h.exponent++,v++),f[--v]++}return h}function P(l){for(var c=[],h=0;h<l;h++)c.push(0);return c}var pe=Number.EPSILON||2220446049250313e-31;function Ie(l,c,h){if(null==h)return l===c;if(l===c)return!0;if(isNaN(l)||isNaN(c))return!1;if(isFinite(l)&&isFinite(c)){var f=Math.abs(l-c);return f<pe||f<=Math.max(Math.abs(l),Math.abs(c))*h}return!1}Math,Math,Math,Math,Math;Math;var Fd=Xe("Complex",[],()=>(Mi.prototype.type="Complex",Mi.prototype.isComplex=!0,Mi.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Mi.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Mi.prototype.format=function(l){var h=this.im,f=this.re,p=Ba(this.re,l),v=Ba(this.im,l),x=gi(l)?l:l?l.precision:null;if(null!==x){var S=Math.pow(10,-x);Math.abs(f/h)<S&&(f=0),Math.abs(h/f)<S&&(h=0)}return 0===h?p:0===f?1===h?"i":-1===h?"-i":v+"i":h<0?-1===h?p+" - i":p+" - "+v.substring(1)+"i":1===h?p+" + i":p+" + "+v+"i"},Mi.fromPolar=function(l){switch(arguments.length){case 1:var c=arguments[0];if("object"==typeof c)return Mi(c);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var h=arguments[0],f=arguments[1];if(gi(h)){if(Am(f)&&f.hasBase("ANGLE")&&(f=f.toNumber("rad")),gi(f))return new Mi({r:h,phi:f});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Mi.prototype.valueOf=Mi.prototype.toString,Mi.fromJSON=function(l){return new Mi(l)},Mi.compare=function(l,c){return l.re>c.re?1:l.re<c.re?-1:l.im>c.im?1:l.im<c.im?-1:0},Mi),{isClass:!0});function Rm(l){var c=0,h=1,f=Object.create(null),p=Object.create(null),v=0,x=function(N){var T=p[N];if(T&&(delete f[T],delete p[N],--c,h===T)){if(!c)return v=0,void(h=1);for(;!hasOwnProperty.call(f,++h););}};return l=Math.abs(l),{hit:function(N){var T=p[N],C=++v;if(f[C]=N,p[N]=C,!T)return++c<=l?void 0:(x(N=f[h]),N);if(delete f[T],h===T)for(;!hasOwnProperty.call(f,++h););},delete:x,clear:function(){c=v=0,h=1,f=Object.create(null),p=Object.create(null)}}}function yf(l){var{hasher:c,limit:h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h=null==h?Number.POSITIVE_INFINITY:h,c=null==c?JSON.stringify:c,function f(){"object"!=typeof f.cache&&(f.cache={values:new Map,lru:Rm(h||Number.POSITIVE_INFINITY)});for(var p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];var x=c(p);if(f.cache.values.has(x))return f.cache.lru.hit(x),f.cache.values.get(x);var S=l.apply(l,p);return f.cache.values.set(x,S),f.cache.values.delete(f.cache.lru.hit(x)),S}}yf(function(l){return new l(1).exp()},{hasher:ph}),yf(function(l){return new l(1).plus(new l(5).sqrt()).div(2)},{hasher:ph});var Om=yf(function(l){return l.acos(-1)},{hasher:ph});function ph(l){return l[0].precision}function ku(l,c){return Xe(l,["config","BigNumber"],f=>{var{config:p,BigNumber:v}=f;return"BigNumber"===p.number?new v(c):c})}yf(function(l){return Om(l).times(2)},{hasher:ph}),Math,Math,Math,ku("fineStructure",.0072973525693),ku("weakMixingAngle",.2229),ku("efimovFactor",22.7),ku("sackurTetrode",-1.16487052358);var Ld=z(4613),lP=Xe("Fraction",[],()=>(Ld.prototype.type="Fraction",Ld.prototype.isFraction=!0,Ld.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Ld.fromJSON=function(l){return new Ld(l)},Ld),{isClass:!0}),gN=Xe("Matrix",[],()=>{function l(){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator")}return l.prototype.type="Matrix",l.prototype.isMatrix=!0,l.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},l.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},l.prototype.create=function(c,h){throw new Error("Cannot invoke create on a Matrix interface")},l.prototype.subset=function(c,h,f){throw new Error("Cannot invoke subset on a Matrix interface")},l.prototype.get=function(c){throw new Error("Cannot invoke get on a Matrix interface")},l.prototype.set=function(c,h,f){throw new Error("Cannot invoke set on a Matrix interface")},l.prototype.resize=function(c,h){throw new Error("Cannot invoke resize on a Matrix interface")},l.prototype.reshape=function(c,h){throw new Error("Cannot invoke reshape on a Matrix interface")},l.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},l.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},l.prototype.map=function(c,h){throw new Error("Cannot invoke map on a Matrix interface")},l.prototype.forEach=function(c){throw new Error("Cannot invoke forEach on a Matrix interface")},l.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},l.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},l.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},l.prototype.format=function(c){throw new Error("Cannot invoke format on a Matrix interface")},l.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},l},{isClass:!0});function ey(l,c,h){var p=new(0,l.constructor)(2),v="";if(h){if(h<1)throw new Error("size must be in greater than 0");if(!Jt(h))throw new Error("size must be an integer");if(l.greaterThan(p.pow(h-1).sub(1))||l.lessThan(p.pow(h-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(h-1,", 2^").concat(h-1,"-1]"));if(!l.isInteger())throw new Error("Value must be an integer");l.lessThan(0)&&(l=l.add(p.pow(h))),v="i".concat(h)}switch(c){case 2:return"".concat(l.toBinary()).concat(v);case 8:return"".concat(l.toOctal()).concat(v);case 16:return"".concat(l.toHexadecimal()).concat(v);default:throw new Error("Base ".concat(c," not supported "))}}function wN(l,c){return void 0!==c?l.toExponential(c-1):l.toExponential()}function Mr(l,c){var h=function Ns(l,c){return"number"==typeof l?Ba(l,c):hi(l)?function bN(l,c){if("function"==typeof c)return c(l);if(!l.isFinite())return l.isNaN()?"NaN":l.gt(0)?"Infinity":"-Infinity";var f,p,h="auto";if(void 0!==c&&(c.notation&&(h=c.notation),"number"==typeof c?f=c:c.precision&&(f=c.precision),c.wordSize&&"number"!=typeof(p=c.wordSize)))throw new Error('Option "wordSize" must be a number');switch(h){case"fixed":return function hP(l,c){return l.toFixed(c)}(l,f);case"exponential":return wN(l,f);case"engineering":return function ty(l,c){var h=l.e,f=h%3==0?h:h<0?h-3-h%3:h-h%3,p=l.mul(Math.pow(10,-f)),v=p.toPrecision(c);return-1!==v.indexOf("e")&&(v=p.toString()),v+"e"+(h>=0?"+":"")+f.toString()}(l,f);case"bin":return ey(l,2,p);case"oct":return ey(l,8,p);case"hex":return ey(l,16,p);case"auto":var v=c&&void 0!==c.lowerExp?c.lowerExp:-3,x=c&&void 0!==c.upperExp?c.upperExp:5;if(l.isZero())return"0";var N=l.toSignificantDigits(f),T=N.e;return(T>=v&&T<x?N.toFixed():wN(l,f)).replace(/((\.\d*?)(0+))($|e)/,function(){var C=arguments[2],b=arguments[4];return"."!==C?C+b:b});default:throw new Error('Unknown notation "'+h+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}(l,c):function fP(l){return l&&"object"==typeof l&&"number"==typeof l.s&&"number"==typeof l.n&&"number"==typeof l.d||!1}(l)?c&&"decimal"===c.fraction?l.toString():l.s*l.n+"/"+l.d:Array.isArray(l)?xN(l,c):ea(l)?'"'+l+'"':"function"==typeof l?l.syntax?String(l.syntax):"function":l&&"object"==typeof l?"function"==typeof l.format?l.format(c):l&&l.toString(c)!=={}.toString()?l.toString(c):"{"+Object.keys(l).map(f=>'"'+f+'": '+Mr(l[f],c)).join(", ")+"}":String(l)}(l,c);return c&&"object"==typeof c&&"truncate"in c&&h.length>c.truncate?h.substring(0,c.truncate-3)+"...":h}function xN(l,c){if(Array.isArray(l)){for(var h="[",f=l.length,p=0;p<f;p++)0!==p&&(h+=", "),h+=xN(l[p],c);return h+"]"}return Mr(l,c)}function zr(l,c,h){if(!(this instanceof zr))throw new SyntaxError("Constructor must be called with the new operator");this.actual=l,this.expected=c,this.relation=h,this.message="Dimension mismatch ("+(Array.isArray(l)?"["+l.join(", ")+"]":l)+" "+(this.relation||"!=")+" "+(Array.isArray(c)?"["+c.join(", ")+"]":c)+")",this.stack=(new Error).stack}function iu(l,c,h){if(!(this instanceof iu))throw new SyntaxError("Constructor must be called with the new operator");this.index=l,arguments.length<3?(this.min=0,this.max=c):(this.min=c,this.max=h),this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")",this.stack=(new Error).stack}function Lr(l){for(var c=[];Array.isArray(l);)c.push(l.length),l=l[0];return c}function Lm(l,c,h){var f,p=l.length;if(p!==c[h])throw new zr(p,c[h]);if(h<c.length-1){var v=h+1;for(f=0;f<p;f++){if(!Array.isArray(l[f]))throw new zr(c.length-1,c.length,"<");Lm(l[f],c,v)}}else for(f=0;f<p;f++)if(Array.isArray(l[f]))throw new zr(c.length+1,c.length,">")}function ny(l,c){if(0===c.length){if(Array.isArray(l))throw new zr(l.length,0)}else Lm(l,c,0)}function ki(l,c){if(!gi(l)||!Jt(l))throw new TypeError("Index must be an integer (value: "+l+")");if(l<0||"number"==typeof c&&l>=c)throw new iu(l,c)}function Bd(l,c,h){if(!Array.isArray(l)||!Array.isArray(c))throw new TypeError("Array expected");if(0===c.length)throw new Error("Resizing to scalar is not supported");return c.forEach(function(p){if(!gi(p)||!Jt(p)||p<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Mr(c)+")")}),Gl(l,c,0,void 0!==h?h:0),l}function Gl(l,c,h,f){var p,v,S=c[h],N=Math.min(l.length,S);if(l.length=S,h<c.length-1){var T=h+1;for(p=0;p<N;p++)v=l[p],Array.isArray(v)||(l[p]=v=[v]),Gl(v,c,T,f);for(p=N;p<S;p++)l[p]=v=[],Gl(v,c,T,f)}else{for(p=0;p<N;p++)for(;Array.isArray(l[p]);)l[p]=l[p][0];for(p=N;p<S;p++)l[p]=f}}function Xb(l,c){var h=CN(l),f=l.slice(),v=l.indexOf(-1);if(l.indexOf(-1,v+1)>=0)throw new Error("More than one wildcard in sizes");if(v>=0){if(c%h!=0)throw new Error("Could not replace wildcard, since "+c+" is no multiple of "+-h);f[v]=-c/h}return f}function CN(l){return l.reduce((c,h)=>c*h,1)}function EN(l,c,h,f){var p=f||Lr(l);if(h)for(var v=0;v<h;v++)l=[l],p.unshift(1);for(l=dP(l,c,0);p.length<c;)p.push(1);return l}function dP(l,c,h){var f,p;if(Array.isArray(l)){var v=h+1;for(f=0,p=l.length;f<p;f++)l[f]=dP(l[f],c,v)}else for(var x=h;x<c;x++)l=[l];return l}function si(l){if(!Array.isArray(l))return l;var c=[];return l.forEach(function h(f){Array.isArray(f)?f.forEach(h):c.push(f)}),c}function Vm(l,c){for(var h,f=0,p=0;p<l.length;p++){var v=l[p],x=Array.isArray(v);if(0===p&&x&&(f=v.length),x&&v.length!==f)return;var S=x?Vm(v,c):c(v);if(void 0===h)h=S;else if(h!==S)return"mixed"}return h}(zr.prototype=new RangeError).constructor=RangeError,zr.prototype.name="DimensionError",zr.prototype.isDimensionError=!0,(iu.prototype=new RangeError).constructor=RangeError,iu.prototype.name="IndexError",iu.prototype.isIndexError=!0;var IN=Xe("DenseMatrix",["Matrix"],l=>{var{Matrix:c}=l;function h(C,b){if(!(this instanceof h))throw new SyntaxError("Constructor must be called with the new operator");if(b&&!ea(b))throw new Error("Invalid datatype: "+b);if(yn(C))"DenseMatrix"===C.type?(this._data=tr(C._data),this._size=tr(C._size),this._datatype=b||C._datatype):(this._data=C.toArray(),this._size=C.size(),this._datatype=b||C._datatype);else if(C&&Ti(C.data)&&Ti(C.size))this._data=C.data,this._size=C.size,ny(this._data,this._size),this._datatype=b||C.datatype;else if(Ti(C))this._data=T(C),this._size=Lr(this._data),ny(this._data,this._size),this._datatype=b;else{if(C)throw new TypeError("Unsupported type of data ("+cr(C)+")");this._data=[],this._size=[0],this._datatype=b}}function f(C,b){if(!Tu(b))throw new TypeError("Invalid index");if(b.isScalar())return C.get(b.min());var M=b.size();if(M.length!==C._size.length)throw new zr(M.length,C._size.length);for(var k=b.min(),F=b.max(),oe=0,ne=C._size.length;oe<ne;oe++)ki(k[oe],C._size[oe]),ki(F[oe],C._size[oe]);return new h(p(C._data,b,M.length,0),C._datatype)}function p(C,b,I,M){var k=M===I-1,F=b.dimension(M);return k?F.map(function(oe){return ki(oe,C.length),C[oe]}).valueOf():F.map(function(oe){return ki(oe,C.length),p(C[oe],b,I,M+1)}).valueOf()}function v(C,b,I,M){if(!b||!0!==b.isIndex)throw new TypeError("Invalid index");var oe,k=b.size(),F=b.isScalar();if(yn(I)?(oe=I.size(),I=I.valueOf()):oe=Lr(I),F){if(0!==oe.length)throw new TypeError("Scalar expected");C.set(b.min(),I,M)}else{if(k.length<C._size.length)throw new zr(k.length,C._size.length,"<");if(oe.length<k.length){for(var ne=0,de=0;1===k[ne]&&1===oe[ne];)ne++;for(;1===k[ne];)de++,ne++;I=EN(I,k.length,de,oe)}if(!Lo(k,oe))throw new zr(k,oe,">");N(C,b.max().map(function(q){return q+1}),M),x(C._data,b,I,k.length,0)}return C}function x(C,b,I,M,k){var F=k===M-1;b.dimension(k).forEach(F?function(ne,de){ki(ne),C[ne]=I[de[0]]}:function(ne,de){ki(ne),x(C[ne],b,I[de[0]],M,k+1)})}function S(C,b,I){if(0===b.length){for(var M=C._data;Ti(M);)M=M[0];return M}return C._size=b.slice(0),C._data=Bd(C._data,C._size,I),C}function N(C,b,I){for(var M=C._size.slice(0),k=!1;M.length<b.length;)M.push(0),k=!0;for(var F=0,oe=b.length;F<oe;F++)b[F]>M[F]&&(M[F]=b[F],k=!0);k&&S(C,M,I)}function T(C){for(var b=0,I=C.length;b<I;b++){var M=C[b];Ti(M)?C[b]=T(M):M&&!0===M.isMatrix&&(C[b]=T(M.valueOf()))}return C}return(h.prototype=new c).createDenseMatrix=function(C,b){return new h(C,b)},h.prototype.type="DenseMatrix",h.prototype.isDenseMatrix=!0,h.prototype.getDataType=function(){return Vm(this._data,cr)},h.prototype.storage=function(){return"dense"},h.prototype.datatype=function(){return this._datatype},h.prototype.create=function(C,b){return new h(C,b)},h.prototype.subset=function(C,b,I){switch(arguments.length){case 1:return f(this,C);case 2:case 3:return v(this,C,b,I);default:throw new SyntaxError("Wrong number of arguments")}},h.prototype.get=function(C){if(!Ti(C))throw new TypeError("Array expected");if(C.length!==this._size.length)throw new zr(C.length,this._size.length);for(var b=0;b<C.length;b++)ki(C[b],this._size[b]);for(var I=this._data,M=0,k=C.length;M<k;M++){var F=C[M];ki(F,I.length),I=I[F]}return I},h.prototype.set=function(C,b,I){if(!Ti(C))throw new TypeError("Array expected");if(C.length<this._size.length)throw new zr(C.length,this._size.length,"<");var M,k,F;N(this,C.map(function(de){return de+1}),I);var ne=this._data;for(M=0,k=C.length-1;M<k;M++)ki(F=C[M],ne.length),ne=ne[F];return ki(F=C[C.length-1],ne.length),ne[F]=b,this},h.prototype.resize=function(C,b,I){if(!Im(C))throw new TypeError("Array or Matrix expected");var M=C.valueOf().map(F=>Array.isArray(F)&&1===F.length?F[0]:F);return S(I?this.clone():this,M,b)},h.prototype.reshape=function(C,b){var I=b?this.clone():this;I._data=function Vd(l,c){var h=si(l),f=h.length;if(!Array.isArray(l)||!Array.isArray(c))throw new TypeError("Array expected");if(0===c.length)throw new zr(0,f,"!=");var p=CN(c=Xb(c,f));if(f!==p)throw new zr(p,f,"!=");try{return function $m(l,c){for(var f,h=l,p=c.length-1;p>0;p--){var v=c[p];f=[];for(var x=h.length/v,S=0;S<x;S++)f.push(h.slice(S*v,(S+1)*v));h=f}return h}(h,c)}catch(v){throw v instanceof zr?new zr(p,f,"!="):v}}(I._data,C);var M=I._size.reduce((k,F)=>k*F);return I._size=Xb(C,M),I},h.prototype.clone=function(){return new h({data:tr(this._data),size:tr(this._size),datatype:this._datatype})},h.prototype.size=function(){return this._size.slice(0)},h.prototype.map=function(C){var b=this,M=function F(oe,ne){return Ti(oe)?oe.map(function(de,j){return F(de,ne.concat(j))}):C(oe,ne,b)}(this._data,[]);return new h(M,void 0!==this._datatype?Vm(M,cr):void 0)},h.prototype.forEach=function(C){var b=this;!function M(k,F){Ti(k)?k.forEach(function(oe,ne){M(oe,F.concat(ne))}):C(k,F,b)}(this._data,[])},h.prototype[Symbol.iterator]=function*(){yield*function*b(I,M){if(Ti(I))for(var k=0;k<I.length;k++)yield*b(I[k],M.concat(k));else yield{value:I,index:M}}(this._data,[])},h.prototype.rows=function(){var C=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var I=this._data;for(var M of I)C.push(new h([M],this._datatype));return C},h.prototype.columns=function(){var C=this,b=[],I=this.size();if(2!==I.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var M=this._data,k=function(ne){var de=M.map(j=>[j[ne]]);b.push(new h(de,C._datatype))},F=0;F<I[1];F++)k(F);return b},h.prototype.toArray=function(){return tr(this._data)},h.prototype.valueOf=function(){return this._data},h.prototype.format=function(C){return Mr(this._data,C)},h.prototype.toString=function(){return Mr(this._data)},h.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},h.prototype.diagonal=function(C){if(C){if(hi(C)&&(C=C.toNumber()),!gi(C)||!Jt(C))throw new TypeError("The parameter k must be an integer number")}else C=0;for(var b=C>0?C:0,I=C<0?-C:0,F=Math.min(this._size[0]-I,this._size[1]-b),oe=[],ne=0;ne<F;ne++)oe[ne]=this._data[ne+I][ne+b];return new h({data:oe,size:[F],datatype:this._datatype})},h.diagonal=function(C,b,I,M){if(!Ti(C))throw new TypeError("Array expected, size parameter");if(2!==C.length)throw new Error("Only two dimensions matrix are supported");if(C=C.map(function(Ce){if(hi(Ce)&&(Ce=Ce.toNumber()),!gi(Ce)||!Jt(Ce)||Ce<1)throw new Error("Size values must be positive integers");return Ce}),I){if(hi(I)&&(I=I.toNumber()),!gi(I)||!Jt(I))throw new TypeError("The parameter k must be an integer number")}else I=0;var j,k=I>0?I:0,F=I<0?-I:0,oe=C[0],ne=C[1],de=Math.min(oe-F,ne-k);if(Ti(b)){if(b.length!==de)throw new Error("Invalid value array length");j=function(Se){return b[Se]}}else if(yn(b)){var ae=b.size();if(1!==ae.length||ae[0]!==de)throw new Error("Invalid matrix length");j=function(Se){return b.get([Se])}}else j=function(){return b};M||(M=hi(j(0))?j(0).mul(0):0);var le=[];if(C.length>0){le=Bd(le,C,M);for(var q=0;q<de;q++)le[q+F][q+k]=j(q)}return new h({data:le,size:[oe,ne]})},h.fromJSON=function(C){return new h(C)},h.prototype.swapRows=function(C,b){if(!(gi(C)&&Jt(C)&&gi(b)&&Jt(b)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return ki(C,this._size[0]),ki(b,this._size[0]),h._swapRows(C,b,this._data),this},h._swapRows=function(C,b,I){var M=I[C];I[C]=I[b],I[b]=M},h},{isClass:!0}),ry=z(1977);function iy(l,c){if(rw(l)&&tw(l,c))return l[c];throw"function"==typeof l[c]&&function nw(l,c){return!(null==l||"function"!=typeof l[c]||Vr(l,c)&&Object.getPrototypeOf&&c in Object.getPrototypeOf(l)||!Vr(bP,c)&&(c in Object.prototype||c in Function.prototype))}(l,c)?new Error('Cannot access method "'+c+'" as a property'):new Error('No access to property "'+c+'"')}function tw(l,c){return!(!l||"object"!=typeof l||!Vr(_P,c)&&(c in Object.prototype||c in Function.prototype))}function rw(l){return"object"==typeof l&&l&&l.constructor===Object}var _P={length:!0,name:!0},bP={toString:!0,valueOf:!0,toLocaleString:!0};function sy(l){return!!l&&(l instanceof Map||l instanceof class Ud{constructor(c){this.wrappedObject=c}keys(){return Object.keys(this.wrappedObject)}get(c){return iy(this.wrappedObject,c)}set(c,h){return function Hm(l,c,h){if(rw(l)&&tw(l,c))return l[c]=h,h;throw new Error('No access to property "'+c+'"')}(this.wrappedObject,c,h),this}has(c){return function vP(l,c){return c in l}(this.wrappedObject,c)}}||"function"==typeof l.set&&"function"==typeof l.get&&"function"==typeof l.keys&&"function"==typeof l.has)}var Bo=function(){return Bo=ry.create,ry},jm=Xe("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],function(c){var{BigNumber:h,Complex:f,DenseMatrix:p,Fraction:v}=c,x=Bo();return x.types=[{name:"number",test:gi},{name:"Complex",test:gs},{name:"BigNumber",test:hi},{name:"Fraction",test:xi},{name:"Unit",test:Am},{name:"string",test:ea},{name:"Chain",test:Du},{name:"Array",test:Ti},{name:"Matrix",test:yn},{name:"DenseMatrix",test:Ci},{name:"SparseMatrix",test:el},{name:"Range",test:ta},{name:"Index",test:Tu},{name:"boolean",test:Tb},{name:"ResultSet",test:tu},{name:"Help",test:ff},{name:"function",test:$l},{name:"Date",test:Gv},{name:"RegExp",test:df},{name:"null",test:hh},{name:"undefined",test:Ab},{name:"AccessorNode",test:Po},{name:"ArrayNode",test:pf},{name:"AssignmentNode",test:YE},{name:"BlockNode",test:Au},{name:"ConditionalNode",test:nu},{name:"ConstantNode",test:Bl},{name:"FunctionNode",test:Co},{name:"FunctionAssignmentNode",test:QE},{name:"IndexNode",test:Ib},{name:"Node",test:Iu},{name:"ObjectNode",test:kd},{name:"OperatorNode",test:Db},{name:"ParenthesisNode",test:Si},{name:"RangeNode",test:Dm},{name:"SymbolNode",test:jv},{name:"Map",test:sy},{name:"Object",test:Ar}],x.conversions=[{from:"number",to:"BigNumber",convert:function(N){if(h||gh(N),function U(l){return l.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}(N)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+N+"). Use function bignumber(x) to convert to BigNumber.");return new h(N)}},{from:"number",to:"Complex",convert:function(N){return f||Ic(N),new f(N,0)}},{from:"number",to:"string",convert:function(N){return N+""}},{from:"BigNumber",to:"Complex",convert:function(N){return f||Ic(N),new f(N.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(N){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(N){return f||Ic(N),new f(N.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(N){v||oy(N);var T=new v(N);if(T.valueOf()!==N)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+N+"). Use function fraction(x) to convert to Fraction.");return T}},{from:"string",to:"number",convert:function(N){var T=Number(N);if(isNaN(T))throw new Error('Cannot convert "'+N+'" to a number');return T}},{from:"string",to:"BigNumber",convert:function(N){h||gh(N);try{return new h(N)}catch(T){throw new Error('Cannot convert "'+N+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(N){v||oy(N);try{return new v(N)}catch(T){throw new Error('Cannot convert "'+N+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(N){f||Ic(N);try{return new f(N)}catch(T){throw new Error('Cannot convert "'+N+'" to Complex')}}},{from:"boolean",to:"number",convert:function(N){return+N}},{from:"boolean",to:"BigNumber",convert:function(N){return h||gh(N),new h(+N)}},{from:"boolean",to:"Fraction",convert:function(N){return v||oy(N),new v(+N)}},{from:"boolean",to:"string",convert:function(N){return String(N)}},{from:"Array",to:"Matrix",convert:function(N){return p||function Hd(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new p(N)}},{from:"Matrix",to:"Array",convert:function(N){return N.valueOf()}}],x});function gh(l){throw new Error("Cannot convert value ".concat(l," into a BigNumber: no class 'BigNumber' provided"))}function Ic(l){throw new Error("Cannot convert value ".concat(l," into a Complex number: no class 'Complex' provided"))}function oy(l){throw new Error("Cannot convert value ".concat(l," into a Fraction, no class 'Fraction' provided."))}function Wn(l,c,h){return l&&"function"==typeof l.map?l.map(function(f){return Wn(f,c,h)}):c(l)}var su="number",yh="number, number";function CP(l){return Math.abs(l)}function SP(l,c){return l+c}function Wd(l,c){return l*c}function Xs(l){return-l}CP.signature=su,SP.signature=yh,Wd.signature=yh,Xs.signature=su;var LN=Xe("abs",["typed"],l=>{var{typed:c}=l;return c("abs",{number:CP,Complex:function(f){return f.abs()},BigNumber:function(f){return f.abs()},Fraction:function(f){return f.abs()},"Array | Matrix":function(f){return Wn(f,this,!0)},Unit:function(f){return f.abs()}})});var $P="addScalar",BP=Xe($P,["typed"],l=>{var{typed:c}=l;return c($P,{"number, number":SP,"Complex, Complex":function(f,p){return f.add(p)},"BigNumber, BigNumber":function(f,p){return f.plus(p)},"Fraction, Fraction":function(f,p){return f.add(p)},"Unit, Unit":function(f,p){if(null==f.value)throw new Error("Parameter x contains a unit with undefined value");if(null==p.value)throw new Error("Parameter y contains a unit with undefined value");if(!f.equalBase(p))throw new Error("Units do not match");var v=f.clone();return v.value=this(v.value,p.value),v.fixPrefix=!1,v}})}),jP=Xe("bignumber",["typed","BigNumber"],l=>{var{typed:c,BigNumber:h}=l;return c("bignumber",{"":function(){return new h(0)},number:function(p){return new h(p+"")},string:function(p){var v=p.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(v){var x=v[2],S=h(v[1]),N=new h(2).pow(Number(x));if(S.gt(N.sub(1)))throw new SyntaxError('String "'.concat(p,'" is out of range'));var T=new h(2).pow(Number(x)-1);return S.gte(T)?S.sub(N):S}return new h(p)},BigNumber:function(p){return p},Fraction:function(p){return new h(p.n).div(p.d).times(p.s)},null:function(p){return new h(0)},"Array | Matrix":function(p){return Wn(p,this)}})});var rL=Xe("conj",["typed"],l=>{var{typed:c}=l;return c("conj",{number:function(f){return f},BigNumber:function(f){return f},Complex:function(f){return f.conjugate()},"Array | Matrix":function(f){return Wn(f,this)}})});function jl(l,c,h){if(null==h)return l.eq(c);if(l.eq(c))return!0;if(l.isNaN()||c.isNaN())return!1;if(l.isFinite()&&c.isFinite()){var f=l.minus(c).abs();if(f.isZero())return!0;var p=l.constructor.max(l.abs(),c.abs());return f.lte(p.times(h))}return!1}var Cy="equalScalar",B8=Xe(Cy,["typed","config"],l=>{var{typed:c,config:h}=l;return c(Cy,{"boolean, boolean":function(p,v){return p===v},"number, number":function(p,v){return Ie(p,v,h.epsilon)},"BigNumber, BigNumber":function(p,v){return p.eq(v)||jl(p,v,h.epsilon)},"Fraction, Fraction":function(p,v){return p.equals(v)},"Complex, Complex":function(p,v){return function uL(l,c,h){return Ie(l.re,c.re,h)&&Ie(l.im,c.im,h)}(p,v,h.epsilon)},"Unit, Unit":function(p,v){if(!p.equalBase(v))throw new Error("Cannot compare units with different base");return this(p.value,v.value)}})});Xe(Cy,["typed","config"],l=>{var{typed:c,config:h}=l;return c(Cy,{"number, number":function(p,v){return Ie(p,v,h.epsilon)}})}),Math.pow(2,53),Xe("hex",["typed","format"],l=>{var{typed:c,format:h}=l;return c("hex",{"number | BigNumber":function(p){return h(p,{notation:"hex"})},"number | BigNumber, number":function(p,v){return h(p,{notation:"hex",wordSize:v})}})});var ql="number";function Iw(l){return 0===l}function AL(l){return Number.isNaN(l)}Iw.signature=ql,AL.signature=ql;var Rw=Xe("isZero",["typed"],l=>{var{typed:c}=l;return c("isZero",{number:Iw,BigNumber:function(f){return f.isZero()},Complex:function(f){return 0===f.re&&0===f.im},Fraction:function(f){return 1===f.d&&0===f.n},Unit:function(f){return this(f.value)},"Array | Matrix":function(f){return Wn(f,this)}})});var DT=Xe("multiplyScalar",["typed"],l=>{var{typed:c}=l;return c("multiplyScalar",{"number, number":Wd,"Complex, Complex":function(f,p){return f.mul(p)},"BigNumber, BigNumber":function(f,p){return f.times(p)},"Fraction, Fraction":function(f,p){return f.mul(p)},"number | Fraction | BigNumber | Complex, Unit":function(f,p){var v=p.clone();return v.value=null===v.value?v._normalize(f):this(v.value,f),v},"Unit, number | Fraction | BigNumber | Complex":function(f,p){var v=f.clone();return v.value=null===v.value?v._normalize(p):this(v.value,p),v},"Unit, Unit":function(f,p){return f.multiply(p)}})});var FT=Xe("number",["typed"],l=>{var{typed:c}=l,h=c("number",{"":function(){return 0},number:function(p){return p},string:function(p){if("NaN"===p)return NaN;var v=function OT(l){var c=l.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);return c?{input:l,radix:{"0b":2,"0o":8,"0x":16}[c[1]],integerPart:c[2],fractionalPart:c[3]}:null}(p);if(v)return function Hw(l){for(var c=parseInt(l.integerPart,l.radix),h=0,f=0;f<l.fractionalPart.length;f++)h+=parseInt(l.fractionalPart[f],l.radix)/Math.pow(l.radix,f+1);var v=c+h;if(isNaN(v))throw new SyntaxError('String "'+l.input+'" is no valid number');return v}(v);var x=0,S=p.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);S&&(x=Number(S[2]),p=S[1]);var N=Number(p);if(isNaN(N))throw new SyntaxError('String "'+p+'" is no valid number');if(S){if(N>2**x-1)throw new SyntaxError('String "'.concat(p,'" is out of range'));N>=2**(x-1)&&(N-=2**x)}return N},BigNumber:function(p){return p.toNumber()},Fraction:function(p){return p.valueOf()},Unit:function(p){throw new Error("Second argument with valueless unit expected")},null:function(p){return 0},"Unit, string | Unit":function(p,v){return p.toNumber(v)},"Array | Matrix":function(p){return Wn(p,this)}});return h.fromJSON=function(f){return parseFloat(f.value)},h});Xe("oct",["typed","format"],l=>{var{typed:c,format:h}=l;return c("oct",{"number | BigNumber":function(p){return h(p,{notation:"oct"})},"number | BigNumber, number":function(p,v){return h(p,{notation:"oct",wordSize:v})}})}),z(340);Date.now();var GT=Xe("SparseMatrix",["typed","equalScalar","Matrix"],l=>{var{typed:c,equalScalar:h,Matrix:f}=l;function p(F,oe){if(!(this instanceof p))throw new SyntaxError("Constructor must be called with the new operator");if(oe&&!ea(oe))throw new Error("Invalid datatype: "+oe);if(yn(F))!function v(F,oe,ne){"SparseMatrix"===oe.type?(F._values=oe._values?tr(oe._values):void 0,F._index=tr(oe._index),F._ptr=tr(oe._ptr),F._size=tr(oe._size),F._datatype=ne||oe._datatype):x(F,oe.valueOf(),ne||oe._datatype)}(this,F,oe);else if(F&&Ti(F.index)&&Ti(F.ptr)&&Ti(F.size))this._values=F.values,this._index=F.index,this._ptr=F.ptr,this._size=F.size,this._datatype=oe||F.datatype;else if(Ti(F))x(this,F,oe);else{if(F)throw new TypeError("Unsupported type of data ("+cr(F)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=oe}}function x(F,oe,ne){F._values=[],F._index=[],F._ptr=[],F._datatype=ne;var de=oe.length,j=0,ae=h,le=0;if(ea(ne)&&(ae=c.find(h,[ne,ne])||h,le=c.convert(0,ne)),de>0){var q=0;do{F._ptr.push(F._index.length);for(var Ce=0;Ce<de;Ce++){var Se=oe[Ce];if(Ti(Se)){if(0===q&&j<Se.length&&(j=Se.length),q<Se.length){var Ee=Se[q];ae(Ee,le)||(F._values.push(Ee),F._index.push(Ce))}}else 0===q&&j<1&&(j=1),ae(Se,le)||(F._values.push(Se),F._index.push(Ce))}q++}while(q<j)}F._ptr.push(F._index.length),F._size=[de,j]}function S(F,oe){if(!Tu(oe))throw new TypeError("Invalid index");if(oe.isScalar())return F.get(oe.min());var de=oe.size();if(de.length!==F._size.length)throw new zr(de.length,F._size.length);var j,ae,le,q,Ce=oe.min(),Se=oe.max();for(j=0,ae=F._size.length;j<ae;j++)ki(Ce[j],F._size[j]),ki(Se[j],F._size[j]);var Ee=F._values,ve=F._index,ke=F._ptr,Oe=oe.dimension(0),Ze=oe.dimension(1),nt=[],ht=[];Oe.forEach(function(Te,mt){ht[Te]=mt[0],nt[Te]=!0});var Je=Ee?[]:void 0,Re=[],kt=[];return Ze.forEach(function(Te){for(kt.push(Re.length),le=ke[Te],q=ke[Te+1];le<q;le++)!0===nt[j=ve[le]]&&(Re.push(ht[j]),Je&&Je.push(Ee[le]))}),kt.push(Re.length),new p({values:Je,index:Re,ptr:kt,size:de,datatype:F._datatype})}function N(F,oe,ne,de){if(!oe||!0!==oe.isIndex)throw new TypeError("Invalid index");var le,j=oe.size(),ae=oe.isScalar();if(yn(ne)?(le=ne.size(),ne=ne.toArray()):le=Lr(ne),ae){if(0!==le.length)throw new TypeError("Scalar expected");F.set(oe.min(),ne,de)}else{if(1!==j.length&&2!==j.length)throw new zr(j.length,F._size.length,"<");if(le.length<j.length){for(var q=0,Ce=0;1===j[q]&&1===le[q];)q++;for(;1===j[q];)Ce++,q++;ne=EN(ne,j.length,Ce,le)}if(!Lo(j,le))throw new zr(j,le,">");if(1===j.length)oe.dimension(0).forEach(function(ke,Oe){ki(ke),F.set([ke,0],ne[Oe[0]],de)});else{var Ee=oe.dimension(0),ve=oe.dimension(1);Ee.forEach(function(ke,Oe){ki(ke),ve.forEach(function(Ze,nt){ki(Ze),F.set([ke,Ze],ne[Oe[0]][nt[0]],de)})})}}return F}function T(F,oe,ne,de){if(ne-oe==0)return ne;for(var j=oe;j<ne;j++)if(de[j]===F)return j;return oe}function b(F,oe,ne,de,j,ae,le){j.splice(F,0,de),ae.splice(F,0,oe);for(var q=ne+1;q<le.length;q++)le[q]++}function I(F,oe,ne,de){var j=de||0,ae=h,le=0;ea(F._datatype)&&(ae=c.find(h,[F._datatype,F._datatype])||h,le=c.convert(0,F._datatype),j=c.convert(j,F._datatype));var Ee,ve,ke,q=!ae(j,le),Ce=F._size[0],Se=F._size[1];if(ne>Se){for(ve=Se;ve<ne;ve++)if(F._ptr[ve]=F._values.length,q)for(Ee=0;Ee<Ce;Ee++)F._values.push(j),F._index.push(Ee);F._ptr[ne]=F._values.length}else ne<Se&&(F._ptr.splice(ne+1,Se-ne),F._values.splice(F._ptr[ne],F._values.length),F._index.splice(F._ptr[ne],F._index.length));if(Se=ne,oe>Ce){if(q){var Oe=0;for(ve=0;ve<Se;ve++){F._ptr[ve]=F._ptr[ve]+Oe,ke=F._ptr[ve+1]+Oe;var Ze=0;for(Ee=Ce;Ee<oe;Ee++,Ze++)F._values.splice(ke+Ze,0,j),F._index.splice(ke+Ze,0,Ee),Oe++}F._ptr[Se]=F._values.length}}else if(oe<Ce){var nt=0;for(ve=0;ve<Se;ve++){F._ptr[ve]=F._ptr[ve]-nt;var Je=F._ptr[ve+1]-nt;for(ke=F._ptr[ve];ke<Je;ke++)(Ee=F._index[ke])>oe-1&&(F._values.splice(ke,1),F._index.splice(ke,1),nt++)}F._ptr[ve]=F._values.length}return F._size[0]=oe,F._size[1]=ne,F}function k(F,oe,ne,de,j){var Ce,Se,ae=de[0],le=de[1],q=[];for(Ce=0;Ce<ae;Ce++)for(q[Ce]=[],Se=0;Se<le;Se++)q[Ce][Se]=0;for(Se=0;Se<le;Se++)for(var ve=ne[Se+1],ke=ne[Se];ke<ve;ke++)q[Ce=oe[ke]][Se]=F?j?tr(F[ke]):F[ke]:1;return q}return(p.prototype=new f).createSparseMatrix=function(F,oe){return new p(F,oe)},p.prototype.type="SparseMatrix",p.prototype.isSparseMatrix=!0,p.prototype.getDataType=function(){return Vm(this._values,cr)},p.prototype.storage=function(){return"sparse"},p.prototype.datatype=function(){return this._datatype},p.prototype.create=function(F,oe){return new p(F,oe)},p.prototype.density=function(){var F=this._size[0],oe=this._size[1];return 0!==F&&0!==oe?this._index.length/(F*oe):0},p.prototype.subset=function(F,oe,ne){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return S(this,F);case 2:case 3:return N(this,F,oe,ne);default:throw new SyntaxError("Wrong number of arguments")}},p.prototype.get=function(F){if(!Ti(F))throw new TypeError("Array expected");if(F.length!==this._size.length)throw new zr(F.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var oe=F[0],ne=F[1];ki(oe,this._size[0]),ki(ne,this._size[1]);var de=T(oe,this._ptr[ne],this._ptr[ne+1],this._index);return de<this._ptr[ne+1]&&this._index[de]===oe?this._values[de]:0},p.prototype.set=function(F,oe,ne){if(!Ti(F))throw new TypeError("Array expected");if(F.length!==this._size.length)throw new zr(F.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var de=F[0],j=F[1],ae=this._size[0],le=this._size[1],q=h,Ce=0;ea(this._datatype)&&(q=c.find(h,[this._datatype,this._datatype])||h,Ce=c.convert(0,this._datatype)),(de>ae-1||j>le-1)&&(I(this,Math.max(de+1,ae),Math.max(j+1,le),ne),ae=this._size[0],le=this._size[1]),ki(de,ae),ki(j,le);var Se=T(de,this._ptr[j],this._ptr[j+1],this._index);return Se<this._ptr[j+1]&&this._index[Se]===de?q(oe,Ce)?function C(F,oe,ne,de,j){ne.splice(F,1),de.splice(F,1);for(var ae=oe+1;ae<j.length;ae++)j[ae]--}(Se,j,this._values,this._index,this._ptr):this._values[Se]=oe:b(Se,de,j,oe,this._values,this._index,this._ptr),this},p.prototype.resize=function(F,oe,ne){if(!Im(F))throw new TypeError("Array or Matrix expected");var de=F.valueOf().map(ae=>Array.isArray(ae)&&1===ae.length?ae[0]:ae);if(2!==de.length)throw new Error("Only two dimensions matrix are supported");return de.forEach(function(ae){if(!gi(ae)||!Jt(ae)||ae<0)throw new TypeError("Invalid size, must contain positive integers (size: "+Mr(de)+")")}),I(ne?this.clone():this,de[0],de[1],oe)},p.prototype.reshape=function(F,oe){if(!Ti(F))throw new TypeError("Array expected");if(2!==F.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");F.forEach(function(Te){if(!gi(Te)||!Jt(Te)||Te<=-2||0===Te)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+Mr(F)+")")});var ne=this._size[0]*this._size[1];if(ne!==(F=Xb(F,ne))[0]*F[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var j=oe?this.clone():this;if(this._size[0]===F[0]&&this._size[1]===F[1])return j;for(var ae=[],le=0;le<j._ptr.length;le++)for(var q=0;q<j._ptr[le+1]-j._ptr[le];q++)ae.push(le);for(var Ce=j._values.slice(),Se=j._index.slice(),Ee=0;Ee<j._index.length;Ee++){var Oe=Se[Ee]*j._size[1]+ae[Ee];ae[Ee]=Oe%F[1],Se[Ee]=Math.floor(Oe/F[1])}j._values.length=0,j._index.length=0,j._ptr.length=F[1]+1,j._size=F.slice();for(var Ze=0;Ze<j._ptr.length;Ze++)j._ptr[Ze]=0;for(var nt=0;nt<Ce.length;nt++){var ht=Se[nt],Je=ae[nt],Re=Ce[nt];b(T(ht,j._ptr[Je],j._ptr[Je+1],j._index),ht,Je,Re,j._values,j._index,j._ptr)}return j},p.prototype.clone=function(){return new p({values:this._values?tr(this._values):void 0,index:tr(this._index),ptr:tr(this._ptr),size:tr(this._size),datatype:this._datatype})},p.prototype.size=function(){return this._size.slice(0)},p.prototype.map=function(F,oe){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var ne=this;return function M(F,oe,ne,de,j,ae,le){var q=[],Ce=[],Se=[],Ee=h,ve=0;ea(F._datatype)&&(Ee=c.find(h,[F._datatype,F._datatype])||h,ve=c.convert(0,F._datatype));for(var ke=function(Et,$t,un){Et=ae(Et,$t,un),Ee(Et,ve)||(q.push(Et),Ce.push($t))},Oe=de;Oe<=j;Oe++){Se.push(q.length);var Ze=F._ptr[Oe],nt=F._ptr[Oe+1];if(le)for(var ht=Ze;ht<nt;ht++){var Je=F._index[ht];Je>=oe&&Je<=ne&&ke(F._values[ht],Je-oe,Oe-de)}else{for(var Re={},kt=Ze;kt<nt;kt++)Re[F._index[kt]]=F._values[kt];for(var mt=oe;mt<=ne;mt++)ke(mt in Re?Re[mt]:0,mt-oe,Oe-de)}}return Se.push(q.length),new p({values:q,index:Ce,ptr:Se,size:[ne-oe+1,j-de+1]})}(this,0,this._size[0]-1,0,this._size[1]-1,function(q,Ce,Se){return F(q,[Ce,Se],ne)},oe)},p.prototype.forEach=function(F,oe){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var de=this._size[0],j=this._size[1],ae=0;ae<j;ae++){var le=this._ptr[ae],q=this._ptr[ae+1];if(oe)for(var Ce=le;Ce<q;Ce++)F(this._values[Ce],[this._index[Ce],ae],this);else{for(var Ee={},ve=le;ve<q;ve++)Ee[this._index[ve]]=this._values[ve];for(var Oe=0;Oe<de;Oe++)F(Oe in Ee?Ee[Oe]:0,[Oe,ae],this)}}},p.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var F=this._size[1],oe=0;oe<F;oe++)for(var de=this._ptr[oe+1],j=this._ptr[oe];j<de;j++){var ae=this._index[j];yield{value:this._values[j],index:[ae,oe]}}},p.prototype.toArray=function(){return k(this._values,this._index,this._ptr,this._size,!0)},p.prototype.valueOf=function(){return k(this._values,this._index,this._ptr,this._size,!1)},p.prototype.format=function(F){for(var oe=this._size[0],ne=this._size[1],de=this.density(),j="Sparse Matrix ["+Mr(oe,F)+" x "+Mr(ne,F)+"] density: "+Mr(de,F)+"\n",ae=0;ae<ne;ae++)for(var q=this._ptr[ae+1],Ce=this._ptr[ae];Ce<q;Ce++)j+="\n    ("+Mr(this._index[Ce],F)+", "+Mr(ae,F)+") ==> "+(this._values?Mr(this._values[Ce],F):"X");return j},p.prototype.toString=function(){return Mr(this.toArray())},p.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},p.prototype.diagonal=function(F){if(F){if(hi(F)&&(F=F.toNumber()),!gi(F)||!Jt(F))throw new TypeError("The parameter k must be an integer number")}else F=0;var oe=F>0?F:0,ne=F<0?-F:0,j=this._size[1],ae=Math.min(this._size[0]-ne,j-oe),le=[],q=[],Ce=[];Ce[0]=0;for(var Se=oe;Se<j&&le.length<ae;Se++)for(var ve=this._ptr[Se+1],ke=this._ptr[Se];ke<ve;ke++){var Oe=this._index[ke];if(Oe===Se-oe+ne){le.push(this._values[ke]),q[le.length-1]=Oe-ne;break}}return Ce.push(le.length),new p({values:le,index:q,ptr:Ce,size:[ae,1]})},p.fromJSON=function(F){return new p(F)},p.diagonal=function(F,oe,ne,de,j){if(!Ti(F))throw new TypeError("Array expected, size parameter");if(2!==F.length)throw new Error("Only two dimensions matrix are supported");if(F=F.map(function(Te){if(hi(Te)&&(Te=Te.toNumber()),!gi(Te)||!Jt(Te)||Te<1)throw new Error("Size values must be positive integers");return Te}),ne){if(hi(ne)&&(ne=ne.toNumber()),!gi(ne)||!Jt(ne))throw new TypeError("The parameter k must be an integer number")}else ne=0;var ae=h,le=0;ea(j)&&(ae=c.find(h,[j,j])||h,le=c.convert(0,j));var ke,q=ne>0?ne:0,Ce=ne<0?-ne:0,Se=F[0],Ee=F[1],ve=Math.min(Se-Ce,Ee-q);if(Ti(oe)){if(oe.length!==ve)throw new Error("Invalid value array length");ke=function(mt){return oe[mt]}}else if(yn(oe)){var Oe=oe.size();if(1!==Oe.length||Oe[0]!==ve)throw new Error("Invalid matrix length");ke=function(mt){return oe.get([mt])}}else ke=function(){return oe};for(var Ze=[],nt=[],ht=[],Je=0;Je<Ee;Je++){ht.push(Ze.length);var Re=Je-q;if(Re>=0&&Re<ve){var kt=ke(Re);ae(kt,le)||(nt.push(Re+Ce),Ze.push(kt))}}return ht.push(Ze.length),new p({values:Ze,index:nt,ptr:ht,size:[Se,Ee]})},p.prototype.swapRows=function(F,oe){if(!(gi(F)&&Jt(F)&&gi(oe)&&Jt(oe)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return ki(F,this._size[0]),ki(oe,this._size[0]),p._swapRows(F,oe,this._size[1],this._values,this._index,this._ptr),this},p._forEachRow=function(F,oe,ne,de,j){for(var le=de[F+1],q=de[F];q<le;q++)j(ne[q],oe[q])},p._swapRows=function(F,oe,ne,de,j,ae){for(var le=0;le<ne;le++){var q=ae[le],Ce=ae[le+1],Se=T(F,q,Ce,j),Ee=T(oe,q,Ce,j);if(Se<Ce&&Ee<Ce&&j[Se]===F&&j[Ee]===oe){if(de){var ve=de[Se];de[Se]=de[Ee],de[Ee]=ve}}else if(Se<Ce&&j[Se]===F&&(Ee>=Ce||j[Ee]!==oe)){var ke=de?de[Se]:void 0;j.splice(Ee,0,oe),de&&de.splice(Ee,0,ke),j.splice(Ee<=Se?Se+1:Se,1),de&&de.splice(Ee<=Se?Se+1:Se,1)}else if(Ee<Ce&&j[Ee]===oe&&(Se>=Ce||j[Se]!==F)){var Oe=de?de[Ee]:void 0;j.splice(Se,0,F),de&&de.splice(Se,0,Oe),j.splice(Se<=Ee?Ee+1:Ee,1),de&&de.splice(Se<=Ee?Ee+1:Ee,1)}}},p},{isClass:!0});Xe("bin",["typed","format"],l=>{var{typed:c,format:h}=l;return c("bin",{"number | BigNumber":function(p){return h(p,{notation:"bin"})},"number | BigNumber, number":function(p,v){return h(p,{notation:"bin",wordSize:v})}})});var JL=Xe("isNaN",["typed"],l=>{var{typed:c}=l;return c("isNaN",{number:AL,BigNumber:function(f){return f.isNaN()},Fraction:function(f){return!1},Complex:function(f){return f.isNaN()},Unit:function(f){return Number.isNaN(f.value)},"Array | Matrix":function(f){return Wn(f,Number.isNaN)}})}),uA="unaryMinus",X8=Xe(uA,["typed"],l=>{var{typed:c}=l;return c(uA,{number:Xs,Complex:function(f){return f.neg()},BigNumber:function(f){return f.neg()},Fraction:function(f){return f.neg()},Unit:function(f){var p=f.clone();return p.value=this(f.value),p},"Array | Matrix":function(f){return Wn(f,this,!0)}})}),u$=Xe("fraction",["typed","Fraction"],l=>{var{typed:c,Fraction:h}=l;return c("fraction",{number:function(p){if(!isFinite(p)||isNaN(p))throw new Error(p+" cannot be represented as a fraction");return new h(p)},string:function(p){return new h(p)},"number, number":function(p,v){return new h(p,v)},null:function(p){return new h(0)},BigNumber:function(p){return new h(p.toString())},Fraction:function(p){return p},Object:function(p){return new h(p)},"Array | Matrix":function(p){return Wn(p,this)}})}),l$="isNumeric",hA=Xe(l$,["typed"],l=>{var{typed:c}=l;return c(l$,{"number | BigNumber | Fraction | boolean":function(){return!0},"Complex | Unit | string | null | undefined | Node":function(){return!1},"Array | Matrix":function(f){return Wn(f,this)}})}),ux=Xe("matrix",["typed","Matrix","DenseMatrix","SparseMatrix"],l=>{var{typed:c,DenseMatrix:f,SparseMatrix:p}=l;return c("matrix",{"":function(){return v([])},string:function(S){return v([],S)},"string, string":function(S,N){return v([],S,N)},Array:function(S){return v(S)},Matrix:function(S){return v(S,S.storage())},"Array | Matrix, string":v,"Array | Matrix, string, string":v});function v(x,S,N){if("dense"===S||"default"===S||void 0===S)return new f(x,N);if("sparse"===S)return new p(x,N);throw new TypeError("Unknown matrix type "+JSON.stringify(S)+".")}}),Ea=Xe("algorithm03",["typed"],l=>{var{typed:c}=l;return function(f,p,v,x){var S=f._data,N=f._size,T=f._datatype,C=p._values,b=p._index,I=p._ptr,M=p._size,k=p._datatype;if(N.length!==M.length)throw new zr(N.length,M.length);if(N[0]!==M[0]||N[1]!==M[1])throw new RangeError("Dimension mismatch. Matrix A ("+N+") must match Matrix B ("+M+")");if(!C)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var ne,F=N[0],oe=N[1],de=0,j=v;"string"==typeof T&&T===k&&(de=c.convert(0,ne=T),j=c.find(v,[ne,ne]));for(var ae=[],le=0;le<F;le++)ae[le]=[];for(var q=[],Ce=[],Se=0;Se<oe;Se++){for(var Ee=Se+1,ke=I[Se+1],Oe=I[Se];Oe<ke;Oe++){var Ze=b[Oe];q[Ze]=x?j(C[Oe],S[Ze][Se]):j(S[Ze][Se],C[Oe]),Ce[Ze]=Ee}for(var nt=0;nt<F;nt++)ae[nt][Se]=Ce[nt]===Ee?q[nt]:x?j(de,S[nt][Se]):j(S[nt][Se],de)}return f.createDenseMatrix({data:ae,size:[F,oe],datatype:ne})}}),Py=Xe("algorithm05",["typed","equalScalar"],l=>{var{typed:c,equalScalar:h}=l;return function(p,v,x){var S=p._values,N=p._index,T=p._ptr,C=p._size,b=p._datatype,I=v._values,M=v._index,k=v._ptr,F=v._size,oe=v._datatype;if(C.length!==F.length)throw new zr(C.length,F.length);if(C[0]!==F[0]||C[1]!==F[1])throw new RangeError("Dimension mismatch. Matrix A ("+C+") must match Matrix B ("+F+")");var j,ne=C[0],de=C[1],ae=h,le=0,q=x;"string"==typeof b&&b===oe&&(ae=c.find(h,[j=b,j]),le=c.convert(0,j),q=c.find(x,[j,j]));var nt,ht,Je,Re,Ce=S&&I?[]:void 0,Se=[],Ee=[],ve=Ce?[]:void 0,ke=Ce?[]:void 0,Oe=[],Ze=[];for(ht=0;ht<de;ht++){Ee[ht]=Se.length;var kt=ht+1;for(Je=T[ht],Re=T[ht+1];Je<Re;Je++)Se.push(nt=N[Je]),Oe[nt]=kt,ve&&(ve[nt]=S[Je]);for(Je=k[ht],Re=k[ht+1];Je<Re;Je++)Oe[nt=M[Je]]!==kt&&Se.push(nt),Ze[nt]=kt,ke&&(ke[nt]=I[Je]);if(Ce)for(Je=Ee[ht];Je<Se.length;){var Te=Oe[nt=Se[Je]],mt=Ze[nt];if(Te===kt||mt===kt){var Et=q(Te===kt?ve[nt]:le,mt===kt?ke[nt]:le);ae(Et,le)?Se.splice(Je,1):(Ce.push(Et),Je++)}}}return Ee[de]=Se.length,p.createSparseMatrix({values:Ce,index:Se,ptr:Ee,size:[ne,de],datatype:j})}}),Vo=Xe("algorithm11",["typed","equalScalar"],l=>{var{typed:c,equalScalar:h}=l;return function(p,v,x,S){var N=p._values,T=p._index,C=p._ptr,b=p._size,I=p._datatype;if(!N)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var F,M=b[0],k=b[1],oe=h,ne=0,de=x;"string"==typeof I&&(oe=c.find(h,[F=I,F]),ne=c.convert(0,F),v=c.convert(v,F),de=c.find(x,[F,F]));for(var j=[],ae=[],le=[],q=0;q<k;q++){le[q]=ae.length;for(var Se=C[q+1],Ee=C[q];Ee<Se;Ee++){var ve=T[Ee],ke=S?de(v,N[Ee]):de(N[Ee],v);oe(ke,ne)||(ae.push(ve),j.push(ke))}}return le[k]=ae.length,p.createSparseMatrix({values:j,index:ae,ptr:le,size:[M,k],datatype:F})}}),ao=Xe("algorithm12",["typed","DenseMatrix"],l=>{var{typed:c,DenseMatrix:h}=l;return function(p,v,x,S){var N=p._values,T=p._index,C=p._ptr,b=p._size,I=p._datatype;if(!N)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var F,M=b[0],k=b[1],oe=x;"string"==typeof I&&(v=c.convert(v,F=I),oe=c.find(x,[F,F]));for(var ne=[],de=[],j=[],ae=0;ae<k;ae++){for(var le=ae+1,Ce=C[ae+1],Se=C[ae];Se<Ce;Se++){var Ee=T[Se];de[Ee]=N[Se],j[Ee]=le}for(var ve=0;ve<M;ve++)0===ae&&(ne[ve]=[]),ne[ve][ae]=j[ve]===le?S?oe(v,de[ve]):oe(de[ve],v):S?oe(v,0):oe(0,v)}return new h({data:ne,size:[M,k],datatype:F})}}),Ui=Xe("algorithm13",["typed"],l=>{var{typed:c}=l;return function(p,v,x){var S=p._data,N=p._size,T=p._datatype,C=v._data,b=v._size,I=v._datatype,M=[];if(N.length!==b.length)throw new zr(N.length,b.length);for(var k=0;k<N.length;k++){if(N[k]!==b[k])throw new RangeError("Dimension mismatch. Matrix A ("+N+") must match Matrix B ("+b+")");M[k]=N[k]}var F,oe=x;"string"==typeof T&&T===I&&(oe=c.find(x,[F=T,F]));var ne=M.length>0?h(oe,0,M,M[0],S,C):[];return p.createDenseMatrix({data:ne,size:M,datatype:F})};function h(f,p,v,x,S,N){var T=[];if(p===v.length-1)for(var C=0;C<x;C++)T[C]=f(S[C],N[C]);else for(var b=0;b<x;b++)T[b]=h(f,p+1,v,v[p+1],S[b],N[b]);return T}}),di=Xe("algorithm14",["typed"],l=>{var{typed:c}=l;return function(p,v,x,S){var b,N=p._data,T=p._size,C=p._datatype,I=x;"string"==typeof C&&(v=c.convert(v,b=C),I=c.find(x,[b,b]));var M=T.length>0?h(I,0,T,T[0],N,v,S):[];return p.createDenseMatrix({data:M,size:tr(T),datatype:b})};function h(f,p,v,x,S,N,T){var C=[];if(p===v.length-1)for(var b=0;b<x;b++)C[b]=T?f(N,S[b]):f(S[b],N);else for(var I=0;I<x;I++)C[I]=h(f,p+1,v,v[p+1],S[I],N,T);return C}}),Oc=Xe("algorithm01",["typed"],l=>{var{typed:c}=l;return function(f,p,v,x){var S=f._data,N=f._size,T=f._datatype,C=p._values,b=p._index,I=p._ptr,M=p._size,k=p._datatype;if(N.length!==M.length)throw new zr(N.length,M.length);if(N[0]!==M[0]||N[1]!==M[1])throw new RangeError("Dimension mismatch. Matrix A ("+N+") must match Matrix B ("+M+")");if(!C)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var j,ae,F=N[0],oe=N[1],ne="string"==typeof T&&T===k?T:void 0,de=ne?c.find(v,[ne,ne]):v,le=[];for(j=0;j<F;j++)le[j]=[];var q=[],Ce=[];for(ae=0;ae<oe;ae++){for(var Se=ae+1,ve=I[ae+1],ke=I[ae];ke<ve;ke++)q[j=b[ke]]=x?de(C[ke],S[j][ae]):de(S[j][ae],C[ke]),Ce[j]=Se;for(j=0;j<F;j++)le[j][ae]=Ce[j]===Se?q[j]:S[j][ae]}return f.createDenseMatrix({data:le,size:[F,oe],datatype:ne})}});function mx(){throw new Error('No "bignumber" implementation available')}function vA(){throw new Error('No "fraction" implementation available')}var J8=Xe("numeric",["number","?bignumber","?fraction"],l=>{var{number:c,bignumber:h,fraction:f}=l,p={string:!0,number:!0,BigNumber:!0,Fraction:!0},v={number:x=>c(x),BigNumber:h?x=>h(x):mx,Fraction:f?x=>f(x):vA};return function(S,N){var T=cr(S);if(!(T in p))throw new TypeError("Cannot convert "+S+' of type "'+T+'"; valid input types are '+Object.keys(p).join(", "));if(!(N in v))throw new TypeError("Cannot convert "+S+' to type "'+N+'"; valid output types are '+Object.keys(v).join(", "));return N===T?S:v[N](S)}});var D$=Xe("size",["typed","config","?matrix"],l=>{var{typed:c,config:h,matrix:f}=l;return c("size",{Matrix:function(v){return v.create(v.size())},Array:Lr,string:function(v){return"Array"===h.matrix?[v.length]:f([v.length])},"number | Complex | BigNumber | Unit | boolean | null":function(v){return"Array"===h.matrix?[]:f?f([]):function gx(){throw new Error('No "matrix" implementation available')}()}})}),Tf=Xe("algorithm10",["typed","DenseMatrix"],l=>{var{typed:c,DenseMatrix:h}=l;return function(p,v,x,S){var N=p._values,T=p._index,C=p._ptr,b=p._size,I=p._datatype;if(!N)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var F,M=b[0],k=b[1],oe=x;"string"==typeof I&&(v=c.convert(v,F=I),oe=c.find(x,[F,F]));for(var ne=[],de=[],j=[],ae=0;ae<k;ae++){for(var le=ae+1,Ce=C[ae+1],Se=C[ae];Se<Ce;Se++){var Ee=T[Se];de[Ee]=N[Se],j[Ee]=le}for(var ve=0;ve<M;ve++)0===ae&&(ne[ve]=[]),ne[ve][ae]=j[ve]===le?S?oe(v,de[ve]):oe(de[ve],v):v}return new h({data:ne,size:[M,k],datatype:F})}}),Cx="subtract",AA=Xe(Cx,["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],l=>{var{typed:c,matrix:h,equalScalar:f,addScalar:p,unaryMinus:v,DenseMatrix:x}=l,S=Oc({typed:c}),N=Ea({typed:c}),T=Py({typed:c,equalScalar:f}),C=Tf({typed:c,DenseMatrix:x}),b=Ui({typed:c}),I=di({typed:c});return c(Cx,{"number, number":function(k,F){return k-F},"Complex, Complex":function(k,F){return k.sub(F)},"BigNumber, BigNumber":function(k,F){return k.minus(F)},"Fraction, Fraction":function(k,F){return k.sub(F)},"Unit, Unit":function(k,F){if(null===k.value)throw new Error("Parameter x contains a unit with undefined value");if(null===F.value)throw new Error("Parameter y contains a unit with undefined value");if(!k.equalBase(F))throw new Error("Units do not match");var oe=k.clone();return oe.value=this(oe.value,F.value),oe.fixPrefix=!1,oe},"SparseMatrix, SparseMatrix":function(k,F){return By(k,F),T(k,F,this)},"SparseMatrix, DenseMatrix":function(k,F){return By(k,F),N(F,k,this,!0)},"DenseMatrix, SparseMatrix":function(k,F){return By(k,F),S(k,F,this,!1)},"DenseMatrix, DenseMatrix":function(k,F){return By(k,F),b(k,F,this)},"Array, Array":function(k,F){return this(h(k),h(F)).valueOf()},"Array, Matrix":function(k,F){return this(h(k),F)},"Matrix, Array":function(k,F){return this(k,h(F))},"SparseMatrix, any":function(k,F){return C(k,v(F),p)},"DenseMatrix, any":function(k,F){return I(k,F,this)},"any, SparseMatrix":function(k,F){return C(F,k,this,!0)},"any, DenseMatrix":function(k,F){return I(F,k,this,!0)},"Array, any":function(k,F){return I(h(k),F,this,!1).valueOf()},"any, Array":function(k,F){return I(h(F),k,this,!0).valueOf()}})});function By(l,c){var h=l.size(),f=c.size();if(h.length!==f.length)throw new zr(h.length,f.length)}var PA="compare",Vy=Xe(PA,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix"],l=>{var{typed:c,config:h,equalScalar:f,matrix:p,BigNumber:v,Fraction:x,DenseMatrix:S}=l,N=Ea({typed:c}),T=Py({typed:c,equalScalar:f}),C=ao({typed:c,DenseMatrix:S}),b=Ui({typed:c}),I=di({typed:c});return c(PA,{"boolean, boolean":function(k,F){return k===F?0:k>F?1:-1},"number, number":function(k,F){return Ie(k,F,h.epsilon)?0:k>F?1:-1},"BigNumber, BigNumber":function(k,F){return jl(k,F,h.epsilon)?new v(0):new v(k.cmp(F))},"Fraction, Fraction":function(k,F){return new x(k.compare(F))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(k,F){if(!k.equalBase(F))throw new Error("Cannot compare units with different base");return this(k.value,F.value)},"SparseMatrix, SparseMatrix":function(k,F){return T(k,F,this)},"SparseMatrix, DenseMatrix":function(k,F){return N(F,k,this,!0)},"DenseMatrix, SparseMatrix":function(k,F){return N(k,F,this,!1)},"DenseMatrix, DenseMatrix":function(k,F){return b(k,F,this)},"Array, Array":function(k,F){return this(p(k),p(F)).valueOf()},"Array, Matrix":function(k,F){return this(p(k),F)},"Matrix, Array":function(k,F){return this(k,p(F))},"SparseMatrix, any":function(k,F){return C(k,F,this,!1)},"DenseMatrix, any":function(k,F){return I(k,F,this,!1)},"any, SparseMatrix":function(k,F){return C(F,k,this,!0)},"any, DenseMatrix":function(k,F){return I(F,k,this,!0)},"Array, any":function(k,F){return I(p(k),F,this,!1).valueOf()},"any, Array":function(k,F){return I(p(F),k,this,!0).valueOf()}})}),If="divideScalar",lp=Xe(If,["typed","numeric"],l=>{var{typed:c,numeric:h}=l;return c(If,{"number, number":function(p,v){return p/v},"Complex, Complex":function(p,v){return p.div(v)},"BigNumber, BigNumber":function(p,v){return p.div(v)},"Fraction, Fraction":function(p,v){return p.div(v)},"Unit, number | Fraction | BigNumber":function(p,v){var x=p.clone(),S=h(1,cr(v));return x.value=this(null===x.value?x._normalize(S):x.value,v),x},"number | Fraction | BigNumber, Unit":function(p,v){var x=v.clone();x=x.pow(-1);var S=h(1,cr(p));return x.value=this(p,null===v.value?v._normalize(S):v.value),x},"Unit, Unit":function(p,v){return p.divide(v)}})}),Ix=(Xe("equal",["typed","equalScalar"],l=>{var{typed:c,equalScalar:h}=l;return c("equal",{"any, any":function(p,v){return null===p?null===v:null===v?null===p:void 0===p?void 0===v:void 0===v?void 0===p:h(p,v)}})}),Xe("algorithm04",["typed","equalScalar"],l=>{var{typed:c,equalScalar:h}=l;return function(p,v,x){var S=p._values,N=p._index,T=p._ptr,C=p._size,b=p._datatype,I=v._values,M=v._index,k=v._ptr,F=v._size,oe=v._datatype;if(C.length!==F.length)throw new zr(C.length,F.length);if(C[0]!==F[0]||C[1]!==F[1])throw new RangeError("Dimension mismatch. Matrix A ("+C+") must match Matrix B ("+F+")");var j,ne=C[0],de=C[1],ae=h,le=0,q=x;"string"==typeof b&&b===oe&&(ae=c.find(h,[j=b,j]),le=c.convert(0,j),q=c.find(x,[j,j]));var nt,ht,Je,kt,Ce=S&&I?[]:void 0,Se=[],Ee=[],ve=S&&I?[]:void 0,ke=S&&I?[]:void 0,Oe=[],Ze=[];for(ht=0;ht<de;ht++){Ee[ht]=Se.length;var Te=ht+1;for(kt=T[ht+1],Je=T[ht];Je<kt;Je++)Se.push(nt=N[Je]),Oe[nt]=Te,ve&&(ve[nt]=S[Je]);for(kt=k[ht+1],Je=k[ht];Je<kt;Je++)if(Oe[nt=M[Je]]===Te){if(ve){var mt=q(ve[nt],I[Je]);ae(mt,le)?Oe[nt]=null:ve[nt]=mt}}else Se.push(nt),Ze[nt]=Te,ke&&(ke[nt]=I[Je]);if(ve&&ke)for(Je=Ee[ht];Je<Se.length;)Oe[nt=Se[Je]]===Te?(Ce[Je]=ve[nt],Je++):Ze[nt]===Te?(Ce[Je]=ke[nt],Je++):Se.splice(Je,1)}return Ee[de]=Se.length,p.createSparseMatrix({values:Ce,index:Se,ptr:Ee,size:[ne,de],datatype:j})}})),iI="partitionSelect",Gr=Xe(iI,["typed","isNumeric","isNaN","compare"],l=>{var{typed:c,isNumeric:h,isNaN:f,compare:p}=l,v=p,x=(T,C)=>-p(T,C);return c(iI,{"Array | Matrix, number":function(C,b){return S(C,b,v)},"Array | Matrix, number, string":function(C,b,I){if("asc"===I)return S(C,b,v);if("desc"===I)return S(C,b,x);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":S});function S(T,C,b){if(!Jt(C)||C<0)throw new Error("k must be a non-negative integer");if(yn(T)){if(T.size().length>1)throw new Error("Only one dimensional matrices supported");return N(T.valueOf(),C,b)}if(Array.isArray(T))return N(T,C,b)}function N(T,C,b){if(C>=T.length)throw new Error("k out of bounds");for(var I=0;I<T.length;I++)if(h(T[I])&&f(T[I]))return T[I];for(var M=0,k=T.length-1;M<k;){for(var F=M,oe=k,ne=T[Math.floor(Math.random()*(k-M+1))+M];F<oe;)if(b(T[F],ne)>=0){var de=T[oe];T[oe]=T[F],T[F]=de,--oe}else++F;b(T[F],ne)>0&&--F,C<=F?k=F:M=F+1}return T[C]}});function lo(l,c,h,f){if(!(this instanceof lo))throw new SyntaxError("Constructor must be called with the new operator");this.fn=l,this.count=c,this.min=h,this.max=f,this.message="Wrong number of arguments in function "+l+" ("+c+" provided, "+h+(null!=f?"-"+f:"")+" expected)",this.stack=(new Error).stack}(lo.prototype=new Error).constructor=Error,lo.prototype.name="ArgumentsError",lo.prototype.isArgumentsError=!0;var pg="unequal",fI=(Xe(pg,["typed","equalScalar"],l=>{var{typed:c,equalScalar:h}=l;return c(pg,{"any, any":function(p,v){return null===p?null!==v:null===v?null!==p:void 0===p?void 0!==v:void 0===v?void 0!==p:!h(p,v)}})}),Xe("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix"],l=>{var{typed:c,matrix:h,addScalar:f,equalScalar:p,DenseMatrix:v}=l,S=Oc({typed:c}),N=Ix({typed:c,equalScalar:p}),T=Tf({typed:c,DenseMatrix:v}),C=Ui({typed:c}),b=di({typed:c});return c("add",fh({"DenseMatrix, DenseMatrix":function(M,k){return C(M,k,f)},"DenseMatrix, SparseMatrix":function(M,k){return S(M,k,f,!1)},"SparseMatrix, DenseMatrix":function(M,k){return S(k,M,f,!0)},"SparseMatrix, SparseMatrix":function(M,k){return N(M,k,f)},"Array, Array":function(M,k){return this(h(M),h(k)).valueOf()},"Array, Matrix":function(M,k){return this(h(M),k)},"Matrix, Array":function(M,k){return this(M,h(k))},"DenseMatrix, any":function(M,k){return b(M,k,f,!1)},"SparseMatrix, any":function(M,k){return T(M,k,f,!1)},"any, DenseMatrix":function(M,k){return b(k,M,f,!0)},"any, SparseMatrix":function(M,k){return T(k,M,f,!0)},"Array, any":function(M,k){return b(h(M),k,f,!1).valueOf()},"any, Array":function(M,k){return b(h(k),M,f,!0).valueOf()},"any, any":f,"any, any, ...any":function(M,k,F){for(var oe=this(M,k),ne=0;ne<F.length;ne++)oe=this(oe,F[ne]);return oe}},f.signatures))}));z(9286);var hl=Xe("dot",["typed","addScalar","multiplyScalar","conj","size"],l=>{var{typed:c,addScalar:h,multiplyScalar:f,conj:p,size:v}=l;return c("dot",{"Array | DenseMatrix, Array | DenseMatrix":function S(C,b){var I=x(C,b),M=yn(C)?C._data:C,k=yn(C)?C._datatype:void 0,F=yn(b)?b._data:b,oe=yn(b)?b._datatype:void 0,ne=2===T(C).length,de=2===T(b).length,j=h,ae=f;if(k&&oe&&k===oe&&"string"==typeof k){var le=k;j=c.find(h,[le,le]),ae=c.find(f,[le,le])}if(!ne&&!de){for(var q=ae(p(M[0]),F[0]),Ce=1;Ce<I;Ce++)q=j(q,ae(p(M[Ce]),F[Ce]));return q}if(!ne&&de){for(var Se=ae(p(M[0]),F[0][0]),Ee=1;Ee<I;Ee++)Se=j(Se,ae(p(M[Ee]),F[Ee][0]));return Se}if(ne&&!de){for(var ve=ae(p(M[0][0]),F[0]),ke=1;ke<I;ke++)ve=j(ve,ae(p(M[ke][0]),F[ke]));return ve}if(ne&&de){for(var Oe=ae(p(M[0][0]),F[0][0]),Ze=1;Ze<I;Ze++)Oe=j(Oe,ae(p(M[Ze][0]),F[Ze][0]));return Oe}},"SparseMatrix, SparseMatrix":function N(C,b){x(C,b);for(var I=C._index,M=C._values,k=b._index,F=b._values,oe=0,ne=h,de=f,j=0,ae=0;j<I.length&&ae<k.length;){var le=I[j],q=k[ae];le<q?j++:le>q?ae++:le===q&&(oe=ne(oe,de(M[j],F[ae])),j++,ae++)}return oe}});function x(C,b){var k,F,I=T(C),M=T(b);if(1===I.length)k=I[0];else{if(2!==I.length||1!==I[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+I.join(", ")+")");k=I[0]}if(1===M.length)F=M[0];else{if(2!==M.length||1!==M[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+M.join(", ")+")");F=M[0]}if(k!==F)throw new RangeError("Vectors must have equal length ("+k+" != "+F+")");if(0===k)throw new RangeError("Cannot calculate the dot product of empty vectors");return k}function T(C){return yn(C)?C.size():v(C)}}),qy="identity",wB=Xe(qy,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],l=>{var{typed:c,config:h,matrix:f,BigNumber:p,DenseMatrix:v,SparseMatrix:x}=l;return c(qy,{"":function(){return"Matrix"===h.matrix?f([]):[]},string:function(C){return f(C)},"number | BigNumber":function(C){return N(C,C,"Matrix"===h.matrix?"dense":void 0)},"number | BigNumber, string":function(C,b){return N(C,C,b)},"number | BigNumber, number | BigNumber":function(C,b){return N(C,b,"Matrix"===h.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(C,b,I){return N(C,b,I)},Array:function(C){return S(C)},"Array, string":function(C,b){return S(C,b)},Matrix:function(C){return S(C.valueOf(),C.storage())},"Matrix, string":function(C,b){return S(C.valueOf(),b)}});function S(T,C){switch(T.length){case 0:return C?f(C):[];case 1:return N(T[0],T[0],C);case 2:return N(T[0],T[1],C);default:throw new Error("Vector containing two values expected")}}function N(T,C,b){var I=hi(T)||hi(C)?p:null;if(hi(T)&&(T=T.toNumber()),hi(C)&&(C=C.toNumber()),!Jt(T)||T<1)throw new Error("Parameters in function identity must be positive integers");if(!Jt(C)||C<1)throw new Error("Parameters in function identity must be positive integers");var M=I?new p(1):1,k=I?new I(0):0,F=[T,C];if(b){if("sparse"===b)return x.diagonal(F,M,0,k);if("dense"===b)return v.diagonal(F,M,0,k);throw new TypeError('Unknown matrix type "'.concat(b,'"'))}for(var oe=Bd([],F,k),ne=T<C?T:C,de=0;de<ne;de++)oe[de][de]=M;return oe}}),Yx="multiply",EB=Xe(Yx,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],l=>{var{typed:c,matrix:h,addScalar:f,multiplyScalar:p,equalScalar:v,dot:x}=l,S=Vo({typed:c,equalScalar:v}),N=di({typed:c});function T(le,q){switch(le.length){case 1:switch(q.length){case 1:if(le[0]!==q[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(le[0]!==q[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+le[0]+") must match Matrix rows ("+q[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+q.length+" dimensions)")}break;case 2:switch(q.length){case 1:if(le[1]!==q[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+le[1]+") must match Vector length ("+q[0]+")");break;case 2:if(le[1]!==q[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+le[1]+") must match Matrix B rows ("+q[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+q.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+le.length+" dimensions)")}}var M=c("_multiplyMatrixVector",{"DenseMatrix, any":function F(le,q){var nt,Ce=le._data,Se=le._size,Ee=le._datatype,ve=q._data,ke=q._datatype,Oe=Se[0],Ze=Se[1],ht=f,Je=p;Ee&&ke&&Ee===ke&&"string"==typeof Ee&&(ht=c.find(f,[nt=Ee,nt]),Je=c.find(p,[nt,nt]));for(var Re=[],kt=0;kt<Oe;kt++){for(var Te=Ce[kt],mt=Je(Te[0],ve[0]),Lt=1;Lt<Ze;Lt++)mt=ht(mt,Je(Te[Lt],ve[Lt]));Re[kt]=mt}return le.createDenseMatrix({data:Re,size:[Oe],datatype:nt})},"SparseMatrix, any":function de(le,q){var Ce=le._values,Se=le._index,Ee=le._ptr,ve=le._datatype;if(!Ce)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var kt,ke=q._data,Oe=q._datatype,Ze=le._size[0],nt=q._size[0],ht=[],Je=[],Re=[],Te=f,mt=p,Lt=v,fn=0;ve&&Oe&&ve===Oe&&"string"==typeof ve&&(Te=c.find(f,[kt=ve,kt]),mt=c.find(p,[kt,kt]),Lt=c.find(v,[kt,kt]),fn=c.convert(0,kt));var Et=[],$t=[];Re[0]=0;for(var un=0;un<nt;un++){var Yt=ke[un];if(!Lt(Yt,fn))for(var Dn=Ee[un+1],On=Ee[un];On<Dn;On++){var an=Se[On];$t[an]?Et[an]=Te(Et[an],mt(Yt,Ce[On])):($t[an]=!0,Je.push(an),Et[an]=mt(Yt,Ce[On]))}}for(var pr=Je.length,ar=0;ar<pr;ar++)ht[ar]=Et[Je[ar]];return Re[1]=Je.length,le.createSparseMatrix({values:ht,index:Je,ptr:Re,size:[Ze,1],datatype:kt})}}),k=c("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function oe(le,q){var Je,Ce=le._data,Se=le._size,Ee=le._datatype,ve=q._data,Oe=q._datatype,Ze=Se[0],nt=Se[1],ht=q._size[1],Re=f,kt=p;Ee&&Oe&&Ee===Oe&&"string"==typeof Ee&&(Re=c.find(f,[Je=Ee,Je]),kt=c.find(p,[Je,Je]));for(var Te=[],mt=0;mt<Ze;mt++){var Lt=Ce[mt];Te[mt]=[];for(var fn=0;fn<ht;fn++){for(var Et=kt(Lt[0],ve[0][fn]),$t=1;$t<nt;$t++)Et=Re(Et,kt(Lt[$t],ve[$t][fn]));Te[mt][fn]=Et}}return le.createDenseMatrix({data:Te,size:[Ze,ht],datatype:Je})},"DenseMatrix, SparseMatrix":function ne(le,q){var Ce=le._data,Se=le._size,Ee=le._datatype,ve=q._values,ke=q._index,Oe=q._ptr,Ze=q._size,nt=q._datatype;if(!ve)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var Re,ht=Se[0],Je=Ze[1],kt=f,Te=p,mt=v,Lt=0;Ee&&nt&&Ee===nt&&"string"==typeof Ee&&(kt=c.find(f,[Re=Ee,Re]),Te=c.find(p,[Re,Re]),mt=c.find(v,[Re,Re]),Lt=c.convert(0,Re));for(var fn=[],Et=[],$t=[],un=q.createSparseMatrix({values:fn,index:Et,ptr:$t,size:[ht,Je],datatype:Re}),Yt=0;Yt<Je;Yt++){$t[Yt]=Et.length;var gn=Oe[Yt],Dn=Oe[Yt+1];if(Dn>gn)for(var On=0,an=0;an<ht;an++){for(var pr=an+1,ar=void 0,Vn=gn;Vn<Dn;Vn++){var Jn=ke[Vn];On!==pr?(ar=Te(Ce[an][Jn],ve[Vn]),On=pr):ar=kt(ar,Te(Ce[an][Jn],ve[Vn]))}On===pr&&!mt(ar,Lt)&&(Et.push(an),fn.push(ar))}}return $t[Je]=Et.length,un},"SparseMatrix, DenseMatrix":function j(le,q){var Ce=le._values,Se=le._index,Ee=le._ptr,ve=le._datatype;if(!Ce)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var Je,ke=q._data,Oe=q._datatype,Ze=le._size[0],nt=q._size[0],ht=q._size[1],Re=f,kt=p,Te=v,mt=0;ve&&Oe&&ve===Oe&&"string"==typeof ve&&(Re=c.find(f,[Je=ve,Je]),kt=c.find(p,[Je,Je]),Te=c.find(v,[Je,Je]),mt=c.convert(0,Je));for(var Lt=[],fn=[],Et=[],$t=le.createSparseMatrix({values:Lt,index:fn,ptr:Et,size:[Ze,ht],datatype:Je}),un=[],Yt=[],gn=0;gn<ht;gn++){Et[gn]=fn.length;for(var Dn=gn+1,On=0;On<nt;On++){var an=ke[On][gn];if(!Te(an,mt))for(var ar=Ee[On+1],Vn=Ee[On];Vn<ar;Vn++){var Jn=Se[Vn];Yt[Jn]!==Dn?(Yt[Jn]=Dn,fn.push(Jn),un[Jn]=kt(an,Ce[Vn])):un[Jn]=Re(un[Jn],kt(an,Ce[Vn]))}}for(var dt=fn.length,tn=Et[gn];tn<dt;tn++)Lt[tn]=un[fn[tn]]}return Et[ht]=fn.length,$t},"SparseMatrix, SparseMatrix":function ae(le,q){var kt,Ce=le._values,Se=le._index,Ee=le._ptr,ve=le._datatype,ke=q._values,Oe=q._index,Ze=q._ptr,nt=q._datatype,ht=le._size[0],Je=q._size[1],Re=Ce&&ke,Te=f,mt=p;ve&&nt&&ve===nt&&"string"==typeof ve&&(Te=c.find(f,[kt=ve,kt]),mt=c.find(p,[kt,kt]));for(var gn,On,an,ar,Vn,Jn,Lt=Re?[]:void 0,fn=[],Et=[],$t=le.createSparseMatrix({values:Lt,index:fn,ptr:Et,size:[ht,Je],datatype:kt}),un=Re?[]:void 0,Yt=[],Ge=0;Ge<Je;Ge++){Et[Ge]=fn.length;var dt=Ge+1;for(ar=Ze[Ge+1],an=Ze[Ge];an<ar;an++)if(Jn=Oe[an],Re)for(On=Ee[Jn+1],gn=Ee[Jn];gn<On;gn++)Yt[Vn=Se[gn]]!==dt?(Yt[Vn]=dt,fn.push(Vn),un[Vn]=mt(ke[an],Ce[gn])):un[Vn]=Te(un[Vn],mt(ke[an],Ce[gn]));else for(On=Ee[Jn+1],gn=Ee[Jn];gn<On;gn++)Yt[Vn=Se[gn]]!==dt&&(Yt[Vn]=dt,fn.push(Vn));if(Re)for(var jt=fn.length,Cn=Et[Ge];Cn<jt;Cn++)Lt[Cn]=un[fn[Cn]]}return Et[Je]=fn.length,$t}});return c(Yx,fh({"Array, Array":function(q,Ce){T(Lr(q),Lr(Ce));var Se=this(h(q),h(Ce));return yn(Se)?Se.valueOf():Se},"Matrix, Matrix":function(q,Ce){var Se=q.size(),Ee=Ce.size();return T(Se,Ee),1===Se.length?1===Ee.length?function C(le,q,Ce){if(0===Ce)throw new Error("Cannot multiply two empty vectors");return x(le,q)}(q,Ce,Se[0]):function b(le,q){if("dense"!==q.storage())throw new Error("Support for SparseMatrix not implemented");return function I(le,q){var ht,Ce=le._data,Ee=le._datatype,ve=q._data,Oe=q._datatype,Ze=le._size[0],nt=q._size[1],Je=f,Re=p;Ee&&Oe&&Ee===Oe&&"string"==typeof Ee&&(Je=c.find(f,[ht=Ee,ht]),Re=c.find(p,[ht,ht]));for(var kt=[],Te=0;Te<nt;Te++){for(var mt=Re(Ce[0],ve[0][Te]),Lt=1;Lt<Ze;Lt++)mt=Je(mt,Re(Ce[Lt],ve[Lt][Te]));kt[Te]=mt}return le.createDenseMatrix({data:kt,size:[nt],datatype:ht})}(le,q)}(q,Ce):1===Ee.length?M(q,Ce):k(q,Ce)},"Matrix, Array":function(q,Ce){return this(q,h(Ce))},"Array, Matrix":function(q,Ce){return this(h(q,Ce.storage()),Ce)},"SparseMatrix, any":function(q,Ce){return S(q,Ce,p,!1)},"DenseMatrix, any":function(q,Ce){return N(q,Ce,p,!1)},"any, SparseMatrix":function(q,Ce){return S(Ce,q,p,!0)},"any, DenseMatrix":function(q,Ce){return N(Ce,q,p,!0)},"Array, any":function(q,Ce){return N(h(q),Ce,p,!1).valueOf()},"any, Array":function(q,Ce){return N(h(Ce),q,p,!0).valueOf()},"any, any":p,"any, any, ...any":function(q,Ce,Se){for(var Ee=this(q,Ce),ve=0;ve<Se.length;ve++)Ee=this(Ee,Se[ve]);return Ee}},p.signatures))}),ZB=Xe("det",["typed","matrix","subtract","multiply","divideScalar","isZero","unaryMinus"],l=>{var{typed:c,matrix:h,subtract:f,multiply:p,divideScalar:v,isZero:x,unaryMinus:S}=l;return c("det",{any:function(C){return tr(C)},"Array | Matrix":function(C){var b;switch((b=yn(C)?C.size():Array.isArray(C)?(C=h(C)).size():[]).length){case 0:return tr(C);case 1:if(1===b[0])return tr(C.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+Mr(b)+")");case 2:var I=b[0];if(I===b[1])return function N(T,C,b){if(1===C)return tr(T[0][0]);if(2===C)return f(p(T[0][0],T[1][1]),p(T[1][0],T[0][1]));for(var I=!1,M=new Array(C).fill(0).map((Ce,Se)=>Se),k=0;k<C;k++){var F=M[k];if(x(T[F][k])){var oe=void 0;for(oe=k+1;oe<C;oe++)if(!x(T[M[oe]][k])){F=M[oe],M[oe]=M[k],M[k]=F,I=!I;break}if(oe===C)return T[F][k]}for(var ne=T[F][k],de=0===k?1:T[M[k-1]][k-1],j=k+1;j<C;j++)for(var ae=M[j],le=k+1;le<C;le++)T[ae][le]=v(f(p(T[ae][le],ne),p(T[ae][k],T[F][le])),de)}var q=T[M[C-1]][C-1];return I?S(q):q}(C.clone().valueOf(),I);throw new RangeError("Matrix must be square (size: "+Mr(b)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Mr(b)+")")}}})}),u3=Xe("quantileSeq",["typed","add","multiply","partitionSelect","compare"],l=>{var{typed:c,add:h,multiply:f,partitionSelect:p,compare:v}=l;function S(T,C,b){var I=si(T),M=I.length;if(0===M)throw new Error("Cannot calculate quantile of an empty sequence");if(gi(C)){var k=C*(M-1),F=k%1;if(0===F){var oe=b?I[k]:p(I,k);return N(oe),oe}var de,j,ne=Math.floor(k);if(b)de=I[ne],j=I[ne+1];else{j=p(I,ne+1),de=I[ne];for(var ae=0;ae<ne;++ae)v(I[ae],de)>0&&(de=I[ae])}return N(de),N(j),h(f(de,1-F),f(j,F))}var le=C.times(M-1);if(le.isInteger()){le=le.toNumber();var q=b?I[le]:p(I,le);return N(q),q}var ve,ke,Ce=le.floor(),Se=le.minus(Ce),Ee=Ce.toNumber();if(b)ve=I[Ee],ke=I[Ee+1];else{ke=p(I,Ee+1),ve=I[Ee];for(var Oe=0;Oe<Ee;++Oe)v(I[Oe],ve)>0&&(ve=I[Oe])}N(ve),N(ke);var Ze=new Se.constructor(1);return h(f(ve,Ze.minus(Se)),f(ke,Se))}var N=c({"number | BigNumber | Unit":function(C){return C}});return function x(T,C,b){var I,M,k;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(Im(T)){if("boolean"==typeof(b=b||!1)){if(M=T.valueOf(),gi(C)){if(C<0)throw new Error("N/prob must be non-negative");if(C<=1)return S(M,C,b);if(C>1){if(!Jt(C))throw new Error("N must be a positive integer");var F=C+1;I=new Array(C);for(var oe=0;oe<C;)I[oe]=S(M,++oe/F,b);return I}}if(hi(C)){var ne=C.constructor;if(C.isNegative())throw new Error("N/prob must be non-negative");if(k=new ne(1),C.lte(k))return new ne(S(M,C,b));if(C.gt(k)){if(!C.isInteger())throw new Error("N must be a positive integer");var de=C.toNumber();if(de>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var j=new ne(de+1);I=new Array(de);for(var ae=0;ae<de;)I[ae]=new ne(S(M,new ne(++ae).div(j),b));return I}}if(Array.isArray(C)){I=new Array(C.length);for(var le=0;le<I.length;++le){var q=C[le];if(gi(q)){if(q<0||q>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!hi(q))throw new TypeError("Unexpected type of argument in function quantileSeq");if(k=new q.constructor(1),q.isNegative()||q.gt(k))throw new Error("Probability must be between 0 and 1, inclusive")}I[le]=S(M,q,b)}return I}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}}),ED=Xe("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],l=>{var{typed:c,matrix:h,divideScalar:f,addScalar:p,multiply:v,unaryMinus:x,det:S,identity:N,abs:T}=l;return c("inv",{"Array | Matrix":function(I){var M=yn(I)?I.size():Lr(I);switch(M.length){case 1:if(1===M[0])return yn(I)?h([f(1,I.valueOf()[0])]):[f(1,I[0])];throw new RangeError("Matrix must be square (size: "+Mr(M)+")");case 2:var k=M[0],F=M[1];if(k===F)return yn(I)?h(C(I.valueOf(),k,F),I.storage()):C(I,k,F);throw new RangeError("Matrix must be square (size: "+Mr(M)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+Mr(M)+")")}},any:function(I){return f(1,I)}});function C(b,I,M){var k,F,oe,ne,de;if(1===I){if(0===(ne=b[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[f(1,ne)]]}if(2===I){var j=S(b);if(0===j)throw Error("Cannot calculate inverse, determinant is zero");return[[f(b[1][1],j),f(x(b[0][1]),j)],[f(x(b[1][0]),j),f(b[0][0],j)]]}var ae=b.concat();for(k=0;k<I;k++)ae[k]=ae[k].concat();for(var le=N(I).valueOf(),q=0;q<M;q++){var Ce=T(ae[q][q]),Se=q;for(k=q+1;k<I;)T(ae[k][q])>Ce&&(Ce=T(ae[k][q]),Se=k),k++;if(0===Ce)throw Error("Cannot calculate inverse, determinant is zero");(k=Se)!==q&&(de=ae[q],ae[q]=ae[k],ae[k]=de,de=le[q],le[q]=le[k],le[k]=de);var Ee=ae[q],ve=le[q];for(k=0;k<I;k++){var ke=ae[k],Oe=le[k];if(k!==q){if(0!==ke[q]){for(oe=f(x(ke[q]),Ee[q]),F=q;F<M;F++)ke[F]=p(ke[F],v(oe,Ee[F]));for(F=0;F<M;F++)Oe[F]=p(Oe[F],v(oe,ve[F]))}}else{for(oe=Ee[q],F=q;F<M;F++)ke[F]=f(ke[F],oe);for(F=0;F<M;F++)Oe[F]=f(Oe[F],oe)}}}return le}}),xp=Xe("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],l=>{var{typed:c,matrix:h,multiply:f,equalScalar:p,divideScalar:v,inv:x}=l,S=Vo({typed:c,equalScalar:p}),N=di({typed:c});return c("divide",fh({"Array | Matrix, Array | Matrix":function(C,b){return f(C,x(b))},"DenseMatrix, any":function(C,b){return N(C,b,v,!1)},"SparseMatrix, any":function(C,b){return S(C,b,v,!1)},"Array, any":function(C,b){return N(h(C),b,v,!1).valueOf()},"any, Array | Matrix":function(C,b){return f(C,x(b))}},v.signatures))}),Bc=Xe("median",["typed","add","divide","compare","partitionSelect"],l=>{var{typed:c,add:h,divide:f,compare:p,partitionSelect:v}=l;function x(T){try{var C=(T=si(T.valueOf())).length;if(0===C)throw new Error("Cannot calculate median of an empty array");if(C%2==0){for(var b=C/2-1,I=v(T,b+1),M=T[b],k=0;k<b;++k)p(T[k],M)>0&&(M=T[k]);return N(M,I)}var F=v(T,(C-1)/2);return S(F)}catch(oe){throw function uo(l,c,h){var f;return-1!==String(l).indexOf("Unexpected type")?(f=arguments.length>2?" (type: "+cr(h)+", value: "+JSON.stringify(h)+")":" (type: "+l.data.actual+")",new TypeError("Cannot calculate "+c+", unexpected type of argument"+f)):-1!==String(l).indexOf("complex numbers")?(f=arguments.length>2?" (type: "+cr(h)+", value: "+JSON.stringify(h)+")":"",new TypeError("Cannot calculate "+c+", no ordering relation is defined for complex numbers"+f)):l}(oe,"median")}}var S=c({"number | BigNumber | Complex | Unit":function(C){return C}}),N=c({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(C,b){return f(h(C,b),2)}});return c("median",{"Array | Matrix":x,"Array | Matrix, number | BigNumber":function(C,b){throw new Error("median(A, dim) is not yet supported")},"...":function(C){if(function rl(l){for(var c=0;c<l.length;c++)if(Im(l[c]))return!0;return!1}(C))throw new TypeError("Scalar values expected in function median");return x(C)}})}),mn=Rb({config:cn}),Ii=Fd({}),kf=lP({}),Uo=gN({}),jr=IN({Matrix:Uo}),Ct=jm({BigNumber:mn,Complex:Ii,DenseMatrix:jr,Fraction:kf}),hu=LN({typed:Ct}),Us=BP({typed:Ct}),xg=jP({BigNumber:mn,typed:Ct}),Np=rL({typed:Ct}),ti=B8({config:cn,typed:Ct}),Nh=Rw({typed:Ct}),Ys=DT({typed:Ct}),Rf=FT({typed:Ct}),Of=GT({Matrix:Uo,equalScalar:ti,typed:Ct}),Cg=JL({typed:Ct}),Jl=X8({typed:Ct}),SV=u$({Fraction:kf,typed:Ct}),Tp=hA({typed:Ct}),$n=ux({DenseMatrix:jr,Matrix:Uo,SparseMatrix:Of,typed:Ct}),Sg=J8({bignumber:xg,fraction:SV,number:Rf}),Ha=D$({matrix:$n,config:cn,typed:Ct}),Qs=AA({DenseMatrix:jr,addScalar:Us,equalScalar:ti,matrix:$n,typed:Ct,unaryMinus:Jl}),Ap=Vy({BigNumber:mn,DenseMatrix:jr,Fraction:kf,config:cn,equalScalar:ti,matrix:$n,typed:Ct}),Is=lp({numeric:Sg,typed:Ct}),FV=Gr({compare:Ap,isNaN:Cg,isNumeric:Tp,typed:Ct}),Ho=fI({DenseMatrix:jr,SparseMatrix:Of,addScalar:Us,equalScalar:ti,matrix:$n,typed:Ct}),Lf=hl({addScalar:Us,conj:Np,multiplyScalar:Ys,size:Ha,typed:Ct}),f_=wB({BigNumber:mn,DenseMatrix:jr,SparseMatrix:Of,config:cn,matrix:$n,typed:Ct}),ia=EB({addScalar:Us,dot:Lf,equalScalar:ti,matrix:$n,multiplyScalar:Ys,typed:Ct}),HV=ZB({divideScalar:Is,isZero:Nh,matrix:$n,multiply:ia,subtract:Qs,typed:Ct,unaryMinus:Jl}),Tg=u3({add:Ho,compare:Ap,multiply:ia,partitionSelect:FV,typed:Ct}),G1=Bc({add:Ho,compare:Ap,divide:xp({divideScalar:Is,equalScalar:ti,inv:ED({abs:hu,addScalar:Us,det:HV,divideScalar:Is,identity:f_,matrix:$n,multiply:ia,typed:Ct,unaryMinus:Jl}),matrix:$n,multiply:ia,typed:Ct}),partitionSelect:FV,typed:Ct});class sz extends oh{constructor({strategy:c="mean",constant:h,quantile:f}={}){super(),gt(this,"strategy"),gt(this,"constant"),gt(this,"quantile"),gt(this,"name","DummyRegressor"),gt(this,"tf"),this.tf=X(),this.strategy=c,this.constant=h,this.quantile=f}fit(c,h){ee(Pe(h),"y variable can not be converted to a 1D Tensor."),ee(["mean","median","constant","quantile"].includes(this.strategy),`Strategy ${this.strategy} not supported. We support 'mean', 'median', 'constant', and 'quantile'`);const f=Ne(h);return"mean"===this.strategy?(this.constant=f.mean().dataSync()[0],this):"median"===this.strategy?(this.constant=G1(f.arraySync()),this):"quantile"===this.strategy?(ee("number"==typeof this.quantile&&!isNaN(this.quantile)&&isFinite(this.quantile),"quantile is not set to a number. Please set it to a value between 0 and 1 in the constructor"),ee(this.quantile<0||this.quantile>1,"quantile must be set to a value between 0 and 1"),this.constant=Tg(f.arraySync(),this.quantile),this):this}predict(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");let f=Ye(c).shape[0];return this.tf.tensor1d(Array(f).fill(this.constant))}}function K1(l){for(var h,c=new Map,f=0,p=0;p<l.length;p++){var v=c.get(l[p]);void 0===v?v=1:v++,v>f&&(h=l[p],f=v),c.set(l[p],v)}if(0===f)throw new Error("mode requires at last one data point");return h}var tC=function(){this.totalCount=0,this.data={}};tC.prototype.train=function(c,h){for(var f in this.data[h]||(this.data[h]={}),c){var p=c[f];void 0===this.data[h][f]&&(this.data[h][f]={}),void 0===this.data[h][f][p]&&(this.data[h][f][p]=0),this.data[h][f][p]++}this.totalCount++},tC.prototype.score=function(c){var f,h={};for(var p in c){var v=c[p];for(f in this.data)h[f]={},h[f][p+"_"+v]=this.data[f][p]?(this.data[f][p][v]||0)/this.totalCount:0}var x={};for(f in h)for(var S in x[f]=0,h[f])x[f]+=h[f][S];return x};var qM=function(){this.weights=[],this.bias=0};qM.prototype.predict=function(c){if(c.length!==this.weights.length)return null;for(var h=0,f=0;f<this.weights.length;f++)h+=this.weights[f]*c[f];return(h+=this.bias)>0?1:0},qM.prototype.train=function(c,h){if(0!==h&&1!==h)return null;c.length!==this.weights.length&&(this.weights=c,this.bias=1);var f=this.predict(c);if("number"==typeof f&&f!==h){for(var p=h-f,v=0;v<this.weights.length;v++)this.weights[v]+=p*c[v];this.bias+=p}return this},Math.log(Math.sqrt(2*Math.PI)),Math.sqrt(2*Math.PI);var w_=Math.sqrt(2*Math.PI);function YM(l){for(var c=l,h=l,f=1;f<15;f++)c+=h*=l*l/(2*f+1);return Math.round(1e4*(.5+c/w_*Math.exp(-l*l/2)))/1e4}for(var oC=[],Mp=0;Mp<=3.09;Mp+=.01)oC.push(YM(Mp));var N9=z(8799),T9=z.n(N9);class Pz extends $i{constructor({strategy:c="mostFrequent",constant:h=0}={}){super(),gt(this,"constant"),gt(this,"strategy"),gt(this,"classes"),gt(this,"name","DummyClassifier"),gt(this,"tf"),this.tf=X(),this.constant=h,this.strategy=c,this.classes=[]}fit(c,h){ee(Pe(h),"Data can not be converted to a 1D or 2D matrix."),ee(["mostFrequent","uniform","constant"].includes(this.strategy),`Strategy ${this.strategy} not supported. We support 'mostFrequent', 'uniform', and 'constant'`);const f=Ne(h);return this.classes=he()(f.arraySync()),"mostFrequent"===this.strategy?(this.constant=K1(f.arraySync()),this):this}predictProba(c){return ee(Ke(c),"Data can not be converted to a 1D or 2D matrix."),ee(["mostFrequent","uniform","constant"].includes(this.strategy),`Strategy ${this.strategy} not supported. We support 'mostFrequent', 'uniform', and 'constant'`),this.tf.oneHot(this.predict(c).toInt(),this.classes.length)}predict(c){ee(Ke(c),"Data can not be converted to a 1D or 2D matrix."),ee(["mostFrequent","uniform","constant"].includes(this.strategy),`Strategy ${this.strategy} not supported. We support 'mostFrequent', 'uniform', and 'constant'`);let f=Ye(c).shape[0];if("mostFrequent"===this.strategy||"constant"===this.strategy)return this.tf.tensor1d(Array(f).fill(this.constant));let p=[];for(let v=0;v<f;v++)p.push(T9()(this.classes));return this.tf.tensor1d(p)}}function $z(l,c,h){let f=X();return h?f.tidy(()=>f.where(l.isNaN(),-1/0,l).max(c)):l.min(c)}function sc(l,c,h){let f=X();return h?f.tidy(()=>f.where(l.isNaN(),0,l).sum(c)):l.sum(c)}function aC(l,c,h){let f=X();return h?f.tidy(()=>f.logicalNot(l.isNaN()).sum(c)):f.onesLike(l).sum(c)}function C_(l,c,h,f){let p=X();return h?p.tidy(f?()=>sc(l,c,h).div(Og(aC(l,c,h))):()=>sc(l,c,h).div(aC(l,c,h))):l.mean(c)}function Og(l){let c=X();return c.tidy(()=>{const h=c.zerosLike(l),f=l.equal(h);return l.add(f)})}class D9 extends ko{constructor({featureRange:c=[0,1]}={}){super(),gt(this,"featureRange"),gt(this,"scale"),gt(this,"min"),gt(this,"dataMin"),gt(this,"dataMax"),gt(this,"dataRange"),gt(this,"nFeaturesIn"),gt(this,"nSamplesSeen"),gt(this,"featureNamesIn"),gt(this,"name","MinMaxScaler"),this.tf=X(),this.featureRange=c,this.scale=this.tf.tensor1d([]),this.min=this.tf.tensor1d([]),this.dataMin=this.tf.tensor1d([]),this.dataMax=this.tf.tensor1d([]),this.dataRange=this.tf.tensor1d([]),this.nFeaturesIn=0,this.nSamplesSeen=0,this.featureNamesIn=[]}isNumber(c){return"number"==typeof c&&isFinite(c)}fit(c){ee(Ke(c),"Data can not be converted to a 2D matrix."),ee(this.isNumber(this.featureRange[0])&&this.isNumber(this.featureRange[1])&&this.featureRange[0]<this.featureRange[1],"featureRange needs to contain exactly two numbers where the first is less than the second");const h=Ye(c),f=$z(h,0,!0),p=function Lz(l,c,h){let f=X();return h?f.tidy(()=>f.where(l.isNaN(),1/0,l).min(c)):l.min(c)}(h,0,!0),v=f.sub(p);return this.scale=this.tf.div(this.featureRange[1]-this.featureRange[0],Og(v)),this.min=this.tf.sub(this.featureRange[0],p.mul(this.scale)),this.dataMin=p,this.dataMax=f,this.dataRange=v,this.nSamplesSeen=h.shape[0],this.nFeaturesIn=h.shape[1],xe(c)&&(this.featureNamesIn=[...c.columns]),this}transform(c){return ee(Ke(c),"Data can not be converted to a 2D matrix."),Ye(c).mul(this.scale).add(this.min)}inverseTransform(c){return ee(Ke(c),"Data can not be converted to a 2D matrix."),Ye(c).sub(this.min).div(this.scale)}}class Vz extends ko{constructor({withMean:c=!0,withStd:h=!0}={}){super(),gt(this,"scale"),gt(this,"mean"),gt(this,"withMean"),gt(this,"withStd"),gt(this,"nFeaturesIn"),gt(this,"nSamplesSeen"),gt(this,"featureNamesIn"),gt(this,"name","StandardScaler"),this.tf=X(),this.withMean=c,this.withStd=h,this.scale=this.tf.tensor1d([]),this.mean=this.tf.tensor1d([]),this.nFeaturesIn=0,this.nSamplesSeen=0,this.featureNamesIn=[]}fit(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");const h=Ye(c);if(this.withMean&&(this.mean=C_(h,0,!0)),this.withStd){const f=function I9(l,c,h){return ee(Boolean(h),"We only need to call this function when ignoreNaN is true"),X().tidy(()=>{const p=C_(l,c,h),v=aC(l,c,h),x=sc(l.sub(p).square(),c,h),S=Og(v);return x.div(S).sqrt()})}(h,0,!0);this.scale=Og(f)}return this.nSamplesSeen=h.shape[0],this.nFeaturesIn=h.shape[1],xe(c)&&(this.featureNamesIn=[...c.columns]),this}transform(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");let h=Ye(c);return this.withMean&&(h=h.sub(this.mean)),this.withStd&&(h=h.div(this.scale)),h}inverseTransform(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");let h=Ye(c);return this.withStd&&(h=h.mul(this.scale)),this.withMean&&(h=h.add(this.mean)),h}}class M9 extends ko{constructor(){super(),gt(this,"scale"),gt(this,"nFeaturesIn"),gt(this,"nSamplesSeen"),gt(this,"featureNamesIn"),gt(this,"name","MaxAbsScaler"),this.tf=X(),this.scale=this.tf.tensor1d([]),this.nFeaturesIn=0,this.nSamplesSeen=0,this.featureNamesIn=[]}fit(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");const h=Ye(c),f=$z(h.abs(),0,!0);return this.scale=Og(f),this.nSamplesSeen=h.shape[0],this.nFeaturesIn=h.shape[1],xe(c)&&(this.featureNamesIn=[...c.columns]),this}transform(c){return ee(Ke(c),"Data can not be converted to a 2D matrix."),Ye(c).div(this.scale)}inverseTransform(c){return ee(Ke(c),"Data can not be converted to a 2D matrix."),Ye(c).mul(this.scale)}}function Uz(l){return l.filter(h=>!function zz(l){return null==l||isNaN(l)&&"string"!=typeof l}(h))}class k9 extends ko{constructor({strategy:c="mean",fillValue:h,missingValues:f=NaN}={}){super(),gt(this,"missingValues"),gt(this,"fillValue"),gt(this,"strategy"),gt(this,"statistics"),gt(this,"name","SimpleImputer"),gt(this,"tf"),this.tf=X(),this.missingValues=f,this.strategy=c,this.fillValue=h,this.statistics=this.tf.tensor1d([])}fit(c){if("constant"===this.strategy)return this;if("mean"===this.strategy){const f=C_(Ye(c),0,!0);return this.statistics=f,this}if("mostFrequent"===this.strategy){const f=Ye(c).transpose().arraySync().map(p=>K1(Uz(p)));return this.statistics=this.tf.tensor1d(f),this}if("median"===this.strategy){const f=Ye(c).transpose().arraySync().map(p=>G1(Uz(p)));return this.statistics=this.tf.tensor1d(f),this}throw new Error(`Strategy ${this.strategy} is unsupported. Supported strategies are 'mean', 'median', 'mostFrequent', and 'constant'`)}transform(c){if("constant"===this.strategy){const f=we(c);return this.tf.where(f.isNaN(),void 0===this.fillValue?"string"!==f.dtype?0:"missing_value":this.fillValue,f)}const h=Ye(c);return this.tf.where(h.isNaN(),this.statistics.reshape([1,-1]),h)}}class rk extends Ls{constructor(){super(),gt(this,"classes"),gt(this,"name","LabelEncoder"),gt(this,"tf"),this.tf=X(),this.classes=[]}convertTo1DArray(c){return ce(c)?c.values:te(c)?c.arraySync():c}classesToMapping(c){const h=new Map;return c.forEach((f,p)=>{h.set(f,p)}),h}fit(c){const h=this.convertTo1DArray(c),f=Array.from(new Set(h));return this.classes=f,this}transform(c){const h=this.convertTo1DArray(c),f=this.classesToMapping(this.classes),p=h.map(v=>{let x=f.get(v);return void 0===x?-1:x});return this.tf.tensor1d(p)}fitTransform(c){return this.fit(c).transform(c)}inverseTransform(c){const h=this.convertTo1DArray(c),f=this.classesToMapping(this.classes),p=new Map(Array.from(f,x=>x.reverse()));return h.map(x=>void 0===p.get(x)?null:p.get(x))}}class Hz extends ko{constructor({categories:c="auto",handleUnknown:h="error",unknownValue:f=NaN}={}){super(),gt(this,"categories"),gt(this,"handleUnknown"),gt(this,"unknownValue"),gt(this,"categoriesParam"),gt(this,"nFeaturesIn"),gt(this,"featureNamesIn"),gt(this,"name","OrdinalEncoder"),this.tf=X(),this.categoriesParam=c,this.categories=[],this.handleUnknown=h,this.unknownValue=f,this.nFeaturesIn=0,this.featureNamesIn=[]}classesToMapping(c){const h=new Map;return c.forEach((f,p)=>{h.set(f,p)}),h}loopOver2DArrayToSetLabels(c){for(let h=0;h<c[0].length;h++){let f=new Set;for(let v=0;v<c.length;v++)f.add(c[v][h]);let p=Array.from(f);this.categories.push(p)}}fit(c,h){const f=je(c);return"auto"===this.categoriesParam?(this.loopOver2DArrayToSetLabels(f),this):(this.categories=this.categoriesParam,this.nFeaturesIn=0===f.length?0:f[0].length||0,xe(c)&&(this.featureNamesIn=[...c.columns]),this)}loopOver2DArrayToUseLabels(c){let h=this.categories.map(p=>this.classesToMapping(p)),f=[];for(let p=0;p<c.length;p++){let v=[];for(let x=0;x<c[0].length;x++){let S=c[p][x],N=h[x].get(S);if(void 0===N){if("error"===this.handleUnknown)throw new Error(`Unknown value ${S} encountered while transforming. Not encountered in training data`);N=this.unknownValue}v.push(N)}f.push(v)}return f}transform(c,h){const f=je(c),p=this.loopOver2DArrayToUseLabels(f);return this.tf.tensor2d(p,void 0,"int32")}}class R9 extends ko{constructor({norm:c="l2"}={}){super(),gt(this,"norm"),gt(this,"nFeaturesIn"),gt(this,"featureNamesIn"),gt(this,"name","Normalizer"),this.tf=X(),this.norm=c,this.nFeaturesIn=0,this.featureNamesIn=[]}fit(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");const h=Ye(c);return this.nFeaturesIn=h.shape[1],xe(c)&&(this.featureNamesIn=[...c.columns]),this}transform(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");const h=Ye(c);if("l1"===this.norm){const p=this.tf.abs(h).sum(1).reshape([-1,1]);return h.divNoNan(p)}if("l2"===this.norm){const p=h.square().sum(1).sqrt().reshape([-1,1]);return h.divNoNan(p)}const f=this.tf.abs(h).max(1).reshape([-1,1]);return h.divNoNan(f)}}class Wz extends Ls{constructor({steps:c=[]}={}){super(),gt(this,"steps"),gt(this,"name","Pipeline"),this.steps=c,this.validateSteps(this.steps)}isTransformer(c){return"passthrough"===c||"function"==typeof c.fit&&"function"==typeof c.transform&&"function"==typeof c.fitTransform}isEstimator(c){return"passthrough"===c||"function"==typeof c.fit}validateSteps(c){if(ee(Array.isArray(c),`steps is not an array. It is ${c}`),0===c.length)return;for(let f=0;f<c.length-1;f++){const p=c[f];ee(Array.isArray(p),`A single step in your pipeline must be an array containing a string as the first argument, and the transformer in the second. Something akin to ['minmaxscaler', new MinMaxScaler()]. Instead it is ${p}`),ee(this.isTransformer(p[1]),`The ${f}th step in your pipeline isn't an array containing a name and a Transformer. Instead it is ${c[f]}.`)}let h=c[c.length-1];ee(Array.isArray(h),`The last element in your pipeline must be a 2-element array that contains a string as the first argument, and an estimator as the second. Instead it is ${h}`),ee(this.isEstimator(h[1]),`The last element in your pipeline should be an Estimator. Instead it is ${h}`)}transformExceptLast(c){let h=c;for(let f=0;f<this.steps.length-1;f++){const[,p]=this.steps[f];"passthrough"!==p&&(h=p.transform(h))}return h}fitTransformExceptLast(c){let h=c;for(let f=0;f<this.steps.length-1;f++){const[,p]=this.steps[f];"passthrough"!==p&&(h=p.fitTransform(h))}return h}getLastEstimator(){return 0===this.steps.length?null:this.steps[this.steps.length-1][1]}assertEstimatorHasFunction(c,h){ee(null!==c,`Your final Estimator is null and therefore you can't call ${h}`),ee("function"==typeof c[h],`Estimator ${c} doesn't implement the function ${h}`)}fit(c,h){var f=this;return(0,K.Z)(function*(){f.validateSteps(f.steps);const p=f.getLastEstimator();f.assertEstimatorHasFunction(p,"fit");let v=f.fitTransformExceptLast(c);return yield p.fit(v,h),f})()}transform(c){this.validateSteps(this.steps);const h=this.getLastEstimator();this.assertEstimatorHasFunction(h,"transform");let f=this.transformExceptLast(c);return h.transform(f)}fitTransform(c,h){this.validateSteps(this.steps);const f=this.getLastEstimator();this.assertEstimatorHasFunction(f,"fitTransform");let p=this.fitTransformExceptLast(c);return f.fitTransform(p)}predict(c){this.validateSteps(this.steps);const h=this.getLastEstimator();this.assertEstimatorHasFunction(h,"predict");let f=this.transformExceptLast(c);return h.predict(f)}fitPredict(c,h){var f=this;return(0,K.Z)(function*(){f.validateSteps(f.steps);const p=f.getLastEstimator();f.assertEstimatorHasFunction(p,"fitPredict");let v=f.fitTransformExceptLast(c);return yield p.fitPredict(v,h)})()}}function O9(...l){let c=[];for(let h=0;h<l.length;h++){let f=l[h];c.push([f.name,f])}return new Wz({steps:c})}function Gz(l){return Array.isArray(l)&&"string"==typeof l[0]}class F9 extends Ls{constructor({transformers:c=[],remainder:h="drop"}={}){super(),gt(this,"transformers"),gt(this,"remainder"),gt(this,"name","ColumnTransformer"),gt(this,"tf"),this.tf=X(),this.transformers=c,this.remainder=h}fit(c,h){for(let f=0;f<this.transformers.length;f++){let[,p,v]=this.transformers[f],x=this.getColumns(c,v);p.fit(x,h)}return this}transform(c,h){let f=[];for(let p=0;p<this.transformers.length;p++){let[,v,x]=this.transformers[p],S=this.getColumns(c,x);f.push(v.transform(S,h))}return this.tf.concat(f,1)}fitTransform(c,h){let f=[];for(let p=0;p<this.transformers.length;p++){let[,v,x]=this.transformers[p],S=this.getColumns(c,x);f.push(v.fitTransform(S,h))}return this.tf.concat(f,1)}getColumns(c,h){if(xe(c))return Gz(h)?c.loc({columns:h}).tensor:Array.isArray(h)?c.iloc({columns:h}).tensor:"string"==typeof h?c[h].tensor:c.iloc({columns:[h]}).tensor;if(Gz(h)||"string"==typeof h)throw new Error("Can't pass string selected columns when not a DataFrame");if("number"==typeof h){let f=this.tf.tensor1d([h]);return c.gather(f,1)}{let f=this.tf.tensor1d(h);return c.gather(f,1)}}}function S_(l){return l.filter(h=>!function P9(l){return null==l||isNaN(l)&&"string"!=typeof l}(h))}class jz extends ko{constructor({quantileRange:c=[25,75],withCentering:h=!0,withScaling:f=!0}={}){super(),gt(this,"scale"),gt(this,"center"),gt(this,"nFeaturesIn"),gt(this,"featureNamesIn"),gt(this,"quantileRange"),gt(this,"withScaling"),gt(this,"withCentering"),gt(this,"name","RobustScaler"),this.tf=X(),this.scale=this.tf.tensor1d([]),this.center=this.tf.tensor1d([]),this.quantileRange=c,this.withScaling=f,this.withCentering=h,this.nFeaturesIn=0,this.featureNamesIn=[]}isNumber(c){return"number"==typeof c&&isFinite(c)}fit(c){ee(Ke(c),"Data can not be converted to a 2D matrix."),ee(this.isNumber(this.quantileRange[0])&&this.isNumber(this.quantileRange[1]),"quantileRange values must be numbers");let h=this.quantileRange[0],f=this.quantileRange[1];ee(h<f&&0<=h&&h<=100&&0<=f&&f<=100,"quantileRange numbers must be between 0 and 100");const p=Ye(c),v=p.transpose().arraySync();if(this.withCentering){const x=v.map(S=>Tg(S_(S),.5));this.center=this.tf.tensor1d(x)}if(this.withScaling){const x=v.map(N=>Tg(S_(N),[h/100,f/100])),S=this.tf.tensor1d(x.map(N=>N[1]-N[0]));this.scale=Og(S)}return this.nFeaturesIn=p.shape[1],xe(c)&&(this.featureNamesIn=[...c.columns]),this}transform(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");let h=Ye(c);return this.withCentering&&(h=h.sub(this.center)),this.withScaling&&(h=h.div(this.scale)),h}inverseTransform(c){ee(Ke(c),"Data can not be converted to a 2D matrix.");let h=Ye(c);return this.withScaling&&(h=h.mul(this.scale)),this.withCentering&&(h=h.add(this.center)),h}}class ik extends Ls{constructor({nClusters:c=8,init:h="random",maxIter:f=300,tol:p=1e-4,nInit:v=10,randomState:x}={}){super(),gt(this,"nClusters"),gt(this,"init"),gt(this,"nInit"),gt(this,"maxIter"),gt(this,"tol"),gt(this,"randomState"),gt(this,"clusterCenters"),gt(this,"name","KMeans"),gt(this,"tf"),this.tf=X(),this.nClusters=c,this.init=h,this.maxIter=f,this.tol=p,this.randomState=x,this.nInit=v,this.clusterCenters=this.tf.tensor2d([[]])}initCentroids(c){if("random"!==this.init)throw new Error(`init ${this.init} is not currently implemented`);{let h=Ue(c.shape[0],this.nClusters,this.randomState);this.clusterCenters=this.tf.gather(c,h)}}closestCentroid(c){return this.tf.tidy(()=>{const h=this.tf.expandDims(c,1),f=this.tf.expandDims(this.clusterCenters,0);return this.tf.squaredDifference(h,f).sum(2).argMin(1)})}updateCentroids(c,h){return this.tf.tidy(()=>{const f=[];for(let p=0;p<this.nClusters;p++){const v=this.tf.equal(h,this.tf.scalar(p).toInt()),x=this.tf.div(this.tf.sum(this.tf.mul(this.tf.expandDims(v.toFloat(),1),c),0),this.tf.sum(v.toFloat()));f.push(x)}return this.tf.stack(f)})}fit(c){let h=Ye(c);this.initCentroids(h);for(let f=0;f<this.maxIter;f++){const p=this.closestCentroid(h);this.clusterCenters=this.updateCentroids(h,p)}return this}predict(c){let h=Ye(c);return this.closestCentroid(h)}transform(c){return this.tf.tidy(()=>{const h=Ye(c),f=this.tf.expandDims(h,1),p=this.tf.expandDims(this.clusterCenters,0);return this.tf.squaredDifference(f,p).sum(2).sqrt()})}fitPredict(c){return this.fit(c).predict(c)}fitTransform(c){return this.fit(c).transform(c)}score(c){return this.tf.tidy(()=>{const h=Ye(c),f=this.tf.expandDims(h,1),p=this.tf.expandDims(this.clusterCenters,0);return this.tf.squaredDifference(f,p).sum(2).min(1).sqrt().sum()})}}const L9={loadBoston:"http://scikitjs.org/data/boston.csv",loadIris:"http://scikitjs.org/data/iris.csv",loadWine:"http://scikitjs.org/data/wine.csv",loadDiabetes:"http://scikitjs.org/data/diabetes.csv",loadBreastCancer:"http://scikitjs.org/data/breast_cancer.csv",loadDigits:"http://scikitjs.org/data/digits.csv",fetchCaliforniaHousing:"http://scikitjs.org/data/california_housing.csv"};class sk extends oh{constructor({estimators:c=[],weights:h}={}){super(),gt(this,"estimators"),gt(this,"weights"),gt(this,"name","VotingRegressor"),this.tf=X(),this.estimators=c,this.weights=h}fit(c,h){var f=this;return(0,K.Z)(function*(){var p;for(let v=0;v<(null==(p=f.estimators)?void 0:p.length);v++){let[x,S]=f.estimators[v];yield S.fit(c,h)}return f})()}predict(c){let h=[],f=this.estimators.length;const p=this.weights||Array(f).fill(1/f);for(let v=0;v<f;v++){let[x,S]=this.estimators[v],N=p[v];h.push(S.predict(c).mul(N))}return this.tf.addN(h)}transform(c){let h=[],f=this.estimators.length;for(let p=0;p<f;p++){let[v,x]=this.estimators[p];h.push(x.predict(c))}return h}fitTransform(c,h){var f=this;return(0,K.Z)(function*(){return(yield f.fit(c,h)).transform(c)})()}}function qz(...l){let c=[];for(let h=0;h<l.length;h++){let f=l[h];c.push([f.name,f])}return new sk({estimators:c})}class ok extends $i{constructor({estimators:c=[],weights:h,voting:f="hard"}={}){super(),gt(this,"estimators"),gt(this,"weights"),gt(this,"le"),gt(this,"name","VotingClassifier"),gt(this,"tf"),this.tf=X(),this.estimators=c,this.weights=h,this.voting=f,this.le=new rk}fit(c,h){var f=this;return(0,K.Z)(function*(){var v;let p=f.le.fitTransform(h);for(let x=0;x<(null==(v=f.estimators)?void 0:v.length);x++){let[S,N]=f.estimators[x];yield N.fit(c,p)}return f})()}predictProba(c){let h=[],f=this.estimators.length;const p=this.weights||Array(f).fill(1/f);for(let v=0;v<f;v++){let[x,S]=this.estimators[v],N=p[v];h.push(S.predictProba(c).mul(N))}return this.tf.addN(h)}predict(c){let h=[],f=this.estimators.length;const p=this.weights||Array(f).fill(1/f);if("hard"===this.voting){for(let v=0;v<f;v++){let[x,S]=this.estimators[v],N=p[v],T=S.predict(c).toInt(),C=this.tf.oneHot(T,this.le.classes.length);h.push(C.mul(N))}return this.tf.tensor1d(this.le.inverseTransform(this.tf.addN(h).argMax(1)))}for(let v=0;v<f;v++){let[x,S]=this.estimators[v],N=p[v],T=S.predictProba(c);h.push(T.mul(N))}return this.tf.tensor1d(this.le.inverseTransform(this.tf.addN(h).argMax(1)))}transform(c){let h=[],f=this.estimators.length;if("hard"===this.voting){for(let p=0;p<f;p++){let[v,x]=this.estimators[p];h.push(x.predict(c))}return h}for(let p=0;p<f;p++){let[v,x]=this.estimators[p];h.push(x.predictProba(c))}return h}fitTransform(c,h){var f=this;return(0,K.Z)(function*(){return(yield f.fit(c,h)).transform(c)})()}}function Zz(...l){let c=[];for(let h=0;h<l.length;h++){let f=l[h];c.push([f.name,f])}return new ok({estimators:c})}class uC{constructor({metric:c,entries:h}){gt(this,"_metric"),gt(this,"_entries"),gt(this,"tf"),this._metric=c,this._entries=h,this.tf=X()}kNearest(c,h){const{_metric:f,_entries:p}=this;return ee(p.shape[1]==h.shape[1],"X_train.shape[1] must equal X_predict.shape[1]"),this.tf.tidy(()=>{const v=this.tf.unstack(h).map(x=>this.tf.tidy(()=>{const S=f.tensorDistance(x,p).neg(),{values:N,indices:T}=this.tf.topk(S,c);return[N,T]}));return{distances:this.tf.stack(v.map(x=>x[0])).neg(),indices:this.tf.stack(v.map(x=>x[1]))}})}}const lC=l=>(c,h)=>{var x,S;let f=X();return ee((null!=(x=c.shape[c.rank-1])?x:NaN)===(null!=(S=h.shape[h.rank-1])?S:NaN),`minkowskiDistance(${l}).tensorDistance(u,v): u.shape[-1] must equal v.shape[-1].`),f.tidy(()=>f.norm(f.sub(c,h),l,-1))},Dh=l=>{switch(l){case 1:return ak;case 2:return cC;case 1/0:return Da}ee(1<=l,"minkowskiMetric(p): Invalid p.");const c={tensorDistance:lC(l),distance(h,f){const p=h.length;if(p!==f.length)throw new Error(`minkowskiMetric(${l}).treeMetric(u,v): u and v must have same length.`);let v=0;for(let x=0;x<p;x++)v+=Math.abs(h[x]-f[x])**l;return v**(1/l)},distToBBox(h,f){if(2*h.length!=f.length)throw new Error(`minkowskiMetric(${l}).treeMetric.minDistToBBox(pt,bBox): pt.length*2 must equal bBox.length.`);let p=0;for(let v=0,x=0;x<h.length;x++)p+=Math.max(0,f[v++]-h[x],h[x]-f[v++])**l;return p**(1/l)},name:`minkowskiMetric(${l})`,toString(){return this.name}};return Object.freeze(c)},ak=Object.freeze({tensorDistance:lC(1),distance(l,c){const h=l.length;if(h!==c.length)throw new Error("minkowskiMetric(1).distance(u,v): u and v must have same length.");let f=0;for(let p=0;p<h;p++)f+=Math.abs(l[p]-c[p]);return f},minDistToBBox(l,c){const h=c.length;if(h!==l.length<<1)throw new Error("minkowskiMetric(1).minDistToBBox(pt,bBox): pt.length*2 must equal bBox.length.");let f=0;for(let p=0;p<h;){const v=l[p>>>1],x=c[p++]-v,S=v-c[p++];f+=.5*(Math.abs(x)+x+(Math.abs(S)+S))}return f},name:"manhattanMetric",toString(){return this.name}}),cC=Object.freeze({tensorDistance:lC(2),distance(l,c){const h=l.length;if(h!==c.length)throw new Error("minkowskiMetric(2).distance(u,v): u and v must have same length.");let f=0;for(let p=0;p<h;p++){const v=l[p]-c[p];f+=v*v}return Math.sqrt(f)},minDistToBBox(l,c){const h=c.length;if(h!==2*l.length)throw new Error("minkowskiMetric(2).minDistToBBox(pt,bBox): pt.length*2 must equal bBox.length.");let f=0;for(let p=0;p<h;){const v=l[p>>>1],x=c[p++]-v,S=v-c[p++],N=.5*(Math.abs(x)+x+(Math.abs(S)+S));f+=N*N}return Math.sqrt(f)},name:"euclideanMetric",toString(){return this.name}}),Da=Object.freeze({tensorDistance:lC(1/0),distance(l,c){const h=l.length;if(h!==c.length)throw new Error("minkowskiMetric(Infinity).distance(u,v): u and v must have same length.");let f=0;for(let p=0;p<h;p++){const v=Math.abs(l[p]-c[p]);f=Math.max(f,v)}return f},minDistToBBox(l,c){const h=c.length;if(h!==2*l.length)throw new Error("minkowskiMetric(Infinity).minDistToBBox(pt,bBox): pt.length*2 must equal bBox.length.");let f=-1/0;for(let p=0;p<h;){const v=l[p>>>1],x=c[p++]-v,S=v-c[p++],N=.5*(Math.abs(x)+x+(Math.abs(S)+S));f=Math.max(f,N)}return f},name:"chebyshevMetric",toString(){return this.name}});function Vf(l,c){let h=new uk(l),f=()=>h.next();return function $9(l,c,h){let f=h&&h.state;f&&("object"==typeof f&&c.copy(f,c),l.state=()=>c.copy(c,{}))}(f,h,c),f}class uk{constructor(c){gt(this,"c"),gt(this,"s0"),gt(this,"s1"),gt(this,"s2"),null==c&&(c=+new Date);let h=4022871197;function f(p){p=String(p);for(let v=0;v<p.length;v++){h+=p.charCodeAt(v);let x=.02519603282416938*h;h=x>>>0,x-=h,x*=h,h=x>>>0,x-=h,h+=4294967296*x}return 2.3283064365386963e-10*(h>>>0)}this.c=1,this.s0=f(" "),this.s1=f(" "),this.s2=f(" "),this.s0-=f(c),this.s0<0&&(this.s0+=1),this.s1-=f(c),this.s1<0&&(this.s1+=1),this.s2-=f(c),this.s2<0&&(this.s2+=1)}next(){let{c,s0:h,s1:f,s2:p}=this,v=2091639*h+2.3283064365386963e-10*c;return this.s0=f,this.s1=p,this.s2=v-(this.c=0|v)}copy(c,h){return h.c=c.c,h.s0=c.s0,h.s1=c.s1,h.s2=c.s2,h}}const zf=l=>(c,h)=>{if(c>=h)throw new Error("randInt(rng)(from,until): from must be less than until.");const f=Math.floor(c+(h-c)*l());return f===h?f-1:f};class E_{constructor(c,h){gt(this,"_keys"),gt(this,"_vals"),gt(this,"_pos");const f=c.length;ee(f>0,"new CappedMaxHeap(keys,vals): keys.length must be positive."),ee(f===h.length,"new CappedMaxHeap(keys,vals): keys.length must equal vals.length."),c[0]=NaN,this._keys=c,this._vals=h,this._pos=f}get maxKey(){return this._keys[0]}add(c,h){let{_keys:f,_vals:p,_pos:v}=this;if(0<v)this._pos=--v;else if(f[0]<=c)return;const x=f.length-1;for(;;){let S=1+(v<<1);if(S>x||(S+=+(S<x&&f[S]<f[S+1]),f[S]<=c))break;f[v]=f[S],p[v]=p[S],v=S}f[v]=c,p[v]=h}sort(){const{_keys:c,_vals:h,_pos:f}=this;ee(0===f,"CappedMaxHeap().sort(): Heap is not full yet.");const p=(N,T)=>{let C=c[N];c[N]=c[T],c[T]=C;let b=h[N];h[N]=h[T],h[T]=b},v=N=>{c[N]>c[N+1]&&p(N,N+1)},x=N=>{v(N),c[N+1]>c[N+2]&&(p(N+1,N+2),v(N))},S=(N,T)=>{switch(T-N){case 0:case 1:return;case 2:return v(N);case 3:return x(N)}const C=N+T>>>1;x(C-1);const b=c[C];p(N,C);let I=N,M=N+1;for(let k=M;k<T;k++){let F=c[k];F<=b&&(p(k,M),F<b&&p(I++,M),M++)}S(N,I),S(M,T)};S(0,c.length)}}const Mh=l=>1+(l<<1);class Pg{constructor(c,h,f,p,v,x,S){gt(this,"_nSamples"),gt(this,"_nFeatures"),gt(this,"_metric"),gt(this,"_points"),gt(this,"_indices"),gt(this,"_bBoxes"),gt(this,"_offsets"),gt(this,"tf"),this.tf=X(),this._nSamples=c,this._nFeatures=h,this._metric=f,this._points=p,this._bBoxes=v,this._offsets=x,this._indices=S,Object.freeze(this)}static build({metric:c,entries:h,leafSize:f=16}){return(0,K.Z)(function*(){ee(1<f,"new KdTree({leafSize=16}): leafSize must be a positive number."),ee("function"==typeof c.minDistToBBox,"new KdTree({metric}): metric must implement `minDistToBBox` function.");const[p,v]=h.shape,x=new Int32Array(p);for(let de=0;de<p;de++)x[de]=de;const S=(yield h.data()).slice(),N=Array.from(x,(de,j)=>S.subarray(v*j,v*++j)),T=(ee(0<=(l=p/f)&&l<=1073741824,"ceilPow2(x): x must be in range [0, 1<<30]."),l=Math.ceil(l),l=Math.max(l,1),2147483648>>>-1+Math.clz32(l-1)),C=2*T-1,b=C-T,I=new Int32Array(T+1),M=function(){const de=2*v,j=new Float32Array(C*de),ae=[];for(let le=0;le<C;)ae.push(j.subarray(de*le,de*++le));return ae}(),k=zf(Vf(`KdTree[${p},${v}]`)),F=(de,j)=>{const ae=x[de];x[de]=x[j],x[j]=ae},oe=(de,j,ae)=>{const le=M[de];for(let Ee=0;Ee<le.length;Ee++)le[Ee]=Ee%2?-1/0:1/0;for(let Ee=j;Ee<ae;Ee++){const ve=v*x[Ee];for(let ke=0;ke<le.length;){const Oe=S[ve+(ke>>>1)];le[ke]=Math.min(le[ke++],Oe),le[ke]=Math.max(le[ke++],Oe)}}if(b<=de){const Ee=de-b;return I[Ee]=j,void(I[Ee+1]=ae)}const q=function(){let Ee=0,ve=-1/0;for(let ke=le.length;ke>0;){const Oe=le[--ke]-le[--ke];Oe>ve&&(ve=Oe,Ee=ke>>>1)}return Ee}(),Ce=j+ae>>>1;for(let Ee=j,ve=ae;;){const ke=S[v*x[k(Ee,ve)]+q];let Oe=Ee,Ze=Ee;for(let nt=Ee;nt<ve;nt++){let ht=S[v*x[nt]+q];ht<=ke&&(F(nt,Ze),ht<ke&&F(Oe++,Ze),Ze++)}if(Oe>Ce)ve=Oe;else{if(!(Ze<Ce))break;Ee=Ze}}const Se=Mh(de);oe(Se,j,Ce),oe(Se+1,Ce,ae)};var l;oe(0,0,p);const ne=(de,j)=>{j*=v;for(const ae=(de*=v)+v;de<ae;de++,j++){const le=S[de];S[de]=S[j],S[j]=le}};for(let de=x.slice(),j=0;j<p;j++)for(let ae=j;;){let le=de[ae];if(de[ae]=ae,le===j)break;ne(ae,ae=le)}return new Pg(p,v,c,N,M,I,x)})()}kNearest(c,h){const{_nSamples:f,_nFeatures:p,_metric:v,_points:x,_bBoxes:S,_offsets:N,_indices:T}=this;c=Math.min(c,f);const[C,b]=h.shape;ee(p===b,"KNeighbors: X_train.shape[1] must equal X_predict.shape[1].");const I=new Float32Array(C*c),M=new Int32Array(C*c),k=1+(S.length-1-1>>1);if(0<c&&0<C){const F=h.dataSync();let oe,ne;const de=(j,ae)=>{if(!(ae>=oe.maxKey))if(j<k){const le=Mh(j),q=v.minDistToBBox(ne,S[le]),Ce=v.minDistToBBox(ne,S[le+1]);q<=Ce?(de(le,q),de(le+1,Ce)):(de(le+1,Ce),de(le,q))}else{const q=N[1+(j-=k)];for(let Ce=N[j];Ce<q;Ce++){const Se=v.distance(ne,x[Ce]);oe.add(Se,T[Ce])}}};for(let j=0;j<C;j++){ne=F.subarray(b*j,b*(j+1));const ae=c*j,le=c+ae;oe=new E_(I.subarray(ae,le),M.subarray(ae,le)),de(0,v.minDistToBBox(ne,S[0]))}}return{distances:this.tf.tensor2d(I,[C,c],"float32"),indices:this.tf.tensor2d(M,[C,c],"int32")}}}const ck={uniform(l){let c=X();const{shape:h}=l;return c.fill(h,1/h[1])},distance(l){let c=X();return c.tidy(()=>{const h=l.min(1,!0),f=c.divNoNan(h.toFloat(),l),p=l.lessEqual(0).toFloat(),v=c.where(h.lessEqual(0),p,f),x=v.sum(1,!0);return v.div(x)})}},hk={minkowski:l=>Dh(l),manhattan:()=>Dh(1),euclidean:()=>Dh(2),chebyshev:()=>Dh(1/0)},N_={kdTree:Pg.build,brute:(l=(0,K.Z)(function*(c){return new uC(c)}),function(h){return l.apply(this,arguments)}),auto:l=>"function"==typeof l.metric.minDistToBBox?N_.kdTree(l):N_.brute(l)};var l;class Uc extends Ls{constructor(c={}){super(),gt(this,"_neighborhood"),gt(this,"_y"),gt(this,"weights"),gt(this,"algorithm"),gt(this,"leafSize"),gt(this,"p"),gt(this,"metric"),gt(this,"nNeighbors"),Object.assign(this,c)}_getFitParams(){const{_neighborhood:c,_y:h,nNeighbors:f=5,weights:p="uniform"}=this;return ee(0<=f&&f%1==0,"KNeighbors({nNeighbors})::predict(X): nNeighbors must be a positive int."),ee(Object.keys(ck).includes(p),"KNeighbors({weights})::predict(X): invalid weights."),ee(null!=c&&null!=h,"KNeighbors::predict(X): model not trained yet. Call `await fit(x, y)` first."),{nNeighbors:f,weightsFn:ck[p],neighborhood:c,y:h}}fit(c,h){var f=this;return(0,K.Z)(function*(){const{algorithm:p="auto",metric:v="minkowski",p:x=2,leafSize:S}=f;ee(Object.keys(hk).includes(v),"KNeighbors({metric}).fit(X,y): invalid metric."),ee(Object.keys(N_).includes(p),"KNeighbors({algorithm}).fit(X,y): invalid algorithm.");const N=hk[v](x),T=Ye(c);return f._neighborhood=yield N_[p]({entries:T,metric:N,leafSize:S}),f._y=Ne(h),f})()}}gt(Uc,"SUPPORTED_ALGORITHMS",Object.freeze(Object.keys(N_)));class hC extends Uc{constructor(){super(...arguments),gt(this,"name","KNeighborsRegressor")}predict(c){let h=X();const{neighborhood:f,y:p,nNeighbors:v,weightsFn:x}=this._getFitParams();return h.tidy(()=>{const S=Ye(c),{distances:N,indices:T}=f.kNearest(v,S),C=p.gather(T),b=x(N);return h.matMul(C.reshape([-1,1,v]),b.reshape([-1,v,1])).as1D()})}}function fk(l){l.engine().backendNames().includes("tensorflow")&&!l.getKernel("Unique","tensorflow")&&(console.info("[scikit.js] Installing tfjs-node polyfill for tf.unique()."),l.registerKernel({kernelName:"Unique",backendName:"tensorflow",kernelFunc:c=>{const h=c.inputs.x,f=c.backend,{axis:p}=c.attrs,v=l.tensor1d([p],"int32"),x={float32:f.binding.TF_FLOAT,float64:f.binding.TF_DOUBLE,int32:f.binding.TF_INT32,int64:f.binding.TF_INT64,complex64:f.binding.TF_COMPLEX64,bool:f.binding.TF_BOOL,string:f.binding.TF_STRING};ee(Object.keys(x).includes(h.dtype),"Unexpected dtype.");try{return f.executeMultipleOutputs("UniqueV2",[{value:x[h.dtype],name:"T",type:f.binding.TF_ATTR_TYPE},{value:x.int32,name:"Taxis",type:f.binding.TF_ATTR_TYPE},{value:x.int32,name:"out_idx",type:f.binding.TF_ATTR_TYPE}],[h,v],2)}finally{v.dispose()}}}))}function z9(l,c){let h=X();return h.tidy(()=>{c=$e(c);const f=this.predict(l);return h.equal(c,f).sum().div(c.shape[0])})}class U9 extends Uc{constructor(){super(...arguments),gt(this,"classes_"),gt(this,"score",z9),gt(this,"name","KNeighborsClassifier")}predictProba(c){var N;const{neighborhood:h,y:f,nNeighbors:p,weightsFn:v}=this._getFitParams(),[x]=null==(N=this.classes_)?void 0:N.shape;let S=X();return S.tidy(()=>{const T=Ye(c),C=T.shape[0],{distances:b,indices:I}=h.kNearest(p,T),M=f.gather(I),k=v(b),F=S.oneHot(M,x);return S.mul(F.reshape([C,p,x]),k.reshape([C,p,1])).sum(1)})}predict(c){const h=this.classes_;return X().tidy(()=>{const v=this.predictProba(c).argMax(1);return h.gather(v)})}fit(c,h){var f=()=>super.fit,p=this;return(0,K.Z)(function*(){let v=X();const{values:x,indices:S}=v.tidy(()=>{const N=$e(h);return fk(v),v.unique(N)});return yield f().call(p,c,S),p.classes_=x,p})()}}class H9 extends Pi{constructor({penalty:c="l2",C:h=1,fitIntercept:f=!0}={}){let p=X();super({modelCompileArgs:{optimizer:p.train.adam(.1),loss:p.losses.hingeLoss,metrics:["accuracy"]},modelFitArgs:{batchSize:32,epochs:1e3,verbose:0,callbacks:[p.callbacks.earlyStopping({monitor:"loss",patience:50})]},denseLayerArgs:{units:1,useBias:Boolean(f),activation:"softmax",kernelInitializer:p.initializers.zeros(),biasInitializer:p.initializers.zeros(),kernelRegularizer:"l2"===c?p.regularizers.l2({l2:h}):"l1"===c?p.regularizers.l1({l1:h}):void 0},isClassification:!0,optimizerType:"adam",lossType:"hingeLoss"}),this.name="LinearSVC"}}class W9 extends yc{constructor({epsilon:c=0,C:h=1,fitIntercept:f=!0}={}){let p=X();super({modelCompileArgs:{optimizer:p.train.adam(.1),loss:function(v,x){return p.abs(p.sub(v,x)).sub(c).maximum(0)},metrics:["accuracy"]},modelFitArgs:{batchSize:32,epochs:1e3,verbose:0,callbacks:[p.callbacks.earlyStopping({monitor:"loss",patience:50})]},denseLayerArgs:{units:1,useBias:Boolean(f),kernelRegularizer:p.regularizers.l2({l2:h})},optimizerType:"adam",lossType:"custom"}),this.name="LinearSVR"}}class Xz extends Ls{constructor(c={}){super(),gt(this,"priors"),gt(this,"varSmoothing"),gt(this,"classes"),gt(this,"means"),gt(this,"variances"),gt(this,"tf"),this.tf=X(),this.classes=this.tf.tensor1d([]),this.means=[],this.variances=[],c.priors&&(this.priors=$e(c.priors)),this.varSmoothing=c.varSmoothing?c.varSmoothing:1e-9}fit(c,h){var f=this;return(0,K.Z)(function*(){const p=Ye(c),v=$e(h),{values:x,meansByLabel:S,variancesByLabel:N}=f.tf.tidy(()=>{fk(f.tf);const T=[],C=[],{values:b}=f.tf.unique(v),{variance:I}=f.tf.moments(p,0),M=I.max().mul(f.varSmoothing);return f.tf.unstack(b).forEach(k=>{const F=f.tf.equal(v,k).toFloat(),oe=f.tf.sum(F),ne=f.tf.mul(p,F.expandDims(1)).sum(0).div(oe),de=f.tf.sub(p,ne).mul(F.expandDims(1)).pow(2).sum(0).div(oe).add(M);T.push(ne),C.push(de)}),{values:b,meansByLabel:T,variancesByLabel:C}});return f.classes=x,f.means=S,f.variances=N,f})()}predictProba(c){const h=Ye(c);return this.tf.tidy(()=>{let p=[];this.classes.unstack().forEach((x,S)=>{const C=this.kernel(h,this.means[S],this.variances[S]);p.push(C)});const v=this.tf.stack(p,1);return this.priors?v.mul(this.priors):v})}predict(c){return this.predictProba(c).argMax(1)}}class Yz extends Xz{constructor(){super(...arguments),gt(this,"name","GaussianNB")}kernel(c,h,f){let p=X();return p.tidy(()=>p.sub(c,h.expandDims(0)).pow(2).div(f.expandDims(0).mul(-2)).exp().div(f.mul(2*Math.PI).expandDims(0).sqrt()).prod(1))}}function dk(l,c){let h=0;for(let f=0;f<l.length;f++)h+=l[f]*l[f];return 1-h/(c*c)}function Qz(l,c){let h=0;for(let f=0;f<l.length;f++){let p=l[f];p>0&&(p/=c,h-=p*Math.log2(p))}return h}function Jz(l,c,h){let f=c/h;return l/h-f*f}class fC extends Ls{constructor({impurityMeasure:c,y:h}){super(),gt(this,"y"),gt(this,"impurityMeasure"),gt(this,"start",0),gt(this,"end",0),gt(this,"pos",0),gt(this,"nLabels"),gt(this,"labelFreqsTotal",[]),gt(this,"labelFreqsLeft",[]),gt(this,"labelFreqsRight",[]),gt(this,"nSamples",0),gt(this,"nSamplesLeft",0),gt(this,"nSamplesRight",0),gt(this,"name","ClassificationCriterion"),this.impurityMeasure=c,this.nLabels=function e4(l){let c=Number.NEGATIVE_INFINITY;for(let h=0;h<l.length;h++)l[h]>c&&(c=l[h]);return c}(h)+1,this.y=h,this.labelFreqsTotal=new Array(this.nLabels).fill(0),this.labelFreqsLeft=new Array(this.nLabels).fill(0),this.labelFreqsRight=new Array(this.nLabels).fill(0)}init(c,h,f){this.start=c,this.end=h,this.nSamples=h-c,this.labelFreqsTotal=this.labelFreqsTotal.fill(0),this.labelFreqsLeft=this.labelFreqsLeft.fill(0),this.labelFreqsRight=this.labelFreqsRight.fill(0);for(let p=c;p<h;p++)this.labelFreqsTotal[this.y[f[p]]]+=1}reset(){this.pos=this.start,this.labelFreqsLeft=this.labelFreqsLeft.fill(0),this.labelFreqsRight=this.labelFreqsRight.fill(0)}update(c,h){for(let f=this.pos;f<c;f++)this.labelFreqsLeft[this.y[h[f]]]+=1;for(let f=0;f<this.labelFreqsTotal.length;f++)this.labelFreqsRight[f]=this.labelFreqsTotal[f]-this.labelFreqsLeft[f];this.pos=c,this.nSamplesLeft=this.pos-this.start,this.nSamplesRight=this.end-this.pos}childrenImpurities(){let c="gini"===this.impurityMeasure?dk:Qz;return{impurityLeft:c(this.labelFreqsLeft,this.nSamplesLeft),impurityRight:c(this.labelFreqsRight,this.nSamplesRight)}}impurityImprovement(){let{impurityLeft:c,impurityRight:h}=this.childrenImpurities();return-this.nSamplesLeft*c-this.nSamplesRight*h}nodeImpurity(){return("gini"===this.impurityMeasure?dk:Qz)(this.labelFreqsTotal,this.nSamples)}nodeValue(){return this.labelFreqsTotal}static fromJson(c){const h=JSON.parse(c),f=new fC({impurityMeasure:h.impurityMeasure,y:h.y});return Object.assign(f,h)}}class dC extends Ls{constructor({impurityMeasure:c,y:h}){super(),gt(this,"y"),gt(this,"impurityMeasure"),gt(this,"start",0),gt(this,"end",0),gt(this,"pos",0),gt(this,"squaredSum",0),gt(this,"squaredSumLeft",0),gt(this,"squaredSumRight",0),gt(this,"sumTotal",0),gt(this,"sumTotalLeft",0),gt(this,"sumTotalRight",0),gt(this,"nSamples",0),gt(this,"nSamplesLeft",0),gt(this,"nSamplesRight",0),gt(this,"name","RegressionCriterion"),this.impurityMeasure=c,this.y=h}init(c,h,f){this.sumTotal=0,this.squaredSum=0,this.start=c,this.end=h,this.nSamples=h-c;for(let p=c;p<h;p++){let x=this.y[f[p]];this.sumTotal+=x,this.squaredSum+=x*x}}reset(){this.pos=this.start,this.squaredSumLeft=0,this.sumTotalLeft=0,this.squaredSumRight=0,this.sumTotalRight=0}update(c,h){for(let f=this.pos;f<c;f++){let v=this.y[h[f]];this.sumTotalLeft+=v,this.squaredSumLeft+=v*v}this.sumTotalRight=this.sumTotal-this.sumTotalLeft,this.squaredSumRight=this.squaredSum-this.squaredSumLeft,this.pos=c,this.nSamplesLeft=this.pos-this.start,this.nSamplesRight=this.end-this.pos}childrenImpurities(){let c=Jz;return{impurityLeft:c(this.squaredSumLeft,this.sumTotalLeft,this.nSamplesLeft),impurityRight:c(this.squaredSumRight,this.sumTotalRight,this.nSamplesRight)}}impurityImprovement(){let{impurityLeft:c,impurityRight:h}=this.childrenImpurities();return-this.nSamplesLeft*c-this.nSamplesRight*h}nodeImpurity(){return Jz(this.squaredSum,this.sumTotal,this.nSamples)}nodeValue(){return[this.sumTotal/this.nSamples]}static fromJson(c){const h=JSON.parse(c),f=new dC({impurityMeasure:h.impurityMeasure,y:h.y});return Object.assign(f,h)}}var G9=z(9336),j9=z.n(G9);function pk(){return{feature:0,threshold:0,pos:-1,impurityLeft:Number.POSITIVE_INFINITY,impurityRight:Number.POSITIVE_INFINITY,foundSplit:!1}}class t4 extends Ls{constructor({X:c,y:h,minSamplesLeaf:f,impurityMeasure:p,maxFeatures:v,samplesSubset:x=[]}){if(super(),gt(this,"kMinSplitDiff"),gt(this,"X"),gt(this,"y"),gt(this,"criterion"),gt(this,"start"),gt(this,"end"),gt(this,"minSamplesLeaf"),gt(this,"maxFeatures"),gt(this,"featureOrder"),gt(this,"shuffleFeatures"),gt(this,"sampleMap"),gt(this,"nSamplesTotal"),gt(this,"nFeatures"),gt(this,"name","Splitter"),this.X=c,this.y=h,this.nFeatures=c[0].length,this.minSamplesLeaf=f,this.maxFeatures=Math.min(v,this.nFeatures),this.shuffleFeatures=v<this.nFeatures,this.sampleMap=new Int32Array(c.length),this.start=0,this.end=0,this.kMinSplitDiff=1e-8,0===x.length){this.nSamplesTotal=c.length;for(let S=0;S<this.nSamplesTotal;S++)this.sampleMap[S]=S}else{this.nSamplesTotal=x.length;for(let S=0;S<this.nSamplesTotal;S++)this.sampleMap[S]=x[S]}this.criterion="squared_error"===p?new dC({impurityMeasure:p,y:h}):new fC({impurityMeasure:p,y:h}),this.featureOrder=[];for(let S=0;S<this.nFeatures;S++)this.featureOrder.push(S);this.resetSampleRange(0,this.nSamplesTotal)}resetSampleRange(c,h){this.start=c,this.end=h,this.criterion.init(c,h,this.sampleMap)}splitNode(){let c=pk(),h=pk(),f=Number.NEGATIVE_INFINITY,p=Number.NEGATIVE_INFINITY,v=0,x=0;for(c.foundSplit=!1,this.shuffleFeatures&&(this.featureOrder=j9()(this.featureOrder));v<this.maxFeatures;){x=this.featureOrder[v];let S=new Float32Array(this.end-this.start);for(let T=this.start;T<this.end;T++)S[T-this.start]=this.X[this.sampleMap[T]][x];if(S.sort(),this.criterion.reset(),this.sampleMap.subarray(this.start,this.end).sort((T,C)=>this.X[T][x]-this.X[C][x]),S[0]===S[S.length-1]){v+=1;continue}let N=this.start+1;for(;N<this.end;){for(;N<this.end&&S[N-this.start]<=S[N-this.start-1]+this.kMinSplitDiff;)N++;N!==this.end?(N-this.start<this.minSamplesLeaf||this.end-N<this.minSamplesLeaf||(c.pos=N,this.criterion.update(c.pos,this.sampleMap),f=this.criterion.impurityImprovement(),f>p&&(p=f,c.foundSplit=!0,c.feature=x,c.threshold=(S[N-this.start-1]+S[N-this.start])/2,h=Object.assign({},c))),N+=1):N++}v+=1}if(c.foundSplit){if(h.pos<this.end&&x!==h.feature){let T=this.start,C=this.end,b=0;for(;T<C;)this.X[this.sampleMap[T]][h.feature]<=h.threshold?T+=1:(C-=1,b=this.sampleMap[T],this.sampleMap[T]=this.sampleMap[C],this.sampleMap[C]=b)}this.criterion.reset(),this.criterion.update(h.pos,this.sampleMap);let{impurityLeft:S,impurityRight:N}=this.criterion.childrenImpurities();return h.impurityLeft=S,h.impurityRight=N,h}return c}}function mk(l){if(0===l.length)throw new Error(`X can not be empty, but it has a length of 0. It is ${l}.`);for(let c=0;c<l.length;c++){let h=l[c];if(0===h.length)throw new Error(`Rows in X can not be empty, but row ${c} in X is ${h}.`);for(let f=0;f<h.length;f++)if("number"!=typeof h[f]||!Number.isFinite(h[f]))throw new Error(`X must contain finite non-NaN numbers, but the element at X[${c}][${f}] is ${h[f]}`)}}function Z9(l){return l.map((c,h)=>[c,h]).reduce((c,h)=>h[0]>c[0]?h:c)[1]}class n4{constructor(){gt(this,"nodes",[]),gt(this,"isBuilt",!1),gt(this,"name","DecisionTree")}getLeafNodes(c){let h=[];for(let f=0;f<c.length;f++){let p=0;for(;!this.nodes[p].isLeaf;)p=c[f][this.nodes[p].splitFeature]<=this.nodes[p].threshold?this.nodes[p].leftChildId:this.nodes[p].rightChildId;h.push(p)}return h}populateChildIds(){for(let c=1;c<this.nodes.length;c++)this.nodes[c].isLeft?this.nodes[this.nodes[c].parentId].leftChildId=c:this.nodes[this.nodes[c].parentId].rightChildId=c}predictProba(c){if(!this.isBuilt)throw new Error("Decision tree must be built with BuildTree method before predictions can be made.");let h=this.getLeafNodes(c),f=[];for(let p=0;p<h.length;p++){let v=[],x=h[p];for(let S=0;S<this.nodes[0].value.length;S++)v.push(this.nodes[x].value[S]/this.nodes[x].nSamples);f.push(v)}return f}predictClassification(c){if(!this.isBuilt)throw new Error("Decision tree must be built with BuildTree method before predictions can be made.");let h=this.getLeafNodes(c),f=[];for(let p=0;p<h.length;p++)f.push(Z9(this.nodes[h[p]].value));return f}predictRegression(c){if(!this.isBuilt)throw new Error("Decision tree must be built with BuildTree method before predictions can be made.");let h=this.getLeafNodes(c),f=[];for(let p=0;p<h.length;p++)f.push(this.nodes[h[p]].value[0]);return f}}class gk extends Ls{constructor({criterion:c="gini",maxDepth:h=Number.POSITIVE_INFINITY,minSamplesSplit:f=2,minSamplesLeaf:p=1,maxFeatures:v,minImpurityDecrease:x=0}={}){super(),gt(this,"splitter"),gt(this,"stack",[]),gt(this,"minSamplesLeaf"),gt(this,"maxDepth"),gt(this,"minSamplesSplit"),gt(this,"minImpurityDecrease"),gt(this,"tree"),gt(this,"criterion"),gt(this,"maxFeatures"),gt(this,"maxFeaturesNumb"),gt(this,"X",[]),gt(this,"y",[]),gt(this,"labelEncoder"),gt(this,"name"),this.criterion=c,this.maxDepth=void 0===h?Number.POSITIVE_INFINITY:Number(h),this.minSamplesSplit=f,this.minSamplesLeaf=p,this.maxFeatures=v,this.minImpurityDecrease=x,this.maxFeaturesNumb=0,this.tree=new n4,this.name="DecisionTreeBase"}calcMaxFeatures(c,h){return"log2"===h?Math.floor(Math.log2(c)):"sqrt"===h||"auto"===h?Math.floor(Math.sqrt(c)):"number"==typeof h?(ee(h>=1,"maxFeatures must be greater than 1"),Math.min(Math.floor(h),c)):c}fit(c,h,f){this.X=c,this.y=h;let p=f||[];this.maxFeaturesNumb=this.calcMaxFeatures(c[0].length,this.maxFeatures),this.splitter=new t4({X:c,y:h,minSamplesLeaf:this.minSamplesLeaf,impurityMeasure:this.criterion,maxFeatures:this.maxFeaturesNumb,samplesSubset:p}),this.stack.push({start:0,end:this.splitter.sampleMap.length,depth:0,impurity:0,nSamples:this.splitter.sampleMap.length,parentId:-1,isLeft:!1});let x=!0;for(;0!==this.stack.length;){let S=this.stack.pop();this.splitter.resetSampleRange(S.start,S.end);let N=pk(),T=!(S.depth<this.maxDepth)||S.nSamples<this.minSamplesSplit||S.nSamples<2*this.minSamplesLeaf;x&&(S.impurity=this.splitter.criterion.nodeImpurity(),x=!1),T||(N=this.splitter.splitNode(),T=T||!N.foundSplit||S.impurity<=this.minImpurityDecrease);let C={parentId:S.parentId,impurity:S.impurity,isLeaf:T,isLeft:S.isLeft,nSamples:S.nSamples,splitFeature:N.feature,threshold:N.threshold,value:this.splitter.criterion.nodeValue().slice(),leftChildId:-1,rightChildId:-1};this.tree.nodes.push(C);let b=this.tree.nodes.length-1;T||(this.stack.push({start:N.pos,end:S.end,nSamples:S.end-N.pos,depth:S.depth+1,parentId:b,isLeft:!1,impurity:N.impurityRight}),this.stack.push({start:S.start,end:N.pos,nSamples:N.pos-S.start,depth:S.depth+1,parentId:b,isLeft:!0,impurity:N.impurityLeft}))}this.tree.populateChildIds(),this.tree.isBuilt=!0}}class K9 extends gk{constructor({criterion:c="gini",maxDepth:h,minSamplesSplit:f=2,minSamplesLeaf:p=1,maxFeatures:v,minImpurityDecrease:x=0}={}){ee(["gini","entropy"].includes(c),'For classification must pass either the "gini" or "entropy" criterion'),super({criterion:c,maxDepth:h,minSamplesSplit:f,minSamplesLeaf:p,maxFeatures:v,minImpurityDecrease:x}),gt(this,"labelEncoder"),gt(this,"name"),this.labelEncoder=new rk,this.name="DecisionTreeClassifier"}fit(c,h){ee(Pe(h),"y value is not a 1D container"),ee(Ke(c),"X value is not a 2D container");let f=je(c),p=We(h);ee(f.length===p.length,"X and y must be the same size"),mk(f),function q9(l){if(0===l.length)throw new Error(`y can not be empty, but it has a length of 0. It is ${l}.`);for(let c=0;c<l.length;c++){let h=l[c];if(!Number.isSafeInteger(h))throw new Error(`Some y values are not an integer. Found ${h} but must be an integer only`)}}(p);let v=this.labelEncoder.fitTransform(p);return super.fit(f,We(v)),this}getNLeaves(){return this.tree.nodes.filter(c=>c.isLeaf).length}predict(c){ee(Ke(c),"X value is not a 2D container");let h=je(c);mk(h);let f=this.tree.predictClassification(h);return this.labelEncoder.inverseTransform(f)}predictProba(c){return this.tree.predictProba(c)}score(c,h){return Fe(h,this.predict(c))}}class X9 extends gk{constructor({criterion:c="squared_error",maxDepth:h,minSamplesSplit:f=2,minSamplesLeaf:p=1,maxFeatures:v,minImpurityDecrease:x=0}={}){ee(["squared_error"].includes(c),'Must pass the regression criterion of "squared_error"'),super({criterion:c,maxDepth:h,minSamplesSplit:f,minSamplesLeaf:p,maxFeatures:v,minImpurityDecrease:x}),gt(this,"name"),this.name="DecisionTreeRegressor"}fit(c,h){ee(Pe(h),"y value is not a 1D container"),ee(Ke(c),"X value is not a 2D container");let f=je(c),p=We(h);return ee(f.length===p.length,"X and y must be the same size"),mk(f),super.fit(f,p),this}getNLeaves(){return this.tree.nodes.filter(c=>c.isLeaf).length}predict(c){return this.tree.predictRegression(c)}score(c,h){return pt(h,this.predict(c))}}const Y9=({nSamples:l=100,nFeatures:c=100,nInformative:h=10,nTargets:f=1,noise:p=1,bias:v=0,effectiveRank:x=null,tailStrength:S=.5,shuffle:N=!1,coef:T=!1}={})=>{let C=X();return C.tidy(()=>{const b=Math.min(c,h);let I;I=null===x?C.randomNormal([l,c]):r4({nSamples:l,nFeatures:c,effectiveRank:x,tailStrength:S});const M=C.randomNormal([b,f]).mul(100),k=C.zeros([c-b,f]),F=C.concat([M,k]);let oe=I.dot(F).add(v);if(p>0&&(oe=oe.add(C.randomNormal(oe.shape,void 0,p))),N){const ne=C.util.createShuffledIndices(l);I=I.gather(ne)}return oe=C.squeeze(oe),T?[I,oe,C.squeeze(F)]:[I,oe]})},r4=({nSamples:l=100,nFeatures:c=100,effectiveRank:h=10,tailStrength:f=.5}={})=>{let p=X();return p.tidy(()=>{let v=Math.min(l,c),[x]=p.linalg.qr(p.randomNormal([l,v])),[S]=p.linalg.qr(p.randomNormal([c,v]));const T=p.range(0,v).div(h),C=p.exp(T.square().neg()).mul(1-f);let b=p.exp(T.mul(-.1)).mul(f),I=C.add(b);return x.mul(I).dot(S.transpose())})};class i4{constructor({nSplits:c=5,shuffle:h=!1,randomState:f}={}){gt(this,"nSplits"),gt(this,"shuffle"),gt(this,"randomState"),gt(this,"name"),gt(this,"tf"),c=Number(c),ee(Number.isInteger(c)&&c>1,"new KFold({nSplits}): nSplits must be an int greater than 1."),this.tf=X(),this.nSplits=c,this.shuffle=Boolean(h),this.randomState=f,this.name="KFold"}getNumSplits(){return this.nSplits}*split(c,h,f){const{nSplits:p,shuffle:v,randomState:x}=this,S=Pt(c);ee(p<=S,"KFold({nSplits})::split(X): nSplits must not be greater than X.shape[0]."),null!=h&&ee(S===Pt(h),"KFold::split(X,y): X.shape[0] must equal y.shape[0]."),null!=f&&ee(S===Pt(f),"KFold::split(X,y,groups): X.shape[0] must equal groups.shape[0].");const N=new Int32Array(S);for(let I=0;I<N.length;I++)N[I]=I;if(v){const I=(l=>Vf(null==l?void 0:l.toString()))(x);(l=>c=>{const h=zf(l);for(let f=c.length;f>1;f--){const p=h(0,f),v=c[f-1];c[f-1]=c[p],c[p]=v}})(I)(N)}const T=Math.floor(S/p);let C=S%p,b=0;for(;b<S;){const I=C-- >0?T+1:T,M=new Int32Array(S-I);M.set(N.subarray(0,b),0),M.set(N.subarray(b+I),b);const k=N.slice(b,b+I);yield{trainIndex:this.tf.tensor1d(M,"int32"),testIndex:this.tf.tensor1d(k,"int32")},b+=I}}}function pC(l,c){let h=X();return te(l)?h.gather(l,c):xe(l)?l.iloc({rows:c}):ce(l)?l.iloc(c):c.map(f=>l[f])}function J9(l,c,h=.1,f,p){const v=Pt(l);ee(v===Pt(c),"X and y don't have the same number of elements. They are of different size");let[S,N]=function Q9(l,c,h,f=.1){if(ee(void 0===h||"number"==typeof h,`Invalid value for trainSize: ${h}. Must be number or undefined`),ee(void 0===c||"number"==typeof c,`Invalid value for testSize: ${c}. Must be number or undefined`),void 0===c&&void 0===h&&(c=f),"number"==typeof c&&(Number.isInteger(c)&&(c>=l||c<=0)||!Number.isInteger(c)&&(c<=0||c>=1)))throw Error(`testSize=${c} should be either positive and smaller than the number of samples ${l} or a float in the (0, 1) range`);if("number"==typeof h&&(Number.isInteger(h)&&(h>=l||h<=0)||!Number.isInteger(h)&&(h<=0||h>=1)))throw Error(`trainSize=${h} should be either positive and smaller than the number of samples ${l} or a float in the (0, 1) range`);if(!Number.isInteger(h)&&!Number.isInteger(c)&&h&&c&&h+c>1)throw Error(`The sum of testSize and trainSize = ${h+c}, should be in the (0, 1) range. Reduce testSize and/or trainSize.`);let p,v;if(Number.isInteger(c)?p=c:"number"==typeof c&&(p=Math.ceil(c*l)),Number.isInteger(h)?v=h:"number"==typeof h&&(v=Math.ceil(h*l)),void 0===h&&(v=l-p),void 0===c&&(p=l-v),"number"!=typeof v||"number"!=typeof p)throw Error("nTrain and nTest must be a number");if(v+p>l)throw Error(`The sum of trainSize and testSize = ${v+p}, should be smaller than the number of samples ${l}. Reduce testSize and/or trainSize.`);if(v=Math.floor(v),p=Math.floor(p),0===v)throw Error(`With nSamples=${l}, testSize=${c} and trainSize=${h}, the resulting train set will be empty. Adjust any of the aforementioned parameters.`);return[v,p]}(v,h,f),T=Ue(v,v,p),C=T.slice(0,S),b=T.slice(S);return[pC(l,C),pC(l,b),pC(c,C),pC(c,b)]}function eq(l,c,h,f){return vk.apply(this,arguments)}function vk(){return vk=(0,K.Z)(function*(l,c,h,f){let p=X(),v=null==h||null==f&&!Pe(h);v&&(f=null!=f?f:h);let{cv:x=new i4,groups:S,scoring:N}=null!=f?f:{};null==N&&(ee("function"==typeof l.score,"crossValScore(estimator,[X,y],params): Either params.scoring or estimator.score(X,y) must be defined."),N=l.score);const T=[];let C;N=N.bind(l),p.engine().startScope();try{c=we(c),v||(h=$e(h));for(const{trainIndex:b,testIndex:I}of x.split(c,h,S)){let M;const k=c.gather(b),F=c.gather(I);if(v)yield l.fit(k),M=N(F);else{const oe=h.gather(b),ne=h.gather(I);yield l.fit(k,oe),M=N(F,ne),oe.dispose(),ne.dispose()}T.push(M),b.dispose(),I.dispose(),k.dispose(),F.dispose()}return C=p.stack(T)}finally{p.engine().endScope(C)}}),vk.apply(this,arguments)}},340:(rt,Ae,z)=>{var G=z(9471),K=z(2992),ue=z(7657),re=z(5583),X=z(1929),se=z(8083),be=z(3818);be.alea=G,be.xor128=K,be.xorwow=ue,be.xorshift7=re,be.xor4096=X,be.tychei=se,rt.exports=be},9471:function(rt,Ae,z){var G;!function(K,ue,re){function X(ee){var ge=this,W=function V(){var ee=4022871197;return function(W){W=String(W);for(var J=0;J<W.length;J++){var H=.02519603282416938*(ee+=W.charCodeAt(J));H-=ee=H>>>0,ee=(H*=ee)>>>0,ee+=4294967296*(H-=ee)}return 2.3283064365386963e-10*(ee>>>0)}}();ge.next=function(){var J=2091639*ge.s0+2.3283064365386963e-10*ge.c;return ge.s0=ge.s1,ge.s1=ge.s2,ge.s2=J-(ge.c=0|J)},ge.c=1,ge.s0=W(" "),ge.s1=W(" "),ge.s2=W(" "),ge.s0-=W(ee),ge.s0<0&&(ge.s0+=1),ge.s1-=W(ee),ge.s1<0&&(ge.s1+=1),ge.s2-=W(ee),ge.s2<0&&(ge.s2+=1),W=null}function se(ee,ge){return ge.c=ee.c,ge.s0=ee.s0,ge.s1=ee.s1,ge.s2=ee.s2,ge}function be(ee,ge){var W=new X(ee),J=ge&&ge.state,H=W.next;return H.int32=function(){return 4294967296*W.next()|0},H.double=function(){return H()+11102230246251565e-32*(2097152*H()|0)},H.quick=H,J&&("object"==typeof J&&se(J,W),H.state=function(){return se(W,{})}),H}ue&&ue.exports?ue.exports=be:z.amdD&&z.amdO?void 0!==(G=function(){return be}.call(Ae,z,Ae,ue))&&(ue.exports=G):this.alea=be}(0,rt=z.nmd(rt))},8083:function(rt,Ae,z){var G;!function(K,ue,re){function X(V){var ee=this,ge="";ee.next=function(){var J=ee.b,H=ee.c,Y=ee.d,me=ee.a;return J=J<<25^J>>>7^H,H=H-Y|0,Y=Y<<24^Y>>>8^me,me=me-J|0,ee.b=J=J<<20^J>>>12^H,ee.c=H=H-Y|0,ee.d=Y<<16^H>>>16^me,ee.a=me-J|0},ee.a=0,ee.b=0,ee.c=-1640531527,ee.d=1367130551,V===Math.floor(V)?(ee.a=V/4294967296|0,ee.b=0|V):ge+=V;for(var W=0;W<ge.length+20;W++)ee.b^=0|ge.charCodeAt(W),ee.next()}function se(V,ee){return ee.a=V.a,ee.b=V.b,ee.c=V.c,ee.d=V.d,ee}function be(V,ee){var ge=new X(V),W=ee&&ee.state,J=function(){return(ge.next()>>>0)/4294967296};return J.double=function(){do{var me=((ge.next()>>>11)+(ge.next()>>>0)/4294967296)/(1<<21)}while(0===me);return me},J.int32=ge.next,J.quick=J,W&&("object"==typeof W&&se(W,ge),J.state=function(){return se(ge,{})}),J}ue&&ue.exports?ue.exports=be:z.amdD&&z.amdO?void 0!==(G=function(){return be}.call(Ae,z,Ae,ue))&&(ue.exports=G):this.tychei=be}(0,rt=z.nmd(rt))},2992:function(rt,Ae,z){var G;!function(K,ue,re){function X(V){var ee=this,ge="";ee.x=0,ee.y=0,ee.z=0,ee.w=0,ee.next=function(){var J=ee.x^ee.x<<11;return ee.x=ee.y,ee.y=ee.z,ee.z=ee.w,ee.w^=ee.w>>>19^J^J>>>8},V===(0|V)?ee.x=V:ge+=V;for(var W=0;W<ge.length+64;W++)ee.x^=0|ge.charCodeAt(W),ee.next()}function se(V,ee){return ee.x=V.x,ee.y=V.y,ee.z=V.z,ee.w=V.w,ee}function be(V,ee){var ge=new X(V),W=ee&&ee.state,J=function(){return(ge.next()>>>0)/4294967296};return J.double=function(){do{var me=((ge.next()>>>11)+(ge.next()>>>0)/4294967296)/(1<<21)}while(0===me);return me},J.int32=ge.next,J.quick=J,W&&("object"==typeof W&&se(W,ge),J.state=function(){return se(ge,{})}),J}ue&&ue.exports?ue.exports=be:z.amdD&&z.amdO?void 0!==(G=function(){return be}.call(Ae,z,Ae,ue))&&(ue.exports=G):this.xor128=be}(0,rt=z.nmd(rt))},1929:function(rt,Ae,z){var G;!function(K,ue,re){function X(V){var ee=this;ee.next=function(){var Y,me,W=ee.w,J=ee.X,H=ee.i;return ee.w=W=W+1640531527|0,me=J[H+34&127],Y=J[H=H+1&127],me^=me<<13,Y^=Y<<17,me=J[H]=(me^=me>>>15)^(Y^=Y>>>12),ee.i=H,me+(W^W>>>16)|0},function ge(W,J){var H,Y,me,te,ce,xe=[],Pe=128;for(J===(0|J)?(Y=J,J=null):(J+="\0",Y=0,Pe=Math.max(Pe,J.length)),me=0,te=-32;te<Pe;++te)J&&(Y^=J.charCodeAt((te+32)%J.length)),0===te&&(ce=Y),Y^=Y<<10,Y^=Y>>>15,Y^=Y<<4,Y^=Y>>>13,te>=0&&(me=0==(H=xe[127&te]^=Y+(ce=ce+1640531527|0))?me+1:0);for(me>=128&&(xe[127&(J&&J.length||0)]=-1),me=127,te=512;te>0;--te)Y=xe[me+34&127],H=xe[me=me+1&127],Y^=Y<<13,H^=H<<17,xe[me]=(Y^=Y>>>15)^(H^=H>>>12);W.w=ce,W.X=xe,W.i=me}(ee,V)}function se(V,ee){return ee.i=V.i,ee.w=V.w,ee.X=V.X.slice(),ee}function be(V,ee){null==V&&(V=+new Date);var ge=new X(V),W=ee&&ee.state,J=function(){return(ge.next()>>>0)/4294967296};return J.double=function(){do{var me=((ge.next()>>>11)+(ge.next()>>>0)/4294967296)/(1<<21)}while(0===me);return me},J.int32=ge.next,J.quick=J,W&&(W.X&&se(W,ge),J.state=function(){return se(ge,{})}),J}ue&&ue.exports?ue.exports=be:z.amdD&&z.amdO?void 0!==(G=function(){return be}.call(Ae,z,Ae,ue))&&(ue.exports=G):this.xor4096=be}(0,rt=z.nmd(rt))},5583:function(rt,Ae,z){var G;!function(K,ue,re){function X(V){var ee=this;ee.next=function(){var H,Y,W=ee.x,J=ee.i;return H=W[J],Y=(H^=H>>>7)^H<<24,Y^=(H=W[J+1&7])^H>>>10,Y^=(H=W[J+3&7])^H>>>3,Y^=(H=W[J+4&7])^H<<7,H=W[J+7&7],W[J]=Y^=(H^=H<<13)^H<<9,ee.i=J+1&7,Y},function ge(W,J){var H,me=[];if(J===(0|J))me[0]=J;else for(J=""+J,H=0;H<J.length;++H)me[7&H]=me[7&H]<<15^J.charCodeAt(H)+me[H+1&7]<<13;for(;me.length<8;)me.push(0);for(H=0;H<8&&0===me[H];++H);for(8==H&&(me[7]=-1),W.x=me,W.i=0,H=256;H>0;--H)W.next()}(ee,V)}function se(V,ee){return ee.x=V.x.slice(),ee.i=V.i,ee}function be(V,ee){null==V&&(V=+new Date);var ge=new X(V),W=ee&&ee.state,J=function(){return(ge.next()>>>0)/4294967296};return J.double=function(){do{var me=((ge.next()>>>11)+(ge.next()>>>0)/4294967296)/(1<<21)}while(0===me);return me},J.int32=ge.next,J.quick=J,W&&(W.x&&se(W,ge),J.state=function(){return se(ge,{})}),J}ue&&ue.exports?ue.exports=be:z.amdD&&z.amdO?void 0!==(G=function(){return be}.call(Ae,z,Ae,ue))&&(ue.exports=G):this.xorshift7=be}(0,rt=z.nmd(rt))},7657:function(rt,Ae,z){var G;!function(K,ue,re){function X(V){var ee=this,ge="";ee.next=function(){var J=ee.x^ee.x>>>2;return ee.x=ee.y,ee.y=ee.z,ee.z=ee.w,ee.w=ee.v,(ee.d=ee.d+362437|0)+(ee.v=ee.v^ee.v<<4^J^J<<1)|0},ee.x=0,ee.y=0,ee.z=0,ee.w=0,ee.v=0,V===(0|V)?ee.x=V:ge+=V;for(var W=0;W<ge.length+64;W++)ee.x^=0|ge.charCodeAt(W),W==ge.length&&(ee.d=ee.x<<10^ee.x>>>4),ee.next()}function se(V,ee){return ee.x=V.x,ee.y=V.y,ee.z=V.z,ee.w=V.w,ee.v=V.v,ee.d=V.d,ee}function be(V,ee){var ge=new X(V),W=ee&&ee.state,J=function(){return(ge.next()>>>0)/4294967296};return J.double=function(){do{var me=((ge.next()>>>11)+(ge.next()>>>0)/4294967296)/(1<<21)}while(0===me);return me},J.int32=ge.next,J.quick=J,W&&("object"==typeof W&&se(W,ge),J.state=function(){return se(ge,{})}),J}ue&&ue.exports?ue.exports=be:z.amdD&&z.amdO?void 0!==(G=function(){return be}.call(Ae,z,Ae,ue))&&(ue.exports=G):this.xorwow=be}(0,rt=z.nmd(rt))},3818:function(rt,Ae,z){var G;!function(K,ue,re){var H,X=256,ee=re.pow(X,6),ge=re.pow(2,52),W=2*ge,J=255;function Y(Ve,it,bt){var $e=[],Ne=xe(ce((it=1==it?{entropy:!0}:it||{}).entropy?[Ve,Ke(ue)]:null==Ve?function Pe(){try{var Ve;return H&&(Ve=H.randomBytes)?Ve=Ve(X):(Ve=new Uint8Array(X),(K.crypto||K.msCrypto).getRandomValues(Ve)),Ke(Ve)}catch($e){var it=K.navigator,bt=it&&it.plugins;return[+new Date,K,bt,K.screen,Ke(ue)]}}():Ve,3),$e),we=new me($e),qe=function(){for(var Ye=we.g(6),at=ee,At=0;Ye<ge;)Ye=(Ye+At)*X,at*=X,At=we.g(1);for(;Ye>=W;)Ye/=2,at/=2,At>>>=1;return(Ye+At)/at};return qe.int32=function(){return 0|we.g(4)},qe.quick=function(){return we.g(4)/4294967296},qe.double=qe,xe(Ke(we.S),ue),(it.pass||bt||function(Ye,at,At,Ut){return Ut&&(Ut.S&&te(Ut,we),Ye.state=function(){return te(we,{})}),At?(re.random=Ye,at):Ye})(qe,Ne,"global"in it?it.global:this==re,it.state)}function me(Ve){var it,bt=Ve.length,$e=this,Ne=0,we=$e.i=$e.j=0,qe=$e.S=[];for(bt||(Ve=[bt++]);Ne<X;)qe[Ne]=Ne++;for(Ne=0;Ne<X;Ne++)qe[Ne]=qe[we=J&we+Ve[Ne%bt]+(it=qe[Ne])],qe[we]=it;($e.g=function(Ye){for(var at,At=0,Ut=$e.i,Mt=$e.j,sn=$e.S;Ye--;)at=sn[Ut=J&Ut+1],At=At*X+sn[J&(sn[Ut]=sn[Mt=J&Mt+at])+(sn[Mt]=at)];return $e.i=Ut,$e.j=Mt,At})(X)}function te(Ve,it){return it.i=Ve.i,it.j=Ve.j,it.S=Ve.S.slice(),it}function ce(Ve,it){var Ne,bt=[],$e=typeof Ve;if(it&&"object"==$e)for(Ne in Ve)try{bt.push(ce(Ve[Ne],it-1))}catch(we){}return bt.length?bt:"string"==$e?Ve:Ve+"\0"}function xe(Ve,it){for(var $e,bt=Ve+"",Ne=0;Ne<bt.length;)it[J&Ne]=J&($e^=19*it[J&Ne])+bt.charCodeAt(Ne++);return Ke(it)}function Ke(Ve){return String.fromCharCode.apply(0,Ve)}if(xe(re.random(),ue),rt.exports){rt.exports=Y;try{H=z(5042)}catch(Ve){}}else void 0!==(G=function(){return Y}.call(Ae,z,Ae,rt))&&(rt.exports=G)}("undefined"!=typeof self?self:this,[],Math)},1977:function(rt,Ae){"use strict";var z,K;z=function(){function ue(){return!0}function re(){return!1}function X(){}return function se(){var be=[{name:"number",test:function(ct){return"number"==typeof ct}},{name:"string",test:function(ct){return"string"==typeof ct}},{name:"boolean",test:function(ct){return"boolean"==typeof ct}},{name:"Function",test:function(ct){return"function"==typeof ct}},{name:"Array",test:Array.isArray},{name:"Date",test:function(ct){return ct instanceof Date}},{name:"RegExp",test:function(ct){return ct instanceof RegExp}},{name:"Object",test:function(ct){return"object"==typeof ct&&null!==ct&&ct.constructor===Object}},{name:"null",test:function(ct){return null===ct}},{name:"undefined",test:function(ct){return void 0===ct}}],V={name:"any",test:ue},ee=[],ge=[],W={types:be,conversions:ge,ignore:ee};function J(ct){var ze=mr(W.types,function(ft){return ft.name===ct});if(ze)return ze;if("any"===ct)return V;var et=mr(W.types,function(ft){return ft.name.toLowerCase()===ct.toLowerCase()});throw new TypeError('Unknown type "'+ct+'"'+(et?'. Did you mean "'+et.name+'"?':""))}function H(ct){return ct===V?999:W.types.indexOf(ct)}function Y(ct){var ze=mr(W.types,function(et){return et.test(ct)});if(ze)return ze.name;throw new TypeError("Value has unknown type. Value: "+ct)}function ce(ct){return ct.map(function(ze){var et=ze.types.map(we);return(ze.restParam?"...":"")+et.join("|")}).join(",")}function xe(ct,ze){var et=0===ct.indexOf("..."),Gt=(et?ct.length>3?ct.slice(3):"any":ct).split("|").map(he).filter(_e).filter(rn),bn=function je(ct,ze){var et={};return ct.forEach(function(ft){-1===ze.indexOf(ft.from)&&-1!==ze.indexOf(ft.to)&&!et[ft.from]&&(et[ft.from]=ft)}),Object.keys(et).map(function(ft){return et[ft]})}(ze,Gt),wn=Gt.map(function(En){var Zn=J(En);return{name:En,typeIndex:H(Zn),test:Zn.test,conversion:null,conversionIndex:-1}}),on=bn.map(function(En){var Zn=J(En.from);return{name:En.from,typeIndex:H(Zn),test:Zn.test,conversion:En,conversionIndex:ze.indexOf(En)}});return{types:wn.concat(on),restParam:et}}function Ke(ct){var ze=pt(ct);return!!ze&&ze.restParam}function Ve(ct){return ct.types.some(function(ze){return null!=ze.conversion})}function it(ct){if(!ct||0===ct.types.length)return ue;if(1===ct.types.length)return J(ct.types[0].name).test;if(2===ct.types.length){var ze=J(ct.types[0].name).test,et=J(ct.types[1].name).test;return function(bn){return ze(bn)||et(bn)}}var ft=ct.types.map(function(Gt){return J(Gt.name).test});return function(bn){for(var wn=0;wn<ft.length;wn++)if(ft[wn](bn))return!0;return!1}}function bt(ct){var ze,et,ft;if(Ke(ct)){var Gt=(ze=function _t(ct){return ct.slice(0,ct.length-1)}(ct).map(it)).length,bn=it(pt(ct));return function(En){for(var Zn=0;Zn<ze.length;Zn++)if(!ze[Zn](En[Zn]))return!1;return function(on){for(var En=Gt;En<on.length;En++)if(!bn(on[En]))return!1;return!0}(En)&&En.length>=Gt+1}}return 0===ct.length?function(En){return 0===En.length}:1===ct.length?(et=it(ct[0]),function(En){return et(En[0])&&1===En.length}):2===ct.length?(et=it(ct[0]),ft=it(ct[1]),function(En){return et(En[0])&&ft(En[1])&&2===En.length}):(ze=ct.map(it),function(En){for(var Zn=0;Zn<ze.length;Zn++)if(!ze[Zn](En[Zn]))return!1;return En.length===ze.length})}function $e(ct,ze){return ze<ct.params.length?ct.params[ze]:Ke(ct.params)?pt(ct.params):null}function Ne(ct,ze,et){var ft=$e(ct,ze);return(ft?et?ft.types.filter(qe):ft.types:[]).map(we)}function we(ct){return ct.name}function qe(ct){return null==ct.conversion}function Ye(ct,ze){var et=function Br(ct){for(var ze={},et=0;et<ct.length;et++)ze[ct[et]]=!0;return Object.keys(ze)}(Ps(ct,function(ft){return Ne(ft,ze,!1)}));return-1!==et.indexOf("any")?["any"]:et}function at(ct,ze,et){var ft,Gt,on,bn=ct||"unnamed",wn=et;for(on=0;on<ze.length;on++){var En=wn.filter(function(bi){var js=it($e(bi,on));return(on<bi.params.length||Ke(bi.params))&&js(ze[on])});if(0===En.length){if((Gt=Ye(wn,on)).length>0){var Zn=Y(ze[on]);return(ft=new TypeError("Unexpected type of argument in function "+bn+" (expected: "+Gt.join(" or ")+", actual: "+Zn+", index: "+on+")")).data={category:"wrongType",fn:bn,index:on,actual:Zn,expected:Gt},ft}}else wn=En}var Nr=wn.map(function(bi){return Ke(bi.params)?1/0:bi.params.length});if(ze.length<Math.min.apply(null,Nr))return Gt=Ye(wn,on),(ft=new TypeError("Too few arguments in function "+bn+" (expected: "+Gt.join(" or ")+", index: "+ze.length+")")).data={category:"tooFewArgs",fn:bn,index:ze.length,expected:Gt},ft;var ji=Math.max.apply(null,Nr);return ze.length>ji?((ft=new TypeError("Too many arguments in function "+bn+" (expected: "+ji+", actual: "+ze.length+")")).data={category:"tooManyArgs",fn:bn,index:ze.length,expectedLength:ji},ft):((ft=new TypeError('Arguments of type "'+ze.join(", ")+'" do not match any of the defined signatures of function '+bn+".")).data={category:"mismatch",actual:ze.map(Y)},ft)}function At(ct){for(var ze=999,et=0;et<ct.types.length;et++)qe(ct.types[et])&&(ze=Math.min(ze,ct.types[et].typeIndex));return ze}function Ut(ct){for(var ze=999,et=0;et<ct.types.length;et++)qe(ct.types[et])||(ze=Math.min(ze,ct.types[et].conversionIndex));return ze}function Mt(ct,ze){var et;return 0!=(et=ct.restParam-ze.restParam)||0!=(et=Ve(ct)-Ve(ze))||0!=(et=At(ct)-At(ze))?et:Ut(ct)-Ut(ze)}function sn(ct,ze){var ft,Gt,et=Math.min(ct.params.length,ze.params.length);if(0!=(Gt=ct.params.some(Ve)-ze.params.some(Ve)))return Gt;for(ft=0;ft<et;ft++)if(0!=(Gt=Ve(ct.params[ft])-Ve(ze.params[ft])))return Gt;for(ft=0;ft<et;ft++)if(0!==(Gt=Mt(ct.params[ft],ze.params[ft])))return Gt;return ct.params.length-ze.params.length}function tt(ct){var ze,et,ft,Gt,bn=[],wn=[];switch(ct.types.forEach(function(on){on.conversion&&(bn.push(J(on.conversion.from).test),wn.push(on.conversion.convert))}),wn.length){case 0:return function(En){return En};case 1:return ze=bn[0],ft=wn[0],function(En){return ze(En)?ft(En):En};case 2:return ze=bn[0],et=bn[1],ft=wn[0],Gt=wn[1],function(En){return ze(En)?ft(En):et(En)?Gt(En):En};default:return function(En){for(var Zn=0;Zn<wn.length;Zn++)if(bn[Zn](En))return wn[Zn](En);return En}}}function Ue(ct,ze){return function et(ft,Gt,bn){if(Gt<ft.length){var En,wn=ft[Gt],on=ze?wn.types.filter(qe):wn.types;if(wn.restParam){var Zn=on.filter(qe);En=Zn.length<on.length?[Zn,on]:[on]}else En=on.map(function(ji){return[ji]});return Ps(En,function(ji){return et(ft,Gt+1,bn.concat([ji]))})}return[bn.map(function(ji,bi){return{types:ji,restParam:bi===ft.length-1&&Ke(ft)}})]}(ct,0,[])}function Vt(ct,ze){if(0===Object.keys(ze).length)throw new SyntaxError("No signatures provided");var et=[];Object.keys(ze).map(function(mi){return function Pe(ct,ze,et){var ft=[];return""!==ct.trim()&&(ft=ct.split(",").map(he).map(function(Gt,bn,wn){var on=xe(Gt,et);if(on.restParam&&bn!==wn.length-1)throw new SyntaxError('Unexpected rest parameter "'+Gt+'": only allowed for the last parameter');return on})),ft.some(yt)?null:{params:ft,fn:ze}}(mi,ze[mi],W.conversions)}).filter(Fe).forEach(function(mi){var Ji=mr(et,function(pa){return function xt(ct,ze){for(var et=Math.max(ct.params.length,ze.params.length),ft=0;ft<et;ft++)if(!_r(Ne(ct,ft,!0),Ne(ze,ft,!0)))return!1;var wn=ct.params.length,on=ze.params.length,En=Ke(ct.params),Zn=Ke(ze.params);return En?Zn?wn===on:on>=wn:Zn?wn>=on:wn===on}(pa,mi)});if(Ji)throw new TypeError('Conflicting signatures "'+ce(Ji.params)+'" and "'+ce(mi.params)+'".');et.push(mi)});var ft=Ps(et,function(mi){return(mi?Ue(mi.params,!1):[]).map(function(pa){return{params:pa,fn:mi.fn}})}).filter(Fe);ft.sort(sn);var Gt=ft[0]&&ft[0].params.length<=2&&!Ke(ft[0].params),bn=ft[1]&&ft[1].params.length<=2&&!Ke(ft[1].params),wn=ft[2]&&ft[2].params.length<=2&&!Ke(ft[2].params),on=ft[3]&&ft[3].params.length<=2&&!Ke(ft[3].params),En=ft[4]&&ft[4].params.length<=2&&!Ke(ft[4].params),Zn=ft[5]&&ft[5].params.length<=2&&!Ke(ft[5].params),Nr=Gt&&bn&&wn&&on&&En&&Zn,ji=ft.map(function(mi){return bt(mi.params)}),bi=Gt?it(ft[0].params[0]):re,js=bn?it(ft[1].params[0]):re,bo=wn?it(ft[2].params[0]):re,Ml=on?it(ft[3].params[0]):re,ym=En?it(ft[4].params[0]):re,kl=Zn?it(ft[5].params[0]):re,_d=Gt?it(ft[0].params[1]):re,Ls=bn?it(ft[1].params[1]):re,ko=wn?it(ft[2].params[1]):re,yb=on?it(ft[3].params[1]):re,oh=En?it(ft[4].params[1]):re,$i=Zn?it(ft[5].params[1]):re,Qu=ft.map(function(mi){return function We(ct,ze){var et=ze;if(ct.some(Ve)){var ft=Ke(ct),Gt=ct.map(tt);et=function(){for(var En=[],Zn=ft?arguments.length-1:arguments.length,Nr=0;Nr<Zn;Nr++)En[Nr]=Gt[Nr](arguments[Nr]);return ft&&(En[Zn]=arguments[Zn].map(Gt[Zn])),ze.apply(this,En)}}var bn=et;if(Ke(ct)){var wn=ct.length-1;bn=function(){return et.apply(this,Sn(arguments,0,wn).concat([Sn(arguments,wn)]))}}return bn}(mi.params,mi.fn)}),yc=Gt?Qu[0]:X,Qh=bn?Qu[1]:X,_m=wn?Qu[2]:X,Qi=on?Qu[3]:X,bd=En?Qu[4]:X,wd=Zn?Qu[5]:X,Pi=Gt?ft[0].params.length:-1,Bn=bn?ft[1].params.length:-1,Cu=wn?ft[2].params.length:-1,qs=on?ft[3].params.length:-1,Rl=En?ft[4].params.length:-1,Jh=Zn?ft[5].params.length:-1,ef=Nr?6:0,bm=ft.length,Ol=function(){for(var Ji=ef;Ji<bm;Ji++)if(ji[Ji](arguments))return Qu[Ji].apply(this,arguments);return W.onMismatch(ct,arguments,ft)},cn=function mi(Ji,pa){return arguments.length===Pi&&bi(Ji)&&_d(pa)?yc.apply(mi,arguments):arguments.length===Bn&&js(Ji)&&Ls(pa)?Qh.apply(mi,arguments):arguments.length===Cu&&bo(Ji)&&ko(pa)?_m.apply(mi,arguments):arguments.length===qs&&Ml(Ji)&&yb(pa)?Qi.apply(mi,arguments):arguments.length===Rl&&ym(Ji)&&oh(pa)?bd.apply(mi,arguments):arguments.length===Jh&&kl(Ji)&&$i(pa)?wd.apply(mi,arguments):Ol.apply(mi,arguments)};try{Object.defineProperty(cn,"name",{value:ct})}catch(mi){}return cn.signatures=function Pt(ct){var ze={};return ct.forEach(function(et){et.params.some(Ve)||Ue(et.params,!0).forEach(function(ft){ze[ce(ft)]=et.fn})}),ze}(ft),cn}function Qt(ct,ze,et){throw at(ct,ze,et)}function rn(ct){return-1===W.ignore.indexOf(ct)}function he(ct){return ct.trim()}function _e(ct){return!!ct}function Fe(ct){return null!==ct}function yt(ct){return 0===ct.types.length}function pt(ct){return ct[ct.length-1]}function Sn(ct,ze,et){return Array.prototype.slice.call(ct,ze,et)}function Gn(ct,ze){return-1!==ct.indexOf(ze)}function _r(ct,ze){for(var et=0;et<ct.length;et++)if(Gn(ze,ct[et]))return!0;return!1}function mr(ct,ze){for(var et=0;et<ct.length;et++)if(ze(ct[et]))return ct[et]}function Ps(ct,ze){return Array.prototype.concat.apply([],ct.map(ze))}function Yi(ct){for(var ze="",et=0;et<ct.length;et++){var ft=ct[et];if(("object"==typeof ft.signatures||"string"==typeof ft.signature)&&""!==ft.name)if(""===ze)ze=ft.name;else if(ze!==ft.name){var Gt=new Error("Function names do not match (expected: "+ze+", actual: "+ft.name+")");throw Gt.data={actual:ft.name,expected:ze},Gt}}return ze}function xs(ct){var ze,et={};function ft(on,En){if(et.hasOwnProperty(on)&&En!==et[on])throw(ze=new Error('Signature "'+on+'" is defined twice')).data={signature:on},ze}for(var Gt=0;Gt<ct.length;Gt++){var bn=ct[Gt];if("object"==typeof bn.signatures)for(var wn in bn.signatures)bn.signatures.hasOwnProperty(wn)&&(ft(wn,bn.signatures[wn]),et[wn]=bn.signatures[wn]);else{if("string"!=typeof bn.signature)throw(ze=new TypeError("Function is no typed-function (index: "+Gt+")")).data={index:Gt},ze;ft(bn.signature,bn),et[bn.signature]=bn}}return et}return(W=Vt("typed",{"string, Object":Vt,Object:function(ct){var ze=[];for(var et in ct)ct.hasOwnProperty(et)&&ze.push(ct[et]);return Vt(Yi(ze),ct)},"...Function":function(ct){return Vt(Yi(ct),xs(ct))},"string, ...Function":function(ct,ze){return Vt(ct,xs(ze))}})).create=se,W.types=be,W.conversions=ge,W.ignore=ee,W.onMismatch=Qt,W.throwMismatchError=Qt,W.createError=at,W.convert=function te(ct,ze){var et=Y(ct);if(ze===et)return ct;for(var ft=0;ft<W.conversions.length;ft++){var Gt=W.conversions[ft];if(Gt.from===et&&Gt.to===ze)return Gt.convert(ct)}throw new Error("Cannot convert from "+et+" to "+ze)},W.find=function me(ct,ze){if(!ct.signatures)throw new TypeError("Function is no typed-function");var et;if("string"==typeof ze){et=ze.split(",");for(var ft=0;ft<et.length;ft++)et[ft]=et[ft].trim()}else{if(!Array.isArray(ze))throw new TypeError("String array or a comma separated string expected");et=ze}var Gt=et.join(","),bn=ct.signatures[Gt];if(bn)return bn;throw new TypeError("Signature not found (signature: "+(ct.name||"unnamed")+"("+et.join(", ")+"))")},W.addType=function(ct,ze){if(!ct||"string"!=typeof ct.name||"function"!=typeof ct.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==ze)for(var et=0;et<W.types.length;et++)if("Object"===W.types[et].name)return void W.types.splice(et,0,ct);W.types.push(ct)},W.addConversion=function(ct){if(!ct||"string"!=typeof ct.from||"string"!=typeof ct.to||"function"!=typeof ct.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");W.conversions.push(ct)},W}()},void 0!==(K=z.apply(Ae,[]))&&(rt.exports=K)},5410:()=>{},8628:()=>{},1601:()=>{},7792:()=>{},8963:()=>{},5042:()=>{},5861:(rt,Ae,z)=>{"use strict";function G(ue,re,X,se,be,V,ee){try{var ge=ue[V](ee),W=ge.value}catch(J){return void X(J)}ge.done?re(W):Promise.resolve(W).then(se,be)}function K(ue){return function(){var re=this,X=arguments;return new Promise(function(se,be){var V=ue.apply(re,X);function ee(W){G(V,se,be,ee,ge,"next",W)}function ge(W){G(V,se,be,ee,ge,"throw",W)}ee(void 0)})}}z.d(Ae,{Z:()=>K})}},rt=>{rt(rt.s=1063)}]);